{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.10", "generated_at": "2024-03-26T06:28:02.624211Z", "invocation_id": "297a4e87-5f10-4b84-85b2-de56c2a36707", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:01.778942Z", "completed_at": "2024-03-26T06:28:01.807297Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:01.807297Z", "completed_at": "2024-03-26T06:28:01.904151Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13811302185058594, "adapter_response": {"_message": "SELECT 1000", "code": "SELECT", "rows_affected": 1000}, "message": "SELECT 1000", "failures": null, "unique_id": "model.postgres_dev.us_healthcare_claims_data", "compiled": true, "compiled_code": "\n \nwith us_healthcare_claims AS (\n\tSELECT *\n\tFROM \n\t\t\"bootcamp_project\".\"public\".\"us_healthcare_claims\"\n),\nsource_data AS (\n \n    select claim as claim_id, member_id, name, address, email, \n\tcase when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,\n\tdate(date_of_birth) AS date_of_birth,\n\tCOALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,\n    \tCASE \n        \tWHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)\n        \tELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3\n            \t\tELSE NULL \n        \t\tEND \n    \tEND AS diagnosis_2,\n    \tCASE \n        \tWHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3\n        \tELSE NULL \n    \tEND AS diagnosis_3,\n\tallowed_amount::varchar AS allowed_amount,\n    paid_amount::varchar AS paid_amount,\n\tenrolled_date,\n\tclaimed_date,\n\tpaid_date,\n\tcreated_date\n\t\n\tfrom \n\t\tus_healthcare_claims\n)\n \nselect *\nfrom source_data", "relation_name": "\"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:01.767045Z", "completed_at": "2024-03-26T06:28:01.778942Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:01.778942Z", "completed_at": "2024-03-26T06:28:02.071811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.31830382347106934, "adapter_response": {"_message": "SELECT 71704", "code": "SELECT", "rows_affected": 71704}, "message": "SELECT 71704", "failures": null, "unique_id": "model.postgres_dev.icd_codes_data", "compiled": true, "compiled_code": "\n\nwith source_data as (\n \n    select category_code, diagnosis_code, full_code, full_description, category_title\n\tfrom \"bootcamp_project\".\"public\".\"icd_codes\"\n \n)\n \nselect *\nfrom source_data", "relation_name": "\"bootcamp_project\".\"public_silver\".\"icd_codes_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:02.005754Z", "completed_at": "2024-03-26T06:28:02.005754Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.023596Z", "completed_at": "2024-03-26T06:28:02.158097Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2382056713104248, "adapter_response": {"_message": "SELECT 1000", "code": "SELECT", "rows_affected": 1000}, "message": "SELECT 1000", "failures": null, "unique_id": "model.postgres_dev.fact_claims", "compiled": true, "compiled_code": "\n\nwith us_healthcare_claims_data AS (\n  SELECT *\n  FROM\n    \"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\"\n\n),\n fact_claims AS (\nSELECT\n  claim_id,\n  member_id as member_key,\n  diagnosis_1 as diagnosis_1_key,\n  diagnosis_2 as diagnosis_2_key,\n  diagnosis_3 as diagnosis_3_key,\n  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,\n  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,\n  date(enrolled_date) as enrolled_date_key, \n  date(claimed_date) as claimed_date_key,\n  date(paid_date) as paid_date_key\n\nFROM\n  us_healthcare_claims_data\n)\n\nSELECT * \nFROM fact_claims", "relation_name": "\"bootcamp_project\".\"public_silver\".\"fact_claims\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:01.922357Z", "completed_at": "2024-03-26T06:28:02.005754Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.019192Z", "completed_at": "2024-03-26T06:28:02.158097Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.25394630432128906, "adapter_response": {"_message": "SELECT 1000", "code": "SELECT", "rows_affected": 1000}, "message": "SELECT 1000", "failures": null, "unique_id": "model.postgres_dev.dim_member", "compiled": true, "compiled_code": "\n\nwith us_healthcare_claims_data AS (\n  Select * \n  FROM\n  \"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\"\n),\nmember_details AS (\n  SELECT\n    DISTINCT member_id AS member_key,\n    name,\n    address,\n    email,\n    gender\n  FROM\n    us_healthcare_claims_data\n)\n\nSELECT *\nFROM member_details", "relation_name": "\"bootcamp_project\".\"public_silver\".\"dim_member\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:01.922233Z", "completed_at": "2024-03-26T06:28:02.005754Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.005754Z", "completed_at": "2024-03-26T06:28:02.158097Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2654571533203125, "adapter_response": {"_message": "SELECT 118", "code": "SELECT", "rows_affected": 118}, "message": "SELECT 118", "failures": null, "unique_id": "model.postgres_dev.dim_date", "compiled": true, "compiled_code": "\n\nwith us_healthcare_claims_data AS (\n    SELECT * \n    FROM \"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\"\n),\ndates_data AS (\n    SELECT\n        DISTINCT DATE(dates) as date_key,\n        EXTRACT(DAY FROM dates) as day_of_month,\n        EXTRACT(MONTH FROM dates) as month,\n        EXTRACT(YEAR FROM dates) as year,\n        EXTRACT(QUARTER FROM dates) as quarter,\n        EXTRACT(DOW FROM dates) as day_of_week,\n        EXTRACT(DOY FROM dates) as day_of_year,\n        EXTRACT(WEEK FROM dates) as week_of_year,\n        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend\n    FROM (\n        SELECT enrolled_date as dates FROM us_healthcare_claims_data \n        UNION\n        SELECT claimed_date as dates FROM us_healthcare_claims_data \n        UNION\n        SELECT paid_date as dates FROM us_healthcare_claims_data \n        UNION\n        SELECT created_date as dates FROM us_healthcare_claims_data \n    ) AS all_dates\n    ORDER BY date_key\n)\n\nSELECT * \nFROM dates_data", "relation_name": "\"bootcamp_project\".\"public_silver\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:02.108711Z", "completed_at": "2024-03-26T06:28:02.121429Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.124957Z", "completed_at": "2024-03-26T06:28:02.257849Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15245389938354492, "adapter_response": {"_message": "SELECT 1000", "code": "SELECT", "rows_affected": 1000}, "message": "SELECT 1000", "failures": null, "unique_id": "model.postgres_dev.final_us_healthcare_claims_data", "compiled": true, "compiled_code": "\n \nwith us_healthcare_claims_data AS (\n\tSELECT *\n\tFROM \n\t\t\"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\"\n),\nsource_data as (\n \n    select\n\tclaim_id, member_id, name, address, email, \n\tgender,\n\tdate(date_of_birth) AS date_of_birth,\n\tdiagnosis_1,\n    diagnosis_2,\n    diagnosis_3,\n\tallowed_amount,\n    paid_amount,\n\tdate(enrolled_date) as enrolled_date,\n\tdate(claimed_date) as claimed_date,\n\tdate(paid_date) as paid_date,\n\tdate(created_date) as created_date\n\t\nfrom \n\tus_healthcare_claims_data\n \n)\n \nselect *\nfrom source_data", "relation_name": "\"bootcamp_project\".\"public_gold\".\"final_us_healthcare_claims_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:02.194184Z", "completed_at": "2024-03-26T06:28:02.205720Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.210665Z", "completed_at": "2024-03-26T06:28:02.374444Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.20620203018188477, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.postgres_dev.total_allowed_amount", "compiled": true, "compiled_code": "\n\nWITH fact_claims AS (\n    SELECT \n        *\n    FROM \n        \"bootcamp_project\".\"public_silver\".\"fact_claims\"\n),\nsource_data AS (\n    SELECT \n        sum(allowed_amount) AS total_allowed_amount\n    FROM \n        fact_claims\n)\n \nSELECT *\nFROM source_data", "relation_name": "\"bootcamp_project\".\"public_gold\".\"total_allowed_amount\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:02.194184Z", "completed_at": "2024-03-26T06:28:02.207708Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.223489Z", "completed_at": "2024-03-26T06:28:02.386394Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.21817302703857422, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.postgres_dev.total_paid_amount", "compiled": true, "compiled_code": "\n\nWITH fact_claims AS (\n    SELECT \n        *\n    FROM \n        \"bootcamp_project\".\"public_silver\".\"fact_claims\"\n), \nsource_data AS (\n    SELECT \n        sum(paid_amount) AS total_paid_amount\n    FROM \n        fact_claims\n)\n \nSELECT *\nFROM source_data", "relation_name": "\"bootcamp_project\".\"public_gold\".\"total_paid_amount\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:02.272384Z", "completed_at": "2024-03-26T06:28:02.281257Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.283378Z", "completed_at": "2024-03-26T06:28:02.405926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1386725902557373, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.postgres_dev.diagnosis_frequency_by_gender", "compiled": true, "compiled_code": "\n\nWITH fact_claims AS( \n    SELECT *\n    FROM \"bootcamp_project\".\"public_silver\".\"fact_claims\"\n),\ndim_member AS (\n    SELECT *\n    FROM \"bootcamp_project\".\"public_silver\".\"dim_member\"\n),\ncte AS (\n    SELECT member_key,\n        CASE WHEN COALESCE(diagnosis_1_key, diagnosis_2_key, diagnosis_3_key) IS NOT NULL THEN\n                  CASE WHEN diagnosis_1_key is not null AND diagnosis_2_key is not null AND diagnosis_3_key is not null THEN 3\n                       WHEN diagnosis_1_key is not null AND diagnosis_2_key is not null THEN 2\n                       ELSE 1\n                  END\n            ELSE null\n        END AS diagnosis_count_member\nFROM fact_claims\n),\ncte_2 AS(\n    SELECT t1.member_key,t2.name,t2.address,t2.gender,t1.diagnosis_count_member \n    FROM cte AS t1\n    JOIN dim_member AS t2\n    ON t1.member_key = t2.member_key\n),\ncte_3 AS(\n    SELECT gender,SUM(diagnosis_count_member) AS diagnosis_frequency \n    FROM cte_2\n    GROUP BY gender\n    ORDER BY diagnosis_frequency DESC\n)\n\nSELECT * \nFROM cte_3", "relation_name": "\"bootcamp_project\".\"public_gold\".\"diagnosis_frequency_by_gender\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:02.174287Z", "completed_at": "2024-03-26T06:28:02.194184Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.209706Z", "completed_at": "2024-03-26T06:28:02.408537Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2481234073638916, "adapter_response": {"_message": "SELECT 71704", "code": "SELECT", "rows_affected": 71704}, "message": "SELECT 71704", "failures": null, "unique_id": "model.postgres_dev.dim_diagnosis", "compiled": true, "compiled_code": "-- models/dim_diagnosis.sql\n\n\n\nWITH icd_codes AS (\n  select *\n  from \"bootcamp_project\".\"public_silver\".\"icd_codes_data\"\n)\n\nSELECT\n  full_code AS diagnosis_key,\n  category_code,\n  diagnosis_code,\n  full_description,\n  category_title\nFROM\n  icd_codes", "relation_name": "\"bootcamp_project\".\"public_silver\".\"dim_diagnosis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:02.400673Z", "completed_at": "2024-03-26T06:28:02.403670Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.408537Z", "completed_at": "2024-03-26T06:28:02.496301Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.10062956809997559, "adapter_response": {"_message": "SELECT 30", "code": "SELECT", "rows_affected": 30}, "message": "SELECT 30", "failures": null, "unique_id": "model.postgres_dev.total_paid_amount_by_day", "compiled": true, "compiled_code": "\n\nWITH fact_claims AS ( \n    SELECT * \n    FROM \n         \"bootcamp_project\".\"public_silver\".\"fact_claims\"\n), \ndim_day AS (\n    SELECT\n        date_key,\n        day_of_month\n    FROM\n        \"bootcamp_project\".\"public_silver\".\"dim_date\"\n),\ncalculate AS (\n    SELECT \n        d.day_of_month AS day_of_month,\n        SUM(fc.paid_amount) AS total_paid_amount\n    FROM \n        fact_claims fc\n    LEFT JOIN\n        dim_day d ON fc.paid_date_key = d.date_key\n    WHERE\n        fc.paid_date_key IS NOT NULL AND fc.paid_amount IS NOT NULL\n    GROUP BY \n        d.day_of_month \n    ORDER BY\n        d.day_of_month \n)\n \nSELECT *\nFROM calculate", "relation_name": "\"bootcamp_project\".\"public_gold\".\"total_paid_amount_by_day\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-26T06:28:02.428719Z", "completed_at": "2024-03-26T06:28:02.439154Z"}, {"name": "execute", "started_at": "2024-03-26T06:28:02.440151Z", "completed_at": "2024-03-26T06:28:02.572568Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14477944374084473, "adapter_response": {"_message": "SELECT 2060", "code": "SELECT", "rows_affected": 2060}, "message": "SELECT 2060", "failures": null, "unique_id": "model.postgres_dev.diagnosis_frequency_by_key", "compiled": true, "compiled_code": "-- models/diagnosis_analysis.sql\n\n\n\nWITH fact_claims AS (\n  SELECT\n    diagnosis_1_key,\n    diagnosis_2_key,\n    diagnosis_3_key\n  FROM \"bootcamp_project\".\"public_silver\".\"fact_claims\"\n),\ndim_diagnosis AS (\n  SELECT *\n  FROM \"bootcamp_project\".\"public_silver\".\"dim_diagnosis\"\n),\nanalysis AS (\n    SELECT\n    diagnosis_key,\n    category_title\n    FROM fact_claims f\n    LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key\n    UNION ALL\n    SELECT\n    diagnosis_key,\n    category_title\n    FROM fact_claims f\n    LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key\n    UNION ALL\n    SELECT\n    diagnosis_key,\n    category_title\n    FROM fact_claims f\n    LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key\n)\n\nselect \n    diagnosis_key,\n    category_title,\n    count(*) as diagnosis_frequency\nfrom \n    analysis\nwhere\n    category_title is NOT NULL\ngroup by\n    diagnosis_key,\n    category_title\norder by\n    diagnosis_frequency desc", "relation_name": "\"bootcamp_project\".\"public_gold\".\"diagnosis_frequency_by_key\""}], "elapsed_time": 1.0145375728607178, "args": {"static_parser": true, "enable_legacy_logger": false, "log_level": "info", "use_colors_file": true, "introspect": true, "write_json": true, "strict_mode": false, "version_check": true, "indirect_selection": "eager", "log_path": "D:\\bootcamp_project\\postgres_dev\\logs", "quiet": false, "use_colors": true, "show_resource_report": false, "log_format": "default", "which": "run", "printer_width": 80, "favor_state": false, "partial_parse": true, "exclude": [], "profiles_dir": "C:\\Users\\Akshay.Funde\\.dbt", "log_format_file": "debug", "macro_debugging": false, "print": true, "defer": false, "warn_error_options": {"include": [], "exclude": []}, "select": [], "log_level_file": "debug", "project_dir": "D:\\bootcamp_project\\postgres_dev", "cache_selected_only": false, "invocation_command": "dbt run", "populate_cache": true, "vars": {}, "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760}}