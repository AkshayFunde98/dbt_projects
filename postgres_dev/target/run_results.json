{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.10", "generated_at": "2024-03-22T07:41:24.013595Z", "invocation_id": "527ba48a-d06b-4d6b-a2f4-423983c5bcec", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.240322Z", "completed_at": "2024-03-22T07:41:23.258794Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.326314Z", "completed_at": "2024-03-22T07:41:23.435407Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1950855255126953, "adapter_response": {"_message": "SELECT 1000", "code": "SELECT", "rows_affected": 1000}, "message": "SELECT 1000", "failures": null, "unique_id": "model.postgres_dev.us_healthcare_claims_data", "compiled": true, "compiled_code": "\n \nwith us_healthcare_claims AS (\n\tSELECT *\n\tFROM \n\t\t\"bootcamp_project\".\"public\".\"us_healthcare_claims\"\n),\nsource_data AS (\n \n    select claim as claim_id, member_id, name, address, email, \n\tcase when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,\n\tdate(date_of_birth) AS date_of_birth,\n\tCOALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,\n    \tCASE \n        \tWHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)\n        \tELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3\n            \t\tELSE NULL \n        \t\tEND \n    \tEND AS diagnosis_2,\n    \tCASE \n        \tWHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3\n        \tELSE NULL \n    \tEND AS diagnosis_3,\n\tallowed_amount::varchar AS allowed_amount,\n    paid_amount::varchar AS paid_amount,\n\tenrolled_date,\n\tclaimed_date,\n\tpaid_date,\n\tcreated_date\n\t\n\tfrom \n\t\tus_healthcare_claims\n)\n \nselect *\nfrom source_data", "relation_name": "\"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.240322Z", "completed_at": "2024-03-22T07:41:23.257784Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.260402Z", "completed_at": "2024-03-22T07:41:23.555439Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.32311439514160156, "adapter_response": {"_message": "SELECT 71704", "code": "SELECT", "rows_affected": 71704}, "message": "SELECT 71704", "failures": null, "unique_id": "model.postgres_dev.icd_codes_data", "compiled": true, "compiled_code": "\n\nwith source_data as (\n \n    select category_code, diagnosis_code, full_code, full_description, category_title\n\tfrom \"bootcamp_project\".\"public\".\"icd_codes\"\n \n)\n \nselect *\nfrom source_data", "relation_name": "\"bootcamp_project\".\"public_silver\".\"icd_codes_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.457961Z", "completed_at": "2024-03-22T07:41:23.467966Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.480759Z", "completed_at": "2024-03-22T07:41:23.612787Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.15482640266418457, "adapter_response": {"_message": "SELECT 1000", "code": "SELECT", "rows_affected": 1000}, "message": "SELECT 1000", "failures": null, "unique_id": "model.postgres_dev.dim_member", "compiled": true, "compiled_code": "\n\nwith us_healthcare_claims_data AS (\n  Select * \n  FROM\n  \"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\"\n),\nmember_details AS (\n  SELECT\n    DISTINCT member_id AS member_key,\n    name,\n    address,\n    email,\n    gender\n  FROM\n    us_healthcare_claims_data\n)\n\nSELECT *\nFROM member_details", "relation_name": "\"bootcamp_project\".\"public_silver\".\"dim_member\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.457961Z", "completed_at": "2024-03-22T07:41:23.467966Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.477378Z", "completed_at": "2024-03-22T07:41:23.612787Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16660189628601074, "adapter_response": {"_message": "SELECT 1000", "code": "SELECT", "rows_affected": 1000}, "message": "SELECT 1000", "failures": null, "unique_id": "model.postgres_dev.fact_claims", "compiled": true, "compiled_code": "\n\nwith us_healthcare_claims_data AS (\n  SELECT *\n  FROM\n    \"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\"\n\n),\n fact_claims AS (\nSELECT\n  claim_id,\n  member_id as member_key,\n  diagnosis_1 as diagnosis_1_key,\n  diagnosis_2 as diagnosis_2_key,\n  diagnosis_3 as diagnosis_3_key,\n  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,\n  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,\n  date(enrolled_date) as enrolled_date_key, \n  date(claimed_date) as claimed_date_key,\n  date(paid_date) as paid_date_key\n\nFROM\n  us_healthcare_claims_data\n)\n\nSELECT * \nFROM fact_claims", "relation_name": "\"bootcamp_project\".\"public_silver\".\"fact_claims\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.457961Z", "completed_at": "2024-03-22T07:41:23.467966Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.467966Z", "completed_at": "2024-03-22T07:41:23.612787Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16860008239746094, "adapter_response": {"_message": "SELECT 118", "code": "SELECT", "rows_affected": 118}, "message": "SELECT 118", "failures": null, "unique_id": "model.postgres_dev.dim_date", "compiled": true, "compiled_code": "\n\nwith us_healthcare_claims_data AS (\n    SELECT * \n    FROM \"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\"\n),\ndates_data AS (\n    SELECT\n        DISTINCT DATE(dates) as date_key,\n        EXTRACT(DAY FROM dates) as day_of_month,\n        EXTRACT(MONTH FROM dates) as month,\n        EXTRACT(YEAR FROM dates) as year,\n        EXTRACT(QUARTER FROM dates) as quarter,\n        EXTRACT(DOW FROM dates) as day_of_week,\n        EXTRACT(DOY FROM dates) as day_of_year,\n        EXTRACT(WEEK FROM dates) as week_of_year,\n        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend\n    FROM (\n        SELECT enrolled_date as dates FROM us_healthcare_claims_data \n        UNION\n        SELECT claimed_date as dates FROM us_healthcare_claims_data \n        UNION\n        SELECT paid_date as dates FROM us_healthcare_claims_data \n        UNION\n        SELECT created_date as dates FROM us_healthcare_claims_data \n    ) AS all_dates\n    ORDER BY date_key\n)\n\nSELECT * \nFROM dates_data", "relation_name": "\"bootcamp_project\".\"public_silver\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.590337Z", "completed_at": "2024-03-22T07:41:23.593666Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.593666Z", "completed_at": "2024-03-22T07:41:23.693919Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12035584449768066, "adapter_response": {"_message": "SELECT 1000", "code": "SELECT", "rows_affected": 1000}, "message": "SELECT 1000", "failures": null, "unique_id": "model.postgres_dev.final_us_healthcare_claims_data", "compiled": true, "compiled_code": "\n \nwith source_data as (\n \n    select\n\tclaim_id, member_id, name, address, email, \n\tgender,\n\tdate(date_of_birth) AS date_of_birth,\n\tdiagnosis_1,\n    diagnosis_2,\n    diagnosis_3,\n\tallowed_amount,\n    paid_amount,\n\tdate(enrolled_date) as enrolled_date,\n\tdate(claimed_date) as claimed_date,\n\tdate(paid_date) as paid_date,\n\tdate(created_date) as created_date\n\t\nfrom \"bootcamp_project\".\"public_silver\".\"us_healthcare_claims_data\"\n \n)\n \nselect *\nfrom source_data", "relation_name": "\"bootcamp_project\".\"public_gold\".\"final_us_healthcare_claims_data\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.645724Z", "completed_at": "2024-03-22T07:41:23.661615Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.667174Z", "completed_at": "2024-03-22T07:41:23.822262Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.18315649032592773, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.postgres_dev.total_allowed_amount", "compiled": true, "compiled_code": "\n\nWITH fact_claims AS (\n    SELECT \n        *\n    FROM \n        \"bootcamp_project\".\"public_silver\".\"fact_claims\"\n),\nsource_data AS (\n    SELECT \n        sum(allowed_amount) AS total_allowed_amount\n    FROM \n        fact_claims\n)\n \nSELECT *\nFROM source_data", "relation_name": "\"bootcamp_project\".\"public_gold\".\"total_allowed_amount\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.645724Z", "completed_at": "2024-03-22T07:41:23.663949Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.668200Z", "completed_at": "2024-03-22T07:41:23.824337Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1811542510986328, "adapter_response": {"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}, "message": "SELECT 1", "failures": null, "unique_id": "model.postgres_dev.total_paid_amount", "compiled": true, "compiled_code": "\n\nWITH fact_claims AS (\n    SELECT \n        *\n    FROM \n        \"bootcamp_project\".\"public_silver\".\"fact_claims\"\n), \nsource_data AS (\n    SELECT \n        sum(paid_amount) AS total_paid_amount\n    FROM \n        fact_claims\n)\n \nSELECT *\nFROM source_data", "relation_name": "\"bootcamp_project\".\"public_gold\".\"total_paid_amount\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.710135Z", "completed_at": "2024-03-22T07:41:23.713950Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.726608Z", "completed_at": "2024-03-22T07:41:23.859974Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14983844757080078, "adapter_response": {"_message": "SELECT 30", "code": "SELECT", "rows_affected": 30}, "message": "SELECT 30", "failures": null, "unique_id": "model.postgres_dev.total_paid_amount_by_day", "compiled": true, "compiled_code": "\n\nWITH source_data AS ( \n    SELECT * \n    FROM \n         \"bootcamp_project\".\"public_silver\".\"fact_claims\"\n), \ndim_day AS (\n    SELECT\n        date_key,\n        day_of_month\n    FROM\n        \"bootcamp_project\".\"public_silver\".\"dim_date\"\n),\ncalculate AS (\n    SELECT \n        d.day_of_month AS paid_by_day,\n        SUM(sd.paid_amount) AS total_paid_amount\n    FROM \n        source_data sd\n    LEFT JOIN\n        dim_day d ON sd.paid_date_key = d.date_key\n    WHERE\n        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL\n    GROUP BY \n        d.day_of_month \n    ORDER BY\n        d.day_of_month \n)\n \nSELECT *\nFROM calculate", "relation_name": "\"bootcamp_project\".\"public_gold\".\"total_paid_amount_by_day\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.630907Z", "completed_at": "2024-03-22T07:41:23.630907Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.644181Z", "completed_at": "2024-03-22T07:41:23.859974Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2290658950805664, "adapter_response": {"_message": "SELECT 71704", "code": "SELECT", "rows_affected": 71704}, "message": "SELECT 71704", "failures": null, "unique_id": "model.postgres_dev.dim_diagnosis", "compiled": true, "compiled_code": "-- models/dim_diagnosis.sql\n\n\n\nWITH icd_codes AS (\n  select *\n  from \"bootcamp_project\".\"public_silver\".\"icd_codes_data\"\n)\n\nSELECT\n  full_code AS diagnosis_key,\n  category_code,\n  diagnosis_code,\n  full_description,\n  category_title\nFROM\n  icd_codes", "relation_name": "\"bootcamp_project\".\"public_silver\".\"dim_diagnosis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-03-22T07:41:23.878540Z", "completed_at": "2024-03-22T07:41:23.878720Z"}, {"name": "execute", "started_at": "2024-03-22T07:41:23.878720Z", "completed_at": "2024-03-22T07:41:23.984584Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.10904049873352051, "adapter_response": {"_message": "SELECT 2060", "code": "SELECT", "rows_affected": 2060}, "message": "SELECT 2060", "failures": null, "unique_id": "model.postgres_dev.diagnosis_frequency", "compiled": true, "compiled_code": "-- models/diagnosis_analysis.sql\n\n\n\nWITH fact_claims AS (\n  SELECT\n    diagnosis_1_key,\n    diagnosis_2_key,\n    diagnosis_3_key\n  FROM \"bootcamp_project\".\"public_silver\".\"fact_claims\"\n),\ndim_diagnosis AS (\n  SELECT *\n  FROM \"bootcamp_project\".\"public_silver\".\"dim_diagnosis\"\n),\nanalysis AS (\n    SELECT\n    diagnosis_key,\n    category_title\n    FROM fact_claims f\n    LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key\n    UNION ALL\n    SELECT\n    diagnosis_key,\n    category_title\n    FROM fact_claims f\n    LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key\n    UNION ALL\n    SELECT\n    diagnosis_key,\n    category_title\n    FROM fact_claims f\n    LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key\n)\n\nselect \n    diagnosis_key,\n    category_title,\n    count(*) as diagnosis_frequency\nfrom \n    analysis\nwhere\n    category_title is NOT NULL\ngroup by\n    diagnosis_key,\n    category_title\norder by\n    diagnosis_frequency desc", "relation_name": "\"bootcamp_project\".\"public_gold\".\"diagnosis_frequency\""}], "elapsed_time": 0.9183790683746338, "args": {"profiles_dir": "C:\\Users\\Akshay.Funde\\.dbt", "static_parser": true, "favor_state": false, "printer_width": 80, "quiet": false, "log_file_max_bytes": 10485760, "write_json": true, "defer": false, "introspect": true, "print": true, "strict_mode": false, "use_colors": true, "partial_parse_file_diff": true, "log_level": "info", "partial_parse": true, "version_check": true, "vars": {}, "populate_cache": true, "log_format_file": "debug", "show_resource_report": false, "enable_legacy_logger": false, "use_colors_file": true, "log_path": "D:\\bootcamp_project\\postgres_dev\\logs", "log_level_file": "debug", "send_anonymous_usage_stats": true, "log_format": "default", "which": "run", "project_dir": "D:\\bootcamp_project\\postgres_dev", "invocation_command": "dbt run", "exclude": [], "select": [], "macro_debugging": false, "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager"}}