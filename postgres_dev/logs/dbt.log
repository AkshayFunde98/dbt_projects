[0m10:29:08.012660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CE847D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CE860390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CE862910>]}


============================== 10:29:08.016658 | e73c0b2d-f949-4d09-a4d7-801cc3488085 ==============================
[0m10:29:08.016658 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:29:08.017658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:08.018659 [info ] [MainThread]: dbt version: 1.7.10
[0m10:29:08.019312 [info ] [MainThread]: python version: 3.11.8
[0m10:29:08.019312 [info ] [MainThread]: python path: C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\python.exe
[0m10:29:08.020314 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m10:29:08.130092 [info ] [MainThread]: Using profiles dir at C:\Users\Akshay.Funde\.dbt
[0m10:29:08.131076 [info ] [MainThread]: Using profiles.yml file at C:\Users\Akshay.Funde\.dbt\profiles.yml
[0m10:29:08.131076 [info ] [MainThread]: Using dbt_project.yml file at D:\bootcamp_project\postgres_dev\dbt_project.yml
[0m10:29:08.132076 [info ] [MainThread]: adapter type: postgres
[0m10:29:08.133077 [info ] [MainThread]: adapter version: 1.7.10
[0m10:29:08.187298 [info ] [MainThread]: Configuration:
[0m10:29:08.187298 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:29:08.187298 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:29:08.187298 [info ] [MainThread]: Required dependencies:
[0m10:29:08.187298 [debug] [MainThread]: Executing "git --help"
[0m10:29:08.218586 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:29:08.225440 [debug] [MainThread]: STDERR: "b''"
[0m10:29:08.226450 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:29:08.226450 [info ] [MainThread]: Connection:
[0m10:29:08.227751 [info ] [MainThread]:   host: localhost
[0m10:29:08.227751 [info ] [MainThread]:   port: 5432
[0m10:29:08.227751 [info ] [MainThread]:   user: postgres
[0m10:29:08.227751 [info ] [MainThread]:   database: bootcamp_project
[0m10:29:08.227751 [info ] [MainThread]:   schema: public
[0m10:29:08.227751 [info ] [MainThread]:   connect_timeout: 10
[0m10:29:08.227751 [info ] [MainThread]:   role: None
[0m10:29:08.227751 [info ] [MainThread]:   search_path: None
[0m10:29:08.227751 [info ] [MainThread]:   keepalives_idle: 0
[0m10:29:08.227751 [info ] [MainThread]:   sslmode: None
[0m10:29:08.227751 [info ] [MainThread]:   sslcert: None
[0m10:29:08.227751 [info ] [MainThread]:   sslkey: None
[0m10:29:08.227751 [info ] [MainThread]:   sslrootcert: None
[0m10:29:08.227751 [info ] [MainThread]:   application_name: dbt
[0m10:29:08.227751 [info ] [MainThread]:   retries: 1
[0m10:29:08.227751 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:29:08.227751 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m10:29:08.227751 [debug] [MainThread]: Using postgres connection "debug"
[0m10:29:08.227751 [debug] [MainThread]: On debug: select 1 as id
[0m10:29:08.227751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:08.310997 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:29:08.310997 [debug] [MainThread]: On debug: Close
[0m10:29:08.310997 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:29:08.310997 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:29:08.310997 [debug] [MainThread]: Command `dbt debug` succeeded at 10:29:08.310997 after 0.37 seconds
[0m10:29:08.310997 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:29:08.310997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CD58CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4CE0B8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4C7BCE350>]}
[0m10:29:08.310997 [debug] [MainThread]: Flushing usage events
[0m10:29:14.482477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D72032D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D75AE290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D7597290>]}


============================== 10:29:14.482477 | 210b6192-b113-4a77-8d5f-f0bf0eccc494 ==============================
[0m10:29:14.482477 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:29:14.482477 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:14.639546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '210b6192-b113-4a77-8d5f-f0bf0eccc494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D75E1710>]}
[0m10:29:14.698660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '210b6192-b113-4a77-8d5f-f0bf0eccc494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D70A57D0>]}
[0m10:29:14.698660 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:29:14.698660 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m10:29:14.698660 [debug] [MainThread]: Command `dbt run` failed at 10:29:14.698660 after 0.25 seconds
[0m10:29:14.698660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D4F46890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D75A2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289D71EA310>]}
[0m10:29:14.698660 [debug] [MainThread]: Flushing usage events
[0m10:29:29.933707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A97A55E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A9740BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A97555790>]}


============================== 10:29:29.936739 | b89a8739-2a14-4e38-a6f6-566f663fd2c4 ==============================
[0m10:29:29.936739 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:29:29.937727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:29:29.993991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b89a8739-2a14-4e38-a6f6-566f663fd2c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A97A56390>]}
[0m10:29:30.016011 [debug] [MainThread]: Set downloads directory='C:\Users\AKSHAY~1.FUN\AppData\Local\Temp\dbt-downloads-8_9hp17s'
[0m10:29:30.016011 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m10:29:30.275106 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m10:29:30.275106 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m10:29:30.531223 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m10:29:30.534926 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m10:29:31.558945 [info ] [MainThread]: Installed from version 1.1.1
[0m10:29:31.558945 [info ] [MainThread]: Up to date!
[0m10:29:31.558945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b89a8739-2a14-4e38-a6f6-566f663fd2c4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A97B870D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A97B87310>]}
[0m10:29:31.558945 [debug] [MainThread]: Command `dbt deps` succeeded at 10:29:31.558945 after 1.67 seconds
[0m10:29:31.564485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A974B9ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A90FFC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A90FFC610>]}
[0m10:29:31.564485 [debug] [MainThread]: Flushing usage events
[0m10:29:37.214122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67AAF32D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67AEA29D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67AEEFA10>]}


============================== 10:29:37.214122 | d6243647-b456-4845-9a96-c657a424dd16 ==============================
[0m10:29:37.214122 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:29:37.214122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:29:37.339658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67AEEE710>]}
[0m10:29:37.383528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67AEAE690>]}
[0m10:29:37.399224 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:29:37.425973 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:29:37.426986 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m10:29:37.427340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B141A10>]}
[0m10:29:38.955799 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:29:38.955799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B3A3F50>]}
[0m10:29:38.986508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B66C2D0>]}
[0m10:29:38.986508 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:29:38.992062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B5B75D0>]}
[0m10:29:38.996093 [info ] [MainThread]: 
[0m10:29:38.996839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:38.996839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:29:39.008266 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:29:39.009265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:29:39.009265 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:29:39.011323 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:29:39.012345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:39.012345 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:29:39.012345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:39.045922 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:29:39.045922 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:29:39.045922 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:29:39.045922 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:29:39.062432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:29:39.062432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:29:39.062432 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:29:39.062432 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:29:39.062432 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:29:39.062432 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:29:39.062432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:39.062432 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:39.091447 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.091447 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:29:39.092487 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:29:39.102446 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.102446 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:29:39.102446 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:29:39.105446 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:29:39.105446 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:29:39.106473 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:29:39.107446 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:29:39.108410 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:29:39.109411 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:29:39.115429 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:39.115429 [debug] [MainThread]: On master: BEGIN
[0m10:29:39.116411 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:39.125510 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.125510 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:39.125510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:39.125510 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:29:39.125510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B3CF650>]}
[0m10:29:39.125510 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:39.125510 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:39.125510 [debug] [MainThread]: On master: BEGIN
[0m10:29:39.125510 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.125510 [debug] [MainThread]: On master: COMMIT
[0m10:29:39.125510 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:39.125510 [debug] [MainThread]: On master: COMMIT
[0m10:29:39.141186 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.141186 [debug] [MainThread]: On master: Close
[0m10:29:39.141186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:29:39.141186 [info ] [MainThread]: 
[0m10:29:39.141186 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:29:39.141186 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:29:39.141186 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:29:39.141186 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:29:39.141186 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:29:39.149973 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:29:39.150654 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:29:39.160155 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:29:39.161118 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:29:39.162086 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:29:39.176864 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:29:39.150654 => 10:29:39.176864
[0m10:29:39.177862 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:29:39.215121 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:29:39.215121 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:29:39.162086 => 10:29:39.215121
[0m10:29:39.215121 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:29:39.226797 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:29:39.228782 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:29:39.228782 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:29:39.229784 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:29:39.229784 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:29:39.230847 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:29:39.230847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:29:39.258980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.258980 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.258980 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:29:39.258980 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:29:39.258980 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:29:39.258980 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:29:39.275397 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:29:39.286453 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:29:39.286453 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:29:39.286453 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.286453 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:29:39.286453 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:29:39.286453 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.303538 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:29:39.303538 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:29:39.303538 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:29:39.311083 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.311083 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:29:39.327234 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:29:39.327234 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:29:39.342870 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.342870 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:29:39.215121 => 10:29:39.342870
[0m10:29:39.342870 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:29:39.342870 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B6EE5D0>]}
[0m10:29:39.342870 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.19s]
[0m10:29:39.342870 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:29:39.342870 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:29:39.342870 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:29:39.342870 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:29:39.342870 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:29:39.342870 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:29:39.353960 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:29:39.355000 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:29:39.356002 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:29:39.357922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:29:39.358668 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:29:39.358668 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:29:39.358668 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:29:39.365270 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:29:39.365270 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:29:39.382286 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:29:39.384304 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:29:39.365270 => 10:29:39.384304
[0m10:29:39.384304 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:29:39.384304 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:29:39.384304 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:29:39.365270 => 10:29:39.384304
[0m10:29:39.384304 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:29:39.365270 => 10:29:39.384304
[0m10:29:39.391599 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:29:39.393454 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:29:39.393454 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:29:39.393454 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:29:39.393454 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:29:39.393454 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:29:39.393454 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:29:39.408121 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:29:39.409573 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:29:39.409573 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:29:39.415924 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:29:39.415924 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:29:39.415924 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:29:39.425900 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.425900 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:29:39.425900 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:29:39.436408 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:29:39.436408 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:29:39.436408 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:29:39.442266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.442266 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:29:39.442266 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:29:39.442266 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:29:39.442266 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:29:39.442266 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:29:39.442266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.458099 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.442266 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:29:39.458099 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.459135 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.459135 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:29:39.459135 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:29:39.462122 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:29:39.462122 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:29:39.462122 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:29:39.463100 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:29:39.463100 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:29:39.464099 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:29:39.465103 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.467124 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:29:39.468118 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:29:39.468118 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:29:39.473104 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.476231 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:29:39.476231 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.477205 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:29:39.479224 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:29:39.479224 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:29:39.480205 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:29:39.481207 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:29:39.484205 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:29:39.485205 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:29:39.485205 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:29:39.486207 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:29:39.488204 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:29:39.489761 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:29:39.490771 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.490771 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.490771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.492867 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:29:39.492867 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.492867 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:29:39.492867 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:29:39.178867 => 10:29:39.492867
[0m10:29:39.492867 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:29:39.492867 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:29:39.393454 => 10:29:39.492867
[0m10:29:39.492867 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:29:39.492867 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:29:39.492867 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:29:39.492867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B650050>]}
[0m10:29:39.492867 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.492867 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.492867 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B78FC50>]}
[0m10:29:39.492867 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:29:39.492867 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.35s]
[0m10:29:39.492867 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:29:39.508495 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:29:39.492867 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.14s]
[0m10:29:39.509539 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:29:39.510144 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:29:39.510144 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:29:39.511146 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:29:39.511146 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:29:39.512289 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:29:39.512668 [debug] [Thread-2 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:29:39.512668 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:29:39.512668 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.512668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:29:39.512668 [info ] [Thread-2 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:29:39.512668 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.512668 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:29:39.524749 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:29:39.525767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.dim_diagnosis)
[0m10:29:39.527188 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:29:39.527188 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:29:39.527188 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:29:39.527188 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:29:39.527188 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:29:39.527188 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:29:39.527188 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:29:39.541422 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:29:39.543426 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:29:39.527188 => 10:29:39.542437
[0m10:29:39.544420 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:29:39.527188 => 10:29:39.544420
[0m10:29:39.545423 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:29:39.546850 [debug] [Thread-2 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:29:39.546850 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.546850 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:29:39.546850 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.561185 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:29:39.563903 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:29:39.384304 => 10:29:39.563903
[0m10:29:39.563903 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:29:39.393454 => 10:29:39.563903
[0m10:29:39.563903 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:29:39.563903 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:29:39.574749 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:29:39.575769 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:29:39.576749 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:29:39.578333 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B70B210>]}
[0m10:29:39.578859 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:29:39.582389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:39.585887 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B7BC5D0>]}
[0m10:29:39.588550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:29:39.587487 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.22s]
[0m10:29:39.590832 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.23s]
[0m10:29:39.593905 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:29:39.595622 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:29:39.597425 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:29:39.598615 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:29:39.599678 [info ] [Thread-4 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:29:39.600744 [info ] [Thread-3 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:29:39.602879 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_allowed_amount)
[0m10:29:39.603945 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_paid_amount)
[0m10:29:39.604473 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:29:39.605528 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:29:39.616441 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:29:39.620157 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:29:39.625170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.625985 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.630531 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:29:39.635010 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:29:39.636354 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:29:39.606057 => 10:29:39.636076
[0m10:29:39.636886 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:29:39.620157 => 10:29:39.636354
[0m10:29:39.637953 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:29:39.639014 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:29:39.640105 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:29:39.640637 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:29:39.655782 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:29:39.669212 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:29:39.671914 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:29:39.672457 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:29:39.682438 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:29:39.683508 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:29:39.684050 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:29:39.685112 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:29:39.685639 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:29:39.686171 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:29:39.687229 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:29:39.688813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.700537 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:29:39.701074 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:29:39.703204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.706929 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:29:39.708576 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:29:39.710923 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.713099 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:29:39.713631 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.714157 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:29:39.715220 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:29:39.716276 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:29:39.716797 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:29:39.744680 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.748376 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:29:39.749952 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:29:39.751005 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:29:39.752597 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:29:39.757425 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:29:39.757996 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:29:39.758710 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:29:39.759244 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.763511 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:29:39.766199 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:29:39.546850 => 10:29:39.765663
[0m10:29:39.766199 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.767290 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:29:39.767815 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:29:39.771006 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:29:39.773216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B717BD0>]}
[0m10:29:39.773801 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.774342 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:29:39.781091 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:29:39.775743 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.26s]
[0m10:29:39.782151 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:29:39.783210 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:29:39.783734 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.784808 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:29:39.787469 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:29:39.787469 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.789114 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:29:39.788002 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:29:39.791295 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:29:39.792004 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:29:39.792697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:29:39.793804 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:29:39.794468 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:29:39.795547 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:29:39.798417 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:29:39.798417 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:29:39.796096 => 10:29:39.798417
[0m10:29:39.798417 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:29:39.810192 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:29:39.812075 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:29:39.812075 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.812075 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.812075 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:29:39.812075 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:29:39.812075 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:29:39.812075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:39.812075 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:29:39.812075 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:29:39.824818 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:29:39.824818 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:29:39.828014 [debug] [Thread-2 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:29:39.828014 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:29:39.828014 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:29:39.828014 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.828014 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.828014 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:29:39.642298 => 10:29:39.828014
[0m10:29:39.828014 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.828014 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:29:39.841447 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:29:39.843445 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:29:39.656319 => 10:29:39.843445
[0m10:29:39.844447 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:29:39.845447 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B5E6B90>]}
[0m10:29:39.846407 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:29:39.846407 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.846407 [info ] [Thread-4 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.24s]
[0m10:29:39.846407 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B865550>]}
[0m10:29:39.846407 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:29:39.846407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.846407 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:29:39.859089 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:29:39.858090 [info ] [Thread-3 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.24s]
[0m10:29:39.859089 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:29:39.860589 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:29:39.860589 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:29:39.860589 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:29:39.860589 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.860589 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:29:39.860589 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:29:39.860589 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:29:39.860589 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:29:39.860589 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:29:39.860589 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:29:39.875757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.879272 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:29:39.879272 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.879272 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:29:39.882809 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:29:39.558153 => 10:29:39.882809
[0m10:29:39.882809 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:29:39.882809 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67B6538D0>]}
[0m10:29:39.882809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:39.882809 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:29:39.882809 [info ] [Thread-2 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.36s]
[0m10:29:39.882809 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:29:39.882809 [debug] [Thread-2 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:29:39.891431 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:29:39.892462 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:29:39.893430 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:29:39.895010 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:29:39.896025 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:29:39.896603 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:29:39.896603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:39.896603 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:29:39.896603 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:29:39.896603 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:29:39.896025 => 10:29:39.896603
[0m10:29:39.896603 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:29:39.908154 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:29:39.911058 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:29:39.911058 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:29:39.911058 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:29:39.798417 => 10:29:39.911058
[0m10:29:39.911058 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:29:39.911058 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:29:39.911058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67CC3BC90>]}
[0m10:29:39.911058 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:29:39.911058 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:29:39.911058 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.12s]
[0m10:29:39.911058 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:29:39.929488 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:39.929488 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:29:39.929488 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT
        fc.*,
        dd.*
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_code,
        category_title,
        COUNT(*) AS diagnosis_count,
        SUM(allowed_amount) AS total_allowed_amount,
        SUM(paid_amount) AS total_paid_amount
    FROM
        diagnosis_details
    WHERE
        diagnosis_key IN (diagnosis_1, diagnosis_2, diagnosis_3) OR
    GROUP BY
        diagnosis_key,
        category_code,
        category_title
    ORDER BY
        diagnosis_count
        
)

SELECT * 
FROM analysis
  );
  
[0m10:29:39.929488 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "GROUP"
LINE 43:     GROUP BY
             ^

[0m10:29:39.929488 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m10:29:39.941564 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:29:39.908154 => 10:29:39.941564
[0m10:29:39.941564 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:29:40.083078 [debug] [Thread-4 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "GROUP"
  LINE 43:     GROUP BY
               ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:29:40.083078 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6243647-b456-4845-9a96-c657a424dd16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67CC21950>]}
[0m10:29:40.083078 [error] [Thread-4 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.19s]
[0m10:29:40.083078 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:29:40.083078 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:40.083078 [debug] [MainThread]: On master: BEGIN
[0m10:29:40.083078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:40.113509 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:40.113509 [debug] [MainThread]: On master: COMMIT
[0m10:29:40.113509 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:40.113509 [debug] [MainThread]: On master: COMMIT
[0m10:29:40.113509 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:40.113509 [debug] [MainThread]: On master: Close
[0m10:29:40.113509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:40.113509 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:29:40.113509 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:29:40.113509 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:29:40.113509 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:29:40.113509 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:29:40.113509 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:29:40.113509 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:29:40.113509 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m10:29:40.113509 [info ] [MainThread]: 
[0m10:29:40.124736 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m10:29:40.126797 [debug] [MainThread]: Command end result
[0m10:29:40.126797 [info ] [MainThread]: 
[0m10:29:40.126797 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:29:40.126797 [info ] [MainThread]: 
[0m10:29:40.126797 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "GROUP"
  LINE 43:     GROUP BY
               ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:29:40.142442 [info ] [MainThread]: 
[0m10:29:40.143425 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m10:29:40.145420 [debug] [MainThread]: Command `dbt run` failed at 10:29:40.145420 after 2.97 seconds
[0m10:29:40.146457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67AAF3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67443C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E67443C550>]}
[0m10:29:40.146457 [debug] [MainThread]: Flushing usage events
[0m10:30:51.536472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AEC932D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF047810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF045390>]}


============================== 10:30:51.536472 | 6acef324-bd0d-4e0a-82f5-0a2c2bba9d65 ==============================
[0m10:30:51.536472 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:30:51.536472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:30:51.656455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF071610>]}
[0m10:30:51.705029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF221D50>]}
[0m10:30:51.720739 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:30:51.720739 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:30:51.792883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:51.792883 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:30:51.874834 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:30:51.874834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF375110>]}
[0m10:30:51.891961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF5ED090>]}
[0m10:30:51.891961 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:30:51.891961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF36C1D0>]}
[0m10:30:51.891961 [info ] [MainThread]: 
[0m10:30:51.891961 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:30:51.891961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:30:51.891961 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:30:51.891961 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:30:51.908179 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:30:51.909165 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:30:51.909165 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:30:51.910125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:51.910701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:51.927962 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:30:51.927962 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:30:51.927962 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:30:51.927962 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:30:51.937506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:30:51.944179 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:30:51.944179 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:30:51.944179 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:30:51.944179 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:30:51.944179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:51.944179 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:30:51.944179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:51.960253 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:30:51.960253 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:30:51.960253 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:30:51.960253 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:30:51.960253 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:30:51.960253 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:30:51.975481 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:30:51.975481 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:30:51.975481 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:30:51.975481 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:30:51.975481 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:30:51.975481 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:30:51.975481 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:51.975481 [debug] [MainThread]: On master: BEGIN
[0m10:30:51.975481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:51.997628 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:51.998627 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:51.998627 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:30:52.002643 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:30:52.003662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF63F9D0>]}
[0m10:30:52.003662 [debug] [MainThread]: On master: ROLLBACK
[0m10:30:52.004627 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:52.005683 [debug] [MainThread]: On master: BEGIN
[0m10:30:52.006710 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.007748 [debug] [MainThread]: On master: COMMIT
[0m10:30:52.007748 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:52.007748 [debug] [MainThread]: On master: COMMIT
[0m10:30:52.008712 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.008712 [debug] [MainThread]: On master: Close
[0m10:30:52.009712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:30:52.010714 [info ] [MainThread]: 
[0m10:30:52.013733 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:30:52.014730 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:30:52.014730 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:30:52.016637 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:30:52.015712 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:30:52.016637 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:30:52.017638 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:30:52.021654 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:30:52.022882 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:30:52.025773 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:30:52.025773 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:30:52.017638 => 10:30:52.025773
[0m10:30:52.025773 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:30:52.025773 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:30:52.023175 => 10:30:52.025773
[0m10:30:52.044872 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:30:52.044872 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:30:52.044872 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:30:52.058517 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:30:52.059560 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:30:52.060922 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:30:52.060922 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:30:52.060922 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:30:52.060922 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:30:52.075369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.075369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.075369 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:30:52.075369 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:30:52.075369 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:30:52.075369 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:30:52.092197 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:30:52.092197 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:30:52.092197 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:30:52.108186 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.110235 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:30:52.111222 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:30:52.112167 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.126216 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:30:52.126216 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:30:52.127129 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:30:52.144675 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.149277 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:30:52.153575 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:30:52.153575 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:30:52.162921 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.162921 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:30:52.044872 => 10:30:52.162921
[0m10:30:52.162921 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:30:52.162921 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF498950>]}
[0m10:30:52.162921 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.15s]
[0m10:30:52.162921 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:30:52.174109 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:30:52.174109 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:30:52.175108 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:30:52.176106 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:30:52.176106 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:30:52.177283 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:30:52.177283 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:30:52.177283 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:30:52.177283 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:30:52.180929 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:30:52.180929 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:30:52.180929 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:30:52.180929 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:30:52.180929 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:30:52.190772 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:30:52.191768 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:30:52.180929 => 10:30:52.190772
[0m10:30:52.192703 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:30:52.180929 => 10:30:52.192703
[0m10:30:52.193704 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:30:52.180929 => 10:30:52.193704
[0m10:30:52.194830 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:30:52.194830 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:30:52.194830 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:30:52.194830 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:30:52.194830 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:30:52.194830 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:30:52.209060 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:30:52.211786 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:30:52.211786 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:30:52.211786 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:30:52.211786 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:30:52.211786 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:30:52.211786 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:30:52.211786 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:30:52.211786 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:30:52.211786 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:30:52.211786 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:30:52.211786 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:30:52.211786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.211786 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:30:52.223075 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:30:52.229614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.229614 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:30:52.229614 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:30:52.229614 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:30:52.229614 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.238123 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.238123 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:30:52.238123 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:30:52.239699 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.239699 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:30:52.240706 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:30:52.241700 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:30:52.242719 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:30:52.271165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.275195 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:30:52.276134 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:30:52.277698 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:30:52.279289 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:30:52.284041 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:30:52.284563 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:30:52.285070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.285070 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:30:52.285070 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:30:52.285070 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:30:52.291482 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:30:52.025773 => 10:30:52.290972
[0m10:30:52.342051 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.344111 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:30:52.344111 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:30:52.345115 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:30:52.347115 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:30:52.347115 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:30:52.349117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF253FD0>]}
[0m10:30:52.349117 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:30:52.350114 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.351120 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.33s]
[0m10:30:52.354137 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:30:52.355137 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.355137 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.356136 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:30:52.356792 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:30:52.359511 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:30:52.361510 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:30:52.362510 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:30:52.364511 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:30:52.364511 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:30:52.365512 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.366511 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:30:52.367656 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:30:52.369655 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:30:52.370656 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.371657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:30:52.372656 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:30:52.377344 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:30:52.378342 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.379343 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:30:52.380717 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:30:52.380806 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:30:52.380806 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:30:52.380806 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:30:52.380806 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:30:52.391748 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:30:52.392749 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.393748 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:30:52.399272 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:30:52.399272 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:30:52.380806 => 10:30:52.399272
[0m10:30:52.399272 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.399272 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:30:52.399272 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:30:52.406369 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:30:52.407420 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.407420 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:30:52.409582 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:30:52.409582 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:30:52.409582 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:30:52.194830 => 10:30:52.409582
[0m10:30:52.409582 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:30:52.409582 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:30:52.409582 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:30:52.409582 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF3F9390>]}
[0m10:30:52.409582 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:30:52.409582 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.409582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:52.409582 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.23s]
[0m10:30:52.423150 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.425143 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:30:52.194830 => 10:30:52.424149
[0m10:30:52.426336 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:30:52.426336 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:30:52.194830 => 10:30:52.426336
[0m10:30:52.426336 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:30:52.426336 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:30:52.426336 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:30:52.426336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF681990>]}
[0m10:30:52.426336 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:30:52.438348 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF624950>]}
[0m10:30:52.441649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m10:30:52.439652 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.25s]
[0m10:30:52.442650 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.26s]
[0m10:30:52.443650 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:30:52.444653 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:30:52.446179 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:30:52.446179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.446179 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:30:52.446179 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:30:52.446179 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:30:52.446179 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:30:52.446179 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:30:52.446179 => 10:30:52.446179
[0m10:30:52.446179 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:30:52.446179 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:30:52.446179 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:30:52.446179 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:30:52.457271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m10:30:52.458272 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m10:30:52.461080 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:30:52.461080 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:30:52.461080 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:30:52.461080 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:30:52.461080 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:30:52.461080 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:30:52.461080 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:30:52.476070 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:30:52.477055 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:30:52.478055 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:30:52.461080 => 10:30:52.477055
[0m10:30:52.478445 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:30:52.478445 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:30:52.461080 => 10:30:52.478445
[0m10:30:52.478445 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:30:52.478445 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:30:52.478445 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:30:52.478445 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:30:52.478445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.478445 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:30:52.493647 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:30:52.494796 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:30:52.494796 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:30:52.494796 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:30:52.494796 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.494796 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:30:52.494796 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:30:52.494796 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:30:52.494796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:30:52.494796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.494796 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:30:52.494796 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:30:52.494796 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:30:52.494796 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:30:52.506479 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:30:52.510994 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.510994 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:30:52.518496 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:30:52.519028 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.519557 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:30:52.520089 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:30:52.520617 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.521146 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:30:52.521683 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:30:52.522858 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:30:52.539823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.540904 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:30:52.541821 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:30:52.542820 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:30:52.408428 => 10:30:52.542820
[0m10:30:52.545822 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:30:52.549822 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:30:52.550821 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:30:52.550821 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:30:52.551819 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:30:52.552820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF78A250>]}
[0m10:30:52.554821 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.18s]
[0m10:30:52.556821 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:30:52.557821 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:30:52.558823 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.559820 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.558823 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:30:52.561819 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:30:52.564823 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:30:52.565819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:30:52.566821 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:30:52.566821 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:30:52.567820 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:30:52.571819 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:30:52.572823 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.573285 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.576997 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:30:52.576997 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:30:52.567820 => 10:30:52.576997
[0m10:30:52.579507 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:30:52.579507 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:30:52.579507 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:30:52.579507 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:30:52.579507 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:30:52.579507 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:30:52.579507 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:30:52.579507 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:30:52.579507 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:30:52.579507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:52.608319 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.609037 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:30:52.609037 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.609037 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:30:52.609037 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:30:52.609037 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:30:52.609037 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:30:52.609037 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:30:52.624000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.622997 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:30:52.625256 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:30:52.625997 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:30:52.625997 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:30:52.625997 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:30:52.625997 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.625997 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:30:52.625997 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:30:52.625997 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.625997 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:30:52.625997 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.625997 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.638283 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:30:52.478445 => 10:30:52.638283
[0m10:30:52.641908 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:30:52.643913 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:30:52.645910 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:30:52.478445 => 10:30:52.644908
[0m10:30:52.645910 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:30:52.646911 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:30:52.646911 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:30:52.646911 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:30:52.647909 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF775DD0>]}
[0m10:30:52.648912 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:30:52.650911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF6AFB90>]}
[0m10:30:52.651911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.651911 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.19s]
[0m10:30:52.656795 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:30:52.653911 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.19s]
[0m10:30:52.657798 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.658798 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:30:52.659607 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:30:52.659742 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:30:52.663743 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:30:52.665742 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:30:52.665742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:52.666744 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:30:52.668743 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:30:52.668743 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:30:52.669746 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:30:52.672940 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.673798 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.675068 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:30:52.458272 => 10:30:52.675068
[0m10:30:52.677239 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:30:52.677239 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:30:52.677239 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:30:52.677239 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF45BC90>]}
[0m10:30:52.677239 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:30:52.677239 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.24s]
[0m10:30:52.677239 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:30:52.677239 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:30:52.677239 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:30:52.677239 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:30:52.677239 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:30:52.677239 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:30:52.677239 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:30:52.579507 => 10:30:52.677239
[0m10:30:52.692644 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:30:52.693643 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:30:52.694998 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:30:52.677239 => 10:30:52.694641
[0m10:30:52.694998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF600E90>]}
[0m10:30:52.694998 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:30:52.694998 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:30:52.694998 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.13s]
[0m10:30:52.694998 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:30:52.694998 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:30:52.694998 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:30:52.694998 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:30:52.711740 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.711740 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:30:52.711740 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT
        fc.*,
        dd.*
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_code,
        category_title,
        COUNT(*) AS diagnosis_count,
        SUM(allowed_amount) AS total_allowed_amount,
        SUM(paid_amount) AS total_paid_amount
    FROM
        diagnosis_details
    WHERE
        diagnosis_key IN (diagnosis_1, diagnosis_2, diagnosis_3)
    GROUP BY
        diagnosis_key,
        category_code,
        category_title
    ORDER BY
        diagnosis_count
)

SELECT * 
FROM analysis
  );
  
[0m10:30:52.711740 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "diagnosis_1" does not exist
LINE 42:         diagnosis_key IN (diagnosis_1, diagnosis_2, diagnosi...
                                   ^
HINT:  Perhaps you meant to reference the column "diagnosis_details.diagnosis_key".

[0m10:30:52.711740 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m10:30:52.725041 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:30:52.694998 => 10:30:52.724042
[0m10:30:52.726044 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:30:52.729958 [debug] [Thread-4 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "diagnosis_1" does not exist
  LINE 42:         diagnosis_key IN (diagnosis_1, diagnosis_2, diagnosi...
                                     ^
  HINT:  Perhaps you meant to reference the column "diagnosis_details.diagnosis_key".
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:30:52.729958 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6acef324-bd0d-4e0a-82f5-0a2c2bba9d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AF16B510>]}
[0m10:30:52.729958 [error] [Thread-4 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.05s]
[0m10:30:52.729958 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:30:52.729958 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:52.729958 [debug] [MainThread]: On master: BEGIN
[0m10:30:52.729958 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:52.741990 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:52.741990 [debug] [MainThread]: On master: COMMIT
[0m10:30:52.741990 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:52.741990 [debug] [MainThread]: On master: COMMIT
[0m10:30:52.741990 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:30:52.741990 [debug] [MainThread]: On master: Close
[0m10:30:52.741990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:52.741990 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:30:52.741990 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:30:52.741990 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:30:52.741990 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:30:52.741990 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:30:52.741990 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m10:30:52.756270 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:30:52.756270 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:30:52.757269 [info ] [MainThread]: 
[0m10:30:52.758269 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m10:30:52.760268 [debug] [MainThread]: Command end result
[0m10:30:52.761070 [info ] [MainThread]: 
[0m10:30:52.761070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:30:52.761070 [info ] [MainThread]: 
[0m10:30:52.761070 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "diagnosis_1" does not exist
  LINE 42:         diagnosis_key IN (diagnosis_1, diagnosis_2, diagnosi...
                                     ^
  HINT:  Perhaps you meant to reference the column "diagnosis_details.diagnosis_key".
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:30:52.773898 [info ] [MainThread]: 
[0m10:30:52.774894 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m10:30:52.775893 [debug] [MainThread]: Command `dbt run` failed at 10:30:52.775893 after 1.27 seconds
[0m10:30:52.775893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7AC98CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A85EC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7A85EC550>]}
[0m10:30:52.777101 [debug] [MainThread]: Flushing usage events
[0m10:31:02.924927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024621D3FD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024621D3EA90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024621CFD590>]}


============================== 10:31:02.924927 | da87b0c4-7e3c-49ed-a1ec-1166a2228c5c ==============================
[0m10:31:02.924927 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:31:02.924927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:31:03.040253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024621EDB1D0>]}
[0m10:31:03.093299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024621E35F10>]}
[0m10:31:03.109089 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:31:03.109719 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:31:03.175919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:31:03.176920 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:31:03.255177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:31:03.264342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622000990>]}
[0m10:31:03.274750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622348AD0>]}
[0m10:31:03.275752 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:31:03.276883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024621EDAB90>]}
[0m10:31:03.277203 [info ] [MainThread]: 
[0m10:31:03.277203 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:31:03.277203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:31:03.277203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:31:03.291373 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:31:03.293356 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:31:03.293356 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:31:03.293356 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:31:03.293356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:03.293356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:03.308486 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:31:03.308486 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:31:03.308486 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:31:03.308486 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:31:03.323417 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:31:03.324428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:31:03.327493 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:31:03.327493 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:31:03.327493 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:31:03.327493 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:31:03.327493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:03.327493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:31:03.362091 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.362091 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:31:03.362091 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.362091 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:31:03.362091 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:31:03.373015 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:31:03.378030 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:31:03.379021 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:31:03.381032 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:31:03.383025 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:31:03.384019 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:31:03.384019 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:31:03.392772 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:03.393770 [debug] [MainThread]: On master: BEGIN
[0m10:31:03.393770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:03.438151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.438151 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:03.438151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:31:03.438151 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:31:03.438151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622277450>]}
[0m10:31:03.438151 [debug] [MainThread]: On master: ROLLBACK
[0m10:31:03.438151 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:03.438151 [debug] [MainThread]: On master: BEGIN
[0m10:31:03.438151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.438151 [debug] [MainThread]: On master: COMMIT
[0m10:31:03.438151 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:03.438151 [debug] [MainThread]: On master: COMMIT
[0m10:31:03.438151 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:31:03.438151 [debug] [MainThread]: On master: Close
[0m10:31:03.438151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:31:03.453776 [info ] [MainThread]: 
[0m10:31:03.453776 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:31:03.453776 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:31:03.453776 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:31:03.453776 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:31:03.453776 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:31:03.453776 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:31:03.461668 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:31:03.463623 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:31:03.463623 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:31:03.463623 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:31:03.461706 => 10:31:03.463623
[0m10:31:03.463623 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:31:03.463623 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:31:03.463623 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:31:03.463623 => 10:31:03.463623
[0m10:31:03.493201 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:31:03.493201 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:31:03.493201 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:31:03.493201 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:31:03.493201 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:31:03.493201 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:31:03.493201 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:31:03.493201 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:31:03.493201 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:31:03.509542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.509542 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.509542 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:31:03.509542 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:31:03.522732 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:31:03.523731 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:31:03.525846 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:31:03.534898 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:31:03.534898 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:31:03.539427 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.542428 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:31:03.542428 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:31:03.543380 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.559026 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:31:03.559026 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:31:03.559026 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:31:03.573703 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:03.575688 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:31:03.580999 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:31:03.580999 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:31:03.592131 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:03.592131 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:31:03.493201 => 10:31:03.592131
[0m10:31:03.592131 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:31:03.598856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622307610>]}
[0m10:31:03.599392 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.14s]
[0m10:31:03.601015 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:31:03.602072 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:31:03.602608 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:31:03.603135 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:31:03.603668 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:31:03.604192 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:31:03.606596 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:31:03.605273 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:31:03.607645 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:31:03.608172 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:31:03.608695 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:31:03.609228 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:31:03.609753 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:31:03.612797 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:31:03.615795 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:31:03.615795 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:31:03.617303 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:31:03.617303 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:31:03.617303 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:31:03.617303 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:31:03.612797 => 10:31:03.617303
[0m10:31:03.623714 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:31:03.616795 => 10:31:03.622715
[0m10:31:03.624714 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:31:03.624714 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.625714 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:31:03.617303 => 10:31:03.624714
[0m10:31:03.625714 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:31:03.627019 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:31:03.627019 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:31:03.627019 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:31:03.627019 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:31:03.627019 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:31:03.627019 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:31:03.639470 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:31:03.640468 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:31:03.641467 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:31:03.642470 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:31:03.642470 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:31:03.643678 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:31:03.643678 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.643678 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:31:03.643678 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:31:03.643678 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:31:03.643678 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:03.643678 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:31:03.643678 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:31:03.658576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:03.662585 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:31:03.662585 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:31:03.662585 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:31:03.662585 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.662585 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:03.662585 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.662585 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.672674 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:31:03.674250 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:31:03.463623 => 10:31:03.674250
[0m10:31:03.674250 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:31:03.674250 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:31:03.674250 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:31:03.674250 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:31:03.674250 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:31:03.674250 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:31:03.674250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246222C4A50>]}
[0m10:31:03.674250 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.22s]
[0m10:31:03.674250 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:31:03.674250 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:31:03.674250 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:31:03.674250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:31:03.674250 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:31:03.674250 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:31:03.674250 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:31:03.674250 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:31:03.689876 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:31:03.689876 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:31:03.689876 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:31:03.674250 => 10:31:03.689876
[0m10:31:03.727563 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:31:03.739572 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:31:03.740572 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:31:03.741576 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:31:03.741974 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:31:03.741974 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.741974 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:31:03.741974 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:31:03.741974 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:31:03.741974 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.741974 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:31:03.741974 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:31:03.741974 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:31:03.741974 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.741974 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:31:03.756106 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:31:03.756106 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.758038 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:31:03.758038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:03.758038 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:31:03.758038 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.762548 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:31:03.762548 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:31:03.762548 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:31:03.762548 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:31:03.762548 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:31:03.762548 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.762548 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:31:03.762548 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:31:03.762548 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:03.762548 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:31:03.774667 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:31:03.775667 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:03.776666 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:31:03.778666 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:31:03.783666 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:31:03.784664 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:31:03.786665 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:31:03.787663 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:03.788665 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:31:03.791664 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:31:03.792666 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.792666 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:03.795671 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:31:03.796664 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:31:03.798665 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:31:03.627019 => 10:31:03.798665
[0m10:31:03.798665 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:03.799663 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:31:03.799663 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:31:03.800663 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:31:03.801668 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:31:03.627019 => 10:31:03.801668
[0m10:31:03.803667 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622119690>]}
[0m10:31:03.804642 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:31:03.807080 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.20s]
[0m10:31:03.809079 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:03.810081 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246222ADE10>]}
[0m10:31:03.812079 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:31:03.817082 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:31:03.625714 => 10:31:03.815085
[0m10:31:03.818078 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:31:03.819081 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:31:03.819081 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.20s]
[0m10:31:03.820078 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:31:03.823944 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:31:03.823944 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:31:03.823944 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:31:03.823944 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:31:03.823944 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622356910>]}
[0m10:31:03.839519 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:31:03.841515 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m10:31:03.843513 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.22s]
[0m10:31:03.845515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.844516 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:31:03.845515 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:31:03.846517 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:31:03.848031 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:31:03.848031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m10:31:03.859090 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:31:03.860090 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:31:03.861090 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:31:03.862092 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:31:03.862092 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:31:03.856099 => 10:31:03.862092
[0m10:31:03.865457 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:31:03.863091 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:31:03.865457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.865457 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:31:03.872787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m10:31:03.873785 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:31:03.863091 => 10:31:03.872787
[0m10:31:03.874787 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:31:03.878783 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:31:03.879790 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:31:03.880961 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:31:03.880961 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:31:03.880961 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:31:03.880961 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:31:03.893447 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:31:03.893447 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:31:03.895299 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:31:03.880961 => 10:31:03.894448
[0m10:31:03.895299 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:31:03.895299 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:31:03.895299 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:31:03.895299 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:31:03.895299 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:31:03.906044 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:31:03.907051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:03.908042 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:03.911268 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:31:03.911268 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:31:03.911268 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:31:03.911268 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:31:03.911268 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:31:03.911268 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:31:03.926694 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:03.929695 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:31:03.741974 => 10:31:03.928692
[0m10:31:03.930323 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:31:03.930323 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622401A50>]}
[0m10:31:03.930323 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.26s]
[0m10:31:03.941450 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:31:03.942973 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:31:03.943970 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:31:03.944970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:31:03.945971 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.945971 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.945971 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:03.946969 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:31:03.946969 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:31:03.947970 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:31:03.947970 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:31:03.950970 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:31:03.951970 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:31:03.952973 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:31:03.952973 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:31:03.956239 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:31:03.948971 => 10:31:03.954372
[0m10:31:03.962237 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:31:03.969236 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:31:03.971237 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:31:03.971237 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:31:03.975234 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:31:03.976241 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:31:03.977235 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:31:03.978243 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:31:03.982158 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:31:03.982158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:31:03.982158 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:31:03.991313 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.992320 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:03.996313 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:31:04.008804 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:31:04.011772 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:31:04.012769 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:31:04.016770 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:04.017770 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:04.020766 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:31:04.028082 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:31:04.029063 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:31:04.030062 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:31:04.031067 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:31:04.032064 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:31:04.034061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:04.036061 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:31:04.037065 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:31:04.097399 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:04.101399 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:31:04.101399 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:04.102396 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:31:04.105398 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:31:04.105398 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:31:04.105398 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:31:04.106397 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:31:04.107393 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:31:04.107393 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:31:04.107393 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:31:04.143456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:04.149454 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:31:04.150454 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:31:04.156743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:04.159943 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:31:04.163470 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:31:04.163470 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:31:04.163470 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:04.163470 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:31:03.889449 => 10:31:04.163470
[0m10:31:04.163470 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:31:04.163470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622374B50>]}
[0m10:31:04.163470 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.32s]
[0m10:31:04.173871 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:31:04.194253 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:04.208497 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:31:03.895299 => 10:31:04.208497
[0m10:31:04.209499 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:31:04.210497 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:31:04.211111 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622444F50>]}
[0m10:31:04.215112 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:31:04.217536 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:31:04.216535 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.35s]
[0m10:31:04.218538 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:31:04.218538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:04.223130 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:31:04.226809 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:31:04.227815 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:04.234815 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:31:04.235815 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:31:04.236997 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:31:04.238999 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:31:04.238999 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:31:04.241006 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:31:04.241191 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:31:04.241191 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:04.241191 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:31:03.963237 => 10:31:04.241191
[0m10:31:04.241191 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:31:04.241191 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:31:04.257366 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:31:04.260339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246223F6F10>]}
[0m10:31:04.262357 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:31:04.263462 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:31:04.263462 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.31s]
[0m10:31:04.263462 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:31:04.263462 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:31:04.263462 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:31:03.875787 => 10:31:04.263462
[0m10:31:04.263462 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:31:04.263462 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024622482E50>]}
[0m10:31:04.263462 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.42s]
[0m10:31:04.263462 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:31:04.274956 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:31:04.278065 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:31:04.280065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:31:04.280065 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:31:04.283066 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:31:04.284066 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:31:04.281092 => 10:31:04.284066
[0m10:31:04.284066 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:31:04.287064 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:31:04.287064 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:31:04.288065 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:31:04.288065 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:31:04.318547 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:31:04.319569 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:31:04.319569 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT
        fc.*,
        dd.*
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_code,
        category_title,
        COUNT(*) AS diagnosis_count,
        SUM(allowed_amount) AS total_allowed_amount,
        SUM(paid_amount) AS total_paid_amount
    FROM
        diagnosis_details
    WHERE
        diagnosis_key IN (diagnosis_1, diagnosis_2, diagnosis_3)
    GROUP BY
        diagnosis_key,
        category_code,
        category_title
    ORDER BY
        diagnosis_count desc
)

SELECT * 
FROM analysis
  );
  
[0m10:31:04.321567 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "diagnosis_1" does not exist
LINE 42:         diagnosis_key IN (diagnosis_1, diagnosis_2, diagnosi...
                                   ^
HINT:  Perhaps you meant to reference the column "diagnosis_details.diagnosis_key".

[0m10:31:04.322546 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m10:31:04.327115 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:31:04.284066 => 10:31:04.326122
[0m10:31:04.328120 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:31:04.338116 [debug] [Thread-2 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "diagnosis_1" does not exist
  LINE 42:         diagnosis_key IN (diagnosis_1, diagnosis_2, diagnosi...
                                     ^
  HINT:  Perhaps you meant to reference the column "diagnosis_details.diagnosis_key".
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:31:04.341118 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da87b0c4-7e3c-49ed-a1ec-1166a2228c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246223CC790>]}
[0m10:31:04.345124 [error] [Thread-2 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.06s]
[0m10:31:04.346279 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:31:04.346279 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:04.346279 [debug] [MainThread]: On master: BEGIN
[0m10:31:04.346279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:31:04.378340 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:31:04.378947 [debug] [MainThread]: On master: COMMIT
[0m10:31:04.378947 [debug] [MainThread]: Using postgres connection "master"
[0m10:31:04.378947 [debug] [MainThread]: On master: COMMIT
[0m10:31:04.378947 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:31:04.378947 [debug] [MainThread]: On master: Close
[0m10:31:04.378947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:31:04.378947 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:31:04.378947 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:31:04.378947 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:31:04.378947 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:31:04.378947 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:31:04.378947 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:31:04.378947 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m10:31:04.378947 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:31:04.378947 [info ] [MainThread]: 
[0m10:31:04.378947 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m10:31:04.393025 [debug] [MainThread]: Command end result
[0m10:31:04.403025 [info ] [MainThread]: 
[0m10:31:04.403025 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:31:04.404025 [info ] [MainThread]: 
[0m10:31:04.404025 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "diagnosis_1" does not exist
  LINE 42:         diagnosis_key IN (diagnosis_1, diagnosis_2, diagnosi...
                                     ^
  HINT:  Perhaps you meant to reference the column "diagnosis_details.diagnosis_key".
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:31:04.404025 [info ] [MainThread]: 
[0m10:31:04.405024 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m10:31:04.406142 [debug] [MainThread]: Command `dbt run` failed at 10:31:04.406142 after 1.52 seconds
[0m10:31:04.407165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002461B01E390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002461B2AC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002461B2AF910>]}
[0m10:31:04.407165 [debug] [MainThread]: Flushing usage events
[0m10:32:07.270753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170261AB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217029E2E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217029E2790>]}


============================== 10:32:07.270753 | fc0eb59f-c8fc-45b5-a108-db2d1e83b727 ==============================
[0m10:32:07.270753 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:32:07.270753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:32:07.403174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021702B9E3D0>]}
[0m10:32:07.456038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021702A21090>]}
[0m10:32:07.456038 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:32:07.456038 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:32:07.522659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:32:07.523562 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:32:07.588208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:32:07.603744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021702FB4690>]}
[0m10:32:07.603744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021703039ED0>]}
[0m10:32:07.603744 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:32:07.603744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021702CF0C50>]}
[0m10:32:07.621187 [info ] [MainThread]: 
[0m10:32:07.622634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:32:07.622966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:32:07.622966 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:32:07.622966 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:32:07.622966 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:32:07.622966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:07.622966 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:32:07.622966 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:32:07.622966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:07.655530 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:32:07.656520 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:32:07.657520 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:32:07.658519 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:32:07.659296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:32:07.659296 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:32:07.671208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:32:07.672270 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:32:07.674206 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:32:07.675208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:07.675208 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:32:07.676110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:32:07.690505 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:32:07.690505 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:32:07.690505 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:32:07.690505 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:32:07.690505 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:32:07.690505 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:32:07.690505 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:32:07.690505 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:32:07.690505 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:32:07.704481 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:32:07.706664 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:32:07.706664 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:32:07.706664 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:07.706664 [debug] [MainThread]: On master: BEGIN
[0m10:32:07.706664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:32:07.729317 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:32:07.730337 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:07.730337 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:32:07.735316 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:32:07.736322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021702BE3750>]}
[0m10:32:07.736322 [debug] [MainThread]: On master: ROLLBACK
[0m10:32:07.738199 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:07.738199 [debug] [MainThread]: On master: BEGIN
[0m10:32:07.740202 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:32:07.740202 [debug] [MainThread]: On master: COMMIT
[0m10:32:07.740202 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:07.741205 [debug] [MainThread]: On master: COMMIT
[0m10:32:07.742201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:32:07.742201 [debug] [MainThread]: On master: Close
[0m10:32:07.743204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:32:07.743204 [info ] [MainThread]: 
[0m10:32:07.747223 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:32:07.747223 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:32:07.748200 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:32:07.749201 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:32:07.748200 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:32:07.749868 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:32:07.749868 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:32:07.755400 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:32:07.755420 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:32:07.758017 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:32:07.758017 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:32:07.750869 => 10:32:07.758017
[0m10:32:07.758017 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:32:07.758017 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:32:07.756427 => 10:32:07.758017
[0m10:32:07.793135 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:32:07.793135 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:32:07.793135 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:32:07.793135 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:32:07.793135 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:32:07.793135 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:32:07.793135 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:32:07.804544 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:32:07.805545 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:32:07.839869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:07.839869 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:32:07.840870 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:32:07.841868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:07.841868 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:32:07.842869 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:32:07.853866 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:32:07.860368 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:32:07.860997 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:32:07.862997 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:07.866000 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:32:07.866000 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:32:07.872041 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:07.872041 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:32:07.872041 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:32:07.887674 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:32:07.904564 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:07.904564 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:32:07.920197 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:32:07.920197 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:32:07.941825 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:07.941825 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:32:07.793135 => 10:32:07.941825
[0m10:32:07.941825 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:32:07.941825 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021703073690>]}
[0m10:32:07.941825 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.19s]
[0m10:32:07.941825 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:32:07.941825 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:32:07.957458 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:32:07.941825 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:32:07.941825 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:32:07.957458 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:32:07.957458 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:32:07.957458 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:32:07.960646 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:32:07.961369 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:32:07.962373 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:32:07.963370 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:32:07.963848 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:32:07.963936 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:32:07.966443 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:32:07.973761 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:32:07.973992 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:32:07.973992 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:32:07.973992 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:32:07.963936 => 10:32:07.973992
[0m10:32:07.973992 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:32:07.973992 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:32:07.973992 => 10:32:07.973992
[0m10:32:07.973992 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:32:07.973992 => 10:32:07.973992
[0m10:32:07.973992 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:32:07.973992 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:32:07.973992 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:32:07.987810 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:32:07.987810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:07.991456 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:32:07.992279 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:32:07.992279 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:32:07.992279 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:32:07.992279 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:32:07.992279 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:32:07.992279 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:32:07.992279 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:32:07.992279 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:32:07.992279 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:32:08.005548 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:32:08.005548 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:32:08.006561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.006561 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:32:08.007162 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:32:08.007162 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:32:08.007162 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:32:08.023724 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.023724 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:32:08.023724 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.023724 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.029932 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:32:08.029932 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:32:08.029932 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:32:08.029932 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:32:08.031446 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:32:08.039305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.041303 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:32:08.042304 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:32:08.043304 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:32:08.046302 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:32:08.049303 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:32:08.050302 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:08.050302 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:32:08.050302 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:32:08.051302 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:32:08.052304 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:32:07.758017 => 10:32:08.052304
[0m10:32:08.054891 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:32:08.087595 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:32:08.087595 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:32:08.087595 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:32:08.087595 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:32:08.087595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217030F3CD0>]}
[0m10:32:08.087595 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.103247 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.087595 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.34s]
[0m10:32:08.103247 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:32:08.103247 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.103247 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:32:08.103247 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:32:08.103247 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:32:08.103247 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:32:08.103247 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:32:08.103247 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:32:08.103247 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:32:08.103247 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.103247 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.103247 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:32:08.115034 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.117805 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:32:08.119112 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:32:08.125321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:32:08.127318 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:32:08.128364 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:32:08.129320 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:32:08.129538 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:32:08.129538 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:32:08.129538 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:32:08.129538 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:32:08.129538 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:32:08.129538 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:32:08.138663 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:32:08.129538 => 10:32:08.129538
[0m10:32:08.139668 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:32:08.143686 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:32:08.143686 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.143686 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.143686 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.143686 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:32:08.143686 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:32:08.143686 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:32:08.143686 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:32:08.143686 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:32:08.143686 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:32:08.155000 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:32:08.155994 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:32:08.156757 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:32:08.156757 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:08.156757 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:32:08.156757 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:32:08.156757 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:08.156757 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:32:07.988823 => 10:32:08.156757
[0m10:32:08.156757 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:08.156757 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:08.156757 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:32:08.156757 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:32:07.992279 => 10:32:08.156757
[0m10:32:08.156757 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:32:07.973992 => 10:32:08.156757
[0m10:32:08.156757 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021703066850>]}
[0m10:32:08.156757 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:32:08.156757 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:32:08.173183 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021703055E50>]}
[0m10:32:08.172194 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.20s]
[0m10:32:08.175181 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170310C410>]}
[0m10:32:08.177181 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:32:08.176180 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.21s]
[0m10:32:08.178180 [debug] [Thread-2 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:32:08.177181 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.22s]
[0m10:32:08.179182 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:32:08.181184 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:32:08.180185 [info ] [Thread-2 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:32:08.183183 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:32:08.184181 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:32:08.185183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.dim_diagnosis)
[0m10:32:08.187185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.186180 [info ] [Thread-3 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:32:08.188623 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:32:08.195352 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:32:08.195869 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:32:08.196880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_allowed_amount)
[0m10:32:08.198790 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m10:32:08.214847 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:32:08.216074 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:32:08.216074 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:32:08.216074 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:32:08.216074 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:32:08.199475 => 10:32:08.216074
[0m10:32:08.228636 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:32:08.232853 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:32:08.234763 [debug] [Thread-2 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:32:08.235189 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:32:08.235189 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:32:08.216074 => 10:32:08.235189
[0m10:32:08.244460 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:32:08.245693 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:32:08.229852 => 10:32:08.245693
[0m10:32:08.245693 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:32:08.245693 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:32:08.245693 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:32:08.245693 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:32:08.245693 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:32:08.245693 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:32:08.245693 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:32:08.257489 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:32:08.257489 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:32:08.257489 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:32:08.257489 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:32:08.257489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.257489 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:32:08.257489 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:32:08.257489 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:32:08.257489 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:32:08.257489 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:32:08.257489 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:32:08.257489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.271951 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:32:08.274970 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:32:08.275956 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:32:08.280952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.283953 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:32:08.284956 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:32:08.285954 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:32:08.285954 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.285954 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.286953 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.286953 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:32:08.287952 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:32:08.288412 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:32:08.288412 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:32:08.289413 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:32:08.289413 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:08.290414 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:32:08.291416 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:32:08.139668 => 10:32:08.291416
[0m10:32:08.292417 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:32:08.293417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021703063890>]}
[0m10:32:08.294416 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.17s]
[0m10:32:08.295415 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:32:08.295415 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:32:08.296414 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:32:08.296414 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:32:08.299415 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:32:08.299415 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:32:08.300415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:32:08.300415 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:32:08.303414 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:32:08.303414 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:32:08.304757 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:32:08.308759 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:32:08.309785 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.310537 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:32:08.318545 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.318545 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:32:08.318545 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:32:08.305761 => 10:32:08.318545
[0m10:32:08.322195 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:32:08.323181 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:32:08.324178 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:32:08.326225 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:32:08.326225 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.326225 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:32:08.326225 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.334670 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:32:08.334670 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:32:08.335688 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:32:08.335688 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:32:08.335688 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:32:08.338454 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:32:08.338454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:32:08.340406 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:32:08.355048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.356052 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:32:08.356052 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:32:08.356962 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.373198 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:32:08.373198 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.374199 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:32:08.377197 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:32:08.377197 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:32:08.378198 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:32:08.379196 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:32:08.379412 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:32:08.382196 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:32:08.382196 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:32:08.402766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.403508 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:08.405269 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:32:08.405269 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:32:08.245693 => 10:32:08.405269
[0m10:32:08.405269 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:08.405269 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:32:08.405269 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:32:08.405269 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:32:08.245693 => 10:32:08.405269
[0m10:32:08.405269 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217030B7C90>]}
[0m10:32:08.405269 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:32:08.405269 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.405269 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021702E4E450>]}
[0m10:32:08.405269 [info ] [Thread-3 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.21s]
[0m10:32:08.405269 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:32:08.405269 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:32:08.405269 [debug] [Thread-2 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:32:08.405269 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.21s]
[0m10:32:08.405269 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:32:08.421796 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:32:08.422374 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:32:08.422374 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:32:08.423378 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:32:08.458921 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.458921 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.458921 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:32:08.474334 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:32:08.474334 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:32:08.474334 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:32:08.474334 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:32:08.474334 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:32:08.474334 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:32:08.474334 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:08.474334 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:32:08.474334 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:32:08.324178 => 10:32:08.474334
[0m10:32:08.474334 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:32:08.474334 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:32:08.474334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021702C15650>]}
[0m10:32:08.474334 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.17s]
[0m10:32:08.474334 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:32:08.474334 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.490474 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:32:08.490474 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:32:08.490474 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:32:08.490474 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:32:08.490474 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:32:08.235189 => 10:32:08.490474
[0m10:32:08.490474 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:32:08.490474 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021702C15650>]}
[0m10:32:08.490474 [info ] [Thread-2 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.31s]
[0m10:32:08.490474 [debug] [Thread-2 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:32:08.490474 [debug] [Thread-3 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:32:08.490474 [info ] [Thread-3 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:32:08.505516 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:32:08.505516 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:32:08.508996 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:32:08.508996 [debug] [Thread-3 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:32:08.506516 => 10:32:08.508996
[0m10:32:08.508996 [debug] [Thread-3 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:32:08.508996 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:32:08.508996 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:32:08.508996 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:32:08.508996 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:32:08.526060 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.526060 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:32:08.526060 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT
        fc.*,
        dd.*
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_code,
        category_title,
        COUNT(*) AS diagnosis_count,
        SUM(allowed_amount) AS total_allowed_amount,
        SUM(paid_amount) AS total_paid_amount
    FROM
        diagnosis_details
    WHERE
        diagnosis_key IN (fc.diagnosis_1, fc.diagnosis_2, fc.diagnosis_3)
    GROUP BY
        diagnosis_key,
        category_code,
        category_title
    ORDER BY
        diagnosis_count
)

SELECT * 
FROM analysis
  );
  
[0m10:32:08.526060 [debug] [Thread-3 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "fc"
LINE 42:         diagnosis_key IN (fc.diagnosis_1, fc.diagnosis_2, fc...
                                   ^

[0m10:32:08.526060 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m10:32:08.538253 [debug] [Thread-3 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:32:08.508996 => 10:32:08.526060
[0m10:32:08.538253 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:32:08.542987 [debug] [Thread-3 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  missing FROM-clause entry for table "fc"
  LINE 42:         diagnosis_key IN (fc.diagnosis_1, fc.diagnosis_2, fc...
                                     ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:32:08.543493 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc0eb59f-c8fc-45b5-a108-db2d1e83b727', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021703066510>]}
[0m10:32:08.543493 [error] [Thread-3 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.04s]
[0m10:32:08.543493 [debug] [Thread-3 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:32:08.543493 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:08.543493 [debug] [MainThread]: On master: BEGIN
[0m10:32:08.543493 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:32:08.556806 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:32:08.556806 [debug] [MainThread]: On master: COMMIT
[0m10:32:08.556806 [debug] [MainThread]: Using postgres connection "master"
[0m10:32:08.556806 [debug] [MainThread]: On master: COMMIT
[0m10:32:08.556806 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:32:08.556806 [debug] [MainThread]: On master: Close
[0m10:32:08.556806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:32:08.556806 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:32:08.556806 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:32:08.556806 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:32:08.556806 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:32:08.556806 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:32:08.556806 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:32:08.556806 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m10:32:08.556806 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:32:08.556806 [info ] [MainThread]: 
[0m10:32:08.556806 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m10:32:08.556806 [debug] [MainThread]: Command end result
[0m10:32:08.575384 [info ] [MainThread]: 
[0m10:32:08.575384 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:32:08.575384 [info ] [MainThread]: 
[0m10:32:08.575384 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  missing FROM-clause entry for table "fc"
  LINE 42:         diagnosis_key IN (fc.diagnosis_1, fc.diagnosis_2, fc...
                                     ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:32:08.575384 [info ] [MainThread]: 
[0m10:32:08.575384 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m10:32:08.588860 [debug] [MainThread]: Command `dbt run` failed at 10:32:08.588860 after 1.35 seconds
[0m10:32:08.589856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021702DEBD50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177BF1C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177BF1C550>]}
[0m10:32:08.589856 [debug] [MainThread]: Flushing usage events
[0m10:35:23.805698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDA7932D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAB7DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAB7DDD0>]}


============================== 10:35:23.821166 | c374a265-3608-431d-8c09-2eab8ebe6055 ==============================
[0m10:35:23.821166 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:35:23.821166 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:35:23.931196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAD1FB10>]}
[0m10:35:23.991681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDA599B10>]}
[0m10:35:23.993156 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:35:24.001140 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:35:24.058307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:35:24.059309 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:35:24.126909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:35:24.142616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDACDC550>]}
[0m10:35:24.142616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDB188450>]}
[0m10:35:24.142616 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:35:24.142616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDB1051D0>]}
[0m10:35:24.142616 [info ] [MainThread]: 
[0m10:35:24.158244 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:35:24.160676 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:35:24.160817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:35:24.167987 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:35:24.167987 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:35:24.167987 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:35:24.167987 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:35:24.167987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:24.167987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:24.187960 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:35:24.187960 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:35:24.187960 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:35:24.187960 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:35:24.187960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:35:24.199794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:35:24.201388 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:35:24.201388 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:35:24.201388 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:35:24.201388 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:35:24.201388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:24.201388 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:24.217559 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.217559 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:35:24.218539 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:35:24.220571 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:35:24.221539 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:35:24.222557 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:35:24.226539 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.226539 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:35:24.227539 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:35:24.229555 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:35:24.230555 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:35:24.231555 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:35:24.236585 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:24.236585 [debug] [MainThread]: On master: BEGIN
[0m10:35:24.237562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:24.250645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.250645 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:24.250645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:35:24.250645 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:35:24.250645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAE74D10>]}
[0m10:35:24.250645 [debug] [MainThread]: On master: ROLLBACK
[0m10:35:24.250645 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:24.250645 [debug] [MainThread]: On master: BEGIN
[0m10:35:24.250645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.250645 [debug] [MainThread]: On master: COMMIT
[0m10:35:24.250645 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:24.250645 [debug] [MainThread]: On master: COMMIT
[0m10:35:24.266314 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.266314 [debug] [MainThread]: On master: Close
[0m10:35:24.266314 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:35:24.266314 [info ] [MainThread]: 
[0m10:35:24.266314 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:35:24.266314 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:35:24.266314 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:35:24.266314 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:35:24.266314 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:35:24.266314 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:35:24.266314 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:35:24.266314 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:35:24.266314 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:35:24.282016 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:35:24.266314 => 10:35:24.282016
[0m10:35:24.283501 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:24.283501 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:35:24.311888 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:35:24.311888 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:35:24.266314 => 10:35:24.311888
[0m10:35:24.311888 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:35:24.311888 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:24.316611 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:24.316611 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:35:24.317648 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:35:24.318649 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:24.319651 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:35:24.319651 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:35:24.335499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.335499 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.335499 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:24.349765 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:24.349765 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:35:24.350811 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:35:24.357765 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:35:24.362380 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:24.362781 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:35:24.364765 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.366857 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:24.367858 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:35:24.368858 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.381987 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:35:24.382982 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:24.383328 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:35:24.401343 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.401343 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:35:24.411912 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:24.411912 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:35:24.427706 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.427706 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:35:24.311888 => 10:35:24.427706
[0m10:35:24.427706 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:35:24.427706 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAF787D0>]}
[0m10:35:24.427706 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.16s]
[0m10:35:24.443243 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:35:24.444770 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:35:24.444770 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:35:24.444770 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:35:24.444770 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:35:24.444770 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:35:24.444770 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:35:24.444770 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:35:24.449866 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:35:24.450865 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:35:24.451861 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:35:24.451861 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:35:24.455884 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:35:24.455884 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:35:24.456862 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:35:24.458879 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:35:24.460880 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:24.462883 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:35:24.463879 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:35:24.452861 => 10:35:24.463879
[0m10:35:24.464863 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:35:24.456862 => 10:35:24.463879
[0m10:35:24.464863 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:35:24.465861 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:35:24.461879 => 10:35:24.464863
[0m10:35:24.465861 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:35:24.466898 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:35:24.466898 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:35:24.466898 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:35:24.466898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.466898 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:35:24.466898 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:35:24.483339 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:24.484506 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:24.484506 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:24.484506 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:35:24.484506 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:24.484506 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:35:24.484506 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:35:24.484506 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:35:24.484506 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:35:24.484506 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:35:24.484506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.484506 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:35:24.484506 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:35:24.484506 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:24.484506 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:35:24.500752 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.500752 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:24.500752 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:35:24.512266 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.512266 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:24.512266 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:35:24.512266 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.512266 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:24.516383 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:35:24.534169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.534169 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:35:24.534169 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:24.534169 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:35:24.550932 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:35:24.558258 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.560574 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:24.560574 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:35:24.560574 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:35:24.560574 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:35:24.284751 => 10:35:24.560574
[0m10:35:24.560574 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:35:24.568303 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:24.616387 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:24.617459 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:35:24.618001 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:35:24.619064 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:35:24.619599 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.620672 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAB47690>]}
[0m10:35:24.624958 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:24.625484 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.626021 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.626544 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:35:24.626544 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.35s]
[0m10:35:24.629250 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:24.632477 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:24.633533 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:35:24.634058 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.634601 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:35:24.635682 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:35:24.636217 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:35:24.639416 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:35:24.641577 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.642107 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.641040 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:35:24.642641 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:24.643951 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:35:24.646247 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:35:24.647363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:35:24.649746 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:35:24.650230 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:24.651304 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:24.651836 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:35:24.652810 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:35:24.653378 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:35:24.656626 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:24.658231 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:35:24.653975 => 10:35:24.657691
[0m10:35:24.658767 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.659301 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:35:24.659837 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.663062 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:35:24.663062 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.666995 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:24.670200 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:35:24.671142 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:24.674979 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:35:24.676591 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:24.676591 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:24.676591 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:35:24.676591 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:24.676591 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:35:24.676591 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:35:24.676591 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:35:24.676591 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:24.683207 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.686372 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:35:24.466898 => 10:35:24.686372
[0m10:35:24.686372 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.686372 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.686372 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:35:24.686372 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:35:24.466898 => 10:35:24.686372
[0m10:35:24.686372 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:35:24.466898 => 10:35:24.686372
[0m10:35:24.686372 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAFA59D0>]}
[0m10:35:24.686372 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:35:24.686372 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:35:24.686372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.686372 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDB1FFC10>]}
[0m10:35:24.686372 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.24s]
[0m10:35:24.686372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDB0EDC10>]}
[0m10:35:24.699847 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:24.700835 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.24s]
[0m10:35:24.702551 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:35:24.702551 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:35:24.702551 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.24s]
[0m10:35:24.702551 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:35:24.702551 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:35:24.702551 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:35:24.702551 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:35:24.702551 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:35:24.702551 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:35:24.702551 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m10:35:24.702551 [info ] [Thread-4 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:35:24.702551 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:35:24.702551 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:35:24.712561 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_allowed_amount)
[0m10:35:24.717406 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:35:24.717406 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:35:24.719418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m10:35:24.719418 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:35:24.725078 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:24.725645 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:35:24.712561 => 10:35:24.725645
[0m10:35:24.726175 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:35:24.728901 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:35:24.729433 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:35:24.729967 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:35:24.732130 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:35:24.733186 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:35:24.726764 => 10:35:24.732654
[0m10:35:24.737523 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:35:24.737523 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.738493 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:35:24.729967 => 10:35:24.738493
[0m10:35:24.739509 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:35:24.739509 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:24.739509 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:24.739509 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:35:24.739509 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:35:24.749780 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:35:24.750847 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:35:24.754792 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:35:24.759614 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:24.760690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:35:24.761773 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:35:24.762307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.763350 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:24.763435 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:35:24.766108 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:35:24.767669 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:35:24.769273 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:24.770281 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:35:24.772539 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:35:24.777409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.782244 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:35:24.783098 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.784704 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:24.785629 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:24.787248 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:35:24.788912 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:35:24.790534 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.791588 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:24.792668 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:35:24.793746 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.794280 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.795858 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:35:24.663591 => 10:35:24.795326
[0m10:35:24.796394 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:24.796933 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:35:24.796933 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:35:24.798556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAEE3D10>]}
[0m10:35:24.799093 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:35:24.800058 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.15s]
[0m10:35:24.806063 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:24.807060 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:35:24.808060 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:35:24.808060 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:35:24.813449 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:24.813977 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:35:24.815044 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:35:24.815562 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:35:24.817519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:35:24.818062 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.818593 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.818593 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:35:24.821797 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:24.824481 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:24.827182 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:24.828249 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:35:24.828788 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:35:24.830382 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:35:24.825030 => 10:35:24.829845
[0m10:35:24.830915 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.831459 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.831990 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:35:24.833807 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:35:24.837586 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:35:24.843634 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:24.844184 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:24.844728 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:24.845802 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:35:24.846332 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:24.846880 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:35:24.847398 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:35:24.847398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:24.865538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:24.866073 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:24.866402 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:35:24.883106 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.886105 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:35:24.887104 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.888308 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:24.888308 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:35:24.890127 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:35:24.891103 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:35:24.893121 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:24.894103 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:24.895104 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:35:24.895104 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:35:24.898104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.901043 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:24.901043 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:35:24.933608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.933608 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.933608 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:35:24.933608 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.933608 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:35:24.750847 => 10:35:24.933608
[0m10:35:24.933608 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:24.933608 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:35:24.739509 => 10:35:24.933608
[0m10:35:24.933608 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:35:24.933608 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:35:24.933608 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:35:24.933608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDB2292D0>]}
[0m10:35:24.949121 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAD33C50>]}
[0m10:35:24.949121 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:35:24.949121 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.22s]
[0m10:35:24.949121 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:24.949121 [info ] [Thread-4 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.25s]
[0m10:35:24.949121 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:35:24.949121 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:35:24.949121 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:35:24.957636 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.957636 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:24.957636 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:35:24.957636 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:24.957636 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:35:24.957636 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:24.957636 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:35:24.957636 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.973389 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:24.974750 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:35:24.977598 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:35:24.977858 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:24.977858 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:24.977858 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:35:24.977858 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:35:24.985647 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.985647 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:35:24.838660 => 10:35:24.985647
[0m10:35:24.985647 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:24.985647 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:35:24.985647 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:35:24.733727 => 10:35:24.985647
[0m10:35:24.985647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDADCD810>]}
[0m10:35:24.985647 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:35:24.985647 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDAEB4A10>]}
[0m10:35:24.985647 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.17s]
[0m10:35:24.985647 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:35:24.985647 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.28s]
[0m10:35:24.985647 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:35:24.985647 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:35:24.985647 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:35:24.999797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:35:24.999797 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:35:25.003810 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:35:25.004638 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:35:25.000812 => 10:35:25.004638
[0m10:35:25.004638 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:35:25.004638 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:35:25.004638 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:25.004638 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:35:25.004638 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:35:25.037720 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:25.037720 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:25.037720 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT

        fc.diagnosis_1_key,
        fc.diagnosis_2_key,
        fc.diagnosis_3_key,
        fc.allowed_amount,
        fc.paid_amount,
        dd.diagnosis_key,
        dd.category_code,
        dd.diagnosis_code,
        dd.full_description,
        dd.category_title
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_code,
        category_title,
        COUNT(*) AS diagnosis_count,
        SUM(allowed_amount) AS total_allowed_amount,
        SUM(paid_amount) AS total_paid_amount
    FROM
        diagnosis_details
    WHERE
        diagnosis_key IN (diagnosis_1_key, diagnosis_2_key, diagnosis_3_key)
    GROUP BY
        diagnosis_key,
        category_code,
        category_title
    ORDER BY
        diagnosis_count
)

SELECT * 
FROM analysis
  );
  
[0m10:35:25.076162 [debug] [Thread-2 (]: SQL status: SELECT 773 in 0.0 seconds
[0m10:35:25.076162 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:25.076162 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m10:35:25.081171 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:25.083388 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:25.083388 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m10:35:25.085390 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:25.087413 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:35:25.087413 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:25.087413 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:35:25.090418 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:25.092409 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m10:35:25.093388 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:25.093388 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m10:35:25.096409 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:25.097390 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:35:25.004638 => 10:35:25.097390
[0m10:35:25.098421 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:35:25.098421 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c374a265-3608-431d-8c09-2eab8ebe6055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028EDB2FA990>]}
[0m10:35:25.099390 [info ] [Thread-2 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 773[0m in 0.11s]
[0m10:35:25.100176 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:35:25.102175 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:25.102175 [debug] [MainThread]: On master: BEGIN
[0m10:35:25.103175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:35:25.119137 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:35:25.119137 [debug] [MainThread]: On master: COMMIT
[0m10:35:25.119137 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:25.119137 [debug] [MainThread]: On master: COMMIT
[0m10:35:25.119137 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:35:25.119137 [debug] [MainThread]: On master: Close
[0m10:35:25.119137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:25.119137 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:35:25.119137 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:35:25.119137 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:35:25.119137 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:35:25.119137 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:35:25.119137 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:35:25.119137 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m10:35:25.119137 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:35:25.119137 [info ] [MainThread]: 
[0m10:35:25.119137 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m10:35:25.119137 [debug] [MainThread]: Command end result
[0m10:35:25.135254 [info ] [MainThread]: 
[0m10:35:25.135254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:25.135254 [info ] [MainThread]: 
[0m10:35:25.135254 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m10:35:25.135254 [debug] [MainThread]: Command `dbt run` succeeded at 10:35:25.135254 after 1.37 seconds
[0m10:35:25.135254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ED40BC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ED40BC4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ED3E2E350>]}
[0m10:35:25.135254 [debug] [MainThread]: Flushing usage events
[0m10:35:50.820392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95A9732D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95AD12D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95AD07E90>]}


============================== 10:35:50.820392 | 46acae19-73eb-43a9-9a28-a44f2c6f0c37 ==============================
[0m10:35:50.820392 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:35:50.820392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:35:50.949764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9586B5F50>]}
[0m10:35:50.990597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95AF13ED0>]}
[0m10:35:51.006198 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:35:51.006198 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:35:51.067126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:35:51.068015 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:35:51.148364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:35:51.148364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95AE98E50>]}
[0m10:35:51.158498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B369F90>]}
[0m10:35:51.158498 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:35:51.158498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B00DAD0>]}
[0m10:35:51.168349 [info ] [MainThread]: 
[0m10:35:51.169376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:35:51.170614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:35:51.170614 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:35:51.170614 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:35:51.170614 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:35:51.170614 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:35:51.170614 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:35:51.182483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:51.182483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:51.203214 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:35:51.204379 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:35:51.204379 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:35:51.204379 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:35:51.215819 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:35:51.217816 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:35:51.220300 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:35:51.220300 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:35:51.220300 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:35:51.220300 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:35:51.220300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:51.220300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:35:51.234658 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.234658 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:35:51.234658 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:35:51.234658 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:35:51.234658 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:35:51.234658 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:35:51.234658 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.234658 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:35:51.249047 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:35:51.251059 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:35:51.251059 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:35:51.251059 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:35:51.258605 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:51.258605 [debug] [MainThread]: On master: BEGIN
[0m10:35:51.258605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:35:51.271351 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.271351 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:51.272348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:35:51.276353 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:35:51.277374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95AD7AD10>]}
[0m10:35:51.277374 [debug] [MainThread]: On master: ROLLBACK
[0m10:35:51.278347 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:51.278347 [debug] [MainThread]: On master: BEGIN
[0m10:35:51.280347 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.280347 [debug] [MainThread]: On master: COMMIT
[0m10:35:51.280347 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:51.280347 [debug] [MainThread]: On master: COMMIT
[0m10:35:51.281346 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.282346 [debug] [MainThread]: On master: Close
[0m10:35:51.282767 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:35:51.283767 [info ] [MainThread]: 
[0m10:35:51.286788 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:35:51.287792 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:35:51.287792 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:35:51.289648 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:35:51.288767 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:35:51.289723 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:35:51.289723 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:35:51.294743 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:35:51.295724 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:35:51.295724 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:35:51.290753 => 10:35:51.295724
[0m10:35:51.297741 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:51.298741 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:35:51.299220 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:35:51.295724 => 10:35:51.299220
[0m10:35:51.320344 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:35:51.320344 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:35:51.320344 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:51.320344 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:51.320344 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:35:51.320344 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:51.332517 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:35:51.332517 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:35:51.333561 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:35:51.358665 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.358665 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.358665 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:51.358665 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:51.358665 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:35:51.358665 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:35:51.378733 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:35:51.383075 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:51.384146 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:35:51.386090 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.389184 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:51.389184 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:35:51.391137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.403799 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:35:51.404768 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:51.404768 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:35:51.415883 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.431603 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:35:51.431603 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:35:51.431603 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:35:51.459028 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.459028 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:35:51.320344 => 10:35:51.459028
[0m10:35:51.459028 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:35:51.459028 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B32FED0>]}
[0m10:35:51.459028 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.17s]
[0m10:35:51.459028 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:35:51.459028 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:35:51.459028 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:35:51.459028 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:35:51.459028 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:35:51.459028 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:35:51.459028 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:35:51.459028 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:35:51.474497 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:35:51.474773 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:35:51.475773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:35:51.477004 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:35:51.477436 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:35:51.483617 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:35:51.484508 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:35:51.484873 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:51.484873 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:35:51.484873 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:35:51.477436 => 10:35:51.484873
[0m10:35:51.484873 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:35:51.484873 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:35:51.484873 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:35:51.484873 => 10:35:51.484873
[0m10:35:51.484873 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:35:51.484873 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:35:51.484873 => 10:35:51.484873
[0m10:35:51.484873 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:35:51.484873 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:35:51.499253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.500301 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:35:51.501577 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:35:51.501577 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:51.501577 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:51.501577 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:35:51.501577 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:51.501577 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:35:51.501577 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:35:51.501577 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:51.501577 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:35:51.501577 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:35:51.501577 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:35:51.501577 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:35:51.501577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.501577 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:35:51.516866 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:35:51.518868 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:51.518868 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:35:51.522935 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.522935 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.522935 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:51.532439 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:51.533443 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:35:51.533443 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.534435 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:35:51.535129 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:51.535129 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:35:51.535129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.535129 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:35:51.535129 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:35:51.535129 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:35:51.549074 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:35:51.551370 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:51.551370 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.551370 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:35:51.551370 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:35:51.551370 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:35:51.551370 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:35:51.299220 => 10:35:51.551370
[0m10:35:51.558929 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:51.599298 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:51.599298 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:35:51.599298 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:35:51.599298 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:35:51.602433 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.602968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B4292D0>]}
[0m10:35:51.609705 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:51.609758 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.610285 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.611333 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:35:51.610811 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.31s]
[0m10:35:51.613731 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:51.614864 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:51.614864 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:35:51.614864 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:35:51.614864 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:35:51.614864 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.614864 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:35:51.614864 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:35:51.621791 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.621791 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.621791 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:51.621791 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:35:51.626181 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:35:51.629193 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:35:51.629193 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:35:51.633470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:35:51.634441 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:51.635421 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:51.636418 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:35:51.636418 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:35:51.637421 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:35:51.638361 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:51.638361 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.638361 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:35:51.638361 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:35:51.638361 => 10:35:51.638361
[0m10:35:51.638361 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.638361 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.638361 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:35:51.638361 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:35:51.651971 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:35:51.651971 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:35:51.651971 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:35:51.659079 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:51.659079 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:35:51.659079 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:35:51.659079 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:35:51.659079 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:51.659079 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:35:51.659079 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:35:51.659079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:51.659079 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.666894 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:35:51.500301 => 10:35:51.665888
[0m10:35:51.666894 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.668416 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.668416 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:35:51.668416 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:35:51.484873 => 10:35:51.668416
[0m10:35:51.668416 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:35:51.501577 => 10:35:51.668416
[0m10:35:51.668416 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B2E07D0>]}
[0m10:35:51.668416 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:35:51.668416 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:35:51.668416 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.19s]
[0m10:35:51.668416 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B2CDC10>]}
[0m10:35:51.668416 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B347610>]}
[0m10:35:51.668416 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:35:51.668416 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.21s]
[0m10:35:51.668416 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:35:51.668416 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.19s]
[0m10:35:51.668416 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:35:51.668416 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:35:51.668416 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:35:51.668416 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:35:51.668416 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:35:51.682413 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m10:35:51.683477 [info ] [Thread-4 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:35:51.683986 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:35:51.685000 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:35:51.686000 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_allowed_amount)
[0m10:35:51.686749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m10:35:51.686749 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:35:51.686749 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:35:51.686749 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:35:51.686749 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:35:51.686749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.686749 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:35:51.686749 => 10:35:51.686749
[0m10:35:51.699178 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:35:51.700176 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:51.700176 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:35:51.686749 => 10:35:51.700176
[0m10:35:51.701176 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:35:51.701176 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:35:51.686749 => 10:35:51.701176
[0m10:35:51.702175 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:35:51.702175 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:35:51.703675 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:35:51.703675 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:35:51.703675 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:35:51.703675 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:35:51.703675 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:51.703675 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:35:51.715803 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:51.716800 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:51.716800 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:35:51.717905 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:51.717905 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:35:51.717905 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:35:51.717905 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:35:51.717905 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:35:51.717905 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:35:51.717905 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:35:51.717905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.717905 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:51.717905 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:35:51.717905 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.733398 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:35:51.734398 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:51.735397 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:35:51.738125 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.738125 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.738125 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:51.738125 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:51.738125 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.738125 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:35:51.738125 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:35:51.738125 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:35:51.738125 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:35:51.738125 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.738125 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:35:51.738125 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:51.738125 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:35:51.751629 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:35:51.751629 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:35:51.751629 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:51.751629 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.759172 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:51.759172 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:35:51.759172 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:35:51.651971 => 10:35:51.759172
[0m10:35:51.759172 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:35:51.759172 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:35:51.759172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B0E4D10>]}
[0m10:35:51.759172 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.759172 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.768465 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:51.766184 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.13s]
[0m10:35:51.768465 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:51.768465 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:35:51.768465 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:35:51.768465 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:35:51.776010 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:35:51.776010 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.776010 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:35:51.776010 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.776010 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:35:51.776010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:35:51.776010 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:35:51.782581 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:51.783582 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:35:51.784636 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:51.784636 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:35:51.787036 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:51.787036 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:35:51.787036 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:35:51.785685 => 10:35:51.787036
[0m10:35:51.787036 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:35:51.787036 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:51.787036 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:51.787036 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:35:51.787036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:35:51.802965 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.807535 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:35:51.807535 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.807535 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:35:51.807535 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:35:51.807535 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:35:51.807535 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:35:51.807535 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:35:51.807535 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.816423 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:51.816860 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:35:51.835426 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.835426 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:35:51.703675 => 10:35:51.835426
[0m10:35:51.835426 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:35:51.835426 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B0AAB90>]}
[0m10:35:51.835426 [info ] [Thread-4 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.15s]
[0m10:35:51.835426 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:35:51.835426 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.835426 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:35:51.703675 => 10:35:51.835426
[0m10:35:51.835426 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:35:51.835426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B11BDD0>]}
[0m10:35:51.835426 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.15s]
[0m10:35:51.835426 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:35:51.849222 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:35:51.853219 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:51.853691 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:35:51.853691 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:35:51.855240 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:51.859248 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:35:51.859248 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.859248 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.859248 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:51.859248 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:51.859248 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:35:51.865726 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:35:51.868253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.868253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.868253 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:35:51.868253 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:35:51.868253 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:51.868253 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:51.868253 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:35:51.868253 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:35:51.900344 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.901345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.904526 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:35:51.904526 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:35:51.904526 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:35:51.904526 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:35:51.904526 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:35:51.904526 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:35:51.904526 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.915255 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:35:51.787036 => 10:35:51.914130
[0m10:35:51.915255 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:35:51.915880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B4B45D0>]}
[0m10:35:51.916883 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:51.918245 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:35:51.703177 => 10:35:51.918245
[0m10:35:51.918245 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.14s]
[0m10:35:51.918245 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:35:51.918245 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:35:51.918245 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B3B7650>]}
[0m10:35:51.918245 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.24s]
[0m10:35:51.918245 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:35:51.927915 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:35:51.929021 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:35:51.930675 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:35:51.931232 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:35:51.935230 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:35:51.936298 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:35:51.931783 => 10:35:51.936298
[0m10:35:51.936834 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:35:51.941229 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:35:51.942356 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:51.942356 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:35:51.942879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:35:51.959460 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:35:51.965796 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:51.965796 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT

        fc.diagnosis_1_key,
        fc.diagnosis_2_key,
        fc.diagnosis_3_key,
        fc.allowed_amount,
        fc.paid_amount,
        dd.diagnosis_key,
        dd.category_code,
        dd.diagnosis_code,
        dd.full_description,
        dd.category_title
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_code,
        category_title,
        COUNT(*) AS diagnosis_count,
        SUM(allowed_amount) AS total_allowed_amount,
        SUM(paid_amount) AS total_paid_amount
    FROM
        diagnosis_details
    WHERE
        diagnosis_key IN (diagnosis_1_key, diagnosis_2_key, diagnosis_3_key)
    GROUP BY
        diagnosis_key,
        category_code,
        category_title
    ORDER BY
        diagnosis_count desc
)

SELECT * 
FROM analysis
  );
  
[0m10:35:51.983701 [debug] [Thread-4 (]: SQL status: SELECT 773 in 0.0 seconds
[0m10:35:51.985447 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:51.985447 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m10:35:51.985447 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.985447 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:51.985447 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m10:35:51.985447 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:35:51.985447 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:35:51.985447 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:51.985447 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:35:51.985447 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:35:51.999178 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m10:35:52.000233 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:35:52.000233 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m10:35:52.001252 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:35:52.001252 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:35:51.937372 => 10:35:52.001252
[0m10:35:52.001252 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:35:52.001252 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46acae19-73eb-43a9-9a28-a44f2c6f0c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95B8A37D0>]}
[0m10:35:52.001252 [info ] [Thread-4 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 773[0m in 0.07s]
[0m10:35:52.001252 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:35:52.001252 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:52.001252 [debug] [MainThread]: On master: BEGIN
[0m10:35:52.001252 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:35:52.021085 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:35:52.021085 [debug] [MainThread]: On master: COMMIT
[0m10:35:52.021085 [debug] [MainThread]: Using postgres connection "master"
[0m10:35:52.021085 [debug] [MainThread]: On master: COMMIT
[0m10:35:52.021085 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:35:52.021085 [debug] [MainThread]: On master: Close
[0m10:35:52.021085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:35:52.021085 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:35:52.021085 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:35:52.021085 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:35:52.021085 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:35:52.021085 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:35:52.021085 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m10:35:52.021085 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:35:52.021085 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:35:52.021085 [info ] [MainThread]: 
[0m10:35:52.032486 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m10:35:52.034716 [debug] [MainThread]: Command end result
[0m10:35:52.034716 [info ] [MainThread]: 
[0m10:35:52.034716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:35:52.034716 [info ] [MainThread]: 
[0m10:35:52.034716 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m10:35:52.034716 [debug] [MainThread]: Command `dbt run` succeeded at 10:35:52.034716 after 1.27 seconds
[0m10:35:52.034716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95A973150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95866CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B95434F910>]}
[0m10:35:52.049082 [debug] [MainThread]: Flushing usage events
[0m10:37:07.241923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9C3CB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9C3D4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9725B10>]}


============================== 10:37:07.241923 | eb4df835-7acb-4017-83bc-45c57781520a ==============================
[0m10:37:07.241923 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:37:07.241923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:37:07.363057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9E25ED0>]}
[0m10:37:07.427315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9D47890>]}
[0m10:37:07.427315 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:37:07.427315 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:37:07.481821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:37:07.481821 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:37:07.577232 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:37:07.582941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA084450>]}
[0m10:37:07.593770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9FAC050>]}
[0m10:37:07.593770 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:37:07.594769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9D5B510>]}
[0m10:37:07.595798 [info ] [MainThread]: 
[0m10:37:07.597779 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:37:07.599564 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:37:07.600743 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:37:07.600743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:37:07.600743 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:37:07.600743 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:37:07.600743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:07.600743 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:37:07.600743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:07.619592 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:37:07.631614 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:37:07.631614 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:37:07.634221 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:37:07.634221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:37:07.634221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:37:07.634221 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:37:07.647272 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:37:07.648278 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:37:07.648278 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:37:07.649212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:07.649212 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:37:07.649212 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:37:07.649212 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:37:07.649212 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:37:07.649212 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:37:07.649212 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:37:07.663854 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:37:07.666873 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:37:07.666873 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:37:07.667867 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:37:07.668873 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:37:07.669873 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:37:07.670853 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:37:07.676870 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:07.676870 [debug] [MainThread]: On master: BEGIN
[0m10:37:07.676870 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:37:07.697265 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:37:07.697265 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:07.697265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:37:07.697265 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:37:07.697265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9ECFC90>]}
[0m10:37:07.697265 [debug] [MainThread]: On master: ROLLBACK
[0m10:37:07.697265 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:07.697265 [debug] [MainThread]: On master: BEGIN
[0m10:37:07.712891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:37:07.712891 [debug] [MainThread]: On master: COMMIT
[0m10:37:07.712891 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:07.712891 [debug] [MainThread]: On master: COMMIT
[0m10:37:07.712891 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:37:07.712891 [debug] [MainThread]: On master: Close
[0m10:37:07.716866 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:37:07.717869 [info ] [MainThread]: 
[0m10:37:07.721884 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:37:07.722869 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:37:07.722869 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:37:07.725096 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:37:07.723886 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:37:07.725096 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:37:07.725681 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:37:07.733523 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:37:07.734720 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:37:07.735284 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:37:07.735284 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:37:07.726683 => 10:37:07.735284
[0m10:37:07.735284 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:37:07.751872 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:37:07.735284 => 10:37:07.750934
[0m10:37:07.769142 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:37:07.769142 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:37:07.769142 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:37:07.769142 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:37:07.769142 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:37:07.769142 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:37:07.769142 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:37:07.780603 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:37:07.781627 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:37:07.799746 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:07.799746 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:07.799746 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:37:07.799746 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:37:07.799746 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:37:07.799746 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:37:07.819019 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:37:07.824083 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:37:07.824083 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:37:07.826013 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:07.829020 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:37:07.829020 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:37:07.831270 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:07.844199 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:37:07.845197 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:37:07.845197 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:37:07.863366 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:07.863366 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:37:07.863366 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:37:07.863366 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:37:07.897069 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:07.897069 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:37:07.769142 => 10:37:07.897069
[0m10:37:07.897069 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:37:07.897069 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA227590>]}
[0m10:37:07.897069 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.17s]
[0m10:37:07.897069 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:37:07.897069 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:37:07.897069 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:37:07.897069 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:37:07.897069 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:37:07.897069 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:37:07.897069 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:37:07.897069 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:37:07.912639 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:37:07.913417 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:37:07.913985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:37:07.914990 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:37:07.921289 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:37:07.921289 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:37:07.921289 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:37:07.921289 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:37:07.921289 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:37:07.921289 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:37:07.916198 => 10:37:07.921289
[0m10:37:07.930733 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:37:07.931784 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:37:07.931784 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:37:07.931784 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:37:07.921289 => 10:37:07.931784
[0m10:37:07.931784 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:37:07.921289 => 10:37:07.931784
[0m10:37:07.931784 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:37:07.931784 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:07.931784 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:37:07.931784 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:37:07.931784 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:37:07.931784 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:37:07.931784 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:37:07.947374 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:37:07.948765 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:37:07.948765 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:37:07.948765 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:37:07.948765 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:37:07.948765 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:37:07.948765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:07.948765 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:37:07.948765 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:37:07.948765 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:37:07.948765 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:37:07.948765 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:37:07.948765 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:37:07.948765 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:37:07.964965 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:07.964965 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:07.964965 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:37:07.980593 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:37:07.981448 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:07.981448 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:37:07.981448 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:37:07.981448 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:37:07.981448 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:37:07.981448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:07.981448 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:37:07.981448 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:37:07.981448 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:37:07.997335 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:07.999352 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:37:07.735284 => 10:37:07.999352
[0m10:37:08.000348 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:37:08.000348 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:37:08.002342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA1B1190>]}
[0m10:37:08.006375 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:37:08.006375 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:37:08.007344 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:37:08.007344 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.28s]
[0m10:37:08.007344 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:37:08.010341 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:37:08.050296 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:37:08.050296 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:37:08.050296 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:37:08.050296 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:37:08.050296 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:37:08.050296 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.066007 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.050296 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:37:08.066701 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.066701 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:37:08.066701 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:37:08.066701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:37:08.066701 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:37:08.066701 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:37:08.066701 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:37:08.066701 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:37:08.066701 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:37:08.066701 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:37:08.066701 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.066701 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.080704 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:37:08.066701 => 10:37:08.080704
[0m10:37:08.084713 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:37:08.084713 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.086733 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:37:08.087060 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:37:08.087060 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:37:08.087060 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:37:08.087060 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:37:08.087060 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:37:08.087060 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:37:08.087060 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:37:08.087060 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:37:08.087060 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:37:08.087060 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:37:08.087060 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:37:08.097460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:08.100463 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.100630 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:37:08.100630 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.100630 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.100630 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:37:08.100630 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:37:08.100630 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:37:08.100630 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:37:08.100630 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:37:08.114116 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:37:08.116416 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:37:08.116416 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:37:08.116416 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:08.116416 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:37:07.931784 => 10:37:08.116416
[0m10:37:08.116416 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:37:08.116416 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA03A7D0>]}
[0m10:37:08.116416 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.22s]
[0m10:37:08.116416 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:37:08.116416 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:08.116416 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:37:08.116416 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:08.116416 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:37:07.931784 => 10:37:08.116416
[0m10:37:08.130595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:08.133591 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:37:07.931784 => 10:37:08.132619
[0m10:37:08.131638 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:37:08.133591 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:37:08.134591 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:37:08.134591 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:37:08.135617 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m10:37:08.136592 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA24CB10>]}
[0m10:37:08.137624 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:37:08.138592 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA201550>]}
[0m10:37:08.138592 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:37:08.139594 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.24s]
[0m10:37:08.146590 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:37:08.141591 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.22s]
[0m10:37:08.147322 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:37:08.149323 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:37:08.149323 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:37:08.150322 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:37:08.141591 => 10:37:08.149323
[0m10:37:08.151320 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:37:08.151320 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:37:08.152797 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:37:08.152797 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:37:08.152797 [info ] [Thread-4 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:37:08.152797 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:37:08.152797 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:37:08.152797 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:37:08.152797 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_allowed_amount)
[0m10:37:08.152797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m10:37:08.163938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.164941 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:37:08.164941 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:37:08.165936 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:37:08.168877 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:37:08.168877 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:37:08.168877 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:37:08.168877 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:37:08.168877 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:37:08.168877 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:37:08.168877 => 10:37:08.168877
[0m10:37:08.168877 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:37:08.168877 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:37:08.168877 => 10:37:08.168877
[0m10:37:08.168877 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:37:08.168877 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:37:08.168877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.182743 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:37:08.185913 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:37:08.185913 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:37:08.185913 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:37:08.185913 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:37:08.185913 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:37:08.185913 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:37:08.185913 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:37:08.185913 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:37:08.185913 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:37:08.185913 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:08.185913 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:37:08.185913 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:37:08.185913 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:37:08.198581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.202579 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:37:08.203576 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:37:08.203576 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:37:08.208572 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:08.213933 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:37:08.087060 => 10:37:08.213933
[0m10:37:08.214932 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:08.214932 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:08.215935 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:37:08.216931 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:37:08.217223 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:37:08.219013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA2B6410>]}
[0m10:37:08.219013 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:37:08.219013 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:37:08.219013 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.15s]
[0m10:37:08.219013 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:37:08.219013 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:37:08.219013 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:37:08.219013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:37:08.219013 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:37:08.230729 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:37:08.232728 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:37:08.219013 => 10:37:08.231734
[0m10:37:08.232728 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:37:08.237534 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:37:08.237534 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:37:08.237534 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:37:08.237534 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:37:08.237534 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:37:08.247321 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:37:08.248328 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:37:08.249323 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:37:08.250326 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:37:08.251584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:37:08.253322 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.253322 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.256153 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:37:08.263900 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:37:08.264898 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:37:08.265897 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:37:08.268898 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.269898 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.272024 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:37:08.272024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:08.272024 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:37:08.272024 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:37:08.279563 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:37:08.279583 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:37:08.279583 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:37:08.283743 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:37:08.283964 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:37:08.283964 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:37:08.283964 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:37:08.283964 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:37:08.283964 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.283964 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:37:08.283964 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:37:08.318977 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.321974 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:37:08.321974 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.321974 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.322992 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:37:08.324974 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:37:08.324974 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:37:08.326992 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:37:08.326992 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:37:08.327973 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:37:08.329995 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:37:08.330973 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:37:08.331974 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:37:08.331974 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:37:08.332974 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:37:08.333976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.334975 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:08.334975 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.338991 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:37:08.338991 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:08.339991 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:37:08.183810 => 10:37:08.339991
[0m10:37:08.341990 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:37:08.341990 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:37:08.342973 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:37:08.168877 => 10:37:08.342973
[0m10:37:08.343972 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:37:08.343972 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:37:08.344972 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:37:08.345976 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA3BB310>]}
[0m10:37:08.345976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.347005 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:37:08.348072 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA3C1010>]}
[0m10:37:08.350619 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:37:08.348596 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.19s]
[0m10:37:08.351599 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:37:08.350619 [info ] [Thread-4 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.19s]
[0m10:37:08.351599 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:37:08.352598 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:37:08.353530 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:37:08.353530 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:08.355557 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:37:08.152797 => 10:37:08.355557
[0m10:37:08.355557 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:37:08.356532 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA3E8A90>]}
[0m10:37:08.356532 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.22s]
[0m10:37:08.357533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.358532 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:37:08.361523 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:37:08.362522 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:37:08.362522 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:37:08.363998 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:37:08.363539 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:37:08.365597 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:37:08.366601 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:37:08.368387 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:37:08.368387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:08.368387 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:37:08.233731 => 10:37:08.368387
[0m10:37:08.368387 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:37:08.366601 => 10:37:08.368387
[0m10:37:08.368387 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:37:08.368387 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:37:08.368387 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:37:08.368387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA201510>]}
[0m10:37:08.380554 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:37:08.368387 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.15s]
[0m10:37:08.381562 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:37:08.381562 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:37:08.382552 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:37:08.386559 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:37:08.386559 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:37:08.397397 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT

        fc.diagnosis_1_key,
        fc.diagnosis_2_key,
        fc.diagnosis_3_key,
        fc.allowed_amount,
        fc.paid_amount,
        dd.diagnosis_key,
        dd.category_code,
        dd.diagnosis_code,
        dd.full_description,
        dd.category_title
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_title,
        COUNT(*) AS diagnosis_count,
        SUM(allowed_amount) AS total_allowed_amount,
        SUM(paid_amount) AS total_paid_amount
    FROM
        diagnosis_details
    WHERE
        diagnosis_key IN (diagnosis_1_key, diagnosis_2_key, diagnosis_3_key)
    GROUP BY
        diagnosis_key,
        category_title
    ORDER BY
        diagnosis_count desc
)

SELECT * 
FROM analysis
  );
  
[0m10:37:08.400406 [debug] [Thread-2 (]: SQL status: SELECT 773 in 0.0 seconds
[0m10:37:08.415906 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:37:08.416909 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m10:37:08.418908 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.419249 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:37:08.419249 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m10:37:08.419249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:37:08.419249 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:37:08.419249 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:37:08.419249 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:37:08.419249 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.431747 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m10:37:08.431747 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:37:08.432754 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m10:37:08.433490 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:37:08.433490 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:37:08.368387 => 10:37:08.433490
[0m10:37:08.433490 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:37:08.433490 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb4df835-7acb-4017-83bc-45c57781520a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDFA3D6350>]}
[0m10:37:08.433490 [info ] [Thread-2 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 773[0m in 0.07s]
[0m10:37:08.433490 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:37:08.433490 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:08.433490 [debug] [MainThread]: On master: BEGIN
[0m10:37:08.433490 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:37:08.449745 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:37:08.449745 [debug] [MainThread]: On master: COMMIT
[0m10:37:08.449745 [debug] [MainThread]: Using postgres connection "master"
[0m10:37:08.449745 [debug] [MainThread]: On master: COMMIT
[0m10:37:08.449745 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:37:08.449745 [debug] [MainThread]: On master: Close
[0m10:37:08.449745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:37:08.449745 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:37:08.449745 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:37:08.449745 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:37:08.449745 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:37:08.449745 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:37:08.449745 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:37:08.449745 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m10:37:08.449745 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:37:08.449745 [info ] [MainThread]: 
[0m10:37:08.449745 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m10:37:08.464870 [debug] [MainThread]: Command end result
[0m10:37:08.468934 [info ] [MainThread]: 
[0m10:37:08.468934 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:37:08.468934 [info ] [MainThread]: 
[0m10:37:08.468934 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m10:37:08.480591 [debug] [MainThread]: Command `dbt run` succeeded at 10:37:08.480591 after 1.27 seconds
[0m10:37:08.481602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9882F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF9883150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDF31EC610>]}
[0m10:37:08.481602 [debug] [MainThread]: Flushing usage events
[0m10:43:42.121705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E497D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E497D550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E497ED10>]}


============================== 10:43:42.121705 | 74e7403f-26ae-4e34-b2b4-4e6cb932efdb ==============================
[0m10:43:42.121705 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:43:42.121705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:43:42.239153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E49713D0>]}
[0m10:43:42.305626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E22C41D0>]}
[0m10:43:42.305626 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:43:42.305626 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:43:42.356773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:43:42.356773 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:43:42.456928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:43:42.456928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4EC42D0>]}
[0m10:43:42.473488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4D78F50>]}
[0m10:43:42.473488 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:43:42.473488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4BC1B50>]}
[0m10:43:42.473488 [info ] [MainThread]: 
[0m10:43:42.473488 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:43:42.473488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:43:42.489927 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:43:42.490892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:43:42.491885 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:43:42.492422 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:43:42.492422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:42.492422 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:43:42.492422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:42.509356 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:43:42.509356 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:43:42.509356 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:43:42.509356 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:43:42.509356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:43:42.522221 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:43:42.525280 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:43:42.527036 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:43:42.527036 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:43:42.527036 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:43:42.527036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:42.527036 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:43:42.567800 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.567800 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.567800 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:43:42.567800 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:43:42.571208 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:43:42.571208 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:43:42.577245 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:43:42.577245 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:43:42.578237 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:43:42.579285 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:43:42.580295 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:43:42.581238 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:43:42.590388 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:42.591371 [debug] [MainThread]: On master: BEGIN
[0m10:43:42.591371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:43:42.610102 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.610102 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:42.610102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:43:42.623049 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:43:42.624053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4BCEE90>]}
[0m10:43:42.624053 [debug] [MainThread]: On master: ROLLBACK
[0m10:43:42.625648 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:42.626618 [debug] [MainThread]: On master: BEGIN
[0m10:43:42.626618 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.626618 [debug] [MainThread]: On master: COMMIT
[0m10:43:42.626618 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:42.626618 [debug] [MainThread]: On master: COMMIT
[0m10:43:42.626618 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:43:42.626618 [debug] [MainThread]: On master: Close
[0m10:43:42.626618 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:43:42.626618 [info ] [MainThread]: 
[0m10:43:42.626618 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:43:42.626618 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:43:42.637716 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:43:42.638716 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:43:42.637716 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:43:42.639714 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:43:42.639714 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:43:42.644733 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:43:42.644733 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:43:42.647734 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:43:42.647734 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:43:42.639714 => 10:43:42.647734
[0m10:43:42.648713 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:43:42.645713 => 10:43:42.648713
[0m10:43:42.648713 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:43:42.648713 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:43:42.676243 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:43:42.678375 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:43:42.678375 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:43:42.678375 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:43:42.678375 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:43:42.678375 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:43:42.678375 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:43:42.678375 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:43:42.694851 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.694851 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:43:42.694851 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.694851 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:43:42.694851 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:43:42.694851 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:43:42.706137 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:43:42.706137 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:43:42.706137 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:43:42.706137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.706137 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:43:42.706137 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:43:42.723262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.738947 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:43:42.738947 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:43:42.739947 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:43:42.756791 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:42.761756 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:43:42.765787 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:43:42.766757 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:43:42.775283 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:42.775283 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:43:42.775283 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:43:42.677124 => 10:43:42.775283
[0m10:43:42.775283 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:43:42.775283 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:43:42.775283 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:43:42.775283 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E5009C90>]}
[0m10:43:42.775283 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.14s]
[0m10:43:42.775283 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:43:42.775283 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.775283 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:43:42.790950 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:43:42.790950 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:43:42.790950 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:43:42.790950 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:43:42.790950 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:43:42.790950 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:43:42.794130 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:43:42.793475 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:43:42.795131 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:43:42.795744 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:43:42.796126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:43:42.796126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.796126 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:43:42.796126 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:43:42.796126 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:43:42.796126 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:43:42.805434 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:43:42.806347 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:43:42.806347 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:43:42.796126 => 10:43:42.806347
[0m10:43:42.806347 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:43:42.806347 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:43:42.796126 => 10:43:42.806347
[0m10:43:42.806347 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:43:42.806347 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:43:42.806347 => 10:43:42.806347
[0m10:43:42.806347 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:43:42.806347 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:43:42.806347 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:43:42.806347 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:43:42.806347 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:43:42.806347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:42.821228 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:43:42.822232 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:43:42.824693 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:43:42.824693 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:43:42.824693 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:43:42.824693 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:43:42.824693 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:43:42.824693 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:43:42.824693 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:43:42.824693 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:43:42.824693 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:43:42.824693 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:43:42.824693 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:43:42.824693 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:42.824693 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:43:42.649712 => 10:43:42.824693
[0m10:43:42.824693 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:43:42.837726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4D42B90>]}
[0m10:43:42.838724 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.20s]
[0m10:43:42.839724 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:43:42.840821 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:43:42.841330 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:43:42.843341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:43:42.844343 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:43:42.845667 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:43:42.845667 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:43:42.844343 => 10:43:42.845667
[0m10:43:42.845667 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:43:42.845667 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:43:42.854598 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:43:42.854598 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:43:42.855595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:42.856594 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.856998 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.856998 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.856998 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:43:42.856998 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:43:42.856998 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:43:42.856998 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:43:42.856998 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:43:42.856998 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:43:42.856998 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:43:42.856998 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:43:42.926054 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:43:42.929779 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:43:42.933181 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:43:42.933181 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:42.940954 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:43:42.942078 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:43:42.943720 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:43:42.944806 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:43:42.945905 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:43:42.948112 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:43:42.951931 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.951948 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.955795 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:43:42.955795 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.958798 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:43:42.959797 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:43:42.959797 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:43:42.962795 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:43:42.962795 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:43:42.964792 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:43:42.965793 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:43:42.966794 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:43:42.966794 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.968794 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:43:42.968794 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.969793 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.969793 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.969793 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:43:42.971794 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:43:42.972830 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:43:42.972830 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:43:42.972830 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:43:42.972830 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:43:42.972830 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:43:42.972830 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:43:42.972830 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:43:42.972830 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:43:42.972830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:42.972830 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:42.972830 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:43:42.972830 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:42.972830 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:42.972830 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:43:42.972830 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:43:42.972830 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:43:42.988459 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:43:42.988459 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:43:42.988459 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:43:42.988459 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:43:42.988459 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:43:42.988459 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:43:42.988459 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:43:42.988459 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:43:42.988459 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:42.988459 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:43:42.988459 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:42.988459 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:42.988459 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:42.988459 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:43:42.988459 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:43:42.806347 => 10:43:42.988459
[0m10:43:42.988459 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:43:42.806347 => 10:43:42.988459
[0m10:43:43.004658 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:43:42.806347 => 10:43:43.004658
[0m10:43:43.004658 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:43:43.004658 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:43:43.004658 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:43:43.004658 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:43:43.004658 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4FC2E90>]}
[0m10:43:43.004658 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4A59850>]}
[0m10:43:43.004658 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4F080D0>]}
[0m10:43:43.004658 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:43.004658 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.21s]
[0m10:43:43.004658 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.21s]
[0m10:43:43.004658 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:43:42.845667 => 10:43:43.004658
[0m10:43:43.004658 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.21s]
[0m10:43:43.004658 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:43:43.004658 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:43:43.004658 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:43:43.004658 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:43:43.004658 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:43:43.020297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4FE1ED0>]}
[0m10:43:43.020297 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:43:43.021971 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:43:43.022670 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:43:43.023671 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.18s]
[0m10:43:43.023671 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:43:43.025006 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m10:43:43.025006 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:43:43.025006 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:43:43.025006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m10:43:43.025006 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:43:43.025006 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m10:43:43.025006 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:43:43.025006 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:43:43.025006 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:43:43.025006 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:43:43.025006 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:43:43.025006 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:43:43.025006 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:43:43.037842 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:43:43.025006 => 10:43:43.037842
[0m10:43:43.038849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:43:43.039844 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:43:43.025006 => 10:43:43.038849
[0m10:43:43.039844 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:43:43.040847 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:43:43.025006 => 10:43:43.040847
[0m10:43:43.040847 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:43:43.042545 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:43:43.042545 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:43:43.042545 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:43:43.042545 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:43:43.042545 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:43:43.058508 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:43:43.058508 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:43:43.059507 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:43:43.042545 => 10:43:43.059507
[0m10:43:43.060508 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:43:43.061509 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:43:43.061509 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:43:43.062508 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:43:43.062508 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:43:43.063506 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:43:43.064888 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:43:43.064888 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:43:43.064888 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:43:43.064888 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:43:43.071069 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:43:43.072067 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:43:43.073065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:43.075995 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:43.075995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:43.075995 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:43:43.075995 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:43:43.075995 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:43:43.075995 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:43.087692 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:43:43.087692 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:43:43.089440 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:43:43.089440 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:43:43.089440 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:43:43.089440 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:43:43.089440 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:43:43.089440 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:43.089440 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:43:43.089440 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:43:43.089440 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:43:43.089440 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:43:43.104449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.104449 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.108166 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:43:43.108166 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:43:43.108166 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:43:43.108166 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:43:43.108166 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:43:43.108166 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:43:43.117195 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.117195 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.117195 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:43:43.117195 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:43:43.121347 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:43:43.122349 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:43:43.122349 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:43:43.123349 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.123349 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:43:43.124349 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:43:43.126366 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:43:43.127348 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:43:43.135346 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:43.138416 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:43:43.138969 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.138969 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:43.139678 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:43:43.141690 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:43:43.143686 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:43:43.143686 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:43:43.144670 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:43:43.145668 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:43:43.145668 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:43:43.146668 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:43:43.153670 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:43.154575 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:43:43.063506 => 10:43:43.154575
[0m10:43:43.154575 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:43:43.154575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4F7F310>]}
[0m10:43:43.154575 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.12s]
[0m10:43:43.154575 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:43:43.154575 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:43.160086 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:43:43.160086 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:43:43.160086 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:43:43.160086 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:43.160086 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:43:43.160086 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:43:43.160086 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:43:43.042545 => 10:43:43.160086
[0m10:43:43.160086 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:43:43.160086 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:43:43.160086 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4F41B90>]}
[0m10:43:43.160086 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.160086 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.14s]
[0m10:43:43.175501 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:43:43.175501 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:43.175501 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:43:43.175501 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:43:43.175501 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:43:43.042545 => 10:43:43.175501
[0m10:43:43.175501 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:43:43.175501 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E50E4C50>]}
[0m10:43:43.175501 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.175501 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:43:43.175501 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.15s]
[0m10:43:43.175501 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:43:43.175501 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:43:43.175501 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:43:43.175501 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:43.187721 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:43:43.188720 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:43:43.189719 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:43:43.191573 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:43.191573 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:43:43.042545 => 10:43:43.191573
[0m10:43:43.191573 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:43:43.191573 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E4F18CD0>]}
[0m10:43:43.191573 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.17s]
[0m10:43:43.191573 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:43:43.191573 [debug] [Thread-1 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:43:43.191573 [info ] [Thread-1 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:43:43.191573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount_by_day, now model.postgres_dev.diagnosis_analysis)
[0m10:43:43.191573 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:43:43.191573 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:43:43.204377 [debug] [Thread-1 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:43:43.191573 => 10:43:43.191573
[0m10:43:43.204377 [debug] [Thread-1 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:43:43.208284 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:43:43.208284 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:43:43.208284 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:43:43.208284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:43:43.225174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:43:43.225174 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:43:43.225174 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT
        fc.diagnosis_1_key,
        fc.diagnosis_2_key,
        fc.diagnosis_3_key,
        fc.allowed_amount,
        fc.paid_amount,
        dd.diagnosis_key,
        dd.category_code,
        dd.diagnosis_code,
        dd.full_description,
        dd.category_title
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_title,
        COUNT(*) AS diagnosis_count,
        SUM(allowed_amount) AS total_allowed_amount,
        SUM(paid_amount) AS total_paid_amount
    FROM
        diagnosis_details
    WHERE
        diagnosis_key IN (diagnosis_1_key, diagnosis_2_key, diagnosis_3_key) OR
        diagnosis_key IN (diagnosis_2_key, diagnosis_3_key, diagnosis_1_key) OR
        diagnosis_key IN (diagnosis_3_key, diagnosis_1_key, diagnosis_2_key)
    GROUP BY
        diagnosis_key,
        category_title
    ORDER BY
        diagnosis_count desc
)

SELECT * 
FROM analysis
  );
  
[0m10:43:43.245167 [debug] [Thread-1 (]: SQL status: SELECT 773 in 0.0 seconds
[0m10:43:43.245167 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:43:43.245167 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m10:43:43.245167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.245167 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:43:43.254552 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m10:43:43.256418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:43:43.256927 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:43:43.256927 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:43:43.256927 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:43:43.256927 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:43:43.256927 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m10:43:43.256927 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:43:43.256927 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m10:43:43.256927 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:43:43.256927 [debug] [Thread-1 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:43:43.204377 => 10:43:43.256927
[0m10:43:43.256927 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:43:43.256927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74e7403f-26ae-4e34-b2b4-4e6cb932efdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184E5067A50>]}
[0m10:43:43.271292 [info ] [Thread-1 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 773[0m in 0.07s]
[0m10:43:43.272269 [debug] [Thread-1 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:43:43.273131 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:43.273131 [debug] [MainThread]: On master: BEGIN
[0m10:43:43.273131 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:43:43.288778 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:43:43.289741 [debug] [MainThread]: On master: COMMIT
[0m10:43:43.289741 [debug] [MainThread]: Using postgres connection "master"
[0m10:43:43.290740 [debug] [MainThread]: On master: COMMIT
[0m10:43:43.291757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:43:43.291757 [debug] [MainThread]: On master: Close
[0m10:43:43.291757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:43:43.291757 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:43:43.291757 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:43:43.291757 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:43:43.291757 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:43:43.291757 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:43:43.291757 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m10:43:43.291757 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m10:43:43.291757 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:43:43.291757 [info ] [MainThread]: 
[0m10:43:43.291757 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m10:43:43.291757 [debug] [MainThread]: Command end result
[0m10:43:43.307083 [info ] [MainThread]: 
[0m10:43:43.307083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:43:43.307083 [info ] [MainThread]: 
[0m10:43:43.307083 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m10:43:43.307083 [debug] [MainThread]: Command `dbt run` succeeded at 10:43:43.307083 after 1.22 seconds
[0m10:43:43.307083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DDF2C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DDF2F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184DDF2F9D0>]}
[0m10:43:43.307083 [debug] [MainThread]: Flushing usage events
[0m10:51:24.904847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E897DCC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E897DD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E897D2C50>]}


============================== 10:51:24.904847 | d4c7e77b-9eb5-4fcd-b9a5-752772c31358 ==============================
[0m10:51:24.904847 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:51:24.904847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:51:25.040340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E897C77D0>]}
[0m10:51:25.102744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E899C3110>]}
[0m10:51:25.102744 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:51:25.102744 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:51:25.173366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:51:25.175002 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:51:25.271299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:51:25.271299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89D568D0>]}
[0m10:51:25.295858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89E35ED0>]}
[0m10:51:25.295858 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:51:25.295858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E899D3890>]}
[0m10:51:25.295858 [info ] [MainThread]: 
[0m10:51:25.295858 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:51:25.295858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:51:25.295858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:51:25.316203 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:51:25.317210 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:51:25.318221 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:51:25.318221 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:51:25.319171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:25.319171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:25.331369 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:51:25.331369 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:51:25.345796 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:51:25.345796 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:51:25.345796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:51:25.366005 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:51:25.367005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:51:25.368019 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:51:25.369987 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:51:25.369987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:25.369987 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:51:25.370988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:25.402858 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.402858 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.403855 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:51:25.403855 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:51:25.404858 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:51:25.405856 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:51:25.410048 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:51:25.410262 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:51:25.411264 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:51:25.413265 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:51:25.415263 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:51:25.415263 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:51:25.423955 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:25.424491 [debug] [MainThread]: On master: BEGIN
[0m10:51:25.424491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:51:25.447554 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.448588 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:25.448588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:51:25.452572 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:51:25.453555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89D88810>]}
[0m10:51:25.453555 [debug] [MainThread]: On master: ROLLBACK
[0m10:51:25.454569 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:25.455556 [debug] [MainThread]: On master: BEGIN
[0m10:51:25.456817 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.456817 [debug] [MainThread]: On master: COMMIT
[0m10:51:25.456817 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:25.457817 [debug] [MainThread]: On master: COMMIT
[0m10:51:25.457817 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.458816 [debug] [MainThread]: On master: Close
[0m10:51:25.458816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:51:25.460134 [info ] [MainThread]: 
[0m10:51:25.464615 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:51:25.464615 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:51:25.465593 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:51:25.466593 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:51:25.465593 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:51:25.467593 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:51:25.467593 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:51:25.472648 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:51:25.472648 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:51:25.475631 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:51:25.475631 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:51:25.467593 => 10:51:25.475631
[0m10:51:25.476733 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:51:25.477736 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:51:25.473612 => 10:51:25.477157
[0m10:51:25.498209 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:51:25.498209 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:51:25.498209 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:51:25.511042 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:51:25.511042 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:51:25.511995 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:51:25.513169 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:51:25.513169 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:51:25.513169 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:51:25.524681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.524681 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:51:25.524681 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:51:25.529377 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.529377 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:51:25.529377 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:51:25.545241 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:51:25.550240 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:51:25.551240 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:51:25.552414 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.555259 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:51:25.555259 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:51:25.557242 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.570258 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:51:25.571240 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:51:25.571240 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:51:25.584418 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.589510 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:51:25.589510 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:51:25.594500 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:51:25.598075 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:51:25.598695 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:51:25.599224 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:51:25.600217 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.603213 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:51:25.604213 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:51:25.604213 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:25.606213 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:51:25.498209 => 10:51:25.606213
[0m10:51:25.606213 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.607233 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:51:25.608246 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:51:25.609230 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89EA6350>]}
[0m10:51:25.610093 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:51:25.611163 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:51:25.610632 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.14s]
[0m10:51:25.612232 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:51:25.612746 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:51:25.612746 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:51:25.612746 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:51:25.613747 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.613747 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:51:25.613747 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:51:25.616766 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:51:25.617746 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:51:25.614748 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:51:25.618340 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:51:25.618959 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:51:25.619960 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:51:25.619960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:51:25.621171 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:51:25.621171 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:51:25.624741 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:51:25.624741 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:51:25.629527 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:51:25.631446 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:51:25.631446 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:25.631446 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:51:25.621171 => 10:51:25.631446
[0m10:51:25.631446 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:51:25.626511 => 10:51:25.631446
[0m10:51:25.631446 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:51:25.477736 => 10:51:25.631446
[0m10:51:25.631446 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:51:25.630508 => 10:51:25.631446
[0m10:51:25.631446 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:51:25.631446 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:51:25.631446 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:51:25.631446 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:51:25.643187 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:51:25.645452 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:51:25.645452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89EBDFD0>]}
[0m10:51:25.645452 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:51:25.645452 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:51:25.645452 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:51:25.645452 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:51:25.645452 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:51:25.645452 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.18s]
[0m10:51:25.645452 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:51:25.645452 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:51:25.645452 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:51:25.645452 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:51:25.645452 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:51:25.645452 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:51:25.645452 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:51:25.645452 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:51:25.661926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:51:25.663415 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:51:25.663415 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:51:25.663415 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:51:25.663415 => 10:51:25.663415
[0m10:51:25.663415 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:51:25.663415 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:51:25.663415 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:51:25.663415 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:51:25.663415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:25.663415 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.663415 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:51:25.663415 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.676524 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.677036 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:51:25.677036 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:51:25.678049 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:51:25.679048 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:51:25.680049 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:51:25.682106 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:51:25.729786 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:51:25.729786 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:51:25.729786 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:51:25.729786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.729786 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:51:25.744237 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:51:25.746290 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:51:25.747332 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:51:25.747332 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:51:25.748199 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:51:25.748199 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:51:25.748199 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.752203 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:51:25.753203 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.753203 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.754207 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:51:25.758202 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:51:25.758202 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:51:25.760200 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:51:25.761227 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:51:25.763198 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:51:25.764197 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.764197 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:51:25.764197 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:51:25.767219 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:51:25.767219 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.768202 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:51:25.771199 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:51:25.771199 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.772221 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.772221 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:51:25.773204 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:51:25.775200 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:51:25.776556 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:51:25.776556 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:51:25.776556 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:51:25.776556 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:51:25.776556 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:51:25.776556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.776556 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.776556 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:51:25.776556 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.776556 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.776556 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:51:25.776556 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:51:25.776556 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:51:25.776556 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:51:25.776556 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:51:25.776556 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:51:25.776556 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:51:25.792385 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:51:25.793022 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:51:25.793583 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:51:25.794093 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:51:25.794093 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.794093 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:51:25.794093 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:25.794093 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:25.794093 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:25.794093 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:51:25.794093 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:51:25.631446 => 10:51:25.794093
[0m10:51:25.794093 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:51:25.645452 => 10:51:25.794093
[0m10:51:25.794093 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:51:25.644191 => 10:51:25.794093
[0m10:51:25.794093 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:51:25.794093 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:51:25.794093 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:51:25.794093 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:51:25.794093 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89E9E750>]}
[0m10:51:25.794093 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89D9ABD0>]}
[0m10:51:25.794093 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89B82690>]}
[0m10:51:25.794093 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:25.794093 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.18s]
[0m10:51:25.809734 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.17s]
[0m10:51:25.809734 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:51:25.663415 => 10:51:25.809734
[0m10:51:25.809734 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.18s]
[0m10:51:25.809734 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:51:25.809734 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:51:25.809734 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:51:25.809734 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:51:25.809734 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:51:25.809734 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:51:25.809734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89DC5210>]}
[0m10:51:25.809734 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:51:25.809734 [info ] [Thread-4 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:51:25.809734 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:51:25.817593 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.15s]
[0m10:51:25.818214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.dim_diagnosis)
[0m10:51:25.818214 [info ] [Thread-3 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:51:25.819231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m10:51:25.820200 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:51:25.820583 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:51:25.820583 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_paid_amount)
[0m10:51:25.820583 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:51:25.820583 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:51:25.827556 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:51:25.828550 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:51:25.831314 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:51:25.831314 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:51:25.831314 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:51:25.831314 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:51:25.820583 => 10:51:25.831314
[0m10:51:25.831314 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:51:25.829554 => 10:51:25.831314
[0m10:51:25.831314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:51:25.831314 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:51:25.831314 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:51:25.831314 => 10:51:25.831314
[0m10:51:25.831314 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:51:25.831314 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:51:25.845586 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:51:25.845586 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:51:25.845586 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:51:25.845586 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:51:25.845586 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:51:25.845586 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:51:25.845586 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:51:25.845586 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:51:25.845586 => 10:51:25.845586
[0m10:51:25.859893 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:51:25.859893 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:51:25.860914 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:51:25.860914 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:51:25.861894 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:51:25.862894 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:51:25.863893 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:51:25.864348 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:51:25.864348 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:51:25.864348 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:51:25.864348 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:51:25.864348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:25.890106 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.890106 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.893283 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:51:25.894282 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:51:25.895282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.895282 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:25.895282 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:51:25.896282 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:51:25.897282 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:51:25.897702 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:51:25.897702 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:51:25.897702 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:51:25.897702 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:51:25.897702 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:51:25.897702 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:51:25.897702 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:51:25.897702 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:51:25.912475 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:51:25.916534 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:51:25.916534 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:51:25.916534 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:51:25.916534 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.916534 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:51:25.916534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.916534 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.916534 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:51:25.925073 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:51:25.927644 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:51:25.928617 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:51:25.928617 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:51:25.929615 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.931617 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:51:25.932614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.932614 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.932614 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:51:25.934638 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:51:25.936638 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:51:25.936638 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:51:25.937616 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:51:25.937616 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:51:25.938616 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:51:25.938616 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:51:25.953193 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.954191 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.954191 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.956192 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:51:25.958211 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:51:25.960289 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:51:25.960289 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:51:25.960289 [debug] [Thread-4 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:51:25.960289 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:51:25.960289 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:51:25.960289 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:51:25.964296 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:51:25.964296 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:51:25.964296 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:51:25.964296 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:51:25.964296 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.964296 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:51:25.964296 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:51:25.979960 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:25.979960 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:51:25.845586 => 10:51:25.979960
[0m10:51:25.979960 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:25.979960 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:25.979960 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:51:25.979960 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:51:25.979960 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:25.979960 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:51:25.845586 => 10:51:25.979960
[0m10:51:25.979960 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89F55510>]}
[0m10:51:25.979960 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:51:25.979960 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:51:25.863893 => 10:51:25.979960
[0m10:51:25.979960 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:51:25.979960 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:51:25.979960 [info ] [Thread-3 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.16s]
[0m10:51:25.979960 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:51:25.979960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89DB9290>]}
[0m10:51:25.979960 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:51:25.995862 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89E34750>]}
[0m10:51:25.996374 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.16s]
[0m10:51:25.996374 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:25.996374 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.16s]
[0m10:51:25.996374 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:51:26.000973 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:51:26.002759 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:51:26.002759 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:51:26.002759 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:51:26.011912 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:26.013921 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:51:25.831314 => 10:51:26.013921
[0m10:51:26.014686 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:51:26.014686 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89C3FB10>]}
[0m10:51:26.014686 [info ] [Thread-4 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.20s]
[0m10:51:26.014686 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:51:26.014686 [debug] [Thread-3 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:51:26.014686 [info ] [Thread-3 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:51:26.014686 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:51:26.014686 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:51:26.025231 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:51:26.026518 [debug] [Thread-3 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:51:26.014686 => 10:51:26.025231
[0m10:51:26.026518 [debug] [Thread-3 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:51:26.029534 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:51:26.031050 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:51:26.031050 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:51:26.031050 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:51:26.047839 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:51:26.047839 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:51:26.047839 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT
        fc.diagnosis_1_key,
        fc.diagnosis_2_key,
        fc.diagnosis_3_key,
        fc.allowed_amount,
        fc.paid_amount,
        dd.diagnosis_key,
        dd.category_code,
        dd.diagnosis_code,
        dd.full_description,
        dd.category_title
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
    LEFT JOIN
        dim_diagnosis dd2 ON fc.diagnosis_2_key = dd2.diagnosis_key
    LEFT JOIN
        dim_diagnosis dd3 ON fc.diagnosis_3_key = dd3.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_title,
        COUNT(*) AS diagnosis_count,
        SUM(allowed_amount) AS total_allowed_amount,
        SUM(paid_amount) AS total_paid_amount
    FROM (
        SELECT diagnosis_1_key AS diagnosis_key, category_title, allowed_amount, paid_amount
        FROM diagnosis_details
        UNION ALL
        SELECT diagnosis_2_key, category_title, allowed_amount, paid_amount
        FROM diagnosis_details
        UNION ALL
        SELECT diagnosis_3_key, category_title, allowed_amount, paid_amount
        FROM diagnosis_details
    ) AS combined_data
    GROUP BY
        diagnosis_key,
        category_title
    ORDER BY
        diagnosis_count DESC
)

SELECT * 
FROM analysis
  );
  
[0m10:51:26.807463 [debug] [Thread-3 (]: SQL status: SELECT 2910 in 1.0 seconds
[0m10:51:26.807463 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:51:26.807463 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m10:51:26.807463 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:26.807463 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:51:26.807463 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m10:51:26.823791 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:51:26.823791 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:51:26.823791 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:51:26.823791 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m10:51:26.826805 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:51:26.826805 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m10:51:26.826805 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:51:26.826805 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m10:51:26.826805 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:51:26.842537 [debug] [Thread-3 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:51:26.026518 => 10:51:26.826805
[0m10:51:26.842537 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:51:26.842537 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c7e77b-9eb5-4fcd-b9a5-752772c31358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E89B6E150>]}
[0m10:51:26.842537 [info ] [Thread-3 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 2910[0m in 0.83s]
[0m10:51:26.842537 [debug] [Thread-3 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:51:26.842537 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:26.842537 [debug] [MainThread]: On master: BEGIN
[0m10:51:26.842537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:51:26.863326 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:51:26.863326 [debug] [MainThread]: On master: COMMIT
[0m10:51:26.863326 [debug] [MainThread]: Using postgres connection "master"
[0m10:51:26.863326 [debug] [MainThread]: On master: COMMIT
[0m10:51:26.863326 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:51:26.863326 [debug] [MainThread]: On master: Close
[0m10:51:26.863326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:26.863326 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:51:26.863326 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:51:26.863326 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:51:26.863326 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:51:26.863326 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:51:26.863326 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m10:51:26.863326 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:51:26.863326 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:51:26.863326 [info ] [MainThread]: 
[0m10:51:26.863326 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m10:51:26.863326 [debug] [MainThread]: Command end result
[0m10:51:26.879149 [info ] [MainThread]: 
[0m10:51:26.879149 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:51:26.879149 [info ] [MainThread]: 
[0m10:51:26.879149 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m10:51:26.879149 [debug] [MainThread]: Command `dbt run` succeeded at 10:51:26.879149 after 2.02 seconds
[0m10:51:26.879149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E8941AC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E82DAF910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021E82DAC610>]}
[0m10:51:26.879149 [debug] [MainThread]: Flushing usage events
[0m10:53:10.374264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B18BD850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B14D2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B18BD8D0>]}


============================== 10:53:10.374264 | bf73b456-8737-48db-b93a-8408ac74835d ==============================
[0m10:53:10.374264 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:53:10.374264 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:53:10.507544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B18BE710>]}
[0m10:53:10.551011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1986790>]}
[0m10:53:10.551011 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:53:10.566868 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:53:10.642241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:10.643350 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:53:10.751348 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:53:10.761763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1DF6AD0>]}
[0m10:53:10.780132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1ECD410>]}
[0m10:53:10.780652 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:53:10.781705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1E44310>]}
[0m10:53:10.783843 [info ] [MainThread]: 
[0m10:53:10.784907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:53:10.786481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:53:10.796329 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:53:10.797381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:53:10.797906 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:53:10.800544 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:53:10.801072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:10.801640 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:53:10.802170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:10.815932 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:53:10.815932 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:53:10.835669 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:53:10.835669 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:53:10.842656 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:53:10.843814 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:53:10.843814 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:53:10.843814 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:53:10.843814 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:53:10.843814 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:53:10.843814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:10.843814 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:10.859133 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:53:10.859133 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:53:10.859133 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:53:10.859133 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:53:10.859133 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:53:10.859133 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:53:10.859133 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:53:10.859133 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:53:10.859133 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:53:10.859133 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:53:10.874028 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:53:10.875154 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:53:10.879667 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:10.879667 [debug] [MainThread]: On master: BEGIN
[0m10:53:10.880674 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:10.907314 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:10.907314 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:10.907314 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:53:10.907314 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:10.907314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B19FAF50>]}
[0m10:53:10.907314 [debug] [MainThread]: On master: ROLLBACK
[0m10:53:10.907314 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:10.923009 [debug] [MainThread]: On master: BEGIN
[0m10:53:10.925744 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:10.926270 [debug] [MainThread]: On master: COMMIT
[0m10:53:10.926270 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:10.926794 [debug] [MainThread]: On master: COMMIT
[0m10:53:10.928522 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:53:10.929076 [debug] [MainThread]: On master: Close
[0m10:53:10.929595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:10.930745 [info ] [MainThread]: 
[0m10:53:10.936714 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:53:10.937281 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:53:10.938517 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:53:10.940031 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:53:10.939026 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:53:10.941040 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:53:10.943034 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:53:10.951045 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:53:10.952031 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:53:10.955033 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:10.955033 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:53:10.943034 => 10:53:10.955033
[0m10:53:10.956035 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:53:10.952031 => 10:53:10.956035
[0m10:53:10.956035 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:53:10.957034 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:53:10.975597 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:53:10.991461 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:10.992394 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:10.992394 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:53:10.992394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:10.992394 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:10.992394 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:53:10.992394 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:53:11.008728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.008728 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:11.008728 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:53:11.008728 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.008728 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:11.008728 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:53:11.035466 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:53:11.041820 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:11.041820 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:53:11.041820 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.047328 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:11.047328 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:53:11.047328 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.066410 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:53:11.066410 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:11.067406 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:53:11.088012 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.091728 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:53:11.095256 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:11.095256 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:53:11.120917 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.120917 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:53:10.975597 => 10:53:11.120917
[0m10:53:11.120917 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:53:11.120917 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B18BCF50>]}
[0m10:53:11.120917 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:53:11.120917 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:11.120917 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.18s]
[0m10:53:11.120917 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:53:11.120917 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:53:11.120917 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:53:11.120917 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:53:11.120917 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:53:11.120917 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.120917 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:53:11.140766 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:11.135435 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:53:11.141402 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:53:11.136444 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:53:11.141402 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:53:11.141402 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:53:11.141402 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:53:11.141402 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:53:11.141402 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:53:11.141402 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:53:11.141402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.141402 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:53:11.141402 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:53:11.158847 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:53:11.158847 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:53:11.141402 => 10:53:11.158847
[0m10:53:11.158847 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:53:11.158847 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:53:11.141402 => 10:53:11.158847
[0m10:53:11.158847 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:11.158847 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:53:11.158847 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:53:11.158847 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:53:11.158847 => 10:53:11.158847
[0m10:53:11.158847 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:53:11.158847 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:53:11.175056 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:53:11.175056 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:53:11.175056 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:11.175056 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:53:11.175056 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:11.175056 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:53:11.175056 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:11.175056 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:53:11.175056 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.190592 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:53:11.191666 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:53:11.191666 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:53:11.191666 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:53:11.191666 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:11.191666 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:11.191666 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:53:11.191666 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.207277 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:53:10.957034 => 10:53:11.207277
[0m10:53:11.208221 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:53:11.208221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1E9F350>]}
[0m10:53:11.208221 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.27s]
[0m10:53:11.208221 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.208221 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:53:11.208221 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.208221 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:11.208221 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:53:11.208221 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:11.208221 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:53:11.208221 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:53:11.208221 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:53:11.208221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:53:11.208221 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.224107 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:53:11.224908 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:11.224908 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:11.224908 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:53:11.224908 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:53:11.224908 => 10:53:11.224908
[0m10:53:11.224908 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:53:11.235420 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:53:11.235420 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:11.308824 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:53:11.308824 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:11.308824 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:53:11.308824 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:53:11.325224 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:11.325224 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:11.325224 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:11.325224 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:53:11.325224 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:53:11.325224 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.325224 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:53:11.335735 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:11.335735 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.335735 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.335735 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:11.335735 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:53:11.343614 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:11.347613 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:11.348617 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:53:11.349616 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:53:11.350614 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.353612 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:53:11.353612 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.354612 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.354612 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:11.356611 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:53:11.358611 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:53:11.358611 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:53:11.359611 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:11.359611 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:11.360611 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:53:11.360611 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:53:11.363992 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.366993 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:53:11.367992 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.367992 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.369994 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:11.372999 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:53:11.374034 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:53:11.374034 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.374034 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:53:11.374034 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:11.374034 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:11.374034 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:11.374034 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:53:11.374034 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:53:11.374034 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:53:11.374034 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.374034 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:53:11.158847 => 10:53:11.374034
[0m10:53:11.374034 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:53:11.374034 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1F5C410>]}
[0m10:53:11.374034 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.374034 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.374034 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.23s]
[0m10:53:11.389667 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:53:11.158847 => 10:53:11.389667
[0m10:53:11.389667 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:53:11.389667 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:53:11.175056 => 10:53:11.389667
[0m10:53:11.389667 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:53:11.389667 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:53:11.389667 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:11.389667 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:53:11.389667 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:53:11.389667 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:53:11.389667 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1EF5C10>]}
[0m10:53:11.407736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1EF4B10>]}
[0m10:53:11.407736 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:53:11.407736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.407736 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.25s]
[0m10:53:11.407736 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m10:53:11.407736 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.26s]
[0m10:53:11.407736 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:11.407736 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:53:11.407736 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:53:11.407736 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:53:11.407736 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:53:11.424420 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:53:11.426108 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:53:11.426108 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:53:11.429082 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:53:11.407736 => 10:53:11.429082
[0m10:53:11.430087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.428080 [info ] [Thread-4 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:53:11.431090 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:53:11.431090 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:53:11.432866 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:53:11.435939 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_allowed_amount)
[0m10:53:11.444952 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:53:11.446895 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m10:53:11.446895 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:11.446895 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:53:11.446895 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:11.446895 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:53:11.446895 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:53:11.446895 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:53:11.458560 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:53:11.461227 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:53:11.461227 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:11.461227 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:53:11.446895 => 10:53:11.461227
[0m10:53:11.461227 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:53:11.459565 => 10:53:11.461227
[0m10:53:11.461227 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:53:11.461227 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.461227 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:53:11.461227 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:53:11.476594 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:53:11.476594 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:53:11.476594 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:11.476594 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.476594 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:11.476594 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:53:11.476594 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:11.476594 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:11.476594 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:53:11.476594 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:53:11.491210 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:53:11.493217 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:11.494222 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:11.497212 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.499214 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:53:11.235420 => 10:53:11.499214
[0m10:53:11.499214 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:53:11.500214 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1CAD550>]}
[0m10:53:11.502218 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.29s]
[0m10:53:11.503218 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:53:11.504214 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:53:11.505212 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:53:11.506906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:53:11.507921 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:53:11.513749 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:11.514748 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:53:11.508924 => 10:53:11.514748
[0m10:53:11.515749 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:53:11.520752 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:11.522754 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:11.522754 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:53:11.523756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:11.524685 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.525186 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.526164 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:11.526741 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:11.527754 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:53:11.528751 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:53:11.543276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.544274 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:11.545274 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:53:11.547273 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:11.547868 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:11.547868 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:11.557320 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:11.557320 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:53:11.558341 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:53:11.560253 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.560253 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.563267 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:11.563267 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:11.563267 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:53:11.563267 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:53:11.563267 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.563267 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.563267 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:53:11.573934 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:53:11.574941 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:11.575941 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:11.576943 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:53:11.576943 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:53:11.578878 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:53:11.578878 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:11.578878 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:53:11.600174 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.602178 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:53:11.603177 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:11.603177 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.604174 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.604174 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:53:11.607176 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:53:11.610500 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:11.612750 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:11.614353 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:53:11.615421 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:53:11.625551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.625551 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.625551 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:53:11.625551 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:53:11.625551 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:53:11.476594 => 10:53:11.625551
[0m10:53:11.625551 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.636563 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:11.636563 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:11.636563 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:53:11.636563 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:53:11.461227 => 10:53:11.636563
[0m10:53:11.636563 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:53:11.636563 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:53:11.636563 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1EC3D10>]}
[0m10:53:11.636563 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:53:11.636563 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1E41D90>]}
[0m10:53:11.636563 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.636563 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.19s]
[0m10:53:11.652203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.636563 [info ] [Thread-4 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.20s]
[0m10:53:11.656080 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:11.658755 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:53:11.660444 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:53:11.660444 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:53:11.660444 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:53:11.660444 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:11.660444 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:53:11.660444 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:11.675138 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:53:11.675138 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.675138 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:11.675138 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:53:11.515749 => 10:53:11.675138
[0m10:53:11.675138 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:53:11.675138 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:53:11.675138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B19E4ED0>]}
[0m10:53:11.675138 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.17s]
[0m10:53:11.675138 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:53:11.675138 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.675138 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:53:11.690691 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:11.691595 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:53:11.691595 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:11.691595 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:53:11.435939 => 10:53:11.691595
[0m10:53:11.691595 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:53:11.691595 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B1FFBE10>]}
[0m10:53:11.691595 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.28s]
[0m10:53:11.691595 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:53:11.691595 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:53:11.691595 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:53:11.708338 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:53:11.708338 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:53:11.708338 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:53:11.708338 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:53:11.708338 => 10:53:11.708338
[0m10:53:11.708338 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:53:11.708338 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:53:11.708338 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:53:11.708338 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:53:11.708338 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:11.738965 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.739508 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:53:11.740035 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT
        fc.diagnosis_1_key,
        fc.diagnosis_2_key,
        fc.diagnosis_3_key,
        dd.diagnosis_key,
        dd.category_code,
        dd.diagnosis_code,
        dd.full_description,
        dd.category_title
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
    LEFT JOIN
        dim_diagnosis dd2 ON fc.diagnosis_2_key = dd2.diagnosis_key
    LEFT JOIN
        dim_diagnosis dd3 ON fc.diagnosis_3_key = dd3.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_title,
        COUNT(*) AS diagnosis_count,
    FROM (
        SELECT diagnosis_1_key AS diagnosis_key, category_title, allowed_amount, paid_amount
        FROM diagnosis_details
        UNION ALL
        SELECT diagnosis_2_key, category_title, allowed_amount, paid_amount
        FROM diagnosis_details
        UNION ALL
        SELECT diagnosis_3_key, category_title, allowed_amount, paid_amount
        FROM diagnosis_details
    ) AS combined_data
    GROUP BY
        diagnosis_key,
        category_title
    ORDER BY
        diagnosis_count DESC
)

SELECT * 
FROM analysis
  );
  
[0m10:53:11.742622 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 46:     FROM (
             ^

[0m10:53:11.743184 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m10:53:11.744294 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:53:11.708338 => 10:53:11.744294
[0m10:53:11.744294 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:53:11.744294 [debug] [Thread-2 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "FROM"
  LINE 46:     FROM (
               ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:53:11.744294 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf73b456-8737-48db-b93a-8408ac74835d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B20101D0>]}
[0m10:53:11.744294 [error] [Thread-2 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.04s]
[0m10:53:11.744294 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:53:11.744294 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:11.744294 [debug] [MainThread]: On master: BEGIN
[0m10:53:11.744294 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:53:11.774929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:11.774929 [debug] [MainThread]: On master: COMMIT
[0m10:53:11.774929 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:11.774929 [debug] [MainThread]: On master: COMMIT
[0m10:53:11.774929 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:53:11.774929 [debug] [MainThread]: On master: Close
[0m10:53:11.774929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:11.774929 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:53:11.774929 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:53:11.774929 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:53:11.774929 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:53:11.790738 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:53:11.791455 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:53:11.791455 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m10:53:11.791455 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:53:11.791455 [info ] [MainThread]: 
[0m10:53:11.791455 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m10:53:11.791455 [debug] [MainThread]: Command end result
[0m10:53:11.791455 [info ] [MainThread]: 
[0m10:53:11.791455 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:53:11.807081 [info ] [MainThread]: 
[0m10:53:11.808065 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "FROM"
  LINE 46:     FROM (
               ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:53:11.808065 [info ] [MainThread]: 
[0m10:53:11.808065 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m10:53:11.808065 [debug] [MainThread]: Command `dbt run` failed at 10:53:11.808065 after 1.47 seconds
[0m10:53:11.808065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B15B4E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2AF216A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2AF2162D0>]}
[0m10:53:11.808065 [debug] [MainThread]: Flushing usage events
[0m10:53:50.957948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D0D432D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D0CC7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D10E2C90>]}


============================== 10:53:50.957948 | 814e19a6-b8c7-4205-a8f3-e9e2ee570cab ==============================
[0m10:53:50.957948 [info ] [MainThread]: Running with dbt=1.7.10
[0m10:53:50.957948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:53:51.089646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D12A2510>]}
[0m10:53:51.142788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D1226E90>]}
[0m10:53:51.142788 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m10:53:51.142788 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m10:53:51.212654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:51.213649 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m10:53:51.288572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m10:53:51.288572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D1149ED0>]}
[0m10:53:51.304200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D17397D0>]}
[0m10:53:51.304200 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m10:53:51.310839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D1542310>]}
[0m10:53:51.310839 [info ] [MainThread]: 
[0m10:53:51.310839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:53:51.310839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:53:51.310839 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m10:53:51.310839 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:53:51.323386 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m10:53:51.324086 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:53:51.324086 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m10:53:51.325134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:51.326077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:51.343987 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:53:51.343987 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:53:51.343987 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:53:51.343987 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m10:53:51.343987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m10:53:51.343987 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:53:51.343987 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m10:53:51.343987 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m10:53:51.357312 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:53:51.358330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:51.358330 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m10:53:51.359310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:51.360143 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.373035 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.374034 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m10:53:51.375035 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m10:53:51.375352 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m10:53:51.375352 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m10:53:51.375352 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:53:51.375352 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:53:51.375352 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m10:53:51.375352 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m10:53:51.375352 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m10:53:51.375352 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m10:53:51.390698 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:51.391386 [debug] [MainThread]: On master: BEGIN
[0m10:53:51.391386 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:53:51.414720 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.415688 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:51.415688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:53:51.419738 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:53:51.420773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D1719C50>]}
[0m10:53:51.420773 [debug] [MainThread]: On master: ROLLBACK
[0m10:53:51.421742 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:51.421742 [debug] [MainThread]: On master: BEGIN
[0m10:53:51.423513 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.424550 [debug] [MainThread]: On master: COMMIT
[0m10:53:51.424550 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:51.424550 [debug] [MainThread]: On master: COMMIT
[0m10:53:51.425613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.426612 [debug] [MainThread]: On master: Close
[0m10:53:51.426612 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:53:51.427599 [info ] [MainThread]: 
[0m10:53:51.431540 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m10:53:51.432514 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m10:53:51.432514 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m10:53:51.434473 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m10:53:51.433514 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m10:53:51.434630 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m10:53:51.435631 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m10:53:51.442007 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m10:53:51.442651 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m10:53:51.442739 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:51.442739 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 10:53:51.435631 => 10:53:51.442739
[0m10:53:51.442739 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m10:53:51.457632 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 10:53:51.442739 => 10:53:51.457632
[0m10:53:51.461030 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m10:53:51.461030 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m10:53:51.473166 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:51.476280 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:51.477901 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m10:53:51.477901 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:51.477901 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:51.477901 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m10:53:51.477901 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:53:51.491798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.491798 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.491798 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:51.491798 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:51.491798 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m10:53:51.491798 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m10:53:51.510863 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:53:51.510863 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:51.510863 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m10:53:51.510863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.523148 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:51.523148 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m10:53:51.525194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.538239 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:53:51.539186 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:51.539186 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m10:53:51.557426 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.557426 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m10:53:51.557426 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m10:53:51.557426 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m10:53:51.582305 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:51.582305 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 10:53:51.473166 => 10:53:51.582305
[0m10:53:51.582305 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m10:53:51.582305 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D1509C90>]}
[0m10:53:51.582305 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.15s]
[0m10:53:51.582305 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m10:53:51.582305 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m10:53:51.597954 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m10:53:51.582305 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m10:53:51.597954 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:53:51.597954 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m10:53:51.597954 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:51.597954 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m10:53:51.597954 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m10:53:51.597954 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m10:53:51.597954 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m10:53:51.604670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m10:53:51.605430 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m10:53:51.605430 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m10:53:51.606429 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m10:53:51.611281 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m10:53:51.611806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.612315 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m10:53:51.614425 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m10:53:51.617092 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:51.619243 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m10:53:51.619243 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 10:53:51.607500 => 10:53:51.619243
[0m10:53:51.619749 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m10:53:51.619749 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 10:53:51.612341 => 10:53:51.619749
[0m10:53:51.619749 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m10:53:51.619749 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 10:53:51.617092 => 10:53:51.619749
[0m10:53:51.619749 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m10:53:51.624070 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m10:53:51.624070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.624070 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m10:53:51.624070 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m10:53:51.624070 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:51.624070 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:53:51.624070 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m10:53:51.624070 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:51.624070 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m10:53:51.624070 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:51.624070 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:51.624070 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m10:53:51.624070 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:53:51.639780 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m10:53:51.640910 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m10:53:51.640910 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:51.640910 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:53:51.657381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.657381 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m10:53:51.657381 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m10:53:51.657381 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.657381 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.657381 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m10:53:51.657381 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:51.657381 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:51.657381 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m10:53:51.657381 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m10:53:51.657381 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.657381 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:51.657381 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:51.657381 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m10:53:51.657381 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 10:53:51.442739 => 10:53:51.657381
[0m10:53:51.673133 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m10:53:51.673929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D168F750>]}
[0m10:53:51.673929 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.24s]
[0m10:53:51.673929 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m10:53:51.673929 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:53:51.673929 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:53:51.673929 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m10:53:51.673929 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:51.673929 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:53:51.673929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m10:53:51.673929 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m10:53:51.689759 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m10:53:51.689759 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:51.690820 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m10:53:51.742388 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.742388 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:51.742388 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m10:53:51.742388 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:51.742388 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:51.742388 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m10:53:51.742388 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m10:53:51.742388 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 10:53:51.742388 => 10:53:51.742388
[0m10:53:51.742388 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.742388 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m10:53:51.742388 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.742388 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.761167 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:51.764582 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:51.766207 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:53:51.768947 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:51.769482 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m10:53:51.770004 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:51.770523 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:51.771029 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m10:53:51.771029 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m10:53:51.771029 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m10:53:51.773060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:51.773338 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.774343 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.776339 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:53:51.777340 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.779341 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:53:51.779341 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:51.783339 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m10:53:51.784342 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:51.784342 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m10:53:51.785341 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m10:53:51.786341 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m10:53:51.786341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.787341 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m10:53:51.788339 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:51.788339 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m10:53:51.790190 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.793223 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m10:53:51.793223 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.794189 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:51.794189 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m10:53:51.797207 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m10:53:51.798188 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 10:53:51.624070 => 10:53:51.798188
[0m10:53:51.799200 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m10:53:51.799200 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m10:53:51.800192 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m10:53:51.800192 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m10:53:51.804223 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:51.805210 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m10:53:51.806310 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D1784090>]}
[0m10:53:51.806310 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m10:53:51.806310 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.20s]
[0m10:53:51.806310 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m10:53:51.806310 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m10:53:51.810819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.810819 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:51.810819 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m10:53:51.810819 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:51.810819 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:51.810819 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 10:53:51.624070 => 10:53:51.810819
[0m10:53:51.810819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m10:53:51.810819 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m10:53:51.810819 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 10:53:51.619749 => 10:53:51.810819
[0m10:53:51.810819 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m10:53:51.810819 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m10:53:51.810819 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m10:53:51.810819 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D17A6810>]}
[0m10:53:51.810819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.810819 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m10:53:51.810819 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D17AF0D0>]}
[0m10:53:51.828682 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:53:51.826459 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.21s]
[0m10:53:51.831305 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 10:53:51.810819 => 10:53:51.830526
[0m10:53:51.830526 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.21s]
[0m10:53:51.831706 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:51.831706 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m10:53:51.831706 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m10:53:51.831706 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m10:53:51.831706 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m10:53:51.831706 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m10:53:51.840659 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m10:53:51.841649 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m10:53:51.843121 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m10:53:51.843121 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m10:53:51.843121 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m10:53:51.843121 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:51.843121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.843121 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m10:53:51.843121 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m10:53:51.843121 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m10:53:51.843121 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m10:53:51.843121 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m10:53:51.843121 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m10:53:51.843121 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:51.843121 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m10:53:51.857010 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m10:53:51.858027 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 10:53:51.843121 => 10:53:51.857010
[0m10:53:51.859026 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m10:53:51.860026 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m10:53:51.861025 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 10:53:51.843121 => 10:53:51.860026
[0m10:53:51.861823 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m10:53:51.861823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:51.861823 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m10:53:51.861823 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 10:53:51.761717 => 10:53:51.861823
[0m10:53:51.861823 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:51.861823 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m10:53:51.861823 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m10:53:51.861823 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m10:53:51.872931 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:51.873931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D182B690>]}
[0m10:53:51.874928 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:51.875930 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m10:53:51.875930 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.20s]
[0m10:53:51.877879 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:51.878392 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m10:53:51.878392 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m10:53:51.878392 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m10:53:51.878392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m10:53:51.878392 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m10:53:51.878392 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:51.878392 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 10:53:51.878392 => 10:53:51.878392
[0m10:53:51.878392 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m10:53:51.890652 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:51.891656 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:51.891656 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m10:53:51.892654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:51.893840 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.893840 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.893840 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:51.893840 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:51.893840 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m10:53:51.893840 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:53:51.893840 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.893840 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:51.893840 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m10:53:51.906311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:51.907310 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:51.907310 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m10:53:51.908527 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:51.911037 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:51.911037 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m10:53:51.911037 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m10:53:51.911037 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:51.917382 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m10:53:51.917382 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m10:53:51.917382 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.917382 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.917382 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:51.925123 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:51.927133 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:51.928360 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m10:53:51.928360 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m10:53:51.928360 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m10:53:51.928360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.928360 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.928360 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.928360 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:51.928360 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:53:51.928360 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:53:51.928360 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m10:53:51.939907 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:51.940897 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:51.942899 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m10:53:51.942899 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m10:53:51.946668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:51.946668 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:53:51.946668 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:51.946668 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m10:53:51.958432 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.958432 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.958432 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m10:53:51.958432 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:51.974653 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m10:53:51.975264 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m10:53:51.977365 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m10:53:51.978516 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m10:53:51.979287 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m10:53:51.979287 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m10:53:51.980374 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m10:53:51.980374 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m10:53:52.001211 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:52.002215 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 10:53:51.861823 => 10:53:52.002215
[0m10:53:52.003215 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m10:53:52.003215 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m10:53:52.007268 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:52.007268 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:52.007268 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:52.007268 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D18BB710>]}
[0m10:53:52.007268 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m10:53:52.007268 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 10:53:51.861823 => 10:53:52.007268
[0m10:53:52.011272 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 10:53:51.878392 => 10:53:52.011272
[0m10:53:52.011272 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m10:53:52.011272 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.16s]
[0m10:53:52.011272 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m10:53:52.011272 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:52.011272 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D18A7410>]}
[0m10:53:52.011272 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m10:53:52.011272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D1490E90>]}
[0m10:53:52.011272 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:52.011272 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.17s]
[0m10:53:52.023123 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m10:53:52.011272 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.13s]
[0m10:53:52.024108 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m10:53:52.025116 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m10:53:52.026507 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:53:52.026507 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:53:52.026507 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:52.026507 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m10:53:52.026507 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m10:53:52.026507 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m10:53:52.026507 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m10:53:52.026507 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m10:53:52.041694 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m10:53:52.041694 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 10:53:51.831706 => 10:53:52.041694
[0m10:53:52.041694 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m10:53:52.041694 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D179F790>]}
[0m10:53:52.041694 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.23s]
[0m10:53:52.041694 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m10:53:52.041694 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m10:53:52.041694 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m10:53:52.041694 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m10:53:52.041694 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m10:53:52.041694 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m10:53:52.041694 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 10:53:52.041694 => 10:53:52.041694
[0m10:53:52.041694 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m10:53:52.041694 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m10:53:52.056359 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:53:52.056359 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m10:53:52.056359 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:52.077233 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m10:53:52.077233 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m10:53:52.077233 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
diagnosis_details AS (
    SELECT
        fc.diagnosis_1_key,
        fc.diagnosis_2_key,
        fc.diagnosis_3_key,
        dd.diagnosis_key,
        dd.category_code,
        dd.diagnosis_code,
        dd.full_description,
        dd.category_title
    FROM
        fact_claims fc
    LEFT JOIN
        dim_diagnosis dd ON fc.diagnosis_1_key = dd.diagnosis_key
    LEFT JOIN
        dim_diagnosis dd2 ON fc.diagnosis_2_key = dd2.diagnosis_key
    LEFT JOIN
        dim_diagnosis dd3 ON fc.diagnosis_3_key = dd3.diagnosis_key
),
analysis AS (
    SELECT
        diagnosis_key,
        category_title,
        COUNT(*) AS diagnosis_count,
    FROM (
        SELECT diagnosis_1_key AS diagnosis_key, category_title
        FROM diagnosis_details
        UNION ALL
        SELECT diagnosis_2_key, category_title
        FROM diagnosis_details
        UNION ALL
        SELECT diagnosis_3_key, category_title
        FROM diagnosis_details
    ) AS combined_data
    GROUP BY
        diagnosis_key,
        category_title
    ORDER BY
        diagnosis_count DESC
)

SELECT * 
FROM analysis
  );
  
[0m10:53:52.089634 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 46:     FROM (
             ^

[0m10:53:52.090642 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m10:53:52.092633 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 10:53:52.041694 => 10:53:52.091634
[0m10:53:52.092735 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m10:53:52.093808 [debug] [Thread-4 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "FROM"
  LINE 46:     FROM (
               ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:53:52.093808 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '814e19a6-b8c7-4205-a8f3-e9e2ee570cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D169FE50>]}
[0m10:53:52.093808 [error] [Thread-4 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.05s]
[0m10:53:52.093808 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m10:53:52.093808 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:52.093808 [debug] [MainThread]: On master: BEGIN
[0m10:53:52.093808 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:53:52.111139 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:53:52.111139 [debug] [MainThread]: On master: COMMIT
[0m10:53:52.111139 [debug] [MainThread]: Using postgres connection "master"
[0m10:53:52.111139 [debug] [MainThread]: On master: COMMIT
[0m10:53:52.111139 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:53:52.111139 [debug] [MainThread]: On master: Close
[0m10:53:52.111139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:52.111139 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:53:52.111139 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m10:53:52.111139 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m10:53:52.111139 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m10:53:52.111139 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m10:53:52.111139 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m10:53:52.111139 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m10:53:52.111139 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m10:53:52.122952 [info ] [MainThread]: 
[0m10:53:52.123953 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m10:53:52.125952 [debug] [MainThread]: Command end result
[0m10:53:52.127099 [info ] [MainThread]: 
[0m10:53:52.127099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:53:52.127099 [info ] [MainThread]: 
[0m10:53:52.127099 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "FROM"
  LINE 46:     FROM (
               ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m10:53:52.127099 [info ] [MainThread]: 
[0m10:53:52.139615 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m10:53:52.141622 [debug] [MainThread]: Command `dbt run` failed at 10:53:52.140620 after 1.21 seconds
[0m10:53:52.141622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212D10ECCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CA6FC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212CA6FC4D0>]}
[0m10:53:52.141622 [debug] [MainThread]: Flushing usage events
[0m11:06:02.311917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E6AD32D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E6E7CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E6E72F10>]}


============================== 11:06:02.311917 | 266704c8-01c7-4c36-ac2d-5a1672e90f67 ==============================
[0m11:06:02.311917 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:06:02.311917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:06:02.436519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E6EBE710>]}
[0m11:06:02.480037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E6FB6050>]}
[0m11:06:02.495706 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:06:02.496935 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:06:02.555899 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:06:02.556982 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:06:02.631667 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:06:02.631667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E71EED90>]}
[0m11:06:02.657574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E74D5C90>]}
[0m11:06:02.657574 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:06:02.657574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E72D1BD0>]}
[0m11:06:02.657574 [info ] [MainThread]: 
[0m11:06:02.657574 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:06:02.657574 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:06:02.657574 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:06:02.657574 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:06:02.672148 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:02.673211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:06:02.677194 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:06:02.678196 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:06:02.678196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:02.693842 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:06:02.695840 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:06:02.696843 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:06:02.698842 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:06:02.700873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:06:02.705667 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:06:02.706747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:06:02.706747 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:06:02.708526 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:06:02.708526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:02.708526 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:06:02.708526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:02.723737 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:06:02.723737 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:06:02.723737 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:06:02.723737 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:06:02.723737 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:06:02.723737 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:06:02.738786 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:06:02.739887 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:06:02.740893 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:06:02.741817 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:06:02.742830 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:06:02.742830 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:06:02.749805 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:02.750801 [debug] [MainThread]: On master: BEGIN
[0m11:06:02.750801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:06:02.772835 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:06:02.772835 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:02.772835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:06:02.772835 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:06:02.772835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E713E190>]}
[0m11:06:02.772835 [debug] [MainThread]: On master: ROLLBACK
[0m11:06:02.772835 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:02.772835 [debug] [MainThread]: On master: BEGIN
[0m11:06:02.772835 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:06:02.788607 [debug] [MainThread]: On master: COMMIT
[0m11:06:02.788607 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:02.788607 [debug] [MainThread]: On master: COMMIT
[0m11:06:02.788607 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:06:02.788607 [debug] [MainThread]: On master: Close
[0m11:06:02.788607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:06:02.788607 [info ] [MainThread]: 
[0m11:06:02.788607 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:06:02.788607 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:06:02.788607 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:06:02.788607 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:06:02.788607 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:06:02.788607 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:06:02.788607 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:06:02.788607 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:06:02.788607 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:06:02.788607 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:06:02.788607 => 11:06:02.788607
[0m11:06:02.806405 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:06:02.806613 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:06:02.822082 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:06:02.788607 => 11:06:02.822082
[0m11:06:02.824149 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:06:02.824149 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:06:02.824149 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:06:02.842775 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:06:02.843510 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:06:02.843510 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:06:02.843510 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:06:02.843510 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:06:02.843510 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:06:02.856886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:02.856886 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:06:02.856886 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:06:02.856886 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:02.856886 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:06:02.856886 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:06:02.875004 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:06:02.879021 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:06:02.880003 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:06:02.882003 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:02.884021 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:06:02.884021 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:06:02.886006 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:02.899163 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:06:02.900289 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:06:02.900289 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:06:02.922109 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:02.937675 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:06:02.937675 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:06:02.937675 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:06:02.966595 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:02.966595 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:06:02.824149 => 11:06:02.966595
[0m11:06:02.966595 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:06:02.966595 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E7534890>]}
[0m11:06:02.966595 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:06:02.966595 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.18s]
[0m11:06:02.966595 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:06:02.966595 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:06:02.966595 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:06:02.966595 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:06:02.966595 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:06:02.966595 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:06:02.966595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:02.966595 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:06:02.982266 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:06:02.985239 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:06:02.983117 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:06:02.986505 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:06:02.986505 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:06:02.990768 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:06:02.991662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:06:02.992172 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:06:02.992172 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:06:02.992172 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:06:02.992172 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:06:02.992172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:02.992172 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:06:02.992172 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:06:02.992172 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:06:02.992172 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:06:02.992172 => 11:06:02.992172
[0m11:06:02.992172 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:06:02.992172 => 11:06:02.992172
[0m11:06:02.992172 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:06:02.992172 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:06:02.992172 => 11:06:02.992172
[0m11:06:02.992172 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:06:03.005406 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:06:03.005406 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:06:03.006493 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:06:03.011564 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:06:03.011564 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:06:03.023172 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:06:03.024117 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:06:03.024999 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:06:03.024999 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:06:03.024999 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:06:03.024999 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:06:03.024999 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:06:03.024999 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:06:03.024999 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:06:03.024999 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:03.024999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.024999 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:06:03.024999 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:06:03.024999 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:06:03.040957 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.040957 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:06:03.049471 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:06:03.049471 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:03.049471 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:06:02.807664 => 11:06:03.049471
[0m11:06:03.049471 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:06:03.049471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E70BFED0>]}
[0m11:06:03.055661 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.055661 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.049471 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.26s]
[0m11:06:03.056674 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:06:03.056674 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:06:03.057663 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:06:03.057663 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:06:03.058661 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:06:03.058661 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:06:03.059659 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:06:03.061681 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:06:03.063662 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:06:03.062699 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:06:03.064664 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:06:03.065661 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.065661 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:06:03.074569 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:06:03.075566 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:06:03.124663 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:06:03.124663 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:06:03.124663 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:06:03.138739 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:06:03.145800 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:06:03.147736 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:06:03.076565 => 11:06:03.147736
[0m11:06:03.149744 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:06:03.150745 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:06:03.151743 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.152740 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:06:03.157738 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:06:03.158738 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.158738 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.166745 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:06:03.167734 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:06:03.169733 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:06:03.172256 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:06:03.173015 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:06:03.173015 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:06:03.173015 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:06:03.174018 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:06:03.175016 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:06:03.175016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:03.176017 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.176017 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.179019 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:06:03.180025 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.184034 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:06:03.185020 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:06:03.188039 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:06:03.188887 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:06:03.188887 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:06:03.189887 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:06:03.190891 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:06:03.190891 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:06:03.194909 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.197891 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:06:03.198889 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.198889 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:03.199888 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:06:03.202909 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:06:03.202909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.204494 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:06:03.011564 => 11:06:03.204494
[0m11:06:03.205382 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:06:03.205382 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:06:03.205382 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:06:03.205382 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:06:03.205382 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:06:03.205382 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:06:03.205382 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E7476D90>]}
[0m11:06:03.205382 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.22s]
[0m11:06:03.205382 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:06:03.205382 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:03.205382 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:06:03.205382 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:03.205382 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:06:03.011564 => 11:06:03.205382
[0m11:06:03.205382 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:06:03.007410 => 11:06:03.205382
[0m11:06:03.205382 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:06:03.205382 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:06:03.205382 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:06:03.205382 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:06:03.205382 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m11:06:03.205382 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E753FAD0>]}
[0m11:06:03.205382 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E753E650>]}
[0m11:06:03.224358 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:06:03.225361 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:06:03.226089 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.21s]
[0m11:06:03.227213 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:06:03.226214 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.22s]
[0m11:06:03.228001 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:06:03.228001 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:06:03.228001 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:06:03.228001 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:06:03.228001 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:06:03.227680 => 11:06:03.228001
[0m11:06:03.228001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.228001 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:06:03.228001 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:06:03.228001 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:06:03.241666 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:06:03.244021 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:06:03.241666 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:06:03.250031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m11:06:03.250031 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:06:03.250031 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:06:03.250031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m11:06:03.250031 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:06:03.250031 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:06:03.250031 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:06:03.255409 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:06:03.256427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.257409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:06:03.259409 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:06:03.261199 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:06:03.261199 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:06:03.250031 => 11:06:03.261199
[0m11:06:03.261199 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:06:03.261199 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:06:03.257409 => 11:06:03.261199
[0m11:06:03.261199 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:06:03.261199 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:06:03.261199 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:06:03.272003 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:06:03.277064 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:06:03.279000 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:06:03.279000 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:06:03.280332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.280332 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.280332 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:06:03.280332 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:06:03.280332 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:06:03.280332 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:06:03.280332 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:06:03.287343 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:03.287343 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:06:03.287343 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:06:03.289732 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:06:03.291637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:03.291637 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:06:03.159736 => 11:06:03.291637
[0m11:06:03.291637 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:06:03.291637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E74410D0>]}
[0m11:06:03.291637 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.23s]
[0m11:06:03.291637 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:06:03.291637 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:06:03.291637 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:06:03.291637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:06:03.291637 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:06:03.308582 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:06:03.309702 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:06:03.291637 => 11:06:03.309702
[0m11:06:03.309702 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:06:03.309702 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:06:03.309702 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:06:03.309702 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:06:03.318223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:06:03.318223 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.318223 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:06:03.318223 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.322013 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:06:03.322013 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:06:03.323013 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:06:03.338185 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:06:03.339148 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:06:03.346423 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:06:03.346423 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:06:03.349931 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:06:03.349931 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:06:03.351457 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.351457 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.357361 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:06:03.358360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.361126 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:06:03.361126 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:06:03.361126 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:06:03.366831 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:06:03.366831 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:06:03.366831 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.366831 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:06:03.366831 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.372013 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:06:03.374014 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:06:03.375262 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:06:03.375262 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:06:03.375262 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:06:03.413800 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.413800 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.414807 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:06:03.417819 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:06:03.421803 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:06:03.424803 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:06:03.425839 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:06:03.426824 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:06:03.427800 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:06:03.427800 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:06:03.429803 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:06:03.430800 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:06:03.430800 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:06:03.431800 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:06:03.432801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.433803 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.437825 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:06:03.440835 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:06:03.441836 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:06:03.442835 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:06:03.446657 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.446812 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:06:03.448888 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:06:03.450813 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:06:03.450813 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:06:03.451814 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:06:03.451814 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:03.452815 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:06:03.452815 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:06:03.455366 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:06:03.261199 => 11:06:03.454409
[0m11:06:03.455822 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:03.456190 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:06:03.458191 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:06:03.273013 => 11:06:03.458191
[0m11:06:03.458191 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.460191 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E751D250>]}
[0m11:06:03.460191 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:06:03.465653 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:06:03.465653 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.466654 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.22s]
[0m11:06:03.467655 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E763F750>]}
[0m11:06:03.469656 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:06:03.472162 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:06:03.473913 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:06:03.475430 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:06:03.474426 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.22s]
[0m11:06:03.475430 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:06:03.476447 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:06:03.477432 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:06:03.493343 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:03.493343 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:06:03.493343 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:06:03.242664 => 11:06:03.493343
[0m11:06:03.493343 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:06:03.309702 => 11:06:03.493343
[0m11:06:03.493343 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:06:03.493343 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:06:03.493343 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E7182350>]}
[0m11:06:03.505489 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E721FD10>]}
[0m11:06:03.506488 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.29s]
[0m11:06:03.508488 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.21s]
[0m11:06:03.510491 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:06:03.511487 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:06:03.512486 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:06:03.513486 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:06:03.514162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:06:03.514162 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:06:03.514162 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:06:03.523035 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:06:03.514162 => 11:06:03.523035
[0m11:06:03.524014 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:06:03.527077 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:06:03.529016 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:06:03.530105 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:06:03.530369 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:06:03.562061 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.562061 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:06:03.562061 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
combined_data AS (
  SELECT
    f.diagnosis_1_key,
    f.diagnosis_2_key,
    f.diagnosis_3_key,
    d1.diagnosis_key AS diagnosis_1_analysis,
    d1.full_description AS diagnosis_1_description,
    d1.category_title AS diagnosis_1_category,
    d2.diagnosis_key AS diagnosis_2_analysis,
    d2.full_description AS diagnosis_2_description,
    d2.category_title AS diagnosis_2_category,
    d3.diagnosis_key AS diagnosis_3_analysis,
    d3.full_description AS diagnosis_3_description,
    d3.category_title AS diagnosis_3_category
  FROM
    fact_claims f
  LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
  LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
  LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

SELECT
  *,
  -- Count the number of claims with each diagnosis
  COUNT(*) AS total_claims,
  -- Check if all diagnoses are populated (useful for data quality checks)
  CASE WHEN diagnosis_1_analysis IS NULL OR diagnosis_2_analysis IS NULL OR diagnosis_3_analysis IS NULL THEN 'Not all diagnoses populated' ELSE 'All diagnoses populated' END AS diagnosis_completeness
FROM
  combined_data
  );
  
[0m11:06:03.591088 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "combined_data.diagnosis_1_key" must appear in the GROUP BY clause or be used in an aggregate function
LINE 44:   *,
           ^

[0m11:06:03.591088 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m11:06:03.591088 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:06:03.524014 => 11:06:03.591088
[0m11:06:03.591088 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:06:03.591088 [debug] [Thread-2 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "combined_data.diagnosis_1_key" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 44:   *,
             ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m11:06:03.591088 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '266704c8-01c7-4c36-ac2d-5a1672e90f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E762DF50>]}
[0m11:06:03.591088 [error] [Thread-2 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.08s]
[0m11:06:03.591088 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:06:03.605301 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:03.605301 [debug] [MainThread]: On master: BEGIN
[0m11:06:03.606410 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:06:03.639786 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:06:03.639786 [debug] [MainThread]: On master: COMMIT
[0m11:06:03.639786 [debug] [MainThread]: Using postgres connection "master"
[0m11:06:03.639786 [debug] [MainThread]: On master: COMMIT
[0m11:06:03.639786 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:06:03.639786 [debug] [MainThread]: On master: Close
[0m11:06:03.650837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:03.650837 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:06:03.650837 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:06:03.650837 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:06:03.650837 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:06:03.650837 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:06:03.650837 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:06:03.650837 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m11:06:03.650837 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:06:03.650837 [info ] [MainThread]: 
[0m11:06:03.650837 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m11:06:03.656590 [debug] [MainThread]: Command end result
[0m11:06:03.672228 [info ] [MainThread]: 
[0m11:06:03.675657 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:06:03.676708 [info ] [MainThread]: 
[0m11:06:03.677659 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "combined_data.diagnosis_1_key" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 44:   *,
             ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m11:06:03.679655 [info ] [MainThread]: 
[0m11:06:03.680650 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m11:06:03.682757 [debug] [MainThread]: Command `dbt run` failed at 11:06:03.682757 after 1.40 seconds
[0m11:06:03.682757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E4816990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E73E7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0E6FC8250>]}
[0m11:06:03.689708 [debug] [MainThread]: Flushing usage events
[0m11:07:13.706599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F6291EE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F61701790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F625331D0>]}


============================== 11:07:13.708700 | 4bd99948-c9b3-4515-86eb-b5f4a723a5a0 ==============================
[0m11:07:13.708700 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:07:13.709699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:07:13.834265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62A46890>]}
[0m11:07:13.887102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62AC27D0>]}
[0m11:07:13.888776 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:07:13.896774 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:07:13.965445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:07:13.966445 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:07:14.049184 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:07:14.049184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F628D3190>]}
[0m11:07:14.069899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62E8D590>]}
[0m11:07:14.069899 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:07:14.069899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62C0DA50>]}
[0m11:07:14.069899 [info ] [MainThread]: 
[0m11:07:14.069899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:07:14.069899 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:07:14.087768 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:07:14.087768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:07:14.087768 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:07:14.087768 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:07:14.087768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:14.087768 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:07:14.087768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:14.108835 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:07:14.108835 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:07:14.108835 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:07:14.120280 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:07:14.122019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:07:14.122019 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:07:14.122019 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:07:14.122019 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:07:14.122019 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:07:14.122019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:14.122019 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:07:14.122019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:14.146331 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.147330 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.147330 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:07:14.147330 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:07:14.148331 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:07:14.148331 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:07:14.151338 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:07:14.151338 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:07:14.152331 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:07:14.153932 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:07:14.155933 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:07:14.156932 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:07:14.163937 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:14.163937 [debug] [MainThread]: On master: BEGIN
[0m11:07:14.164937 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:14.188010 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.188010 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:14.188010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:07:14.188010 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:07:14.188010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62CCF650>]}
[0m11:07:14.188010 [debug] [MainThread]: On master: ROLLBACK
[0m11:07:14.188010 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:14.188010 [debug] [MainThread]: On master: BEGIN
[0m11:07:14.204513 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.204513 [debug] [MainThread]: On master: COMMIT
[0m11:07:14.204513 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:14.205551 [debug] [MainThread]: On master: COMMIT
[0m11:07:14.206554 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.206554 [debug] [MainThread]: On master: Close
[0m11:07:14.207521 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:14.207521 [info ] [MainThread]: 
[0m11:07:14.211362 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:07:14.212263 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:07:14.212263 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:07:14.213264 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:07:14.213264 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:07:14.214279 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:07:14.214279 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:07:14.219279 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:07:14.220268 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:07:14.220551 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:07:14.215265 => 11:07:14.220551
[0m11:07:14.223120 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:14.223120 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:07:14.253772 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:07:14.221257 => 11:07:14.253772
[0m11:07:14.256773 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:07:14.257422 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:07:14.263097 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:14.263691 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:14.264753 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:07:14.265285 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:14.265811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:14.265811 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:07:14.266385 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:07:14.272182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.272182 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.272182 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:14.272182 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:14.272182 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:07:14.272182 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:07:14.289911 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:07:14.294927 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:14.294927 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:07:14.296911 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.298931 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:14.299928 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:07:14.300911 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.314115 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:07:14.315231 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:14.315231 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:07:14.321299 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.321299 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:07:14.337057 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:14.337057 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:07:14.349754 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.349754 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:07:14.258504 => 11:07:14.349754
[0m11:07:14.349754 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:07:14.349754 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:07:14.349754 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:14.349754 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62FACB50>]}
[0m11:07:14.349754 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:07:14.349754 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.14s]
[0m11:07:14.349754 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:07:14.349754 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:07:14.349754 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:07:14.349754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.349754 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:07:14.349754 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:07:14.349754 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:14.349754 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:07:14.349754 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:07:14.349754 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:07:14.349754 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:07:14.365390 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:07:14.365390 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:07:14.366565 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:07:14.367606 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:07:14.371316 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:07:14.371316 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.371316 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:07:14.371316 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:07:14.371316 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:07:14.371316 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:07:14.371316 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:07:14.367632 => 11:07:14.371316
[0m11:07:14.371316 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:14.371316 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:07:14.371316 => 11:07:14.371316
[0m11:07:14.371316 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:07:14.371316 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:07:14.371316 => 11:07:14.371316
[0m11:07:14.371316 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:07:14.371316 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:07:14.387349 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:07:14.387811 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:07:14.392262 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:07:14.392262 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:07:14.392262 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:14.392262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.392262 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:14.392262 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:14.392262 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:07:14.392262 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:07:14.392262 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:07:14.392262 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:07:14.392262 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:07:14.392262 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:14.392262 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:14.392262 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:07:14.404103 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:07:14.405528 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.405528 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:07:14.223120 => 11:07:14.405528
[0m11:07:14.405528 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:07:14.405528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62F7D590>]}
[0m11:07:14.405528 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.19s]
[0m11:07:14.405528 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:07:14.405528 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:07:14.420832 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.420832 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.421860 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:07:14.422835 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:14.422835 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:14.423833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:07:14.423833 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.424834 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:07:14.424834 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:07:14.425833 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:07:14.425833 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:14.428832 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:14.429832 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:07:14.429832 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:07:14.426832 => 11:07:14.429832
[0m11:07:14.430832 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:07:14.434852 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:14.434852 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:07:14.489208 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:07:14.489208 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:14.489208 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:14.489208 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:07:14.489208 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:14.489208 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:07:14.489208 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:07:14.489208 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:14.489208 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:07:14.489208 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:07:14.489208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:14.489208 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.489208 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.508670 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:14.509646 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.512660 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:14.512660 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:07:14.515661 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:14.515661 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:07:14.516643 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:07:14.517645 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.518646 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.518646 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.520672 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:07:14.522673 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:07:14.524700 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:07:14.525675 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:14.525675 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:14.525675 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:14.526673 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:07:14.526673 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:07:14.527672 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:07:14.529673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.529673 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.530673 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:14.532693 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:07:14.532693 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.533672 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.533672 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:07:14.534672 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:14.536705 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:07:14.537765 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:07:14.537765 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:07:14.537765 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:14.537765 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:14.537765 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:07:14.537765 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:07:14.537765 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.537765 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:07:14.537765 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.537765 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:07:14.388596 => 11:07:14.537765
[0m11:07:14.537765 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:14.537765 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.550300 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:07:14.371316 => 11:07:14.550300
[0m11:07:14.550300 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:07:14.550300 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:07:14.550300 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:07:14.392262 => 11:07:14.550300
[0m11:07:14.550300 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:07:14.550300 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F629DBD10>]}
[0m11:07:14.550300 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:07:14.550300 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62F9FA10>]}
[0m11:07:14.550300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.550300 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62EC8310>]}
[0m11:07:14.550300 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.20s]
[0m11:07:14.550300 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:14.550300 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.20s]
[0m11:07:14.550300 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:07:14.550300 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.18s]
[0m11:07:14.550300 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:07:14.563459 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:07:14.564139 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:07:14.564139 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:07:14.565139 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:07:14.566902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.566902 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:07:14.566902 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m11:07:14.566902 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:07:14.572752 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:07:14.573730 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:07:14.573730 [info ] [Thread-4 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:07:14.574822 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:14.574822 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:07:14.574822 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:07:14.574822 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_allowed_amount)
[0m11:07:14.574822 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:07:14.574822 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m11:07:14.574822 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:07:14.574822 => 11:07:14.574822
[0m11:07:14.574822 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:07:14.574822 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:07:14.574822 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:07:14.574822 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:07:14.586995 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.589091 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:07:14.591258 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:07:14.591258 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:07:14.591258 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:07:14.574822 => 11:07:14.591258
[0m11:07:14.591258 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:07:14.586995 => 11:07:14.591258
[0m11:07:14.591258 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:14.591258 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:07:14.591258 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:14.591258 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:07:14.591258 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:07:14.605747 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:07:14.606807 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:07:14.608252 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:07:14.608252 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:14.608252 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:14.608252 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:07:14.608252 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:14.608252 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:14.608252 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:07:14.608252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:14.608252 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.608252 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:07:14.430832 => 11:07:14.608252
[0m11:07:14.620312 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:07:14.621314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62F41890>]}
[0m11:07:14.622311 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.20s]
[0m11:07:14.624314 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:07:14.625365 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:07:14.626331 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:07:14.626929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:07:14.626929 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:07:14.626929 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:14.626929 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:07:14.626929 => 11:07:14.626929
[0m11:07:14.626929 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:07:14.637071 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.637071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.639573 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:14.639573 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.639573 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:14.639573 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:14.639573 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:14.639573 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:14.639573 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:07:14.639573 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:07:14.639573 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:07:14.639573 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:07:14.639573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:14.650583 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:07:14.658598 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:14.658598 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:07:14.659460 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:07:14.665009 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:14.665009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.665009 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:07:14.665009 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:14.665009 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.670244 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:07:14.673261 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:14.674243 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.674243 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:07:14.676194 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:14.676194 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:07:14.676194 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.676194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.686961 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:07:14.687965 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:07:14.689458 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:07:14.692986 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:14.692986 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:14.692986 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:14.692986 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:07:14.692986 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:07:14.692986 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:07:14.703626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.711545 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:14.711545 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:07:14.711545 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.711545 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:07:14.711545 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:14.711545 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:07:14.711545 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.711545 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:07:14.711545 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:14.711545 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:07:14.720283 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.723296 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:07:14.724298 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.725297 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:14.725297 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.726298 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:07:14.591258 => 11:07:14.726298
[0m11:07:14.727297 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:07:14.729315 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:07:14.729315 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:07:14.731298 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:14.732296 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62AE6D50>]}
[0m11:07:14.733298 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:07:14.734296 [info ] [Thread-4 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.16s]
[0m11:07:14.735296 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:07:14.740959 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.743960 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:07:14.607317 => 11:07:14.742986
[0m11:07:14.743960 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:07:14.743960 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:07:14.746978 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:14.746978 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.747960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62C7CC90>]}
[0m11:07:14.747960 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:07:14.748960 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:07:14.637071 => 11:07:14.748960
[0m11:07:14.750959 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:07:14.749959 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.17s]
[0m11:07:14.751961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62D0A510>]}
[0m11:07:14.751961 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.753956 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:07:14.755697 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:14.753956 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.13s]
[0m11:07:14.755697 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:07:14.755697 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:07:14.755697 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:14.755697 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:07:14.755697 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:14.755697 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:07:14.772049 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.772049 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:07:14.772049 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:14.772049 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:07:14.772049 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:14.772049 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:07:14.590030 => 11:07:14.772049
[0m11:07:14.772049 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:07:14.772049 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62D44DD0>]}
[0m11:07:14.772049 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.21s]
[0m11:07:14.772049 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:07:14.788264 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:07:14.788264 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:07:14.788264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:07:14.788264 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:07:14.788264 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:07:14.788264 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:07:14.788264 => 11:07:14.788264
[0m11:07:14.788264 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:07:14.788264 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:07:14.788264 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:07:14.788264 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:07:14.788264 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:14.804975 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.804975 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:07:14.804975 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
combined_data AS (
  SELECT
    f.diagnosis_1_key,
    f.diagnosis_2_key,
    f.diagnosis_3_key,
    d1.diagnosis_key AS diagnosis_1_analysis,
    d1.full_description AS diagnosis_1_description,
    d1.category_title AS diagnosis_1_category,
    d2.diagnosis_key AS diagnosis_2_analysis,
    d2.full_description AS diagnosis_2_description,
    d2.category_title AS diagnosis_2_category,
    d3.diagnosis_key AS diagnosis_3_analysis,
    d3.full_description AS diagnosis_3_description,
    d3.category_title AS diagnosis_3_category
  FROM
    fact_claims f
  LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
  LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
  LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

SELECT
  *,
  -- Count the number of claims with each diagnosis
  COUNT(*) AS total_claims,
  -- Check if all diagnoses are populated (useful for data quality checks)
  CASE WHEN diagnosis_1_analysis IS NULL OR diagnosis_2_analysis IS NULL OR diagnosis_3_analysis IS NULL THEN 'Not all diagnoses populated' ELSE 'All diagnoses populated' END AS diagnosis_completeness
FROM
  combined_data
GROUP BY
  combined_data.diagnosis_1_key,
  combined_data.diagnosis_2_key,
  combined_data.diagnosis_3_key
  );
  
[0m11:07:14.821697 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "combined_data.diagnosis_1_analysis" must appear in the GROUP BY clause or be used in an aggregate function
LINE 44:   *,
           ^

[0m11:07:14.821697 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m11:07:14.821697 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:07:14.788264 => 11:07:14.821697
[0m11:07:14.821697 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:07:14.821697 [debug] [Thread-4 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "combined_data.diagnosis_1_analysis" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 44:   *,
             ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m11:07:14.821697 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bd99948-c9b3-4515-86eb-b5f4a723a5a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62DD0290>]}
[0m11:07:14.821697 [error] [Thread-4 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.03s]
[0m11:07:14.821697 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:07:14.821697 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:14.821697 [debug] [MainThread]: On master: BEGIN
[0m11:07:14.821697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:14.838087 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:07:14.838087 [debug] [MainThread]: On master: COMMIT
[0m11:07:14.851133 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:14.851133 [debug] [MainThread]: On master: COMMIT
[0m11:07:14.851133 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:07:14.851133 [debug] [MainThread]: On master: Close
[0m11:07:14.851133 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:14.851133 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:07:14.851133 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:07:14.851133 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:07:14.854551 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:07:14.854857 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:07:14.854857 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m11:07:14.854857 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:07:14.854857 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:07:14.854857 [info ] [MainThread]: 
[0m11:07:14.854857 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m11:07:14.854857 [debug] [MainThread]: Command end result
[0m11:07:14.870450 [info ] [MainThread]: 
[0m11:07:14.871919 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:07:14.871919 [info ] [MainThread]: 
[0m11:07:14.871919 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "combined_data.diagnosis_1_analysis" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 44:   *,
             ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m11:07:14.871919 [info ] [MainThread]: 
[0m11:07:14.871919 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m11:07:14.871919 [debug] [MainThread]: Command `dbt run` failed at 11:07:14.871919 after 1.21 seconds
[0m11:07:14.871919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F628C6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F6161CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F62B24D90>]}
[0m11:07:14.871919 [debug] [MainThread]: Flushing usage events
[0m11:07:52.600690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0652F52D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A06532F450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A06532CD50>]}


============================== 11:07:52.600690 | 06b73115-e0d1-4857-8a69-1d05f292c142 ==============================
[0m11:07:52.600690 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:07:52.600690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:07:52.735928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A065456990>]}
[0m11:07:52.790262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A065322410>]}
[0m11:07:52.790262 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:07:52.798375 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:07:52.864661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:07:52.865647 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:07:52.940339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:07:52.940339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A065626ED0>]}
[0m11:07:52.961596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A065939390>]}
[0m11:07:52.962596 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:07:52.963595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0655BFDD0>]}
[0m11:07:52.964595 [info ] [MainThread]: 
[0m11:07:52.965594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:07:52.967595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:07:52.967595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:07:52.973665 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:07:52.973665 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:07:52.973665 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:07:52.973665 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:07:52.973665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:52.973665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:53.004824 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:07:53.004824 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:07:53.005824 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:07:53.007703 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:07:53.007703 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:07:53.021691 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:07:53.021320 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:07:53.021691 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:07:53.021691 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:07:53.021691 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:07:53.021691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:53.021691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:53.040306 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.040306 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:07:53.040306 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:07:53.040306 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:07:53.040306 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:07:53.040306 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.040306 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:07:53.040306 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:07:53.040306 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:07:53.054695 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:07:53.055695 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:07:53.056696 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:07:53.061692 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:53.061692 [debug] [MainThread]: On master: BEGIN
[0m11:07:53.061692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:07:53.094671 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.094671 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:53.095671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:07:53.099671 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:07:53.100671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0652D6510>]}
[0m11:07:53.100671 [debug] [MainThread]: On master: ROLLBACK
[0m11:07:53.102024 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:53.102791 [debug] [MainThread]: On master: BEGIN
[0m11:07:53.104342 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.104342 [debug] [MainThread]: On master: COMMIT
[0m11:07:53.104342 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:53.104342 [debug] [MainThread]: On master: COMMIT
[0m11:07:53.105345 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.106343 [debug] [MainThread]: On master: Close
[0m11:07:53.106343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:07:53.107344 [info ] [MainThread]: 
[0m11:07:53.112344 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:07:53.112344 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:07:53.113346 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:07:53.115460 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:07:53.114354 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:07:53.115460 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:07:53.116460 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:07:53.120870 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:07:53.122636 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:07:53.123011 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:07:53.116460 => 11:07:53.123011
[0m11:07:53.123011 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:53.123011 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:07:53.123011 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:07:53.123011 => 11:07:53.123011
[0m11:07:53.155663 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:07:53.155663 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:07:53.155663 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:53.155663 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:53.155663 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:07:53.155663 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:07:53.155663 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:53.155663 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:07:53.155663 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:07:53.172940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.172940 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.172940 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:53.172940 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:53.172940 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:07:53.185936 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:07:53.193934 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:07:53.198938 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:53.198938 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:07:53.200935 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.202939 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:53.203939 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:07:53.205360 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.219439 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:07:53.220374 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:53.220868 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:07:53.230987 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.235986 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:07:53.239987 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:07:53.239987 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:07:53.256877 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.257880 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:07:53.155663 => 11:07:53.257880
[0m11:07:53.258879 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:07:53.258879 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:07:53.259876 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0659AC190>]}
[0m11:07:53.262896 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:53.263877 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:07:53.263877 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.14s]
[0m11:07:53.264878 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:07:53.265877 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:07:53.265877 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:07:53.265877 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:07:53.266877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.266877 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:07:53.266877 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:07:53.270645 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:53.267877 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:07:53.270645 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:07:53.271625 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:07:53.271625 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:07:53.272626 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:07:53.272626 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:07:53.273964 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:07:53.274492 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:07:53.277084 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:07:53.277084 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.279069 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:07:53.281087 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:07:53.283098 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:07:53.283098 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:07:53.275067 => 11:07:53.283098
[0m11:07:53.284069 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:07:53.277084 => 11:07:53.284069
[0m11:07:53.284069 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:53.285071 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:07:53.279069 => 11:07:53.285071
[0m11:07:53.285071 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:07:53.286241 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:07:53.286241 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:07:53.286853 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:07:53.289561 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:07:53.289561 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:07:53.289561 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:07:53.289561 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:53.289561 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:53.303228 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:53.303228 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:07:53.304228 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:07:53.304228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.305230 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:07:53.306230 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:07:53.306230 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:07:53.308637 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:07:53.308637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:53.308637 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:07:53.308637 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:07:53.308637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.321023 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:07:53.123011 => 11:07:53.321023
[0m11:07:53.322021 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:07:53.323269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A065966BD0>]}
[0m11:07:53.323269 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.21s]
[0m11:07:53.323269 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:07:53.323269 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:07:53.323269 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.323269 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:07:53.323269 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:53.323269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:07:53.323269 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:07:53.323269 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:07:53.339369 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:53.339369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.339369 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.340898 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:53.340898 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:53.340898 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:07:53.323269 => 11:07:53.340898
[0m11:07:53.340898 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:07:53.340898 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:07:53.340898 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:07:53.340898 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:07:53.340898 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:53.405450 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:07:53.405450 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:07:53.405450 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:53.414741 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:07:53.421775 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:53.427456 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:53.427977 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:53.428543 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:07:53.429081 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:07:53.429620 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:07:53.430134 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.431136 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:53.435150 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:53.435150 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.436444 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.437446 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:07:53.441444 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:53.443460 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:53.444443 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:07:53.444443 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:07:53.445446 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.445446 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.446443 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.447467 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:07:53.449443 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:07:53.451460 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:07:53.451460 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:53.451460 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:53.452445 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:53.453035 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:07:53.453391 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:07:53.453541 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:07:53.453541 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.453541 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:07:53.453541 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.453541 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.453541 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:07:53.453541 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:07:53.453541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.453541 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:07:53.453541 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:07:53.453541 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:07:53.453541 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:53.453541 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:07:53.453541 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:07:53.453541 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:07:53.469529 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:07:53.471534 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.472531 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:07:53.286853 => 11:07:53.472531
[0m11:07:53.472531 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.473532 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:07:53.473532 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.474530 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:07:53.289561 => 11:07:53.474530
[0m11:07:53.475531 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0655BDE90>]}
[0m11:07:53.476530 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:07:53.477533 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:07:53.289561 => 11:07:53.477533
[0m11:07:53.477533 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:07:53.480552 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:53.478530 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.20s]
[0m11:07:53.481547 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:07:53.482533 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A065A09A50>]}
[0m11:07:53.482533 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:07:53.483532 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:07:53.484530 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A06567B8D0>]}
[0m11:07:53.485531 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.21s]
[0m11:07:53.486539 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:07:53.486539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.488046 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:07:53.488046 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.21s]
[0m11:07:53.488046 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:53.488046 [info ] [Thread-4 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:07:53.488046 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:07:53.488046 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:07:53.488046 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.dim_diagnosis)
[0m11:07:53.488046 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:07:53.488046 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:07:53.488046 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:07:53.488046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.488046 [info ] [Thread-3 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:07:53.488046 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:07:53.488046 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:07:53.488046 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:07:53.488046 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_allowed_amount)
[0m11:07:53.488046 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m11:07:53.502699 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:53.503428 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:07:53.488046 => 11:07:53.502699
[0m11:07:53.503428 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:07:53.503428 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:07:53.504436 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:07:53.504436 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:07:53.506041 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:07:53.506041 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:07:53.506041 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:07:53.506041 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:07:53.506041 => 11:07:53.506041
[0m11:07:53.506041 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:07:53.505437 => 11:07:53.506041
[0m11:07:53.506041 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:07:53.519355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.519355 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:53.520359 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:07:53.524001 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:07:53.524604 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:07:53.524604 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:07:53.524604 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:07:53.524604 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:07:53.524604 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:53.524604 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:07:53.524604 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:53.524604 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:07:53.536024 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:07:53.537055 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:07:53.538030 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:53.539029 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:07:53.542204 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.542204 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:07:53.340898 => 11:07:53.542204
[0m11:07:53.542204 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:07:53.542204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0659D7E50>]}
[0m11:07:53.542204 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.22s]
[0m11:07:53.542204 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:07:53.542204 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:07:53.552629 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:07:53.554627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:07:53.554627 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:07:53.555351 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:53.555351 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:07:53.555351 => 11:07:53.555351
[0m11:07:53.555351 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:07:53.555351 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:53.555351 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.555351 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:53.555351 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:53.555351 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:07:53.555351 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.555351 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:07:53.569902 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:53.569902 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.570900 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:07:53.571674 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:07:53.571674 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:53.571674 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:07:53.571674 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:07:53.571674 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:53.571674 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:07:53.571674 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:07:53.571674 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.587310 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:53.592402 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:53.592402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.593718 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:07:53.593718 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:07:53.593718 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:53.593718 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:07:53.622323 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.623320 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.623931 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:07:53.623931 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:53.623931 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:07:53.623931 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:53.623931 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:07:53.623931 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:53.623931 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:07:53.635976 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:07:53.642064 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.642064 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.642064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.642064 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:07:53.642064 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:07:53.642064 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:53.657702 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:53.657702 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:07:53.657702 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:07:53.657702 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:07:53.660396 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:07:53.662398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.664400 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:07:53.665401 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:53.665401 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:07:53.669541 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.672544 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:07:53.673545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.673545 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.674543 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:07:53.674543 [debug] [Thread-4 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:07:53.676556 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:07:53.677546 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:07:53.520359 => 11:07:53.677546
[0m11:07:53.677546 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:07:53.679543 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:53.680543 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:07:53.680543 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:07:53.681544 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:07:53.681544 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:07:53.682545 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0655FF810>]}
[0m11:07:53.685545 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.684550 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.19s]
[0m11:07:53.686582 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:53.686582 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.686582 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.686582 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:07:53.686582 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:07:53.686582 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:07:53.524604 => 11:07:53.686582
[0m11:07:53.686582 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:07:53.555351 => 11:07:53.686582
[0m11:07:53.686582 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:07:53.686582 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:07:53.686582 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:07:53.686582 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A065442750>]}
[0m11:07:53.686582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0659C9050>]}
[0m11:07:53.686582 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:07:53.686582 [info ] [Thread-3 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.20s]
[0m11:07:53.686582 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:53.686582 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.13s]
[0m11:07:53.700949 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:07:53.700949 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:07:53.701623 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:07:53.704302 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.704302 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:07:53.704302 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:07:53.704302 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:07:53.704302 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:07:53.704302 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:07:53.506041 => 11:07:53.704302
[0m11:07:53.704302 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:07:53.704302 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A0654576D0>]}
[0m11:07:53.719414 [info ] [Thread-4 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.22s]
[0m11:07:53.721425 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:07:53.722209 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:07:53.722209 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:07:53.722209 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:07:53.722209 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:07:53.722209 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:07:53.722209 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:07:53.722209 => 11:07:53.722209
[0m11:07:53.722209 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:07:53.722209 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:07:53.722209 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:07:53.722209 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:07:53.722209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:07:53.742096 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.742096 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:07:53.742096 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
combined_data AS (
  SELECT
    f.diagnosis_1_key,
    f.diagnosis_2_key,
    f.diagnosis_3_key,
    d1.diagnosis_key AS diagnosis_1_analysis,
    d1.full_description AS diagnosis_1_description,
    d1.category_title AS diagnosis_1_category,
    d2.diagnosis_key AS diagnosis_2_analysis,
    d2.full_description AS diagnosis_2_description,
    d2.category_title AS diagnosis_2_category,
    d3.diagnosis_key AS diagnosis_3_analysis,
    d3.full_description AS diagnosis_3_description,
    d3.category_title AS diagnosis_3_category
  FROM
    fact_claims f
  LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
  LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
  LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

SELECT
  *,
  -- Count the number of claims with each diagnosis
  COUNT(*) AS total_claims,
  -- Check if all diagnoses are populated (useful for data quality checks)
  CASE WHEN diagnosis_1_analysis IS NULL OR diagnosis_2_analysis IS NULL OR diagnosis_3_analysis IS NULL THEN 'Not all diagnoses populated' ELSE 'All diagnoses populated' END AS diagnosis_completeness
FROM
  combined_data
GROUP BY
  combined_data.diagnosis_1_analysis,
  combined_data.diagnosis_2_analysis,
  combined_data.diagnosis_3_analysis
  );
  
[0m11:07:53.742096 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "combined_data.diagnosis_1_key" must appear in the GROUP BY clause or be used in an aggregate function
LINE 44:   *,
           ^

[0m11:07:53.753132 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m11:07:53.753924 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:07:53.722209 => 11:07:53.753924
[0m11:07:53.753924 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:07:53.753924 [debug] [Thread-2 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "combined_data.diagnosis_1_key" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 44:   *,
             ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m11:07:53.753924 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06b73115-e0d1-4857-8a69-1d05f292c142', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A065985E10>]}
[0m11:07:53.753924 [error] [Thread-2 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.03s]
[0m11:07:53.753924 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:07:53.753924 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:53.753924 [debug] [MainThread]: On master: BEGIN
[0m11:07:53.753924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:07:53.785874 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:07:53.787319 [debug] [MainThread]: On master: COMMIT
[0m11:07:53.787319 [debug] [MainThread]: Using postgres connection "master"
[0m11:07:53.787319 [debug] [MainThread]: On master: COMMIT
[0m11:07:53.787319 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:07:53.787319 [debug] [MainThread]: On master: Close
[0m11:07:53.787319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:53.787319 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:07:53.787319 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:07:53.787319 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:07:53.787319 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:07:53.787319 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:07:53.787319 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:07:53.787319 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:07:53.787319 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m11:07:53.787319 [info ] [MainThread]: 
[0m11:07:53.787319 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m11:07:53.787319 [debug] [MainThread]: Command end result
[0m11:07:53.803703 [info ] [MainThread]: 
[0m11:07:53.803703 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:07:53.803703 [info ] [MainThread]: 
[0m11:07:53.803703 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "combined_data.diagnosis_1_key" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 44:   *,
             ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m11:07:53.803703 [info ] [MainThread]: 
[0m11:07:53.803703 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m11:07:53.803703 [debug] [MainThread]: Command `dbt run` failed at 11:07:53.803703 after 1.24 seconds
[0m11:07:53.803703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A062C76810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A064F33150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A064D39850>]}
[0m11:07:53.803703 [debug] [MainThread]: Flushing usage events
[0m11:08:54.167702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EEA13290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EE8B5890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EEDBD3D0>]}


============================== 11:08:54.167702 | e162f15c-b985-4de4-b839-8ea915969d1f ==============================
[0m11:08:54.167702 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:08:54.167702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:08:54.300198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EEDB2FD0>]}
[0m11:08:54.349839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EEDEA850>]}
[0m11:08:54.349839 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:08:54.349839 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:08:54.419232 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:08:54.419232 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:08:54.504722 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:08:54.504722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF0C1F10>]}
[0m11:08:54.518857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF408750>]}
[0m11:08:54.518857 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:08:54.518857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF0BFF90>]}
[0m11:08:54.525102 [info ] [MainThread]: 
[0m11:08:54.526105 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:08:54.527382 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:08:54.537127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:08:54.537127 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:08:54.537127 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:08:54.537127 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:08:54.537127 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:08:54.537127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:54.537127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:54.568926 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:08:54.568926 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:08:54.570960 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:08:54.571874 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:08:54.572600 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:08:54.581213 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:08:54.581213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:08:54.584312 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:08:54.585640 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:08:54.586619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:54.586929 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:08:54.586929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:54.603372 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.603372 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.603372 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:08:54.603372 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:08:54.603372 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:08:54.603372 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:08:54.619941 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:08:54.619941 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:08:54.620915 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:08:54.622029 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:08:54.623948 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:08:54.623948 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:08:54.631001 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:54.631001 [debug] [MainThread]: On master: BEGIN
[0m11:08:54.632015 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:08:54.651326 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.651326 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:54.651326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:08:54.651326 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:08:54.651326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF08E110>]}
[0m11:08:54.651326 [debug] [MainThread]: On master: ROLLBACK
[0m11:08:54.651326 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:54.651326 [debug] [MainThread]: On master: BEGIN
[0m11:08:54.666983 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.666983 [debug] [MainThread]: On master: COMMIT
[0m11:08:54.666983 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:54.666983 [debug] [MainThread]: On master: COMMIT
[0m11:08:54.666983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:08:54.666983 [debug] [MainThread]: On master: Close
[0m11:08:54.666983 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:08:54.666983 [info ] [MainThread]: 
[0m11:08:54.666983 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:08:54.666983 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:08:54.666983 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:08:54.666983 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:08:54.666983 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:08:54.676993 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:08:54.677580 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:08:54.686535 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:08:54.687535 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:08:54.688204 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:08:54.677580 => 11:08:54.688204
[0m11:08:54.688204 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:08:54.688204 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:08:54.720712 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:08:54.720712 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:08:54.688204 => 11:08:54.720712
[0m11:08:54.720712 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:08:54.720712 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:08:54.720712 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:08:54.720712 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:08:54.720712 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:08:54.720712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:54.720712 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:08:54.720712 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:08:54.736769 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.736769 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.736769 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:08:54.736769 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:08:54.736769 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:08:54.736769 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:08:54.756206 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:08:54.761189 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:08:54.762195 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:08:54.764190 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:54.766210 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:08:54.766210 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:08:54.768548 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:54.783566 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:08:54.784664 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:08:54.784664 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:08:54.784664 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:54.800390 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:08:54.801960 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:08:54.801960 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:08:54.801960 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:08:54.801960 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:08:54.801960 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:08:54.801960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:54.801960 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:08:54.801960 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:08:54.817634 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:54.819178 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:08:54.819178 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:08:54.819178 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:08:54.819178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:54.819178 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:08:54.819178 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:54.819178 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:08:54.819178 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:08:54.720712 => 11:08:54.819178
[0m11:08:54.819178 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:08:54.819178 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:08:54.819178 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF48E1D0>]}
[0m11:08:54.819178 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.14s]
[0m11:08:54.819178 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:08:54.819178 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:08:54.819178 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:08:54.819178 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:08:54.819178 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:54.819178 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:08:54.819178 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:08:54.834817 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:08:54.688204 => 11:08:54.834817
[0m11:08:54.819178 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:08:54.834817 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:08:54.834817 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:08:54.834817 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:08:54.834817 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:08:54.834817 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:08:54.834817 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:08:54.834817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EEFB3BD0>]}
[0m11:08:54.834817 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:08:54.834817 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:08:54.834817 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:08:54.847191 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:08:54.834817 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.17s]
[0m11:08:54.848377 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:08:54.834817 => 11:08:54.848377
[0m11:08:54.849388 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:08:54.834817 => 11:08:54.849388
[0m11:08:54.850072 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:08:54.850072 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:08:54.834817 => 11:08:54.850072
[0m11:08:54.851355 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:08:54.851964 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:08:54.853196 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:08:54.853196 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:08:54.853196 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:08:54.853196 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:08:54.853196 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:08:54.853196 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:08:54.868343 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:08:54.872295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:08:54.873306 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:08:54.873306 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:08:54.874690 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:08:54.874870 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:08:54.874870 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:08:54.874870 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:08:54.874870 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:08:54.874870 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:08:54.874870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:08:54.874870 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:08:54.874870 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:08:54.874870 => 11:08:54.874870
[0m11:08:54.874870 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:08:54.893129 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:08:54.895100 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:08:54.895100 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:08:54.895100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:54.905363 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.905363 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:08:54.905363 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:08:54.905363 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.905363 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.905363 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:08:54.905363 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:08:54.905363 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:08:54.905363 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:08:54.920331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:54.923086 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:08:54.923826 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:08:54.925354 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:08:54.972892 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:08:54.973886 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:08:54.973886 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:08:54.975889 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:08:54.977947 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:08:54.979946 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:08:54.982953 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:08:54.982953 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:08:54.982953 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:08:54.983900 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:08:54.984592 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:08:54.984592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:54.984592 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:54.984592 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:54.984592 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:54.984592 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:08:54.984592 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:08:54.984592 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:08:54.984592 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:08:54.984592 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:08:54.984592 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:08:54.984592 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:08:54.984592 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:08:55.000282 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.000282 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.000282 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.001398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.003046 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:08:55.005047 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:08:55.007327 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:08:55.009344 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:08:55.009344 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:08:55.010326 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:08:55.010326 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:08:55.010326 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:08:55.011327 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:08:55.011327 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:08:55.011327 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:08:55.012326 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:08:55.014357 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:55.016358 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:08:55.017345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:55.017882 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:55.018283 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:55.018827 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:08:55.020410 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:08:55.024104 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:08:55.025106 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:08:55.026263 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:08:55.026263 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:08:55.027309 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:08:55.028056 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:08:55.028747 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:08:55.028747 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:08:55.029768 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:08:55.031765 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:55.032765 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:08:54.853196 => 11:08:55.032765
[0m11:08:55.033764 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:55.033764 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:08:55.034656 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:55.035311 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:55.036551 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:08:54.874870 => 11:08:55.035544
[0m11:08:55.036551 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF3E9610>]}
[0m11:08:55.038549 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:08:54.853196 => 11:08:55.038549
[0m11:08:55.039574 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:08:54.853196 => 11:08:55.039574
[0m11:08:55.039574 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:08:55.040550 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:08:55.040550 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.20s]
[0m11:08:55.041549 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:08:55.041549 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF394D90>]}
[0m11:08:55.042550 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF1D2B50>]}
[0m11:08:55.043552 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:08:55.044551 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4ED90DC10>]}
[0m11:08:55.045549 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.17s]
[0m11:08:55.047065 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:08:55.045549 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.21s]
[0m11:08:55.048065 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:08:55.047065 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.21s]
[0m11:08:55.049065 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:08:55.048065 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:08:55.049065 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:08:55.050069 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:08:55.050069 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:08:55.051266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m11:08:55.051820 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:08:55.051820 [info ] [Thread-1 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:08:55.052824 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:08:55.053828 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:08:55.055291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_allowed_amount)
[0m11:08:55.053828 [info ] [Thread-4 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:08:55.055291 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m11:08:55.055291 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:08:55.055291 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:08:55.055291 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount_by_day)
[0m11:08:55.055291 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:08:55.055291 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:08:55.055291 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:08:55.055291 => 11:08:55.055291
[0m11:08:55.055291 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:08:55.069824 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:08:55.070823 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:08:55.070823 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:08:55.055291 => 11:08:55.070823
[0m11:08:55.073021 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:08:55.073021 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:08:55.073021 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:08:55.055291 => 11:08:55.073021
[0m11:08:55.073021 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:08:55.073021 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:08:55.070823 => 11:08:55.073021
[0m11:08:55.073021 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:08:55.073021 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:08:55.088024 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:08:55.088024 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:08:55.089576 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:08:55.089576 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:08:55.089576 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:08:55.089576 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:08:55.089576 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:08:55.089576 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:08:55.101221 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:08:55.102249 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:08:55.103220 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:08:55.103969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:08:55.103969 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:08:55.103969 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:08:55.103969 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:08:55.119821 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:55.119821 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:55.119821 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:08:55.119821 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:08:55.134753 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:08:55.135767 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:55.135767 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:55.136756 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:08:55.136756 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:08:55.137757 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:08:55.138757 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:08:55.138757 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:08:55.145255 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:08:55.145255 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:08:55.146254 [debug] [Thread-4 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:08:55.148254 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:08:55.151261 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:08:55.152788 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:08:55.153786 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:08:55.153786 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:08:55.154788 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:08:55.156784 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.157789 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.157789 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.160790 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:08:55.162784 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:08:55.164783 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:08:55.165785 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:08:55.165785 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:08:55.166784 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:08:55.167902 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.167902 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.167902 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.167902 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:08:55.167902 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:08:55.167902 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:08:55.167902 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:08:55.167902 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:08:55.176916 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:08:55.176916 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:08:55.176916 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:08:55.176916 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:08:55.176916 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:55.176916 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:08:55.176916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:55.176916 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:08:55.192552 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:55.192552 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:08:55.192552 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:08:55.195767 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:08:55.195767 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:08:55.195767 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:08:55.195767 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:08:55.195767 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:08:55.195767 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:08:55.195767 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:08:55.195767 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:08:55.205788 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.205788 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:08:55.205788 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:55.205788 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:55.205788 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:55.205788 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:08:55.205788 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:08:55.089026 => 11:08:55.205788
[0m11:08:55.205788 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:08:55.073021 => 11:08:55.205788
[0m11:08:55.205788 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:08:55.089576 => 11:08:55.205788
[0m11:08:55.205788 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:08:55.205788 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:08:55.205788 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:08:55.205788 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:08:55.205788 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF48FB50>]}
[0m11:08:55.205788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF56A6D0>]}
[0m11:08:55.205788 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF4E52D0>]}
[0m11:08:55.219797 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:08:55.219797 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.15s]
[0m11:08:55.219797 [info ] [Thread-1 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.15s]
[0m11:08:55.219797 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:08:55.219797 [info ] [Thread-4 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.15s]
[0m11:08:55.219797 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:08:55.219797 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:08:55.219797 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:08:55.219797 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:08:55.219797 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:08:55.219797 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:08:55.219797 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:08:55.219797 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:08:55.219797 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:08:55.219797 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:08:55.073021 => 11:08:55.219797
[0m11:08:55.219797 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:08:55.219797 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4ED90DC10>]}
[0m11:08:55.235437 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.17s]
[0m11:08:55.236770 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:08:55.237691 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:08:55.238697 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:08:55.239696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:08:55.240019 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:08:55.240326 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:08:55.240326 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:08:55.240326 => 11:08:55.240326
[0m11:08:55.240326 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:08:55.240326 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:08:55.240326 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:08:55.240326 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:08:55.240326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:08:55.273031 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:08:55.273031 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:08:55.273031 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
combined_data AS (
  SELECT
    f.diagnosis_1_key,
    f.diagnosis_2_key,
    f.diagnosis_3_key,
    d1.diagnosis_key AS diagnosis_1_analysis,
    d1.full_description AS diagnosis_1_description,
    d1.category_title AS diagnosis_1_category,
    d2.diagnosis_key AS diagnosis_2_analysis,
    d2.full_description AS diagnosis_2_description,
    d2.category_title AS diagnosis_2_category,
    d3.diagnosis_key AS diagnosis_3_analysis,
    d3.full_description AS diagnosis_3_description,
    d3.category_title AS diagnosis_3_category
  FROM
    fact_claims f
  LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
  LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
  LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

SELECT
  *,
  -- Count the number of claims with each diagnosis
  COUNT(*) AS total_claims,
  -- Check if all diagnoses are populated (useful for data quality checks)
  CASE WHEN diagnosis_1_analysis IS NULL OR diagnosis_2_analysis IS NULL OR diagnosis_3_analysis IS NULL THEN 'Not all diagnoses populated' ELSE 'All diagnoses populated' END AS diagnosis_completeness
FROM
  combined_data
GROUP BY
  combined_data.diagnosis_1_key,
  combined_data.diagnosis_2_key,
  combined_data.diagnosis_3_key,
  combined_data.diagnosis_1_analysis,
  combined_data.diagnosis_2_analysis,
  combined_data.diagnosis_3_analysis
  );
  
[0m11:08:55.273031 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "combined_data.diagnosis_1_description" must appear in the GROUP BY clause or be used in an aggregate function
LINE 44:   *,
           ^

[0m11:08:55.284538 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m11:08:55.286565 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:08:55.240326 => 11:08:55.285538
[0m11:08:55.286565 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:08:55.289846 [debug] [Thread-2 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "combined_data.diagnosis_1_description" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 44:   *,
             ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m11:08:55.289846 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e162f15c-b985-4de4-b839-8ea915969d1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EF08CB90>]}
[0m11:08:55.289846 [error] [Thread-2 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.05s]
[0m11:08:55.289846 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:08:55.289846 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:55.289846 [debug] [MainThread]: On master: BEGIN
[0m11:08:55.289846 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:08:55.303985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:08:55.303985 [debug] [MainThread]: On master: COMMIT
[0m11:08:55.303985 [debug] [MainThread]: Using postgres connection "master"
[0m11:08:55.303985 [debug] [MainThread]: On master: COMMIT
[0m11:08:55.303985 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:08:55.317883 [debug] [MainThread]: On master: Close
[0m11:08:55.318890 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:55.318890 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:08:55.318890 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:08:55.319886 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:08:55.319886 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:08:55.319886 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m11:08:55.319886 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:08:55.320887 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:08:55.320887 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:08:55.321885 [info ] [MainThread]: 
[0m11:08:55.321885 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m11:08:55.323667 [debug] [MainThread]: Command end result
[0m11:08:55.336686 [info ] [MainThread]: 
[0m11:08:55.338552 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:08:55.338552 [info ] [MainThread]: 
[0m11:08:55.338552 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  column "combined_data.diagnosis_1_description" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 44:   *,
             ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m11:08:55.338552 [info ] [MainThread]: 
[0m11:08:55.338552 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m11:08:55.338552 [debug] [MainThread]: Command `dbt run` failed at 11:08:55.338552 after 1.21 seconds
[0m11:08:55.338552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EC7560D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EC756810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4EC756A90>]}
[0m11:08:55.338552 [debug] [MainThread]: Flushing usage events
[0m11:10:08.859766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2C4E1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2C0FF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2C4E110>]}


============================== 11:10:08.863767 | c71d6873-0e27-4657-9c45-eb5b3aa60b98 ==============================
[0m11:10:08.863767 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:10:08.864681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:10:08.994692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2DEA410>]}
[0m11:10:09.048474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2863150>]}
[0m11:10:09.049681 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:10:09.058935 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:10:09.116123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:10:09.117159 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:10:09.200307 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:10:09.205067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2D89050>]}
[0m11:10:09.215007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A3258F50>]}
[0m11:10:09.216263 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:10:09.217505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2EE3ED0>]}
[0m11:10:09.218603 [info ] [MainThread]: 
[0m11:10:09.219599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:10:09.221593 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:10:09.227593 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:10:09.228613 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:10:09.228613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:09.229550 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:10:09.230565 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:10:09.231505 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:10:09.231505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:09.268695 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:10:09.268695 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:10:09.268695 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:10:09.268695 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:10:09.268695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:10:09.268695 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:10:09.285181 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:10:09.285181 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:10:09.285181 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:10:09.285181 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:10:09.285181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:09.285181 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:09.305431 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.306395 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.306395 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:10:09.307425 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:10:09.307425 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:10:09.308414 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:10:09.311395 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:10:09.311395 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:10:09.312418 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:10:09.313410 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:10:09.314410 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:10:09.315394 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:10:09.321477 [debug] [MainThread]: Using postgres connection "master"
[0m11:10:09.321477 [debug] [MainThread]: On master: BEGIN
[0m11:10:09.322460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:10:09.334489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.334489 [debug] [MainThread]: Using postgres connection "master"
[0m11:10:09.334489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:10:09.334489 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:10:09.334489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2F1E490>]}
[0m11:10:09.334489 [debug] [MainThread]: On master: ROLLBACK
[0m11:10:09.334489 [debug] [MainThread]: Using postgres connection "master"
[0m11:10:09.334489 [debug] [MainThread]: On master: BEGIN
[0m11:10:09.334489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.334489 [debug] [MainThread]: On master: COMMIT
[0m11:10:09.334489 [debug] [MainThread]: Using postgres connection "master"
[0m11:10:09.350207 [debug] [MainThread]: On master: COMMIT
[0m11:10:09.350207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.350207 [debug] [MainThread]: On master: Close
[0m11:10:09.350207 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:10:09.350207 [info ] [MainThread]: 
[0m11:10:09.350207 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:10:09.350207 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:10:09.350207 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:10:09.350207 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:10:09.350207 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:10:09.359546 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:10:09.360115 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:10:09.369090 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:10:09.370067 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:10:09.371203 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:10:09.371203 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:10:09.360115 => 11:10:09.371203
[0m11:10:09.371203 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:10:09.385906 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:10:09.370694 => 11:10:09.385906
[0m11:10:09.402255 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:10:09.402255 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:10:09.402255 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:10:09.402255 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:10:09.402255 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:10:09.402255 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:10:09.402255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:10:09.402255 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:10:09.402255 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:10:09.417949 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.417949 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.417949 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:10:09.417949 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:10:09.417949 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:10:09.417949 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:10:09.439007 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:10:09.444025 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:10:09.445025 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:10:09.446007 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.449024 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:10:09.449024 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:10:09.451286 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.464266 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:10:09.465278 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:10:09.465278 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:10:09.475358 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.479374 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:10:09.483037 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:10:09.483037 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:10:09.483037 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.493101 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:10:09.402255 => 11:10:09.493101
[0m11:10:09.493101 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:10:09.493101 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:10:09.496698 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:10:09.496698 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A32D4190>]}
[0m11:10:09.496698 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:10:09.496698 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.14s]
[0m11:10:09.496698 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:10:09.496698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.496698 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:10:09.496698 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:10:09.496698 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:10:09.496698 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:10:09.496698 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:10:09.496698 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:10:09.496698 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:10:09.496698 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:10:09.507988 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:10:09.507988 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:10:09.508990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.509883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:10:09.510372 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:10:09.510372 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:10:09.510372 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:10:09.510372 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:10:09.518757 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:10:09.518757 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:10:09.518757 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:10:09.518757 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:10:09.518757 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:10:09.510372 => 11:10:09.518757
[0m11:10:09.518757 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:10:09.518757 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:10:09.518757 => 11:10:09.518757
[0m11:10:09.518757 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:10:09.518757 => 11:10:09.518757
[0m11:10:09.518757 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:10:09.518757 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:10:09.518757 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:10:09.534780 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:10:09.535114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.535114 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:10:09.535114 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:10:09.535114 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:10:09.535114 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:10:09.535114 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:10:09.535114 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:10:09.535114 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:10:09.535114 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:10:09.535114 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:10:09.535114 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:10:09.535114 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:10:09.549386 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:10:09.549386 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:10:09.550467 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:10:09.554453 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.554453 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:10:09.371203 => 11:10:09.554453
[0m11:10:09.554453 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:10:09.554453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2ECDE50>]}
[0m11:10:09.554453 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.20s]
[0m11:10:09.554453 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:10:09.554453 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:10:09.566089 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:10:09.568088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:10:09.569088 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:10:09.569364 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.569364 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:10:09.569364 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:10:09.569364 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:10:09.569364 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:10:09.569364 => 11:10:09.569364
[0m11:10:09.569364 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:10:09.569364 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.569364 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.582723 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:10:09.583728 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:10:09.584791 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:10:09.585321 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:10:09.586317 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:10:09.587543 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:10:09.587543 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:10:09.635451 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:10:09.635451 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:10:09.649504 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:10:09.650558 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:10:09.651734 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:10:09.651734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:09.651734 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:10:09.651734 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.651734 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:10:09.651734 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.666147 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:10:09.672145 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:10:09.673145 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:10:09.674141 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.678155 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:10:09.678155 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:10:09.679138 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.679138 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:10:09.682141 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:10:09.684121 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:10:09.685121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.685121 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:10:09.686155 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:10:09.686155 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:10:09.687121 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:10:09.687121 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:10:09.688121 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:10:09.688121 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.691123 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:10:09.692141 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.692141 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.693121 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:10:09.695123 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:10:09.695123 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:10:09.697139 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:10:09.698142 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:10:09.700223 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:10:09.700223 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.700223 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:10:09.700223 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:10:09.700223 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:10:09.700223 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:10:09.700223 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:10:09.700223 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:10:09.700223 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:10:09.700223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.700223 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:10:09.700223 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.700223 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.700223 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.700223 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:10:09.700223 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:10:09.535114 => 11:10:09.700223
[0m11:10:09.700223 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:10:09.535114 => 11:10:09.700223
[0m11:10:09.715878 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:10:09.715878 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:10:09.715878 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:10:09.715878 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:10:09.715878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.715878 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A32A9A50>]}
[0m11:10:09.715878 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A32CCCD0>]}
[0m11:10:09.715878 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:10:09.715878 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:10:09.715878 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.21s]
[0m11:10:09.715878 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.21s]
[0m11:10:09.715878 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:10:09.715878 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:10:09.715878 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:10:09.715878 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:10:09.715878 [debug] [Thread-2 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:10:09.715878 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.715878 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:10:09.715878 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:10:09.518757 => 11:10:09.715878
[0m11:10:09.715878 [info ] [Thread-2 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:10:09.728719 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.729458 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:10:09.729458 [info ] [Thread-3 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:10:09.730460 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.dim_diagnosis)
[0m11:10:09.732721 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:10:09.735471 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2C79190>]}
[0m11:10:09.735471 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_allowed_amount)
[0m11:10:09.735471 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:10:09.735471 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:10:09.735471 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:10:09.735471 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.23s]
[0m11:10:09.735471 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:10:09.735471 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:10:09.750603 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:10:09.751537 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:10:09.752537 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:10:09.735471 => 11:10:09.751537
[0m11:10:09.753817 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:10:09.753817 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:10:09.735471 => 11:10:09.753817
[0m11:10:09.753817 [debug] [Thread-2 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:10:09.753817 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:10:09.753817 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:10:09.753817 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.753817 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:10:09.753817 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:10:09.766178 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m11:10:09.768220 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:10:09.569364 => 11:10:09.768220
[0m11:10:09.769327 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:10:09.770251 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:10:09.771243 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:10:09.771243 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:10:09.771243 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:10:09.771243 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:10:09.771243 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:10:09.771243 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A30744D0>]}
[0m11:10:09.771243 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:10:09.771243 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:10:09.771243 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:10:09.771243 => 11:10:09.771243
[0m11:10:09.771243 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.20s]
[0m11:10:09.782893 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:10:09.783910 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:10:09.786417 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:10:09.786417 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:10:09.786417 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:10:09.786417 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:10:09.786417 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:10:09.786417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:10:09.786417 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:10:09.797450 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:10:09.801443 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:10:09.802441 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.802441 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.803476 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:10:09.804441 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:10:09.797450 => 11:10:09.803476
[0m11:10:09.804882 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:10:09.804882 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:10:09.804882 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:10:09.804882 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:10:09.804882 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:10:09.816252 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:10:09.817261 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:10:09.818249 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.818249 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:10:09.818982 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:10:09.818982 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:10:09.818982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:10:09.818982 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:10:09.818982 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:10:09.818982 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.818982 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:10:09.818982 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:10:09.833692 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:10:09.833692 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.838313 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:10:09.840337 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:10:09.840337 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.840337 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:10:09.840337 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:10:09.840337 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:10:09.840337 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:10:09.840337 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:10:09.852228 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.852228 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:10:09.852228 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.852228 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:10:09.852228 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:10:09.852228 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:10:09.852228 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:10:09.868146 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:10:09.868615 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.868615 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:10:09.868615 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:10:09.868615 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:10:09.868615 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:10:09.868615 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:10:09.868615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.868615 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:10:09.868615 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:10:09.868615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.882885 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:10:09.883912 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:10:09.883912 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:10:09.892881 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.893882 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:10:09.753817 => 11:10:09.893882
[0m11:10:09.894902 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:10:09.894902 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.895916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.896882 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A31F6D50>]}
[0m11:10:09.899840 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:10:09.901841 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:10:09.901841 [debug] [Thread-2 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:10:09.902840 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:10:09.902840 [info ] [Thread-3 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.16s]
[0m11:10:09.903839 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:10:09.905873 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:10:09.906861 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:10:09.906861 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:10:09.907839 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:10:09.907839 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:10:09.909840 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.913839 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:10:09.913839 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:10:09.916725 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:09.918524 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:10:09.919360 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:10:09.919731 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:10:09.919731 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.919731 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.919731 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:10:09.783910 => 11:10:09.919731
[0m11:10:09.919731 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:09.919731 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:10:09.804882 => 11:10:09.919731
[0m11:10:09.919731 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:10:09.919731 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:10:09.919731 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:10:09.919731 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A33B5E10>]}
[0m11:10:09.919731 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:10:09.932748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A321AB90>]}
[0m11:10:09.934747 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:10:09.934747 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.15s]
[0m11:10:09.935630 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:10:09.935630 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.15s]
[0m11:10:09.935630 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:10:09.935630 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:09.935630 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:10:09.753817 => 11:10:09.935630
[0m11:10:09.935630 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:10:09.935630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A3081D90>]}
[0m11:10:09.935630 [info ] [Thread-2 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.21s]
[0m11:10:09.935630 [debug] [Thread-2 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:10:09.935630 [debug] [Thread-3 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:10:09.935630 [info ] [Thread-3 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:10:09.950328 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:10:09.950328 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:10:09.953414 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:10:09.953414 [debug] [Thread-3 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:10:09.950328 => 11:10:09.953414
[0m11:10:09.953414 [debug] [Thread-3 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:10:09.953414 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:10:09.953414 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:10:09.953414 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:10:09.953414 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:10:09.970281 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:10:09.970281 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:10:09.970281 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
    SELECT *
    FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
combined_data AS (
  SELECT
    f.diagnosis_1_key,
    f.diagnosis_2_key,
    f.diagnosis_3_key,
    d1.diagnosis_key AS diagnosis_1_analysis,
    d1.full_description AS diagnosis_1_description,
    d1.category_title AS diagnosis_1_category,
    d2.diagnosis_key AS diagnosis_2_analysis,
    d2.full_description AS diagnosis_2_description,
    d2.category_title AS diagnosis_2_category,
    d3.diagnosis_key AS diagnosis_3_analysis,
    d3.full_description AS diagnosis_3_description,
    d3.category_title AS diagnosis_3_category
  FROM
    fact_claims f
  LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
  LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
  LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

SELECT
  *,
  -- Count the number of claims with each diagnosis
  COUNT(*) AS total_claims,
  -- Check if all diagnoses are populated (useful for data quality checks)
  CASE WHEN diagnosis_1_analysis IS NULL OR diagnosis_2_analysis IS NULL OR diagnosis_3_analysis IS NULL THEN 'Not all diagnoses populated' ELSE 'All diagnoses populated' END AS diagnosis_completeness
FROM
  combined_data
GROUP BY
  combined_data.diagnosis_1_key,
  combined_data.diagnosis_2_key,
  combined_data.diagnosis_3_key,
  combined_data.diagnosis_1_analysis,
  combined_data.diagnosis_2_analysis,
  combined_data.diagnosis_3_analysis,
  combined_data.diagnosis_1_description,
  combined_data.diagnosis_1_category,
  combined_data.diagnosis_2_description,
  combined_data.diagnosis_2_category,
  combined_data.diagnosis_3_description,
  combined_data.diagnosis_3_category
  );
  
[0m11:10:10.542269 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 1.0 seconds
[0m11:10:10.544269 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:10:10.545270 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m11:10:10.546271 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:10.548278 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:10:10.549607 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m11:10:10.549607 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:10:10.549607 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:10:10.549607 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:10:10.549607 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:10:10.549607 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:10:10.549607 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m11:10:10.549607 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:10:10.549607 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m11:10:10.549607 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:10:10.565356 [debug] [Thread-3 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:10:09.953414 => 11:10:10.565356
[0m11:10:10.565957 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:10:10.565957 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c71d6873-0e27-4657-9c45-eb5b3aa60b98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A321AE90>]}
[0m11:10:10.565957 [info ] [Thread-3 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 1000[0m in 0.62s]
[0m11:10:10.565957 [debug] [Thread-3 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:10:10.565957 [debug] [MainThread]: Using postgres connection "master"
[0m11:10:10.565957 [debug] [MainThread]: On master: BEGIN
[0m11:10:10.565957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:10:10.591280 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:10:10.591280 [debug] [MainThread]: On master: COMMIT
[0m11:10:10.592282 [debug] [MainThread]: Using postgres connection "master"
[0m11:10:10.592282 [debug] [MainThread]: On master: COMMIT
[0m11:10:10.593281 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:10:10.593281 [debug] [MainThread]: On master: Close
[0m11:10:10.594282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:10.594282 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:10:10.594282 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:10:10.594282 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:10:10.595281 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:10:10.595281 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:10:10.595281 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:10:10.595281 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m11:10:10.596306 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:10:10.596822 [info ] [MainThread]: 
[0m11:10:10.597478 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.38 seconds (1.38s).
[0m11:10:10.599427 [debug] [MainThread]: Command end result
[0m11:10:10.600516 [info ] [MainThread]: 
[0m11:10:10.600516 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:10.600516 [info ] [MainThread]: 
[0m11:10:10.600516 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:10:10.616901 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:10.616901 after 1.80 seconds
[0m11:10:10.616901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A15746D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5A2669850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C59C1AC4D0>]}
[0m11:10:10.616901 [debug] [MainThread]: Flushing usage events
[0m11:20:43.854941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFACD932D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD144090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD147D10>]}


============================== 11:20:43.854941 | 21dc9e7f-c619-40b9-9c05-7837d5d5037b ==============================
[0m11:20:43.854941 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:20:43.854941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:43.993925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD17E710>]}
[0m11:20:44.055406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD127D50>]}
[0m11:20:44.055406 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:20:44.071012 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:20:44.144301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:20:44.145312 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:20:44.235187 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:20:44.240200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD2C7E10>]}
[0m11:20:44.250727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD78D710>]}
[0m11:20:44.250727 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:20:44.250727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD705350>]}
[0m11:20:44.250727 [info ] [MainThread]: 
[0m11:20:44.250727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:20:44.250727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:20:44.250727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:20:44.250727 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:20:44.266355 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:20:44.267506 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:20:44.268042 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:20:44.268042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:44.269043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:44.286639 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:20:44.286639 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:20:44.286639 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:20:44.286639 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:20:44.286639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:20:44.286639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:20:44.301752 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:20:44.303730 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:20:44.304728 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:20:44.304728 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:20:44.305674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:44.305674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:44.340346 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.340346 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:20:44.340346 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.340346 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:20:44.340346 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:20:44.340346 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:20:44.351033 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:20:44.354030 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:20:44.354030 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:20:44.357026 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:20:44.357026 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:20:44.361030 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:20:44.367027 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:44.367617 [debug] [MainThread]: On master: BEGIN
[0m11:20:44.367617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:44.384725 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.384725 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:44.384725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:44.384725 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:20:44.384725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD592050>]}
[0m11:20:44.384725 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:44.384725 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:44.384725 [debug] [MainThread]: On master: BEGIN
[0m11:20:44.400351 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.400351 [debug] [MainThread]: On master: COMMIT
[0m11:20:44.400351 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:44.400351 [debug] [MainThread]: On master: COMMIT
[0m11:20:44.400351 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:44.402937 [debug] [MainThread]: On master: Close
[0m11:20:44.403747 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:20:44.403747 [info ] [MainThread]: 
[0m11:20:44.407752 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:20:44.407752 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:20:44.408750 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:20:44.410346 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:20:44.408750 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:20:44.410346 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:20:44.411350 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:20:44.416346 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:20:44.416346 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:20:44.417605 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:20:44.411350 => 11:20:44.417449
[0m11:20:44.419967 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:20:44.421084 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:20:44.421084 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:20:44.417605 => 11:20:44.421084
[0m11:20:44.454049 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:20:44.454049 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:20:44.454049 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:20:44.454049 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:20:44.454049 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:20:44.454049 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:20:44.454049 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:20:44.454049 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:20:44.454049 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:20:44.477251 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.477813 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:20:44.478341 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:20:44.479919 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.480447 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:20:44.480447 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:20:44.491639 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:20:44.496632 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:20:44.497157 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:20:44.499805 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.502637 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:20:44.503169 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:20:44.506312 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.520936 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:20:44.520936 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:20:44.521938 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:20:44.549341 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:44.555676 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:20:44.560677 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:20:44.560677 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:20:44.579874 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:44.580875 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:20:44.454049 => 11:20:44.580875
[0m11:20:44.581875 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:20:44.582873 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD7131D0>]}
[0m11:20:44.582873 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:20:44.587441 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:20:44.583875 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.17s]
[0m11:20:44.588426 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:20:44.589427 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:20:44.590423 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:20:44.590423 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:20:44.591423 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:20:44.591423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.592422 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:20:44.592422 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:20:44.595839 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:20:44.593819 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:20:44.596837 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:20:44.597843 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:20:44.598825 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:20:44.599819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:20:44.599819 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:20:44.599819 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:20:44.601486 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:20:44.605867 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:20:44.605867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.605867 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:20:44.605867 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:20:44.605867 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:20:44.605867 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:20:44.602154 => 11:20:44.605867
[0m11:20:44.617350 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:20:44.605867 => 11:20:44.617350
[0m11:20:44.618372 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:20:44.605867 => 11:20:44.618372
[0m11:20:44.619351 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:20:44.619351 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:20:44.620353 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:20:44.621352 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:20:44.621352 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:20:44.625241 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:20:44.625241 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:20:44.625241 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:20:44.635180 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:20:44.636175 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:20:44.637177 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:20:44.637177 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:20:44.638175 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:20:44.638175 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:20:44.638175 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:20:44.639173 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:20:44.640084 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:20:44.640084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:44.640084 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:20:44.640084 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:20:44.640084 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:20:44.653691 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:44.653691 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.653691 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:20:44.421084 => 11:20:44.653691
[0m11:20:44.653691 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.653691 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:20:44.653691 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:20:44.653691 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:20:44.653691 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:20:44.653691 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.653691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD7A5C90>]}
[0m11:20:44.653691 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:20:44.653691 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:20:44.665332 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.24s]
[0m11:20:44.665332 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:20:44.667406 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:20:44.667919 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:20:44.669810 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:20:44.669810 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:20:44.669810 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:20:44.669810 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:20:44.669810 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:20:44.669810 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:20:44.669810 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:20:44.669810 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:20:44.669810 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:20:44.669810 => 11:20:44.669810
[0m11:20:44.737335 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:20:44.737335 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:20:44.737335 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:20:44.737335 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:20:44.737335 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.737335 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:20:44.737335 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:20:44.737335 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:20:44.737335 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:20:44.751745 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:20:44.753400 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:20:44.753400 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.753400 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.753400 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:20:44.753400 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:20:44.753400 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.753400 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:20:44.753400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:44.753400 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:20:44.753400 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:20:44.753400 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:20:44.753400 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:20:44.753400 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:20:44.753400 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.767376 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:20:44.768398 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.769371 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:44.769371 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:20:44.772373 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:20:44.775371 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:20:44.775371 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:20:44.776374 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:20:44.777371 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:20:44.778370 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:20:44.778370 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:20:44.781371 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:44.784351 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:20:44.784351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.784351 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:44.785355 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:44.786355 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:20:44.786355 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:20:44.789368 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:20:44.625241 => 11:20:44.789368
[0m11:20:44.792257 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:20:44.792487 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:20:44.792487 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:20:44.793508 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:20:44.793508 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:20:44.795508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD819190>]}
[0m11:20:44.795508 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:20:44.796507 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.20s]
[0m11:20:44.798507 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:20:44.798507 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:20:44.799505 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:44.799505 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:20:44.801539 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:20:44.625241 => 11:20:44.801539
[0m11:20:44.801539 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:44.801539 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m11:20:44.801539 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:20:44.801539 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:20:44.805140 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:20:44.622352 => 11:20:44.804835
[0m11:20:44.805435 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:20:44.806489 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD72E650>]}
[0m11:20:44.809175 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:20:44.809696 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:20:44.812437 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:20:44.813511 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:20:44.813511 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.21s]
[0m11:20:44.814589 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD7F7390>]}
[0m11:20:44.815703 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:20:44.809696 => 11:20:44.815634
[0m11:20:44.816229 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:20:44.816753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.817605 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:20:44.817280 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.22s]
[0m11:20:44.818290 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:20:44.821364 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:20:44.825958 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:20:44.825958 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:20:44.825958 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:20:44.825958 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:20:44.825958 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:20:44.825958 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:20:44.825958 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m11:20:44.825958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.825958 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:20:44.825958 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:20:44.825958 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:20:44.835083 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:20:44.835083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:20:44.838081 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:20:44.839011 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m11:20:44.839011 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:20:44.839011 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:20:44.835083 => 11:20:44.839011
[0m11:20:44.839011 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:20:44.839011 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:20:44.839011 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:20:44.839011 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:20:44.853717 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:20:44.853717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:44.854719 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:20:44.839011 => 11:20:44.854719
[0m11:20:44.857306 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:20:44.857306 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.857306 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:20:44.857306 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:20:44.857306 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:20:44.857306 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:20:44.857306 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:20:44.857306 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:20:44.857306 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:20:44.867777 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:20:44.867777 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:20:44.868780 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:20:44.870777 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:20:44.870777 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:20:44.872931 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:44.872931 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:20:44.737335 => 11:20:44.872931
[0m11:20:44.872931 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:20:44.872931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD558790>]}
[0m11:20:44.872931 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.20s]
[0m11:20:44.872931 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:20:44.872931 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:20:44.885284 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:20:44.886284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:20:44.887021 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:20:44.892032 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:20:44.892032 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:20:44.887021 => 11:20:44.892032
[0m11:20:44.892032 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:20:44.892032 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:20:44.892032 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.892032 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:20:44.900734 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:20:44.901737 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:20:44.901737 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.903076 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:20:44.904371 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:20:44.904371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:44.904371 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:20:44.908888 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:20:44.908888 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:20:44.908888 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:20:44.908888 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:20:44.919422 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:20:44.920418 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.920418 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:20:44.926693 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:20:44.926693 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:20:44.926693 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.926693 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.926693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:44.937086 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:20:44.939371 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:20:44.939371 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:20:44.939371 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:20:44.939371 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:20:44.939371 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:20:44.946382 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:20:44.946382 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:20:44.946382 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.951740 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:20:44.954293 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:20:44.954293 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:20:44.954293 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:20:44.954293 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:20:44.996497 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:20:44.997496 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:44.997496 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:44.998496 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:45.000497 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:20:45.002144 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:20:45.004163 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:20:45.007138 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:20:45.008219 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:20:45.008699 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:20:45.009438 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:20:45.010915 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:20:45.011914 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:20:45.011914 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:20:45.012914 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:45.012914 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:45.015919 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:20:45.018940 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:20:45.018940 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:45.018940 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:45.018940 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:20:45.018940 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:20:45.018940 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:20:44.857306 => 11:20:45.018940
[0m11:20:45.026471 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:20:44.839011 => 11:20:45.026471
[0m11:20:45.026471 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:20:45.026471 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:20:45.026471 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:20:45.026471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:45.026471 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFABFE4110>]}
[0m11:20:45.026471 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD78DDD0>]}
[0m11:20:45.026471 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:20:45.026471 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:45.026471 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.19s]
[0m11:20:45.026471 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:20:45.026471 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.20s]
[0m11:20:45.042770 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:20:45.042770 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:20:45.042770 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:20:45.042770 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:20:45.042770 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:20:45.042770 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:20:45.042770 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:45.042770 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:20:45.042770 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:20:45.042770 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:45.042770 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:20:45.042770 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:20:44.821364 => 11:20:45.042770
[0m11:20:45.042770 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:20:45.042770 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD8D4110>]}
[0m11:20:45.042770 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.24s]
[0m11:20:45.042770 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:20:45.057772 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:20:45.058452 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:20:45.059462 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:20:45.059462 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:45.059462 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:20:45.061170 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:20:44.892032 => 11:20:45.061170
[0m11:20:45.061170 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:20:45.061170 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:20:45.068981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD125BD0>]}
[0m11:20:45.069978 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:20:45.061170 => 11:20:45.069978
[0m11:20:45.071060 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:20:45.071060 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.18s]
[0m11:20:45.071060 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:20:45.071060 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:20:45.071060 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:20:45.071060 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:20:45.071060 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:20:45.089677 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:45.089677 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:20:45.089677 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claim AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
icd_codes AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
)

SELECT
  f.diagnosis_1_key,
  f.diagnosis_2_key,
  f.diagnosis_3_key,
  d.diagnosis_key,
  d.category_code,
  d.diagnosis_code,
  d.full_description,
  d.category_title
FROM fact_claim f
JOIN icd_codes d
ON f.diagnosis_1_key = d.diagnosis_key
OR f.diagnosis_2_key = d.diagnosis_key
OR f.diagnosis_3_key = d.diagnosis_key
  );
  
[0m11:20:49.937066 [debug] [Thread-4 (]: SQL status: SELECT 2094 in 5.0 seconds
[0m11:20:49.940084 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:20:49.940084 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m11:20:49.942066 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:49.944068 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:20:49.945068 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m11:20:49.946067 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:20:49.947068 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:20:49.948095 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:20:49.948095 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:20:49.951067 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:20:49.953083 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m11:20:49.954088 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:20:49.954088 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m11:20:49.958067 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:20:49.959086 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:20:45.071060 => 11:20:49.959086
[0m11:20:49.959086 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:20:49.960066 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21dc9e7f-c619-40b9-9c05-7837d5d5037b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAD8845D0>]}
[0m11:20:49.960066 [info ] [Thread-4 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 2094[0m in 4.90s]
[0m11:20:49.962067 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:20:49.964071 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:49.964071 [debug] [MainThread]: On master: BEGIN
[0m11:20:49.965072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:49.999501 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:50.000505 [debug] [MainThread]: On master: COMMIT
[0m11:20:50.001509 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:50.002510 [debug] [MainThread]: On master: COMMIT
[0m11:20:50.004501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:50.005503 [debug] [MainThread]: On master: Close
[0m11:20:50.008511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:50.009506 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:20:50.009506 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:20:50.010505 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:20:50.010505 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:20:50.011504 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:20:50.011504 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m11:20:50.012501 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:20:50.012501 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:20:50.012501 [info ] [MainThread]: 
[0m11:20:50.013502 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 5.76 seconds (5.76s).
[0m11:20:50.016615 [debug] [MainThread]: Command end result
[0m11:20:50.028130 [info ] [MainThread]: 
[0m11:20:50.030132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:20:50.031141 [info ] [MainThread]: 
[0m11:20:50.032136 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:20:50.033135 [debug] [MainThread]: Command `dbt run` succeeded at 11:20:50.033135 after 6.21 seconds
[0m11:20:50.034130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAAAD5F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAAAD6690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EFAAAD6750>]}
[0m11:20:50.035132 [debug] [MainThread]: Flushing usage events
[0m11:32:36.775842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D096B55D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09705E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09705E150>]}


============================== 11:32:36.775842 | 85ff8988-0822-405b-b13c-bbd7d751c62a ==============================
[0m11:32:36.775842 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:32:36.775842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:32:36.909769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0970AE710>]}
[0m11:32:36.960588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0971A7950>]}
[0m11:32:36.960588 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:32:36.960588 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:32:37.044529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:32:37.045528 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:32:37.144005 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:32:37.149005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0973DD250>]}
[0m11:32:37.162433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0974C1ED0>]}
[0m11:32:37.162433 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:32:37.164262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09729D690>]}
[0m11:32:37.165845 [info ] [MainThread]: 
[0m11:32:37.166971 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:32:37.166971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:32:37.166971 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:32:37.166971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:32:37.166971 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:32:37.182735 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:32:37.183454 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:37.183979 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:32:37.183979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:37.201940 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:32:37.201940 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:32:37.201940 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:32:37.201940 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:32:37.201940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:32:37.217508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:32:37.217508 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:32:37.217508 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:32:37.217508 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:32:37.217508 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:32:37.217508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:37.217508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:37.245851 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.245851 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:32:37.245851 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:32:37.245851 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.245851 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:32:37.245851 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:32:37.250973 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:32:37.250973 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:32:37.250973 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:32:37.250973 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:32:37.250973 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:32:37.250973 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:32:37.250973 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:37.250973 [debug] [MainThread]: On master: BEGIN
[0m11:32:37.250973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:37.267705 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.267705 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:37.267705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:32:37.267705 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:32:37.283591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0975EEC10>]}
[0m11:32:37.284607 [debug] [MainThread]: On master: ROLLBACK
[0m11:32:37.285595 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:37.285595 [debug] [MainThread]: On master: BEGIN
[0m11:32:37.287593 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.287593 [debug] [MainThread]: On master: COMMIT
[0m11:32:37.287593 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:37.288592 [debug] [MainThread]: On master: COMMIT
[0m11:32:37.288592 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.289592 [debug] [MainThread]: On master: Close
[0m11:32:37.289592 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:37.290593 [info ] [MainThread]: 
[0m11:32:37.296592 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:32:37.296592 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:32:37.296592 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:32:37.298595 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:32:37.297596 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:32:37.298595 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:32:37.299596 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:32:37.301973 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:32:37.301973 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:32:37.301973 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:32:37.301973 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:32:37.300595 => 11:32:37.301973
[0m11:32:37.301973 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:32:37.317399 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:32:37.301973 => 11:32:37.317399
[0m11:32:37.334105 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:32:37.334105 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:32:37.346114 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:32:37.346114 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:32:37.346114 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:32:37.350700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:32:37.351568 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:32:37.351568 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:32:37.351568 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:32:37.367592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.367592 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.367592 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:32:37.367592 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:32:37.367592 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:32:37.367592 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:32:37.367592 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:32:37.389099 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:32:37.389099 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:32:37.389099 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.389099 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:32:37.389099 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:32:37.389099 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.410590 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:32:37.411591 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:32:37.411591 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:32:37.424160 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.430149 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:32:37.435188 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:32:37.435188 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:32:37.446209 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.446209 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:32:37.346114 => 11:32:37.446209
[0m11:32:37.446209 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:32:37.446209 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0976D1B50>]}
[0m11:32:37.446209 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.15s]
[0m11:32:37.446209 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:32:37.446209 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:32:37.446209 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:32:37.446209 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:32:37.446209 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:32:37.446209 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:32:37.446209 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:32:37.446209 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:32:37.446209 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:32:37.461842 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:32:37.465596 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:32:37.466723 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:32:37.467726 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:32:37.470658 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:32:37.470658 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:32:37.470658 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:32:37.470658 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:32:37.470658 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:32:37.470658 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:32:37.470658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.470658 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:32:37.470658 => 11:32:37.470658
[0m11:32:37.483492 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:32:37.470658 => 11:32:37.483492
[0m11:32:37.485875 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:32:37.485875 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:32:37.470658 => 11:32:37.485875
[0m11:32:37.485875 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:32:37.485875 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:32:37.485875 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:32:37.485875 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:32:37.485875 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:32:37.485875 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:32:37.500096 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.503093 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:32:37.504092 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:32:37.505079 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:32:37.505079 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:32:37.505079 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:32:37.505079 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:32:37.505079 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:32:37.505079 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:32:37.505079 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:32:37.505079 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:32:37.505079 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:32:37.505079 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:32:37.505079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:32:37.521723 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.521723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.521723 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.521723 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:32:37.534495 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:32:37.535670 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.535670 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:32:37.535670 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:32:37.535670 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:32:37.535670 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:32:37.535670 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:32:37.535670 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:32:37.535670 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:32:37.546179 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.546179 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:32:37.301973 => 11:32:37.546179
[0m11:32:37.546179 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:32:37.546179 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:32:37.553159 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:32:37.553159 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:32:37.554161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0976F3CD0>]}
[0m11:32:37.554161 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:32:37.558160 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:32:37.558160 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:32:37.559159 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.26s]
[0m11:32:37.560160 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:32:37.616857 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:32:37.617868 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.618857 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:32:37.619345 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:32:37.619345 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:32:37.619345 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.619345 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:32:37.619345 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:32:37.619345 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:32:37.619345 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.619345 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:32:37.619345 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:32:37.635051 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.635051 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:32:37.636052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:32:37.639025 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:32:37.639025 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.639025 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:32:37.640025 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:32:37.640025 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:32:37.642028 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:32:37.644044 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:32:37.644044 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.645025 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:32:37.645025 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:32:37.647045 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:32:37.647045 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:32:37.642028 => 11:32:37.647045
[0m11:32:37.648027 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:32:37.648027 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:32:37.649026 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:32:37.649026 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:32:37.653254 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:32:37.653254 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.654235 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.656236 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:32:37.656236 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.657236 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:32:37.658257 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:32:37.660234 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:32:37.662250 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:32:37.662250 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:32:37.663237 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:32:37.663237 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:32:37.664236 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:32:37.664236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:37.665237 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:32:37.665237 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:32:37.670198 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.671789 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:32:37.485875 => 11:32:37.671789
[0m11:32:37.671789 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.671789 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.671789 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:32:37.671789 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:32:37.485875 => 11:32:37.671789
[0m11:32:37.671789 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:32:37.485875 => 11:32:37.671789
[0m11:32:37.671789 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097696A90>]}
[0m11:32:37.671789 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:32:37.671789 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:32:37.671789 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.23s]
[0m11:32:37.683517 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0973A42D0>]}
[0m11:32:37.685521 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097660910>]}
[0m11:32:37.686519 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:32:37.687255 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.23s]
[0m11:32:37.687255 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:32:37.687255 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.22s]
[0m11:32:37.687255 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:32:37.687255 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:32:37.687255 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:32:37.687255 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:32:37.687255 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:32:37.687255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.687255 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m11:32:37.687255 [info ] [Thread-4 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:32:37.687255 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:32:37.687255 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:32:37.687255 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:32:37.687255 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_allowed_amount)
[0m11:32:37.687255 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:32:37.687255 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m11:32:37.702054 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:32:37.702054 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:32:37.703055 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:32:37.704969 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:32:37.704969 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:32:37.687255 => 11:32:37.704969
[0m11:32:37.704969 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:32:37.704969 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:32:37.704969 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:32:37.716757 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:32:37.704969 => 11:32:37.704969
[0m11:32:37.719761 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:32:37.720756 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:32:37.704969 => 11:32:37.719761
[0m11:32:37.721934 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:32:37.721934 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:32:37.721934 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:32:37.721934 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:32:37.721934 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:32:37.721934 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:32:37.734937 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:32:37.734937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.735937 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:32:37.735937 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:32:37.736937 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:32:37.738464 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:32:37.738464 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:32:37.738464 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:32:37.738464 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:32:37.738464 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:32:37.738464 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:32:37.745970 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:32:37.745970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.750136 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:32:37.751150 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:32:37.752135 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:32:37.753419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.753419 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:32:37.753419 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:32:37.753419 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:32:37.753419 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.753419 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:32:37.650025 => 11:32:37.753419
[0m11:32:37.753419 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:32:37.753419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0974259D0>]}
[0m11:32:37.767446 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.12s]
[0m11:32:37.769421 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:32:37.769421 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:32:37.769421 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:32:37.769421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:32:37.769421 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:32:37.769421 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:32:37.769421 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:32:37.769421 => 11:32:37.769421
[0m11:32:37.769421 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:32:37.769421 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.787423 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:32:37.787423 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.788171 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.788171 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:32:37.788171 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:32:37.788171 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:32:37.788171 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:32:37.788171 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:32:37.788171 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:32:37.788171 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:32:37.788171 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:32:37.788171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:32:37.802161 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:32:37.803160 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:32:37.807162 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:32:37.810182 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:32:37.810182 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:32:37.810182 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:32:37.810182 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.810182 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.810182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.820304 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:32:37.822470 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:32:37.822470 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:32:37.822470 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:32:37.822470 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:32:37.822470 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:32:37.830490 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.830490 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.834469 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:32:37.837445 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:32:37.837539 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:32:37.837539 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:32:37.841128 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:32:37.841128 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:32:37.846185 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.846185 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:32:37.846185 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.846185 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:32:37.846185 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:32:37.846185 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:32:37.858894 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:32:37.858894 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:32:37.858894 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:32:37.858894 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:32:37.858894 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:32:37.873977 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.874978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.875978 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:32:37.721934 => 11:32:37.875978
[0m11:32:37.876977 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.878979 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:32:37.879979 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:32:37.879979 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:32:37.880979 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:32:37.721934 => 11:32:37.880979
[0m11:32:37.881979 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:32:37.882977 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0974CFE50>]}
[0m11:32:37.884880 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:32:37.885878 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:32:37.886878 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:32:37.886878 [info ] [Thread-4 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.19s]
[0m11:32:37.887880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.887880 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0975E7CD0>]}
[0m11:32:37.888881 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:32:37.890898 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:32:37.891879 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.891879 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.20s]
[0m11:32:37.892882 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:32:37.894669 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:32:37.895646 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:32:37.895646 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:32:37.896647 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:32:37.897646 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:37.901226 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:32:37.901226 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:32:37.902228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.902228 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:32:37.904048 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:32:37.904048 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:32:37.904048 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:32:37.904048 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:37.904048 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:32:37.904048 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.904048 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:32:37.904048 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:32:37.769421 => 11:32:37.904048
[0m11:32:37.916861 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:32:37.916861 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:32:37.918865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0977A4AD0>]}
[0m11:32:37.919865 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.15s]
[0m11:32:37.920865 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:32:37.922213 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:37.922213 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:32:37.720756 => 11:32:37.922213
[0m11:32:37.922213 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:32:37.922213 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D097634ED0>]}
[0m11:32:37.922213 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.23s]
[0m11:32:37.922213 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:32:37.922213 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:32:37.922213 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:32:37.922213 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:32:37.922213 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:32:37.935000 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:32:37.936000 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:32:37.922213 => 11:32:37.936000
[0m11:32:37.936000 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:32:37.939348 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:32:37.939348 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:32:37.939348 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:32:37.939348 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:32:37.955059 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:32:37.955059 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:32:37.955059 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
)

SELECT
  f.diagnosis_1_key,
  d1.diagnosis_key as diagnosis_1_diagnosis_key,
  d1.category_code as diagnosis_1_category_code,
  d1.diagnosis_code as diagnosis_1_diagnosis_code,
  d1.full_description as diagnosis_1_full_description,
  d1.category_title as diagnosis_1_category_title,
  
  f.diagnosis_2_key,
  d2.diagnosis_key as diagnosis_2_diagnosis_key,
  d2.category_code as diagnosis_2_category_code,
  d2.diagnosis_code as diagnosis_2_diagnosis_code,
  d2.full_description as diagnosis_2_full_description,
  d2.category_title as diagnosis_2_category_title,
  
  f.diagnosis_3_key,
  d3.diagnosis_key as diagnosis_3_diagnosis_key,
  d3.category_code as diagnosis_3_category_code,
  d3.diagnosis_code as diagnosis_3_diagnosis_code,
  d3.full_description as diagnosis_3_full_description,
  d3.category_title as diagnosis_3_category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
  );
  
[0m11:32:38.410380 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:32:38.410380 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:32:38.410380 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m11:32:38.410380 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:38.410380 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:32:38.410380 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m11:32:38.426013 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:32:38.427019 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:32:38.427019 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:32:38.427019 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:32:38.427019 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:32:38.427019 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m11:32:38.427019 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:32:38.427019 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m11:32:38.427019 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:32:38.427019 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:32:37.936999 => 11:32:38.427019
[0m11:32:38.442651 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:32:38.443219 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85ff8988-0822-405b-b13c-bbd7d751c62a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09774E050>]}
[0m11:32:38.443666 [info ] [Thread-4 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 1000[0m in 0.52s]
[0m11:32:38.443666 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:32:38.447738 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:38.447738 [debug] [MainThread]: On master: BEGIN
[0m11:32:38.447738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:38.467196 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:38.467196 [debug] [MainThread]: On master: COMMIT
[0m11:32:38.467196 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:38.467196 [debug] [MainThread]: On master: COMMIT
[0m11:32:38.467196 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:38.467196 [debug] [MainThread]: On master: Close
[0m11:32:38.467196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:38.467196 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:32:38.467196 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:32:38.467196 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:32:38.467196 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:32:38.467196 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:32:38.467196 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m11:32:38.467196 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:32:38.467196 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:32:38.467196 [info ] [MainThread]: 
[0m11:32:38.467196 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.30 seconds (1.30s).
[0m11:32:38.484515 [debug] [MainThread]: Command end result
[0m11:32:38.484515 [info ] [MainThread]: 
[0m11:32:38.484515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:32:38.484515 [info ] [MainThread]: 
[0m11:32:38.484515 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:32:38.484515 [debug] [MainThread]: Command `dbt run` succeeded at 11:32:38.484515 after 1.76 seconds
[0m11:32:38.500134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D096CB2F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0949ACA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D09718AA10>]}
[0m11:32:38.500676 [debug] [MainThread]: Flushing usage events
[0m11:36:21.189552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A739E8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A73ED050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A73EFDD0>]}


============================== 11:36:21.189552 | facb977d-5b74-49e7-821f-8dae98c0e775 ==============================
[0m11:36:21.189552 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:36:21.189552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:36:21.328947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A757E510>]}
[0m11:36:21.396015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A4D340D0>]}
[0m11:36:21.396015 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:36:21.423465 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:36:21.479809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:21.479809 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:36:21.596380 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:36:21.596380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A76E4E90>]}
[0m11:36:21.622998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A796B890>]}
[0m11:36:21.622998 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:36:21.622998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A73ECE10>]}
[0m11:36:21.622998 [info ] [MainThread]: 
[0m11:36:21.628117 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:36:21.629262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:36:21.629262 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:36:21.629262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:36:21.629262 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:36:21.646512 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:36:21.646512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:21.646512 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:36:21.646512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:21.662406 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:36:21.662406 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:36:21.662406 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:36:21.662406 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:36:21.678078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:36:21.678949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:36:21.678949 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:36:21.678949 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:36:21.678949 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:36:21.678949 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:36:21.678949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:21.678949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:21.696196 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:36:21.696196 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:36:21.696196 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:36:21.696196 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:36:21.696196 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:36:21.696196 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:36:21.712216 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:36:21.712216 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:36:21.712216 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:36:21.712216 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:36:21.712216 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:36:21.712216 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:36:21.729182 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:21.729182 [debug] [MainThread]: On master: BEGIN
[0m11:36:21.729182 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:21.745896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:36:21.745896 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:21.745896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:36:21.762613 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:36:21.762613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A798D650>]}
[0m11:36:21.762613 [debug] [MainThread]: On master: ROLLBACK
[0m11:36:21.762613 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:21.762613 [debug] [MainThread]: On master: BEGIN
[0m11:36:21.762613 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:36:21.762613 [debug] [MainThread]: On master: COMMIT
[0m11:36:21.762613 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:21.762613 [debug] [MainThread]: On master: COMMIT
[0m11:36:21.762613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:36:21.762613 [debug] [MainThread]: On master: Close
[0m11:36:21.762613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:36:21.762613 [info ] [MainThread]: 
[0m11:36:21.779212 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:36:21.779212 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:36:21.779212 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:36:21.779212 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:36:21.779212 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:36:21.779212 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:36:21.779212 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:36:21.779212 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:36:21.779212 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:36:21.795890 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:36:21.795890 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:36:21.779212 => 11:36:21.795890
[0m11:36:21.795890 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:36:21.811530 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:36:21.794712 => 11:36:21.811530
[0m11:36:21.829562 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:36:21.829562 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:36:21.829562 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:36:21.829562 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:36:21.829562 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:36:21.829562 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:36:21.829562 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:36:21.829562 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:36:21.844757 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:36:21.862765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:21.862765 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:21.878247 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:36:21.878247 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:36:21.879641 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:36:21.879641 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:36:21.879641 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:36:21.895930 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:36:21.895930 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:36:21.902121 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:21.902121 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:36:21.902121 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:36:21.902121 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:21.912560 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:36:21.912560 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:36:21.912560 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:36:21.930369 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:21.930369 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:36:21.946148 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:36:21.950002 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:36:21.958670 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:21.963336 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:36:21.829562 => 11:36:21.963336
[0m11:36:21.963336 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:36:21.967701 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A7697050>]}
[0m11:36:21.967701 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:36:21.967701 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:36:21.967701 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.19s]
[0m11:36:21.967701 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:36:21.967701 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:36:21.967701 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:36:21.967701 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:36:21.967701 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:36:21.967701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:21.967701 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:36:21.967701 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:36:21.979409 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:36:21.977777 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:36:21.979409 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:36:21.979409 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:36:21.979409 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:36:21.979409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:36:21.979409 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:36:21.979409 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:36:21.979409 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:36:21.979409 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:36:21.979409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:21.979409 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:36:21.979409 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:36:21.995805 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:36:21.995805 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:36:21.979409 => 11:36:21.995805
[0m11:36:21.995805 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:36:21.979409 => 11:36:21.995805
[0m11:36:21.995805 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:36:21.995805 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:36:21.979409 => 11:36:21.995805
[0m11:36:21.995805 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:36:21.995805 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:36:21.995805 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:36:21.995805 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:36:21.995805 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:36:22.012657 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:36:22.012657 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:36:22.012657 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:36:22.012657 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:36:22.012657 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:36:22.012657 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:22.012657 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:36:22.012657 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:36:22.012657 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:36:22.028957 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:36:22.028957 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:36:22.028957 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:36:22.028957 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:36:22.028957 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:36:22.028957 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:36:22.028957 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:22.045563 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:36:21.795890 => 11:36:22.045563
[0m11:36:22.045563 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:36:22.045563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A7A658D0>]}
[0m11:36:22.045563 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.27s]
[0m11:36:22.045563 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:36:22.045563 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:22.045563 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:36:22.045563 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:36:22.045563 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:36:22.045563 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:36:22.061440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:36:22.062574 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:22.062574 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:36:22.069837 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:36:22.070374 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:22.073043 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:36:22.074118 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:36:22.074655 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:36:22.075188 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:36:22.080984 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:36:22.080984 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:36:22.070374 => 11:36:22.080984
[0m11:36:22.080984 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:36:22.080984 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:36:22.080984 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:36:22.145521 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.162762 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:36:22.162762 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:36:22.162762 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:36:22.170500 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:36:22.186394 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:36:22.190003 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:36:22.206772 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:36:22.208279 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:36:22.208986 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:36:22.210287 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:36:22.212809 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:36:22.215687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:22.217447 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.218234 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.228289 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:36:22.229975 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.233459 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:36:22.234577 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:36:22.240032 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:36:22.241607 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:36:22.243228 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:36:22.244351 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.245239 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:22.245777 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:36:22.249026 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:36:22.249562 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.250091 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:36:22.251194 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:36:22.253334 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:36:22.254423 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:36:22.254952 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:36:22.255477 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:36:22.256012 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:22.257088 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:36:22.257592 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:36:22.257592 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:22.267318 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:36:22.273343 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:36:22.273343 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:36:22.273343 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:22.273343 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:36:22.273343 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:36:22.278676 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:36:22.278676 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:36:22.278676 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:36:22.278676 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:36:22.278676 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:36:22.278676 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:36:22.278676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.278676 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:22.278676 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:36:22.278676 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:22.278676 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:22.278676 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:36:21.995805 => 11:36:22.278676
[0m11:36:22.278676 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:36:22.278676 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:36:21.995805 => 11:36:22.278676
[0m11:36:22.294336 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:36:22.012657 => 11:36:22.278676
[0m11:36:22.295355 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:36:22.295355 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:36:22.295355 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:36:22.295355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.295355 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A7A79A50>]}
[0m11:36:22.295355 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A7A795D0>]}
[0m11:36:22.295355 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A73CEC10>]}
[0m11:36:22.295355 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:36:22.295355 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.32s]
[0m11:36:22.295355 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.32s]
[0m11:36:22.295355 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:36:22.295355 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.32s]
[0m11:36:22.295355 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:36:22.295355 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:36:22.295355 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:36:22.295355 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:36:22.295355 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:36:22.295355 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:36:22.295355 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:36:22.295355 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:36:22.310985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:22.295355 [info ] [Thread-4 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:36:22.312004 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:36:22.313754 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m11:36:22.315662 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:36:22.315662 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_allowed_amount)
[0m11:36:22.315662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m11:36:22.315662 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:36:22.315662 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:36:22.315662 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:36:22.315662 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:36:22.315662 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:36:22.328344 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:36:22.333343 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:36:22.334785 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:36:22.334785 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:36:22.315662 => 11:36:22.334785
[0m11:36:22.334785 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:36:22.329383 => 11:36:22.334785
[0m11:36:22.334785 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:36:22.334785 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:36:22.334785 => 11:36:22.334785
[0m11:36:22.334785 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:36:22.347015 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:22.348014 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:36:22.348999 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:36:22.351656 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:36:22.351656 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:36:22.080984 => 11:36:22.351656
[0m11:36:22.351656 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:36:22.351656 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:36:22.351656 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:36:22.351656 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:36:22.351656 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:36:22.351656 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:36:22.361549 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:36:22.362548 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A74D93D0>]}
[0m11:36:22.363544 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:36:22.364231 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:36:22.364231 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:36:22.364231 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.32s]
[0m11:36:22.364231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:36:22.364231 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:36:22.364231 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:36:22.364231 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:36:22.364231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:36:22.364231 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:36:22.364231 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:36:22.364231 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:36:22.364231 => 11:36:22.364231
[0m11:36:22.364231 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:36:22.384026 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:36:22.384026 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:36:22.384026 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:36:22.384026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:22.384026 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:22.384026 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:22.384026 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:36:22.384026 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:36:22.384026 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:36:22.384026 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:36:22.384026 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:22.384026 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:36:22.384026 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:36:22.398851 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:36:22.404847 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:36:22.406208 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:36:22.406208 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:36:22.406208 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:36:22.412821 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.414591 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:36:22.421602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:22.422585 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:36:22.424371 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:36:22.424371 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:36:22.424371 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.424371 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:36:22.435340 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.435340 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:36:22.435340 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:36:22.441866 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:36:22.441866 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:36:22.441866 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:36:22.470048 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.471088 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:22.473074 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:36:22.475189 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:36:22.476047 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:36:22.476047 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:36:22.477053 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:36:22.478050 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:36:22.483759 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:36:22.484737 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:36:22.485735 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:36:22.496774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.512632 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:22.512632 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:36:22.512632 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:36:22.512632 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:22.512632 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:36:22.512632 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:36:22.512632 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:36:22.512632 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:36:22.351656 => 11:36:22.512632
[0m11:36:22.512632 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:36:22.512632 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.512632 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:36:22.512632 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:36:22.512632 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:36:22.512632 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:36:22.527168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A7995110>]}
[0m11:36:22.528746 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:36:22.528746 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.528746 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.21s]
[0m11:36:22.528746 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:36:22.528746 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:36:22.528746 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:36:22.528746 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:36:22.528746 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:22.528746 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:36:22.528746 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:36:22.528746 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:36:22.528746 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:22.544374 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:22.544949 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:36:22.348999 => 11:36:22.528746
[0m11:36:22.545395 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:22.548576 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:36:22.548576 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:36:22.548576 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:36:22.548576 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:36:22.548576 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A7B67990>]}
[0m11:36:22.548576 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:36:22.548576 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:36:22.548576 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:36:22.548576 [info ] [Thread-4 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.23s]
[0m11:36:22.561463 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:36:22.563719 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:22.563719 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:22.563719 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:36:22.364231 => 11:36:22.563719
[0m11:36:22.563719 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:36:22.334785 => 11:36:22.563719
[0m11:36:22.563719 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:36:22.563719 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:36:22.563719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A7B678D0>]}
[0m11:36:22.563719 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A7B65410>]}
[0m11:36:22.563719 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.20s]
[0m11:36:22.563719 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:36:22.563719 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.25s]
[0m11:36:22.578086 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:36:22.579078 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:36:22.580079 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:36:22.582085 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:36:22.583084 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:36:22.584061 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:36:22.584061 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:36:22.583084 => 11:36:22.584061
[0m11:36:22.584061 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:36:22.584061 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:36:22.584061 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:36:22.584061 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:36:22.594892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:36:22.630875 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:36:22.630875 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:36:22.630875 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
)

SELECT
  f.diagnosis_1_key,
  d1.category_code as diagnosis_1_category_code,
  d1.diagnosis_code as diagnosis_1_diagnosis_code,
  d1.full_description as diagnosis_1_full_description,
  d1.category_title as diagnosis_1_category_title,
  
  f.diagnosis_2_key,
  d2.category_code as diagnosis_2_category_code,
  d2.diagnosis_code as diagnosis_2_diagnosis_code,
  d2.full_description as diagnosis_2_full_description,
  d2.category_title as diagnosis_2_category_title,
  
  f.diagnosis_3_key,
  d3.category_code as diagnosis_3_category_code,
  d3.diagnosis_code as diagnosis_3_diagnosis_code,
  d3.full_description as diagnosis_3_full_description,
  d3.category_title as diagnosis_3_category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
  );
  
[0m11:36:23.234835 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 1.0 seconds
[0m11:36:23.234835 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:36:23.234835 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m11:36:23.234835 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:23.245347 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:36:23.245347 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m11:36:23.245347 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:36:23.245347 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:36:23.245347 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:36:23.245347 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:36:23.261610 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:36:23.262627 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m11:36:23.262627 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:36:23.262627 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m11:36:23.262627 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:36:23.262627 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:36:22.584061 => 11:36:23.262627
[0m11:36:23.262627 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:36:23.262627 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'facb977d-5b74-49e7-821f-8dae98c0e775', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A7B0C790>]}
[0m11:36:23.262627 [info ] [Thread-2 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 1000[0m in 0.68s]
[0m11:36:23.262627 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:36:23.280318 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:23.280318 [debug] [MainThread]: On master: BEGIN
[0m11:36:23.280318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:23.320317 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:36:23.329241 [debug] [MainThread]: On master: COMMIT
[0m11:36:23.329603 [debug] [MainThread]: Using postgres connection "master"
[0m11:36:23.329603 [debug] [MainThread]: On master: COMMIT
[0m11:36:23.338117 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:36:23.338117 [debug] [MainThread]: On master: Close
[0m11:36:23.338117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:23.338117 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:36:23.338117 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:36:23.338117 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:36:23.338117 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:36:23.338117 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:36:23.338117 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:36:23.338117 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m11:36:23.338117 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:36:23.338117 [info ] [MainThread]: 
[0m11:36:23.338117 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m11:36:23.348068 [debug] [MainThread]: Command end result
[0m11:36:23.359109 [info ] [MainThread]: 
[0m11:36:23.361890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:23.363893 [info ] [MainThread]: 
[0m11:36:23.364893 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:36:23.366892 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:23.366892 after 2.21 seconds
[0m11:36:23.368713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A4D36A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A4D36910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5A4D36B90>]}
[0m11:36:23.368881 [debug] [MainThread]: Flushing usage events
[0m11:49:34.942915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E954826D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9548E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9548E050>]}


============================== 11:49:34.942915 | 4a621c2c-31e4-4d56-80fd-db1590fab212 ==============================
[0m11:49:34.942915 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:49:34.942915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:49:35.057980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E955E2750>]}
[0m11:49:35.119170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E955C5C50>]}
[0m11:49:35.120167 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:49:35.128352 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:49:35.177803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:49:35.177803 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:49:35.254194 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:49:35.254194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E956CE150>]}
[0m11:49:35.278172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95ADD850>]}
[0m11:49:35.278172 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:49:35.278172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95A54E50>]}
[0m11:49:35.278172 [info ] [MainThread]: 
[0m11:49:35.278172 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:49:35.278172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:49:35.278172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:49:35.293253 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:49:35.294522 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:49:35.294522 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:49:35.294522 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:49:35.294522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:35.294522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:35.313176 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:49:35.313176 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:49:35.313176 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:49:35.313176 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:49:35.313176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:49:35.313176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:49:35.313176 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:49:35.326535 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:49:35.326535 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:49:35.327536 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:49:35.327536 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:35.328535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:35.338820 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.338820 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.338820 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:49:35.342964 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:49:35.344158 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:49:35.344158 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:49:35.344158 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:49:35.344158 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:49:35.344158 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:49:35.344158 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:49:35.344158 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:49:35.344158 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:49:35.344158 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:35.344158 [debug] [MainThread]: On master: BEGIN
[0m11:49:35.344158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:49:35.383999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.384998 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:35.384998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:49:35.388999 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:49:35.389999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E956FE3D0>]}
[0m11:49:35.391019 [debug] [MainThread]: On master: ROLLBACK
[0m11:49:35.391998 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:35.392662 [debug] [MainThread]: On master: BEGIN
[0m11:49:35.393663 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.394690 [debug] [MainThread]: On master: COMMIT
[0m11:49:35.394690 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:35.394690 [debug] [MainThread]: On master: COMMIT
[0m11:49:35.395664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.395664 [debug] [MainThread]: On master: Close
[0m11:49:35.396664 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:49:35.397668 [info ] [MainThread]: 
[0m11:49:35.401682 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:49:35.402677 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:49:35.403664 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:49:35.405151 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:49:35.403664 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:49:35.405151 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:49:35.406156 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:49:35.411353 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:49:35.411759 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:49:35.411759 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:49:35.406156 => 11:49:35.411759
[0m11:49:35.411759 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:49:35.411759 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:49:35.411759 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:49:35.411759 => 11:49:35.411759
[0m11:49:35.438765 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:49:35.442243 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:49:35.446828 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:49:35.446828 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:49:35.446828 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:49:35.446828 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:49:35.446828 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:49:35.446828 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:49:35.446828 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:49:35.460993 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.460993 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.460993 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:49:35.475504 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:49:35.476641 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:49:35.477128 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:49:35.477128 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:49:35.493261 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:49:35.493693 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:49:35.495694 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.497697 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:49:35.498697 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:49:35.499694 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.520281 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:49:35.520836 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:49:35.521870 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:49:35.539920 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.543202 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:49:35.543202 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:49:35.543202 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:49:35.560336 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:35.560336 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:49:35.443246 => 11:49:35.560336
[0m11:49:35.560336 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:49:35.560336 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E959FFE90>]}
[0m11:49:35.560336 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.16s]
[0m11:49:35.560336 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:49:35.560336 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:49:35.560336 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:49:35.560336 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:49:35.575971 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:49:35.575971 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:49:35.575971 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:49:35.575971 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:49:35.579142 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:49:35.579789 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:49:35.580797 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:49:35.581978 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:49:35.581978 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:49:35.581978 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:49:35.581978 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:49:35.588588 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:49:35.588588 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:49:35.592250 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:49:35.581978 => 11:49:35.588588
[0m11:49:35.595377 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:49:35.596963 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:49:35.597035 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:49:35.581978 => 11:49:35.597035
[0m11:49:35.597552 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:49:35.598075 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:49:35.592250 => 11:49:35.598075
[0m11:49:35.598596 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:49:35.602227 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:49:35.602785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.602785 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:49:35.605961 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:49:35.607037 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:49:35.608888 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:49:35.612655 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:49:35.612655 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:49:35.612655 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:49:35.612655 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:49:35.612655 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:49:35.612655 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:49:35.612655 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:49:35.612655 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:49:35.612655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.612655 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:49:35.612655 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:49:35.612655 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:49:35.612655 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:49:35.612655 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:49:35.639066 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.639066 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.639066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.639066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.639066 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:49:35.639066 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:49:35.642191 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:49:35.643876 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:49:35.643876 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:49:35.643876 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:49:35.643876 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:49:35.643876 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:49:35.643876 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:49:35.643876 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:35.643876 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:49:35.411759 => 11:49:35.643876
[0m11:49:35.643876 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:49:35.643876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E958C4F10>]}
[0m11:49:35.643876 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:49:35.643876 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.24s]
[0m11:49:35.660534 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:49:35.660534 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:49:35.661534 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:49:35.662534 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:49:35.662534 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:49:35.665555 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:49:35.666537 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:49:35.712305 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:49:35.712305 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.712305 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:49:35.712305 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:49:35.712305 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:49:35.712305 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:49:35.712305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:49:35.712305 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:49:35.712305 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:49:35.712305 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.712305 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.712305 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:49:35.712305 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.725492 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:49:35.728127 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:49:35.728127 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:49:35.712305 => 11:49:35.728127
[0m11:49:35.728127 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:49:35.728127 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:49:35.728127 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:49:35.728127 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:49:35.728127 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:49:35.728127 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:49:35.728127 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.728127 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.728127 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:49:35.728127 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:49:35.739164 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:49:35.739164 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:49:35.739164 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:49:35.739164 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:49:35.742883 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:49:35.742883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:35.743885 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:49:35.743885 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:49:35.744882 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.746759 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:49:35.746759 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.746759 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.746759 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:49:35.746759 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:49:35.746759 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:49:35.758877 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:49:35.760876 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:49:35.761960 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:49:35.761960 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:49:35.761960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.761960 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:49:35.761960 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:49:35.761960 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:35.761960 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:49:35.761960 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:49:35.603315 => 11:49:35.761960
[0m11:49:35.761960 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:35.761960 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:49:35.761960 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:35.761960 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:49:35.609888 => 11:49:35.761960
[0m11:49:35.761960 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95A91D10>]}
[0m11:49:35.776559 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:49:35.599123 => 11:49:35.775554
[0m11:49:35.777556 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:49:35.778553 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:49:35.778553 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.18s]
[0m11:49:35.779346 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:49:35.779346 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95873990>]}
[0m11:49:35.779346 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:49:35.779346 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:49:35.779346 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95B5DC10>]}
[0m11:49:35.779346 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:49:35.779346 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.20s]
[0m11:49:35.779346 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:49:35.779346 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.20s]
[0m11:49:35.779346 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:49:35.779346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.779346 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:49:35.779346 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:49:35.779346 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:49:35.793764 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:49:35.794763 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m11:49:35.795765 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:49:35.796503 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:49:35.796503 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:49:35.796503 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:49:35.796503 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:49:35.796503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m11:49:35.796503 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:49:35.796503 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.796503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m11:49:35.796503 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:49:35.796503 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:49:35.796503 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:49:35.796503 => 11:49:35.796503
[0m11:49:35.796503 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:49:35.796503 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:49:35.796503 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:49:35.796503 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:49:35.810413 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:49:35.811419 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:49:35.796503 => 11:49:35.811419
[0m11:49:35.811419 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:49:35.813550 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:49:35.813550 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:49:35.813550 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:49:35.796503 => 11:49:35.813550
[0m11:49:35.813550 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:49:35.813550 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:49:35.813550 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.813550 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:49:35.813550 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:49:35.813550 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:49:35.826473 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:49:35.829494 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:49:35.829494 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:49:35.829494 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:49:35.829494 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:49:35.829494 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:49:35.829494 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:49:35.829494 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:49:35.829494 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:49:35.829494 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:49:35.839001 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:35.839001 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:49:35.728127 => 11:49:35.839001
[0m11:49:35.839001 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:49:35.842296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95A2F550>]}
[0m11:49:35.843294 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.13s]
[0m11:49:35.845294 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:49:35.845294 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:49:35.847025 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:49:35.847025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:49:35.847025 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:49:35.847025 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:49:35.847025 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:49:35.847025 => 11:49:35.847025
[0m11:49:35.847025 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:49:35.847025 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:49:35.847025 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:49:35.847025 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:49:35.847025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:49:35.859776 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.859776 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.860777 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.861207 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:49:35.861207 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:49:35.861207 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:49:35.861207 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:49:35.861207 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:49:35.861207 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:49:35.861207 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:49:35.861207 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:49:35.861207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:35.877589 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:49:35.880019 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:49:35.880019 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:49:35.880019 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:49:35.880019 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:49:35.880019 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:49:35.880019 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.880019 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.888530 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:49:35.888530 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:49:35.892422 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:49:35.892928 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:49:35.894940 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.895937 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.896795 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:49:35.896795 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:49:35.896795 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:49:35.896795 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:49:35.896795 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:49:35.896795 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:49:35.896795 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:49:35.896795 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:49:35.896795 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:49:35.913398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.925663 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.927981 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:49:35.927981 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.927981 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:49:35.927981 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:49:35.927981 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:49:35.927981 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:49:35.927981 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:49:35.927981 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:49:35.927981 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:49:35.927981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.939007 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:49:35.939007 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:49:35.939007 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:49:35.967039 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:35.968035 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:35.971035 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:49:35.827470 => 11:49:35.970035
[0m11:49:35.974033 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:49:35.975033 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:49:35.975033 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:49:35.977222 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:49:35.977222 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:49:35.977222 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:35.977222 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95B5C550>]}
[0m11:49:35.977222 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:49:35.977222 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:49:35.992288 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:49:35.813550 => 11:49:35.992288
[0m11:49:35.993288 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.18s]
[0m11:49:35.995288 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:49:35.996286 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:49:35.997302 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:35.997302 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95A53150>]}
[0m11:49:35.997302 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:49:36.011202 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:49:36.009190 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.20s]
[0m11:49:36.012185 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:36.013233 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:49:36.014267 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:36.016083 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:49:35.847025 => 11:49:36.016083
[0m11:49:36.018744 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:49:36.019762 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:49:36.020816 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:49:36.025304 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E9578FE50>]}
[0m11:49:36.026719 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:49:36.027767 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.18s]
[0m11:49:36.029769 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:49:36.034270 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:36.040168 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:49:36.042671 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:49:36.045830 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:49:36.060642 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:36.064822 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:49:35.812412 => 11:49:36.064291
[0m11:49:36.065875 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:49:36.067558 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E956D8B50>]}
[0m11:49:36.068565 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.27s]
[0m11:49:36.070567 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:49:36.072568 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:49:36.073565 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:49:36.075574 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:49:36.076891 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:49:36.076891 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:49:36.076891 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:49:36.076891 => 11:49:36.076891
[0m11:49:36.076891 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:49:36.076891 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:49:36.076891 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:49:36.076891 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:49:36.092645 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:49:36.116948 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:49:36.125644 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:49:36.125644 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
)

SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
  );
  
[0m11:49:36.197427 [debug] [Thread-4 (]: SQL status: SELECT 3000 in 0.0 seconds
[0m11:49:36.200430 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:49:36.201429 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m11:49:36.202598 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:36.214520 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:49:36.215519 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m11:49:36.217517 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:49:36.219522 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:49:36.220520 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:49:36.221521 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:49:36.234573 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:49:36.237572 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m11:49:36.238572 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:49:36.238572 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m11:49:36.248154 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:49:36.250156 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:49:36.076891 => 11:49:36.250156
[0m11:49:36.250156 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:49:36.251152 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a621c2c-31e4-4d56-80fd-db1590fab212', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95B57E10>]}
[0m11:49:36.253156 [info ] [Thread-4 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 3000[0m in 0.18s]
[0m11:49:36.255154 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:49:36.261364 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:36.264360 [debug] [MainThread]: On master: BEGIN
[0m11:49:36.266152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:49:36.302632 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:49:36.303635 [debug] [MainThread]: On master: COMMIT
[0m11:49:36.303635 [debug] [MainThread]: Using postgres connection "master"
[0m11:49:36.303635 [debug] [MainThread]: On master: COMMIT
[0m11:49:36.305555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:49:36.305555 [debug] [MainThread]: On master: Close
[0m11:49:36.305555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:36.305555 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:49:36.305555 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:49:36.305555 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:49:36.309076 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:49:36.309076 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:49:36.310120 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m11:49:36.310640 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:49:36.310640 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:49:36.311647 [info ] [MainThread]: 
[0m11:49:36.312672 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m11:49:36.315659 [debug] [MainThread]: Command end result
[0m11:49:36.327356 [info ] [MainThread]: 
[0m11:49:36.327356 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:49:36.327356 [info ] [MainThread]: 
[0m11:49:36.327356 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:49:36.327356 [debug] [MainThread]: Command `dbt run` succeeded at 11:49:36.327356 after 1.43 seconds
[0m11:49:36.327356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E94F85810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E95066DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E8EA9F910>]}
[0m11:49:36.327356 [debug] [MainThread]: Flushing usage events
[0m11:53:24.371528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8511650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F84ED590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F84EE050>]}


============================== 11:53:24.387149 | ecb6c286-173c-45cd-a9e4-1fb6c738d1eb ==============================
[0m11:53:24.387149 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:53:24.387149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:53:24.502581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F869E150>]}
[0m11:53:24.556220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8625E90>]}
[0m11:53:24.556220 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:53:24.556220 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:53:24.621592 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:24.621592 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:53:24.707273 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:53:24.712332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8840790>]}
[0m11:53:24.721412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8A9D0D0>]}
[0m11:53:24.721412 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:53:24.721412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8AB84D0>]}
[0m11:53:24.721412 [info ] [MainThread]: 
[0m11:53:24.721412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:24.721412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:53:24.721412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:53:24.737863 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:53:24.737863 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:53:24.737863 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:53:24.737863 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:53:24.737863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:24.737863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:24.754417 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:53:24.754417 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:53:24.754417 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:53:24.754417 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:53:24.754417 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:53:24.769963 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:53:24.770842 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:53:24.770842 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:53:24.770842 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:53:24.770842 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:53:24.770842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:24.770842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:24.788400 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:53:24.788400 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:53:24.788400 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:53:24.788400 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:53:24.788400 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:53:24.795428 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:53:24.795428 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:53:24.795428 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:53:24.795428 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:53:24.795428 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:53:24.803324 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:53:24.804162 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:53:24.810208 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:24.810208 [debug] [MainThread]: On master: BEGIN
[0m11:53:24.810208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:24.846965 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:24.846965 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:24.847971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:53:24.851933 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:53:24.853047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8794950>]}
[0m11:53:24.853047 [debug] [MainThread]: On master: ROLLBACK
[0m11:53:24.853879 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:24.853879 [debug] [MainThread]: On master: BEGIN
[0m11:53:24.855918 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:24.855918 [debug] [MainThread]: On master: COMMIT
[0m11:53:24.855918 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:24.856986 [debug] [MainThread]: On master: COMMIT
[0m11:53:24.857923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:53:24.857923 [debug] [MainThread]: On master: Close
[0m11:53:24.858931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:24.859881 [info ] [MainThread]: 
[0m11:53:24.866295 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:53:24.867296 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:53:24.868297 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:53:24.870993 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:53:24.868953 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:53:24.871999 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:53:24.872789 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:53:24.873214 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:53:24.873214 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:53:24.873214 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:53:24.873214 => 11:53:24.873214
[0m11:53:24.873214 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:24.886680 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:53:24.910510 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:53:24.910510 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:24.910510 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:53:24.910510 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:53:24.873214 => 11:53:24.910510
[0m11:53:24.910510 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:53:24.910510 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:53:24.920094 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:24.921161 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:24.921161 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:53:24.922129 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:53:24.924355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:24.924355 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:24.924355 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:53:24.938631 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:24.938631 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:24.938631 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:53:24.960170 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:53:24.960170 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:24.960170 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:53:24.971101 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:24.974163 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:24.974163 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:53:24.976301 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:24.989293 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:53:24.989293 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:24.990238 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:53:25.010611 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.010611 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:53:25.010611 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:25.010611 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:53:25.031759 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.031759 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:53:25.031759 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:53:24.910510 => 11:53:25.031759
[0m11:53:25.031759 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:25.031759 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:53:25.047392 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:53:25.047392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8BBB190>]}
[0m11:53:25.047392 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.18s]
[0m11:53:25.047392 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:53:25.047392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.047392 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:53:25.047392 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:53:25.047392 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:53:25.047392 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:25.047392 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:53:25.047392 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:53:25.047392 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:53:25.057629 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:53:25.047392 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:53:25.058632 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:53:25.059828 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:53:25.059828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.059828 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:53:25.059828 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:53:25.059828 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:53:25.059828 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:53:25.059828 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:53:25.059828 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:53:25.059828 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:25.070557 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:53:25.071558 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:53:25.059828 => 11:53:25.071558
[0m11:53:25.072544 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:53:25.073050 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:53:25.059828 => 11:53:25.073050
[0m11:53:25.073050 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:53:25.073050 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:53:25.059828 => 11:53:25.073050
[0m11:53:25.073050 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:53:25.073050 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:53:25.073050 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:53:25.073050 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:53:25.073050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.086757 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:25.086757 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:53:25.089761 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:53:25.090699 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:25.090699 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:53:25.090699 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:25.090699 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:25.090699 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:53:25.090699 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:53:25.090699 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:53:25.090699 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:53:25.090699 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:53:25.090699 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:25.090699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.090699 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:53:24.886680 => 11:53:25.090699
[0m11:53:25.090699 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:53:25.090699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8B0BFD0>]}
[0m11:53:25.104196 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.22s]
[0m11:53:25.106443 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:53:25.106443 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:53:25.106443 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:53:25.110453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:53:25.110453 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:53:25.110453 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:25.110453 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:53:25.110453 => 11:53:25.110453
[0m11:53:25.110453 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:53:25.121013 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:25.121013 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.122010 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.123011 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:25.123011 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:25.124217 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:25.124217 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.124217 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:53:25.124217 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:53:25.124217 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:53:25.124217 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:25.124217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:25.124217 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:53:25.124217 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:53:25.173015 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:53:25.173015 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:53:25.173015 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:25.186758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.187780 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:25.188722 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:25.188722 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:53:25.188722 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:25.188722 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:53:25.188722 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:53:25.188722 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:53:25.188722 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.188722 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:25.188722 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.188722 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.188722 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:53:25.188722 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:25.188722 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:53:25.205317 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:25.205317 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:53:25.208331 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:25.208331 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.208331 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:53:25.209334 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:53:25.210319 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:53:25.211318 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.211318 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:25.214320 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:53:25.214320 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.214320 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.215317 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:53:25.215317 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:25.216315 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:53:25.218337 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:25.219332 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:53:25.219332 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:25.220426 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:53:25.220426 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:53:25.222428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.224427 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:53:25.224427 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.224427 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.225427 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.225427 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:25.227431 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:53:25.229443 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:53:25.232427 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:53:25.232427 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:53:25.233430 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:25.233430 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:25.234452 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:25.235428 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:53:25.235428 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:53:25.236428 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:53:25.237505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.237505 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:53:25.237505 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.237505 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:25.237505 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.237505 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.237505 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:53:25.073050 => 11:53:25.237505
[0m11:53:25.237505 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:53:25.237505 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:53:25.073050 => 11:53:25.237505
[0m11:53:25.237505 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:53:25.073050 => 11:53:25.237505
[0m11:53:25.237505 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:53:25.237505 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:53:25.237505 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:53:25.237505 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8AD87D0>]}
[0m11:53:25.237505 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8BAD910>]}
[0m11:53:25.237505 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8A94F50>]}
[0m11:53:25.237505 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.237505 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.18s]
[0m11:53:25.237505 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.18s]
[0m11:53:25.253135 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:53:25.110453 => 11:53:25.253135
[0m11:53:25.237505 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.18s]
[0m11:53:25.253135 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:53:25.253135 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:53:25.253135 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:53:25.253135 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:53:25.253135 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:53:25.253135 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8B07C50>]}
[0m11:53:25.253135 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:53:25.253135 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:53:25.253135 [info ] [Thread-4 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:53:25.253135 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.14s]
[0m11:53:25.253135 [info ] [Thread-3 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:53:25.261099 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.dim_diagnosis)
[0m11:53:25.260573 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:53:25.262104 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:53:25.263184 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_allowed_amount)
[0m11:53:25.263184 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:53:25.263184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m11:53:25.263184 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:53:25.263184 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:53:25.263184 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:53:25.263184 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:53:25.271656 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:53:25.263184 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:53:25.272325 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:53:25.272325 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:53:25.263184 => 11:53:25.272325
[0m11:53:25.272325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:53:25.272325 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:53:25.263184 => 11:53:25.272325
[0m11:53:25.272325 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:53:25.272325 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:53:25.272325 => 11:53:25.272325
[0m11:53:25.272325 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:53:25.272325 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:53:25.272325 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:53:25.272325 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:53:25.272325 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:25.286619 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:53:25.290279 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:53:25.290895 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:25.290895 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:53:25.272325 => 11:53:25.290895
[0m11:53:25.290895 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:25.290895 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:53:25.290895 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:25.290895 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:53:25.290895 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:53:25.290895 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:53:25.290895 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:53:25.290895 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:25.290895 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:53:25.290895 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:25.290895 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:25.290895 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:53:25.290895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:25.310651 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.310651 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.310651 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.310651 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:25.310651 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:25.310651 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:25.310651 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:53:25.310651 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:53:25.310651 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:53:25.322321 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:53:25.322321 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:53:25.322321 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:25.322321 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:25.322321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.322321 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:53:25.322321 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:53:25.322321 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:25.337646 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:53:25.338994 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.338994 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.338994 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:25.344506 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:25.344506 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:53:25.344506 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:53:25.344506 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:53:25.344506 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:25.344506 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:53:25.358344 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.358344 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.359344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.360348 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:53:25.362344 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:53:25.365343 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:25.365343 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:25.366344 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:25.366344 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:53:25.367345 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:53:25.367345 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:53:25.403081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.403081 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.403081 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:53:25.403081 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.410600 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:53:25.410600 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:25.410600 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:53:25.410600 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:25.410600 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:53:25.410600 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:25.417002 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:53:25.417002 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:53:25.426011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.426011 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:53:25.426011 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:25.426011 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:53:25.426011 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.426011 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:53:25.272325 => 11:53:25.426011
[0m11:53:25.426011 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:53:25.426011 [debug] [Thread-4 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:53:25.441652 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F88F2110>]}
[0m11:53:25.441652 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:25.441652 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:53:25.441652 [info ] [Thread-3 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.18s]
[0m11:53:25.441652 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:53:25.441652 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.441652 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.441652 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:53:25.287757 => 11:53:25.441652
[0m11:53:25.441652 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:25.441652 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.441652 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:53:25.441652 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:53:25.441652 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:53:25.290895 => 11:53:25.441652
[0m11:53:25.441652 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8CA3B50>]}
[0m11:53:25.441652 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:53:25.457271 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.458715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8782850>]}
[0m11:53:25.457271 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.18s]
[0m11:53:25.460611 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:53:25.461989 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:53:25.461989 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.19s]
[0m11:53:25.461989 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:25.461989 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:53:25.461989 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:53:25.461989 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.470005 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:53:25.471007 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:25.471007 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:53:25.472314 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.472314 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:53:25.272325 => 11:53:25.472314
[0m11:53:25.472314 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:53:25.472314 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8B9E3D0>]}
[0m11:53:25.472314 [info ] [Thread-4 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.21s]
[0m11:53:25.472314 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:53:25.472314 [debug] [Thread-3 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:53:25.472314 [info ] [Thread-3 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:53:25.472314 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:53:25.472314 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:53:25.486679 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:53:25.487680 [debug] [Thread-3 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:53:25.472314 => 11:53:25.487680
[0m11:53:25.488679 [debug] [Thread-3 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:53:25.490984 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:53:25.490984 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:25.490984 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:53:25.490984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:53:25.506001 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.507006 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:25.507006 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (

SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

select 
    diagnosis_key,
    category_title,
    count(*) as count
from 
    analysis
group by
    diagnosis_key,
    category_title
  );
  
[0m11:53:25.555804 [debug] [Thread-3 (]: SQL status: SELECT 2061 in 0.0 seconds
[0m11:53:25.555804 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:25.555804 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m11:53:25.555804 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.555804 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:25.555804 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m11:53:25.555804 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:25.555804 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:53:25.555804 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:25.555804 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:53:25.570430 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.572450 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m11:53:25.573445 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:25.573445 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m11:53:25.577429 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:25.578433 [debug] [Thread-3 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:53:25.488679 => 11:53:25.578433
[0m11:53:25.579433 [debug] [Thread-3 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:53:25.579433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecb6c286-173c-45cd-a9e4-1fb6c738d1eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F8C67D50>]}
[0m11:53:25.580434 [info ] [Thread-3 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 2061[0m in 0.11s]
[0m11:53:25.581434 [debug] [Thread-3 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:53:25.583429 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:25.583429 [debug] [MainThread]: On master: BEGIN
[0m11:53:25.583429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:53:25.614636 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:25.614636 [debug] [MainThread]: On master: COMMIT
[0m11:53:25.614636 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:25.614636 [debug] [MainThread]: On master: COMMIT
[0m11:53:25.614636 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:53:25.614636 [debug] [MainThread]: On master: Close
[0m11:53:25.614636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:25.614636 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:53:25.614636 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:53:25.619990 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:53:25.619990 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:53:25.619990 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:53:25.619990 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m11:53:25.620992 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:53:25.620992 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:53:25.621989 [info ] [MainThread]: 
[0m11:53:25.622620 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m11:53:25.622620 [debug] [MainThread]: Command end result
[0m11:53:25.622620 [info ] [MainThread]: 
[0m11:53:25.622620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:25.622620 [info ] [MainThread]: 
[0m11:53:25.622620 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:53:25.636628 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:25.636628 after 1.29 seconds
[0m11:53:25.637630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F812A590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F1A6F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F1A6C4D0>]}
[0m11:53:25.637630 [debug] [MainThread]: Flushing usage events
[0m11:53:57.566509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC063CB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC00F5BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC05F1FD0>]}


============================== 11:53:57.566509 | 0a7530f4-d69e-45c2-b2ae-34987064a2c5 ==============================
[0m11:53:57.566509 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:53:57.566509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:53:57.683730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC07B14D0>]}
[0m11:53:57.738713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0735B90>]}
[0m11:53:57.738713 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m11:53:57.747014 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:53:57.802688 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:57.803964 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m11:53:57.877979 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m11:53:57.890162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC09166D0>]}
[0m11:53:57.900348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0C483D0>]}
[0m11:53:57.900348 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m11:53:57.900348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC08DC550>]}
[0m11:53:57.903758 [info ] [MainThread]: 
[0m11:53:57.903758 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:57.903758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:53:57.903758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m11:53:57.908386 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:53:57.908386 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m11:53:57.908386 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:53:57.908386 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m11:53:57.908386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:57.908386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:57.921156 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:53:57.921156 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:53:57.921156 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:53:57.936900 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m11:53:57.937609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m11:53:57.937609 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m11:53:57.937609 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:53:57.937609 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:53:57.937609 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m11:53:57.937609 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m11:53:57.937609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:57.937609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:57.954680 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:53:57.954680 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:53:57.954680 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m11:53:57.954680 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m11:53:57.954680 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m11:53:57.954680 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m11:53:57.954680 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:53:57.969898 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:53:57.970896 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m11:53:57.973030 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m11:53:57.973030 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m11:53:57.973030 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m11:53:57.973030 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:57.973030 [debug] [MainThread]: On master: BEGIN
[0m11:53:57.973030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:57.996943 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:57.996943 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:57.997944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:53:58.000944 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:53:58.002887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC09E3BD0>]}
[0m11:53:58.003446 [debug] [MainThread]: On master: ROLLBACK
[0m11:53:58.004445 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:58.004445 [debug] [MainThread]: On master: BEGIN
[0m11:53:58.007444 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.007444 [debug] [MainThread]: On master: COMMIT
[0m11:53:58.007444 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:58.007444 [debug] [MainThread]: On master: COMMIT
[0m11:53:58.008446 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.009445 [debug] [MainThread]: On master: Close
[0m11:53:58.009445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:53:58.010445 [info ] [MainThread]: 
[0m11:53:58.013446 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m11:53:58.014444 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m11:53:58.014444 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m11:53:58.016340 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m11:53:58.015445 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m11:53:58.016851 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m11:53:58.016851 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m11:53:58.020202 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m11:53:58.020202 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m11:53:58.020202 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:58.020202 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 11:53:58.016851 => 11:53:58.020202
[0m11:53:58.020202 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m11:53:58.036103 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 11:53:58.020202 => 11:53:58.035831
[0m11:53:58.038360 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m11:53:58.052641 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m11:53:58.055163 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:58.055163 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:58.055163 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m11:53:58.055163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:53:58.055163 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:58.055163 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m11:53:58.055163 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:53:58.071072 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.071072 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.071072 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:58.071072 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:58.071072 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m11:53:58.071072 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m11:53:58.096276 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:53:58.100835 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:58.100835 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m11:53:58.103834 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.106134 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:58.106134 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m11:53:58.108112 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.119294 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:53:58.119294 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:58.119294 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m11:53:58.134927 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.134927 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m11:53:58.134927 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m11:53:58.134927 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m11:53:58.156081 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.156081 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 11:53:58.053654 => 11:53:58.156081
[0m11:53:58.156081 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m11:53:58.171745 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0BDC950>]}
[0m11:53:58.171745 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.15s]
[0m11:53:58.173965 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m11:53:58.173965 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m11:53:58.173965 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m11:53:58.173965 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m11:53:58.173965 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m11:53:58.173965 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:53:58.173965 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m11:53:58.173965 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m11:53:58.173965 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m11:53:58.181046 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:58.181046 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m11:53:58.184552 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m11:53:58.184552 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m11:53:58.185866 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m11:53:58.185866 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m11:53:58.187382 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m11:53:58.187382 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m11:53:58.187382 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m11:53:58.187382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.187382 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 11:53:58.186866 => 11:53:58.187382
[0m11:53:58.187382 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m11:53:58.187382 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 11:53:58.187382 => 11:53:58.187382
[0m11:53:58.187382 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:58.187382 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m11:53:58.187382 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m11:53:58.187382 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 11:53:58.187382 => 11:53:58.187382
[0m11:53:58.187382 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m11:53:58.203633 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m11:53:58.204382 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m11:53:58.204382 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m11:53:58.204382 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:58.204382 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:58.204382 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.204382 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m11:53:58.204382 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m11:53:58.204382 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m11:53:58.204382 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:53:58.204382 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:58.204382 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:53:58.204382 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:53:58.204382 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:58.204382 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m11:53:58.204382 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m11:53:58.204382 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:58.222495 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.237843 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:58.238844 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.239916 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m11:53:58.239916 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:58.239916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.239916 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.239916 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m11:53:58.239916 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m11:53:58.239916 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:58.239916 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m11:53:58.239916 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m11:53:58.239916 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m11:53:58.239916 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:53:58.254591 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:58.254591 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m11:53:58.255590 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.256591 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.257588 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 11:53:58.020202 => 11:53:58.257588
[0m11:53:58.261588 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:58.261588 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:53:58.262589 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m11:53:58.262589 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m11:53:58.262589 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m11:53:58.286946 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:58.302577 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:58.302577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0D19050>]}
[0m11:53:58.302577 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m11:53:58.302577 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m11:53:58.302577 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.302577 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.29s]
[0m11:53:58.302577 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:53:58.302577 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.302577 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.302577 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m11:53:58.302577 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:58.302577 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:58.319565 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:58.320204 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:53:58.320204 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m11:53:58.320204 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m11:53:58.320204 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m11:53:58.320204 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m11:53:58.320204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m11:53:58.320204 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.320204 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.320204 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m11:53:58.320204 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:53:58.320204 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.320204 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:53:58.320204 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:58.320204 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:58.320204 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m11:53:58.320204 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:58.320204 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m11:53:58.320204 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 11:53:58.320204 => 11:53:58.320204
[0m11:53:58.335872 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m11:53:58.336874 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m11:53:58.337795 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m11:53:58.337795 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m11:53:58.337795 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:58.337795 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.337795 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.337795 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:58.337795 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m11:53:58.337795 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m11:53:58.337795 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.337795 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m11:53:58.337795 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m11:53:58.337795 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m11:53:58.337795 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 11:53:58.204382 => 11:53:58.337795
[0m11:53:58.337795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:58.337795 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m11:53:58.337795 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m11:53:58.352493 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m11:53:58.354795 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0751CD0>]}
[0m11:53:58.354795 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.17s]
[0m11:53:58.354795 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m11:53:58.354795 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.354795 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.354795 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m11:53:58.354795 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 11:53:58.204382 => 11:53:58.354795
[0m11:53:58.354795 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 11:53:58.187382 => 11:53:58.354795
[0m11:53:58.354795 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m11:53:58.354795 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m11:53:58.354795 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m11:53:58.354795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0C48050>]}
[0m11:53:58.354795 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m11:53:58.354795 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0C13590>]}
[0m11:53:58.354795 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m11:53:58.354795 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.17s]
[0m11:53:58.354795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.371187 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m11:53:58.369197 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.18s]
[0m11:53:58.371187 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m11:53:58.371187 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:58.371187 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 11:53:58.370195 => 11:53:58.371187
[0m11:53:58.371187 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m11:53:58.371187 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m11:53:58.371187 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m11:53:58.371187 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m11:53:58.371187 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m11:53:58.371187 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m11:53:58.371187 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m11:53:58.371187 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m11:53:58.371187 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m11:53:58.371187 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:58.385852 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m11:53:58.385852 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:53:58.387850 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m11:53:58.388384 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m11:53:58.388384 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m11:53:58.388384 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:58.388384 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m11:53:58.388384 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:53:58.388384 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m11:53:58.388384 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 11:53:58.388384 => 11:53:58.388384
[0m11:53:58.388384 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m11:53:58.388384 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m11:53:58.388384 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 11:53:58.388384 => 11:53:58.388384
[0m11:53:58.402531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.404493 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m11:53:58.404493 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m11:53:58.404493 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:58.404493 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:58.404493 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m11:53:58.404493 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m11:53:58.404493 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m11:53:58.404493 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:58.404493 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.404493 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.404493 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:53:58.404493 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m11:53:58.404493 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:58.404493 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:53:58.404493 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:53:58.404493 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m11:53:58.404493 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:58.420756 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m11:53:58.422580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.422580 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m11:53:58.422580 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m11:53:58.422580 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m11:53:58.422580 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.422580 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:58.422580 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:53:58.422580 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.436537 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:58.437539 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m11:53:58.438263 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.438263 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 11:53:58.337795 => 11:53:58.438263
[0m11:53:58.438263 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m11:53:58.438263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0C82F10>]}
[0m11:53:58.438263 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:53:58.438263 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.12s]
[0m11:53:58.444773 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:58.444773 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m11:53:58.444773 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m11:53:58.444773 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m11:53:58.444773 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:58.444773 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m11:53:58.452611 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m11:53:58.453611 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m11:53:58.455608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m11:53:58.455608 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.455608 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.456608 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m11:53:58.460724 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:58.460724 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:58.460724 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:58.466735 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m11:53:58.466735 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m11:53:58.466735 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 11:53:58.460724 => 11:53:58.466735
[0m11:53:58.469326 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m11:53:58.472273 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:58.472273 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.472273 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.472273 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:53:58.472273 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:58.479780 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:53:58.479780 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:58.479780 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m11:53:58.479780 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:58.479780 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m11:53:58.479780 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:58.479780 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m11:53:58.488459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.488459 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:58.488459 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m11:53:58.504842 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.504842 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m11:53:58.504842 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.504842 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m11:53:58.504842 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m11:53:58.504842 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m11:53:58.504842 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m11:53:58.504842 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m11:53:58.521375 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:58.521375 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m11:53:58.521375 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m11:53:58.521375 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m11:53:58.526388 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:58.526388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.526388 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m11:53:58.526388 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:58.526388 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m11:53:58.526388 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.526388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.526388 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:58.535922 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:53:58.535922 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m11:53:58.536925 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:58.536925 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.537920 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m11:53:58.538920 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 11:53:58.404493 => 11:53:58.538920
[0m11:53:58.539917 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.539917 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m11:53:58.541917 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:53:58.541917 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.542919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.543917 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0BF6C10>]}
[0m11:53:58.544159 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:58.544919 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 11:53:58.388384 => 11:53:58.544919
[0m11:53:58.548934 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m11:53:58.549919 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m11:53:58.548934 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.16s]
[0m11:53:58.549919 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m11:53:58.550928 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m11:53:58.551918 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m11:53:58.552919 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0C9DE90>]}
[0m11:53:58.552919 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m11:53:58.554722 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.18s]
[0m11:53:58.555724 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m11:53:58.556899 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.558900 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m11:53:58.559918 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.559918 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m11:53:58.560925 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 11:53:58.470327 => 11:53:58.560925
[0m11:53:58.561904 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m11:53:58.561904 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m11:53:58.562903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0D92350>]}
[0m11:53:58.563903 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.11s]
[0m11:53:58.564905 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m11:53:58.565901 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.567899 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 11:53:58.371187 => 11:53:58.567899
[0m11:53:58.567899 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m11:53:58.569131 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0A02C50>]}
[0m11:53:58.569948 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.21s]
[0m11:53:58.570580 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m11:53:58.570580 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m11:53:58.570580 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m11:53:58.570580 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m11:53:58.570580 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m11:53:58.570580 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m11:53:58.570580 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 11:53:58.570580 => 11:53:58.570580
[0m11:53:58.570580 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m11:53:58.570580 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m11:53:58.570580 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:58.570580 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m11:53:58.570580 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:53:58.588188 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.588188 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:58.588188 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (

SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

select 
    diagnosis_key,
    category_title,
    count(*) as count
from 
    analysis
group by
    diagnosis_key,
    category_title
order by
    count desc
  );
  
[0m11:53:58.638084 [debug] [Thread-4 (]: SQL status: SELECT 2061 in 0.0 seconds
[0m11:53:58.641194 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:58.641194 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m11:53:58.641194 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.641194 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:58.641194 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m11:53:58.641194 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:58.641194 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:53:58.641194 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:58.641194 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m11:53:58.653551 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.655552 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m11:53:58.655552 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m11:53:58.656552 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m11:53:58.659551 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m11:53:58.660552 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 11:53:58.570580 => 11:53:58.660552
[0m11:53:58.660552 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m11:53:58.661551 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7530f4-d69e-45c2-b2ae-34987064a2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0C9C7D0>]}
[0m11:53:58.661551 [info ] [Thread-4 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 2061[0m in 0.09s]
[0m11:53:58.663551 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m11:53:58.664551 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:58.664551 [debug] [MainThread]: On master: BEGIN
[0m11:53:58.665552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:53:58.686693 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:58.686693 [debug] [MainThread]: On master: COMMIT
[0m11:53:58.686693 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:58.686693 [debug] [MainThread]: On master: COMMIT
[0m11:53:58.686693 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:53:58.686693 [debug] [MainThread]: On master: Close
[0m11:53:58.686693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:58.686693 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:53:58.686693 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m11:53:58.686693 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m11:53:58.686693 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m11:53:58.686693 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m11:53:58.686693 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m11:53:58.686693 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m11:53:58.686693 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m11:53:58.686693 [info ] [MainThread]: 
[0m11:53:58.686693 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m11:53:58.686693 [debug] [MainThread]: Command end result
[0m11:53:58.704204 [info ] [MainThread]: 
[0m11:53:58.704204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:58.704204 [info ] [MainThread]: 
[0m11:53:58.704204 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m11:53:58.704204 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:58.704204 after 1.18 seconds
[0m11:53:58.704204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018ABDF967D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC00599D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC0059B50>]}
[0m11:53:58.704204 [debug] [MainThread]: Flushing usage events
[0m12:02:07.996476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B0096510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B008F1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B008FF90>]}


============================== 12:02:08.012228 | 0ace1c53-7c22-4d12-98fe-afb782a28e76 ==============================
[0m12:02:08.012228 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:02:08.012228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:08.133807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B0283950>]}
[0m12:02:08.180797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B01C5B90>]}
[0m12:02:08.180797 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:02:08.180797 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:02:08.246310 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:08.246310 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m12:02:08.315851 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:02:08.315851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B060D310>]}
[0m12:02:08.342733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B0654E90>]}
[0m12:02:08.342733 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:02:08.342733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B04D7AD0>]}
[0m12:02:08.342733 [info ] [MainThread]: 
[0m12:02:08.342733 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:02:08.342733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:02:08.342733 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:02:08.342733 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:02:08.342733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:08.342733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:02:08.359595 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:02:08.359595 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:02:08.360171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:08.360171 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:02:08.374176 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:02:08.375769 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:02:08.375769 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:02:08.375769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:02:08.375769 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:02:08.375769 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:02:08.375769 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:02:08.375769 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:02:08.375769 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:02:08.375769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:08.375769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:08.393168 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.393168 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.393168 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:02:08.393168 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:02:08.393168 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:02:08.393168 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:02:08.393168 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:02:08.393168 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:02:08.408334 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:02:08.408797 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:02:08.408797 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:02:08.408797 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:02:08.408797 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:08.408797 [debug] [MainThread]: On master: BEGIN
[0m12:02:08.408797 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:08.428999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.428999 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:08.428999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:02:08.434001 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:02:08.434999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B04C5F50>]}
[0m12:02:08.434999 [debug] [MainThread]: On master: ROLLBACK
[0m12:02:08.436000 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:08.436999 [debug] [MainThread]: On master: BEGIN
[0m12:02:08.438001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.438001 [debug] [MainThread]: On master: COMMIT
[0m12:02:08.439000 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:08.439000 [debug] [MainThread]: On master: COMMIT
[0m12:02:08.439999 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.439999 [debug] [MainThread]: On master: Close
[0m12:02:08.441001 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:02:08.442001 [info ] [MainThread]: 
[0m12:02:08.446000 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:02:08.446000 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:02:08.446000 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m12:02:08.446999 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:02:08.446999 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:02:08.446999 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m12:02:08.453016 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:02:08.454000 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:02:08.454000 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:02:08.448667 => 12:02:08.454000
[0m12:02:08.454999 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:02:08.454999 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:02:08.458268 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:02:08.476520 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m12:02:08.476520 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:02:08.456000 => 12:02:08.476520
[0m12:02:08.476520 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:02:08.476520 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:02:08.476520 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:02:08.476520 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m12:02:08.476520 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:08.476520 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:02:08.490699 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m12:02:08.491705 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:02:08.525016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.525016 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.526018 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:02:08.526018 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:02:08.527017 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m12:02:08.527017 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m12:02:08.537909 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:02:08.543775 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:02:08.544775 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m12:02:08.545776 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.548774 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:02:08.548774 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m12:02:08.550774 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.564399 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:02:08.564399 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:02:08.565400 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:02:08.583236 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.588237 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m12:02:08.592099 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:02:08.592099 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m12:02:08.602610 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:08.602610 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:02:08.476520 => 12:02:08.602610
[0m12:02:08.602610 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m12:02:08.602610 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B0602E10>]}
[0m12:02:08.602610 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.15s]
[0m12:02:08.602610 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:02:08.618494 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m12:02:08.619721 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m12:02:08.619936 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m12:02:08.619936 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:02:08.619936 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m12:02:08.619936 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m12:02:08.626955 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:02:08.619936 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m12:02:08.626955 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m12:02:08.629478 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m12:02:08.629478 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m12:02:08.629478 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m12:02:08.629478 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m12:02:08.629478 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m12:02:08.629478 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:02:08.629478 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:02:08.629478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.634983 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:02:08.634983 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:02:08.640725 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:02:08.640725 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 12:02:08.629478 => 12:02:08.640725
[0m12:02:08.641726 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 12:02:08.629478 => 12:02:08.641726
[0m12:02:08.643052 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m12:02:08.643052 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:02:08.634983 => 12:02:08.643052
[0m12:02:08.643052 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m12:02:08.643052 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m12:02:08.643052 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m12:02:08.643052 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m12:02:08.643052 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.643052 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m12:02:08.643052 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m12:02:08.643052 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:02:08.643052 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:02:08.643052 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:02:08.657396 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:02:08.658393 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m12:02:08.658393 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:02:08.659642 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m12:02:08.659642 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:02:08.659642 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:02:08.659642 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m12:02:08.659642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:02:08.659642 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:08.676990 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.676990 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m12:02:08.676990 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:02:08.676990 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m12:02:08.676990 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.676990 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.676990 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:02:08.676990 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:02:08.676990 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m12:02:08.676990 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.676990 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m12:02:08.676990 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:02:08.676990 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:08.676990 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m12:02:08.692173 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:02:08.458268 => 12:02:08.692173
[0m12:02:08.693170 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m12:02:08.693170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B0741690>]}
[0m12:02:08.694174 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.25s]
[0m12:02:08.695170 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:02:08.696175 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:02:08.696175 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m12:02:08.697190 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:02:08.698172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:02:08.702169 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:02:08.702169 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:02:08.702169 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:02:08.703168 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m12:02:08.706188 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:02:08.706188 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m12:02:08.743678 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:02:08.743678 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m12:02:08.743678 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:02:08.743678 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.757413 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:02:08.706188 => 12:02:08.757413
[0m12:02:08.758413 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m12:02:08.759435 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:02:08.759435 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.759435 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:02:08.759435 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m12:02:08.759435 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:02:08.759435 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.759435 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:02:08.759435 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m12:02:08.759435 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:02:08.759435 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.759435 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:02:08.759435 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:02:08.759435 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:02:08.774123 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.774123 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m12:02:08.775127 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:02:08.777127 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:02:08.777127 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.777127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:08.778124 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:02:08.778124 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:02:08.779124 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:02:08.780126 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:02:08.781123 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:02:08.781123 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:02:08.783124 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.786133 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m12:02:08.786133 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.787128 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.788143 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:02:08.790123 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m12:02:08.792080 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m12:02:08.792080 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m12:02:08.793081 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:02:08.794082 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:02:08.795083 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m12:02:08.796082 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m12:02:08.798082 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:08.800083 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 12:02:08.643052 => 12:02:08.800083
[0m12:02:08.800083 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m12:02:08.801082 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:08.801082 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:08.802080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B0297350>]}
[0m12:02:08.802080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.804083 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:02:08.643052 => 12:02:08.804083
[0m12:02:08.805103 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 12:02:08.643052 => 12:02:08.805103
[0m12:02:08.806084 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:02:08.805103 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.18s]
[0m12:02:08.806084 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m12:02:08.807080 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m12:02:08.807080 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m12:02:08.808108 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m12:02:08.808108 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B026D8D0>]}
[0m12:02:08.808108 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B0214B50>]}
[0m12:02:08.808108 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:02:08.808108 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.18s]
[0m12:02:08.808108 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.18s]
[0m12:02:08.813448 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m12:02:08.808108 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m12:02:08.813866 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m12:02:08.813866 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:02:08.813866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m12:02:08.813866 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:02:08.813866 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:02:08.813866 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m12:02:08.813866 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:02:08.813866 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:02:08.813866 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m12:02:08.813866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m12:02:08.825721 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:02:08.825721 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m12:02:08.825721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m12:02:08.825721 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:02:08.825721 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:02:08.813866 => 12:02:08.825721
[0m12:02:08.825721 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:02:08.825721 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:02:08.825721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.825721 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:02:08.825721 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:02:08.835228 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:02:08.835228 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m12:02:08.835228 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:02:08.825721 => 12:02:08.835228
[0m12:02:08.835228 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m12:02:08.835228 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:02:08.825721 => 12:02:08.835228
[0m12:02:08.840821 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:02:08.841827 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:02:08.842823 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:02:08.843126 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m12:02:08.843126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.843126 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m12:02:08.843126 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m12:02:08.843126 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:02:08.843126 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:02:08.843126 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:02:08.843126 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m12:02:08.843126 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:02:08.843126 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:02:08.843126 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:02:08.843126 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m12:02:08.843126 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:02:08.843126 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:08.860442 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.860442 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m12:02:08.860442 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:02:08.860442 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m12:02:08.860442 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.860442 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:02:08.860442 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m12:02:08.860442 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:08.874405 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:02:08.759435 => 12:02:08.874405
[0m12:02:08.875407 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.876445 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m12:02:08.876445 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:02:08.876445 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:02:08.876445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B0296790>]}
[0m12:02:08.876445 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.18s]
[0m12:02:08.876445 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.876445 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:02:08.876445 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:02:08.885160 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:02:08.885160 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:02:08.885160 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m12:02:08.885160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m12:02:08.885160 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:02:08.885160 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:02:08.891763 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:02:08.894691 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:02:08.894691 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:02:08.894691 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m12:02:08.900192 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:02:08.900192 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:02:08.891763 => 12:02:08.900192
[0m12:02:08.900192 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m12:02:08.900192 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:02:08.900192 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.900192 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:02:08.900192 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.909044 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:02:08.909044 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:02:08.909044 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:02:08.909044 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m12:02:08.909044 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m12:02:08.909044 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m12:02:08.909044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:08.909044 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.909044 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.909044 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:02:08.909044 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:02:08.909044 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:02:08.909044 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:02:08.909044 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:02:08.909044 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:02:08.935212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:08.935212 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:02:08.935212 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m12:02:08.943364 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.943364 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.943364 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m12:02:08.943364 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m12:02:08.943364 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m12:02:08.943364 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:02:08.943364 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:02:08.943364 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:02:08.943364 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m12:02:08.943364 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m12:02:08.943364 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m12:02:08.959331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.962327 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:02:08.962327 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m12:02:08.978329 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.978329 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:08.980329 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:02:08.980329 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:02:08.981327 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:08.982354 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:02:08.843126 => 12:02:08.982354
[0m12:02:08.982354 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:02:08.984347 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:02:08.985344 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:02:08.843126 => 12:02:08.985344
[0m12:02:08.986331 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m12:02:08.986331 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:02:08.987329 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m12:02:08.987329 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m12:02:08.988328 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B06A3A10>]}
[0m12:02:08.990331 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B075ED90>]}
[0m12:02:08.990888 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.990888 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.16s]
[0m12:02:08.990888 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:02:08.990888 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.18s]
[0m12:02:08.990888 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:02:08.990888 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m12:02:08.990888 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:02:08.990888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:08.990888 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m12:02:08.990888 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:02:08.990888 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:02:08.990888 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:02:08.990888 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m12:02:08.990888 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:02:08.990888 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:02:09.006517 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:09.007615 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:02:09.008581 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:02:08.900192 => 12:02:09.008581
[0m12:02:09.008581 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m12:02:09.008581 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m12:02:09.008581 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:02:09.008581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B04B9A10>]}
[0m12:02:09.008581 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m12:02:09.008581 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.12s]
[0m12:02:09.008581 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:02:09.008581 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:02:09.008581 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:02:08.835228 => 12:02:09.008581
[0m12:02:09.008581 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m12:02:09.008581 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B01C68D0>]}
[0m12:02:09.025217 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.19s]
[0m12:02:09.026463 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:02:09.026463 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m12:02:09.026463 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m12:02:09.026463 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m12:02:09.026463 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m12:02:09.026463 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m12:02:09.026463 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 12:02:09.026463 => 12:02:09.026463
[0m12:02:09.026463 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m12:02:09.035497 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m12:02:09.035497 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:02:09.035497 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m12:02:09.035497 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:02:09.042643 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:02:09.042643 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:02:09.042643 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (

SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key,
WHERE d1.diagnosis_key IS NOT NULL OR d2.diagnosis_key IS NOT NULL OR d3.diagnosis_key IS NOT NULL;
)

select 
    diagnosis_key,
    category_title,
    count(*) as count
from 
    analysis
group by
    diagnosis_key,
    category_title
order by
    count desc
  );
  
[0m12:02:09.042643 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "WHERE"
LINE 46: WHERE d1.diagnosis_key IS NOT NULL OR d2.diagnosis_key IS NO...
         ^

[0m12:02:09.042643 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m12:02:09.042643 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 12:02:09.026463 => 12:02:09.042643
[0m12:02:09.042643 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m12:02:09.059463 [debug] [Thread-4 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "WHERE"
  LINE 46: WHERE d1.diagnosis_key IS NOT NULL OR d2.diagnosis_key IS NO...
           ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m12:02:09.059463 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ace1c53-7c22-4d12-98fe-afb782a28e76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B0836750>]}
[0m12:02:09.059463 [error] [Thread-4 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.03s]
[0m12:02:09.059463 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m12:02:09.059463 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:09.059463 [debug] [MainThread]: On master: BEGIN
[0m12:02:09.059463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:09.076175 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:02:09.076175 [debug] [MainThread]: On master: COMMIT
[0m12:02:09.076175 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:09.076175 [debug] [MainThread]: On master: COMMIT
[0m12:02:09.076175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:02:09.076175 [debug] [MainThread]: On master: Close
[0m12:02:09.076175 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:09.076175 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:02:09.076175 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:02:09.076175 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:02:09.076175 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:02:09.076175 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m12:02:09.076175 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m12:02:09.076175 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m12:02:09.090629 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m12:02:09.090629 [info ] [MainThread]: 
[0m12:02:09.091631 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m12:02:09.093077 [debug] [MainThread]: Command end result
[0m12:02:09.093077 [info ] [MainThread]: 
[0m12:02:09.093077 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:02:09.093077 [info ] [MainThread]: 
[0m12:02:09.107417 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "WHERE"
  LINE 46: WHERE d1.diagnosis_key IS NOT NULL OR d2.diagnosis_key IS NO...
           ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m12:02:09.109211 [info ] [MainThread]: 
[0m12:02:09.109211 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:02:09.109211 [debug] [MainThread]: Command `dbt run` failed at 12:02:09.109211 after 1.14 seconds
[0m12:02:09.109211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152ADA26C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152ADA26B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000152B00E5710>]}
[0m12:02:09.109211 [debug] [MainThread]: Flushing usage events
[0m12:03:03.103983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C90832D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C942EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C942CD90>]}


============================== 12:03:03.103983 | a824ed97-c7df-475d-b49d-13ebd0d1cdb4 ==============================
[0m12:03:03.103983 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:03:03.103983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:03:03.221852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C946E710>]}
[0m12:03:03.279107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C906AD90>]}
[0m12:03:03.279107 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:03:03.290265 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:03:03.340897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:03:03.341896 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m12:03:03.419503 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:03:03.419503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C96C2850>]}
[0m12:03:03.431015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C97592D0>]}
[0m12:03:03.431015 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:03:03.431015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C99A40D0>]}
[0m12:03:03.442555 [info ] [MainThread]: 
[0m12:03:03.442555 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:03:03.442555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:03:03.442555 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:03:03.442555 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:03:03.442555 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:03:03.442555 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:03:03.442555 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:03:03.442555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:03.456003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:03.475515 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:03:03.475515 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:03:03.475515 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:03:03.475515 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:03:03.475515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:03:03.475515 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:03:03.475515 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:03:03.475515 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:03:03.489440 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:03:03.489440 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:03:03.490447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:03.490447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:03.508395 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.508395 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.508395 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:03:03.508395 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:03:03.508395 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:03:03.508395 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:03:03.525770 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:03:03.526785 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:03:03.527766 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:03:03.529765 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:03:03.530765 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:03:03.531763 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:03:03.539786 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:03.540807 [debug] [MainThread]: On master: BEGIN
[0m12:03:03.540807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:03.556872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.556872 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:03.556872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:03:03.556872 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:03:03.556872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C9888950>]}
[0m12:03:03.556872 [debug] [MainThread]: On master: ROLLBACK
[0m12:03:03.556872 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:03.556872 [debug] [MainThread]: On master: BEGIN
[0m12:03:03.572501 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.572501 [debug] [MainThread]: On master: COMMIT
[0m12:03:03.572501 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:03.572501 [debug] [MainThread]: On master: COMMIT
[0m12:03:03.572501 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:03:03.572501 [debug] [MainThread]: On master: Close
[0m12:03:03.572501 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:03:03.572501 [info ] [MainThread]: 
[0m12:03:03.572501 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:03:03.572501 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:03:03.572501 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m12:03:03.582150 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:03:03.572501 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m12:03:03.583139 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:03:03.583139 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:03:03.592070 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:03:03.592070 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:03:03.592070 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:03:03.592070 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:03:03.583139 => 12:03:03.592070
[0m12:03:03.592070 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:03:03.592070 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:03:03.592070 => 12:03:03.592070
[0m12:03:03.625466 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m12:03:03.625466 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:03:03.631977 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:03:03.631977 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:03:03.631977 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m12:03:03.631977 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:03:03.631977 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:03:03.631977 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m12:03:03.631977 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:03:03.666174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.666174 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.667174 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:03:03.667174 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:03:03.668175 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m12:03:03.668175 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m12:03:03.676920 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:03:03.681919 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:03:03.681919 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m12:03:03.683919 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.685920 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:03:03.685920 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m12:03:03.688059 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.695682 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:03:03.695682 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:03:03.695682 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:03:03.718827 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:03.718827 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m12:03:03.718827 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:03:03.718827 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m12:03:03.734361 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:03.734361 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:03:03.625466 => 12:03:03.734361
[0m12:03:03.734361 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m12:03:03.734361 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C98331D0>]}
[0m12:03:03.734361 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.15s]
[0m12:03:03.749999 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:03:03.750294 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m12:03:03.750294 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m12:03:03.750294 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m12:03:03.750294 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m12:03:03.750294 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m12:03:03.750294 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m12:03:03.750294 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m12:03:03.750294 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:03:03.754949 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m12:03:03.755825 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m12:03:03.755825 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m12:03:03.759827 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:03:03.759827 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m12:03:03.761844 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:03:03.762827 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:03:03.762827 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m12:03:03.764827 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:03:03.765828 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 12:03:03.759827 => 12:03:03.765828
[0m12:03:03.767830 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:03:03.767830 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 12:03:03.762827 => 12:03:03.767830
[0m12:03:03.768828 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m12:03:03.769828 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:03:03.765828 => 12:03:03.768828
[0m12:03:03.769828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.769828 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m12:03:03.773860 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m12:03:03.773860 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m12:03:03.773860 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:03:03.773860 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m12:03:03.773860 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m12:03:03.773860 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:03:03.773860 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m12:03:03.773860 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:03:03.773860 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:03:03.773860 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m12:03:03.773860 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m12:03:03.773860 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m12:03:03.773860 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:03:03.773860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.773860 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:03:03.773860 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:03:03.790286 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:03:03.790286 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:03:03.790286 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:03:03.790286 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.807450 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:03:03.807450 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m12:03:03.807450 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:03.807450 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m12:03:03.807450 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.807450 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.807450 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:03:03.807450 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:03:03.807450 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:03:03.807450 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m12:03:03.807450 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m12:03:03.807450 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m12:03:03.823718 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:03.823718 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m12:03:03.823718 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:03:03.592070 => 12:03:03.823718
[0m12:03:03.827744 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:03:03.827744 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:03:03.827744 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m12:03:03.827744 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:03:03.827744 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m12:03:03.831756 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:03:03.831756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C96EE190>]}
[0m12:03:03.880200 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:03:03.881199 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m12:03:03.882203 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m12:03:03.882203 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.26s]
[0m12:03:03.882203 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.883200 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:03:03.886216 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:03:03.886216 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.886216 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.887200 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:03:03.887200 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:03:03.889996 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:03:03.889996 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:03:03.889996 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m12:03:03.889996 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m12:03:03.889996 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m12:03:03.889996 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:03:03.889996 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.889996 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.889996 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:03:03.889996 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:03:03.889996 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.889996 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:03:03.889996 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:03:03.889996 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:03:03.889996 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:03:03.889996 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:03:03.889996 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:03:03.889996 => 12:03:03.889996
[0m12:03:03.905623 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:03:03.906078 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:03:03.906986 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:03:03.906986 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:03:03.906986 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:03:03.906986 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:03:03.906986 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:03.906986 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:03.906986 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m12:03:03.906986 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:03.906986 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:03:03.906986 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m12:03:03.906986 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:03:03.906986 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m12:03:03.906986 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m12:03:03.906986 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:03:03.906986 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m12:03:03.906986 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:03:03.922615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:03.922853 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m12:03:03.923856 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m12:03:03.925530 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:03.925530 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 12:03:03.770826 => 12:03:03.925530
[0m12:03:03.925530 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:03.925530 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:03.925530 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m12:03:03.932039 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:03:03.773860 => 12:03:03.932039
[0m12:03:03.932039 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 12:03:03.773860 => 12:03:03.932039
[0m12:03:03.932039 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C96EF490>]}
[0m12:03:03.932039 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m12:03:03.932039 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m12:03:03.932039 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C9A198D0>]}
[0m12:03:03.932039 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.18s]
[0m12:03:03.932039 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C9A17ED0>]}
[0m12:03:03.939339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.941340 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m12:03:03.940339 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.18s]
[0m12:03:03.941718 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:03:03.941718 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.18s]
[0m12:03:03.941718 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:03:03.941718 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m12:03:03.941718 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m12:03:03.941718 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m12:03:03.941718 [info ] [Thread-4 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m12:03:03.941718 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:03:03.941718 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:03:03.941718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.dim_diagnosis)
[0m12:03:03.941718 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m12:03:03.941718 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:03:03.941718 [info ] [Thread-3 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m12:03:03.941718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m12:03:03.941718 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:03:03.941718 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:03:03.941718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_paid_amount)
[0m12:03:03.941718 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:03:03.941718 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:03:03.941718 => 12:03:03.941718
[0m12:03:03.958129 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:03:03.958129 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:03:03.958129 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:03:03.958129 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:03:03.958129 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m12:03:03.958129 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:03:03.958129 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m12:03:03.958129 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:03:03.958129 => 12:03:03.958129
[0m12:03:03.958129 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:03:03.958129 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:03:03.958129 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m12:03:03.972717 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.972717 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:03:03.958129 => 12:03:03.958129
[0m12:03:03.973719 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m12:03:03.974908 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:03:03.974908 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:03:03.974908 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:03:03.974908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:03:03.974908 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m12:03:03.974908 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m12:03:03.974908 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m12:03:03.974908 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:03:03.974908 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:03:03.974908 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:03.974908 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m12:03:03.974908 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:03:03.974908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:03:03.974908 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:03:03.974908 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:03:03.991893 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:03.991893 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m12:03:03.991893 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:03:03.991893 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.991893 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m12:03:03.991893 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:03:03.991893 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.991893 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:03.991893 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:03:03.991893 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:03:03.991893 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:03:03.991893 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m12:03:03.991893 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:03:03.991893 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:04.007052 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:03:03.906986 => 12:03:04.007052
[0m12:03:04.007765 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m12:03:04.007765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C9AE9390>]}
[0m12:03:04.007765 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:03:04.007765 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.12s]
[0m12:03:04.007765 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:03:04.007765 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:03:04.007765 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:03:04.007765 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m12:03:04.007765 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:03:04.007765 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:03:04.007765 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m12:03:04.007765 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:04.007765 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m12:03:04.022753 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:04.024952 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:03:04.024952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m12:03:04.029975 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:03:04.029975 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m12:03:04.029975 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:03:04.031994 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m12:03:04.031994 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:03:04.031994 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:04.031994 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:03:04.031994 => 12:03:04.031994
[0m12:03:04.039405 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:03:04.040407 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:04.041938 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:03:04.041938 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:03:04.041938 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:03:04.048963 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:03:04.048963 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:03:04.048963 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:03:04.048963 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:03:04.048963 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:03:04.056143 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m12:03:04.057149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:03:04.076359 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:04.077966 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:04.081140 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m12:03:04.082212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:04.086615 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m12:03:04.087699 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:03:04.088757 [debug] [Thread-4 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:03:04.088757 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:03:04.090408 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:03:04.090930 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m12:03:04.094700 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:03:04.095226 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m12:03:04.095804 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m12:03:04.096857 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m12:03:04.099527 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:04.103274 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:03:04.103805 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m12:03:04.106460 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:04.106986 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m12:03:04.109606 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:03:04.112874 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:03:04.113941 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:03:04.114471 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:04.114996 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m12:03:04.115524 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:03:04.115524 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:04.117515 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:03:03.958129 => 12:03:04.117515
[0m12:03:04.119511 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:03:03.974908 => 12:03:04.119511
[0m12:03:04.120512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:04.120512 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:04.121511 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m12:03:04.121511 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: Close
[0m12:03:04.124739 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:03:04.128385 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m12:03:04.129958 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C9A42C90>]}
[0m12:03:04.131769 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C9BC4450>]}
[0m12:03:04.132304 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m12:03:04.134460 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:03:04.135533 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.19s]
[0m12:03:04.136063 [info ] [Thread-3 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.19s]
[0m12:03:04.137110 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m12:03:04.138165 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:03:04.138693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:03:04.139758 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:03:04.142914 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:03:04.143972 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:03:04.144498 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:03:04.146082 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:04.147655 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:03:03.958129 => 12:03:04.147655
[0m12:03:04.148181 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: Close
[0m12:03:04.149230 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C9B12250>]}
[0m12:03:04.149759 [info ] [Thread-4 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.21s]
[0m12:03:04.151371 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:03:04.152344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:03:04.153399 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m12:03:04.159226 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m12:03:04.161893 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:03:04.160801 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m12:03:04.162960 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m12:03:04.164007 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m12:03:04.165063 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m12:03:04.168767 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m12:03:04.169322 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:03:04.171998 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:03:04.041938 => 12:03:04.171998
[0m12:03:04.173055 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 12:03:04.166098 => 12:03:04.172524
[0m12:03:04.173532 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m12:03:04.174606 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m12:03:04.175456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C988DB50>]}
[0m12:03:04.180862 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m12:03:04.181926 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.15s]
[0m12:03:04.182992 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:03:04.184055 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:03:04.184576 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m12:03:04.185106 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:03:04.198994 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:03:04.199512 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:03:04.200096 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (

SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key,
WHERE f.diagnosis_1_key IS NOT NULL OR f.diagnosis_2_key IS NOT NULL OR f.diagnosis_3_key IS NOT NULL;
)

select 
    diagnosis_key,
    category_title,
    count(*) as count
from 
    analysis
group by
    diagnosis_key,
    category_title
order by
    count desc
  );
  
[0m12:03:04.201161 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "WHERE"
LINE 46: WHERE f.diagnosis_1_key IS NOT NULL OR f.diagnosis_2_key IS ...
         ^

[0m12:03:04.201691 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m12:03:04.202744 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 12:03:04.176608 => 12:03:04.202220
[0m12:03:04.203249 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m12:03:04.205982 [debug] [Thread-2 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "WHERE"
  LINE 46: WHERE f.diagnosis_1_key IS NOT NULL OR f.diagnosis_2_key IS ...
           ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m12:03:04.206981 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a824ed97-c7df-475d-b49d-13ebd0d1cdb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C984A3D0>]}
[0m12:03:04.207899 [error] [Thread-2 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.04s]
[0m12:03:04.207899 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m12:03:04.207899 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:04.207899 [debug] [MainThread]: On master: BEGIN
[0m12:03:04.207899 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:04.232389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:03:04.232389 [debug] [MainThread]: On master: COMMIT
[0m12:03:04.232389 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:04.232389 [debug] [MainThread]: On master: COMMIT
[0m12:03:04.232389 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:03:04.232389 [debug] [MainThread]: On master: Close
[0m12:03:04.232389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:04.232389 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:03:04.232389 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:03:04.232389 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:03:04.232389 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:03:04.232389 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m12:03:04.232389 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m12:03:04.232389 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m12:03:04.232389 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m12:03:04.232389 [info ] [MainThread]: 
[0m12:03:04.232389 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m12:03:04.240304 [debug] [MainThread]: Command end result
[0m12:03:04.241154 [info ] [MainThread]: 
[0m12:03:04.241154 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:03:04.241154 [info ] [MainThread]: 
[0m12:03:04.241154 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near "WHERE"
  LINE 46: WHERE f.diagnosis_1_key IS NOT NULL OR f.diagnosis_2_key IS ...
           ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m12:03:04.241154 [info ] [MainThread]: 
[0m12:03:04.241154 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:03:04.241154 [debug] [MainThread]: Command `dbt run` failed at 12:03:04.241154 after 1.19 seconds
[0m12:03:04.241154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C2A2C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C2A2C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000191C942E890>]}
[0m12:03:04.241154 [debug] [MainThread]: Flushing usage events
[0m12:04:11.554470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDA632D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDE32B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDE31950>]}


============================== 12:04:11.554470 | 0b7dd591-2c65-4bac-9803-646e3f9c5a61 ==============================
[0m12:04:11.554470 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:04:11.554470 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:04:11.676770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDFC1790>]}
[0m12:04:11.723754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDE42310>]}
[0m12:04:11.739328 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:04:11.739328 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:04:11.800010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:04:11.800010 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m12:04:11.876747 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:04:11.876747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE395150>]}
[0m12:04:11.894755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE0F7CD0>]}
[0m12:04:11.894755 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:04:11.894755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE10A950>]}
[0m12:04:11.894755 [info ] [MainThread]: 
[0m12:04:11.894755 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:04:11.894755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:04:11.894755 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:04:11.906059 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:04:11.906059 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:04:11.906059 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:04:11.906059 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:04:11.906059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:11.906059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:11.922860 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:04:11.922860 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:04:11.922860 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:04:11.922860 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:04:11.937673 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:04:11.938672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:04:11.939856 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:04:11.939856 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:04:11.939856 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:04:11.939856 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:04:11.939856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:11.939856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:11.956062 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:04:11.956062 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:04:11.956062 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:04:11.956062 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:04:11.956062 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:04:11.956062 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:04:11.972043 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:04:11.973041 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:04:11.974037 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:04:11.975037 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:04:11.976038 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:04:11.976038 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:04:11.983052 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:11.983052 [debug] [MainThread]: On master: BEGIN
[0m12:04:11.983052 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:04:12.004936 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.004936 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:12.004936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:04:12.004936 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:04:12.004936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE45D910>]}
[0m12:04:12.004936 [debug] [MainThread]: On master: ROLLBACK
[0m12:04:12.004936 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:12.004936 [debug] [MainThread]: On master: BEGIN
[0m12:04:12.004936 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.020566 [debug] [MainThread]: On master: COMMIT
[0m12:04:12.020566 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:12.020566 [debug] [MainThread]: On master: COMMIT
[0m12:04:12.020566 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.020566 [debug] [MainThread]: On master: Close
[0m12:04:12.020566 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:04:12.020566 [info ] [MainThread]: 
[0m12:04:12.020566 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:04:12.020566 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:04:12.020566 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m12:04:12.020566 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:04:12.020566 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m12:04:12.030451 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:04:12.030909 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:04:12.037672 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:04:12.038670 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:04:12.039440 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:04:12.039440 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:04:12.030909 => 12:04:12.039440
[0m12:04:12.039440 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:04:12.057815 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m12:04:12.057815 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:04:12.039440 => 12:04:12.057815
[0m12:04:12.057815 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:04:12.057815 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:04:12.057815 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m12:04:12.073247 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:04:12.073247 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:04:12.073247 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:04:12.073247 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m12:04:12.073247 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:04:12.089828 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.089828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.089828 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:04:12.089828 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:04:12.089828 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m12:04:12.104461 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m12:04:12.111974 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:04:12.116975 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:04:12.116975 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m12:04:12.118977 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.120975 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:04:12.121976 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m12:04:12.122976 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.135771 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:04:12.136770 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:04:12.136770 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:04:12.153491 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.153491 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m12:04:12.153491 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:04:12.153491 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m12:04:12.177150 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.177150 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:04:12.057815 => 12:04:12.177150
[0m12:04:12.177150 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m12:04:12.177150 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE3D2FD0>]}
[0m12:04:12.177150 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.15s]
[0m12:04:12.177150 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:04:12.177150 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m12:04:12.177150 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m12:04:12.177150 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m12:04:12.177150 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m12:04:12.177150 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m12:04:12.177150 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m12:04:12.177150 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m12:04:12.177150 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m12:04:12.191685 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:04:12.177150 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m12:04:12.192666 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:04:12.192666 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m12:04:12.192666 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:04:12.192666 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m12:04:12.192666 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:04:12.192666 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m12:04:12.192666 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 12:04:12.192222 => 12:04:12.192666
[0m12:04:12.192666 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:04:12.204384 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:04:12.206080 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m12:04:12.206080 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 12:04:12.192666 => 12:04:12.206080
[0m12:04:12.206080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.206080 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:04:12.192666 => 12:04:12.206080
[0m12:04:12.206080 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m12:04:12.206080 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m12:04:12.206080 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:04:12.206080 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m12:04:12.206080 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m12:04:12.206080 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:04:12.206080 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m12:04:12.206080 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m12:04:12.221150 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:04:12.222152 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m12:04:12.223158 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:04:12.223702 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m12:04:12.223702 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:04:12.223702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.223702 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m12:04:12.223702 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:04:12.223702 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:04:12.223702 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:04:12.223702 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:04:12.223702 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:04:12.241305 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.241305 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:04:12.241305 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m12:04:12.241305 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.241305 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.241305 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.241305 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m12:04:12.241305 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:04:12.241305 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:04:12.241305 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:04:12.254333 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:04:12.255662 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:04:12.255662 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m12:04:12.255662 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m12:04:12.255662 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m12:04:12.255662 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m12:04:12.255662 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.255662 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:04:12.255662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.255662 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m12:04:12.255662 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:04:12.039440 => 12:04:12.255662
[0m12:04:12.255662 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m12:04:12.255662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE522610>]}
[0m12:04:12.255662 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.255662 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:04:12.272739 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:04:12.255662 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.24s]
[0m12:04:12.305915 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:04:12.305915 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m12:04:12.305915 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:04:12.305915 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:04:12.305915 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m12:04:12.321193 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:04:12.322195 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:04:12.322195 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:04:12.322995 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m12:04:12.322995 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.322995 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m12:04:12.322995 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:04:12.322995 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.322995 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.322995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:04:12.322995 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m12:04:12.322995 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m12:04:12.338627 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:04:12.339631 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:04:12.340629 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:04:12.340629 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:04:12.343633 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:04:12.343633 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.343633 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m12:04:12.344629 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:04:12.341631 => 12:04:12.344629
[0m12:04:12.346629 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:04:12.346629 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.347629 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:04:12.347629 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:04:12.349629 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:04:12.352643 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:04:12.352643 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.353630 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:04:12.353630 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:04:12.354255 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:04:12.355836 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 12:04:12.206080 => 12:04:12.355836
[0m12:04:12.355836 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:04:12.355836 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m12:04:12.355836 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m12:04:12.355836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:12.355836 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDF097D0>]}
[0m12:04:12.355836 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.355836 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.355836 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m12:04:12.355836 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.18s]
[0m12:04:12.355836 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m12:04:12.355836 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:04:12.355836 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m12:04:12.355836 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:04:12.371042 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m12:04:12.371042 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:04:12.372041 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m12:04:12.373010 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m12:04:12.373010 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m12:04:12.373010 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:04:12.378020 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:04:12.378020 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.378020 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.378020 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:04:12.373010 => 12:04:12.378020
[0m12:04:12.378020 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:04:12.206080 => 12:04:12.378020
[0m12:04:12.378020 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 12:04:12.206080 => 12:04:12.378020
[0m12:04:12.378020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.378020 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:04:12.378020 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m12:04:12.387660 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m12:04:12.388659 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:04:12.389409 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m12:04:12.389409 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE16FA10>]}
[0m12:04:12.389409 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE45A250>]}
[0m12:04:12.389409 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m12:04:12.389409 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:04:12.389409 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.20s]
[0m12:04:12.389409 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.21s]
[0m12:04:12.389409 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m12:04:12.389409 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m12:04:12.389409 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m12:04:12.389409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:04:12.389409 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:04:12.389409 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:04:12.389409 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m12:04:12.389409 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m12:04:12.405430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m12:04:12.406415 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m12:04:12.407583 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:04:12.407583 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:04:12.407583 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:04:12.407583 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:04:12.407583 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:04:12.407583 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:04:12.407583 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m12:04:12.407583 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:04:12.407583 => 12:04:12.407583
[0m12:04:12.407583 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.407583 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:04:12.407583 => 12:04:12.407583
[0m12:04:12.407583 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:04:12.407583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.407583 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:04:12.407583 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:04:12.422802 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m12:04:12.422802 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:04:12.422802 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m12:04:12.422802 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m12:04:12.422802 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m12:04:12.422802 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:04:12.422802 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:04:12.422802 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m12:04:12.422802 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m12:04:12.422802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.422802 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:04:12.422802 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:04:12.422802 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:04:12.422802 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:04:12.437710 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:04:12.440598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.444331 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m12:04:12.444331 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:04:12.444331 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m12:04:12.456609 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.456609 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.456609 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.456609 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:04:12.349629 => 12:04:12.456609
[0m12:04:12.456609 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:04:12.456609 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:04:12.456609 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m12:04:12.456609 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:04:12.456609 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:04:12.456609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE1D6250>]}
[0m12:04:12.456609 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.13s]
[0m12:04:12.456609 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:04:12.456609 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:04:12.456609 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m12:04:12.471046 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m12:04:12.471046 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:04:12.474040 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:04:12.475040 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:04:12.481039 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:04:12.482038 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:04:12.482038 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:04:12.472041 => 12:04:12.482038
[0m12:04:12.483039 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m12:04:12.486042 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:04:12.487044 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:04:12.487044 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m12:04:12.490451 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:04:12.491449 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.494448 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:04:12.495503 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:04:12.495503 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:04:12.495503 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.496451 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m12:04:12.496451 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m12:04:12.498447 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:04:12.500450 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:04:12.501449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:12.502447 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m12:04:12.502447 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m12:04:12.502447 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.505715 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:04:12.505715 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.505715 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.505715 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:04:12.505715 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:04:12.505715 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:04:12.505715 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:04:12.505715 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:04:12.505715 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m12:04:12.505715 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:04:12.505715 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.505715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.505715 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:04:12.505715 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:04:12.521195 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:04:12.521707 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m12:04:12.522718 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:04:12.523176 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.523176 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.523176 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.523176 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m12:04:12.523176 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m12:04:12.523176 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m12:04:12.523176 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m12:04:12.523176 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:04:12.537776 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:04:12.538778 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:04:12.539780 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:04:12.539780 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m12:04:12.540783 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m12:04:12.540783 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m12:04:12.540783 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m12:04:12.542779 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.545780 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:04:12.545780 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.546779 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.546779 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.546779 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m12:04:12.547779 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:04:12.422802 => 12:04:12.547779
[0m12:04:12.548796 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:04:12.421036 => 12:04:12.548796
[0m12:04:12.549782 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:04:12.389409 => 12:04:12.549782
[0m12:04:12.550798 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m12:04:12.551778 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m12:04:12.551778 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m12:04:12.551778 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:04:12.552779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CD2D9110>]}
[0m12:04:12.553779 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE5B7B50>]}
[0m12:04:12.554784 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE4C4890>]}
[0m12:04:12.556787 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:04:12.557786 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.15s]
[0m12:04:12.557786 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.15s]
[0m12:04:12.558788 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:04:12.558788 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.18s]
[0m12:04:12.559787 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:04:12.560785 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:04:12.560785 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:04:12.560785 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:04:12.561812 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m12:04:12.562786 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m12:04:12.563786 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_analysis)
[0m12:04:12.563786 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.563786 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m12:04:12.565788 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m12:04:12.568804 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m12:04:12.569789 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:04:12.570653 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m12:04:12.571004 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 12:04:12.566788 => 12:04:12.571004
[0m12:04:12.571666 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m12:04:12.571666 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m12:04:12.571666 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:04:12.571666 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:04:12.488337 => 12:04:12.571666
[0m12:04:12.571666 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m12:04:12.578175 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:04:12.578175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE459450>]}
[0m12:04:12.578175 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m12:04:12.578175 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:04:12.578175 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.12s]
[0m12:04:12.578175 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:04:12.589404 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.589404 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:04:12.589404 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (

SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
UNION ALL
SELECT
  diagnosis_key,
  category_title
FROM fact_claims f
LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key,
)

select 
    diagnosis_key,
    category_title,
    count(*) as count
from 
    analysis
where
    category_title is NOT NULL
group by
    diagnosis_key,
    category_title
order by
    count desc
  );
  
[0m12:04:12.589404 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 46: )
         ^

[0m12:04:12.589404 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: ROLLBACK
[0m12:04:12.589404 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 12:04:12.571666 => 12:04:12.589404
[0m12:04:12.589404 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m12:04:12.589404 [debug] [Thread-4 (]: Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near ")"
  LINE 46: )
           ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m12:04:12.589404 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b7dd591-2c65-4bac-9803-646e3f9c5a61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CE4C48D0>]}
[0m12:04:12.589404 [error] [Thread-4 (]: 11 of 11 ERROR creating sql table model public_gold.diagnosis_analysis ......... [[31mERROR[0m in 0.03s]
[0m12:04:12.589404 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m12:04:12.589404 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:12.589404 [debug] [MainThread]: On master: BEGIN
[0m12:04:12.589404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:12.623074 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:04:12.623074 [debug] [MainThread]: On master: COMMIT
[0m12:04:12.623074 [debug] [MainThread]: Using postgres connection "master"
[0m12:04:12.623074 [debug] [MainThread]: On master: COMMIT
[0m12:04:12.623074 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:04:12.623074 [debug] [MainThread]: On master: Close
[0m12:04:12.623074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:12.623074 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:04:12.623074 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:04:12.623074 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:04:12.623074 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:04:12.623074 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m12:04:12.623074 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m12:04:12.637619 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m12:04:12.637619 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m12:04:12.637619 [info ] [MainThread]: 
[0m12:04:12.638643 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m12:04:12.639796 [debug] [MainThread]: Command end result
[0m12:04:12.656577 [info ] [MainThread]: 
[0m12:04:12.656577 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:04:12.656577 [info ] [MainThread]: 
[0m12:04:12.656577 [error] [MainThread]:   Database Error in model diagnosis_analysis (models\gold\analytics\diagnosis_analysis.sql)
  syntax error at or near ")"
  LINE 46: )
           ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\diagnosis_analysis.sql
[0m12:04:12.656577 [info ] [MainThread]: 
[0m12:04:12.656577 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:04:12.656577 [debug] [MainThread]: Command `dbt run` failed at 12:04:12.656577 after 1.14 seconds
[0m12:04:12.656577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CB7A5D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207C742C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000207CDDFF550>]}
[0m12:04:12.656577 [debug] [MainThread]: Flushing usage events
[0m12:05:49.612274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241BF6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241C17890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241C15410>]}


============================== 12:05:49.615274 | 32203f12-263a-49b9-9c5f-6213ab4fa567 ==============================
[0m12:05:49.615274 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:05:49.616274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:05:49.735441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241D89C50>]}
[0m12:05:49.782318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241DF6F90>]}
[0m12:05:49.782318 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:05:49.797944 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:05:49.852839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:05:49.852839 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\diagnosis_analysis.sql
[0m12:05:49.935333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:05:49.940593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241F7B610>]}
[0m12:05:49.953001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A242258410>]}
[0m12:05:49.953753 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:05:49.953753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241C4EA10>]}
[0m12:05:49.953753 [info ] [MainThread]: 
[0m12:05:49.953753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:05:49.953753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:05:49.953753 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:05:49.953753 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:05:49.953753 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:05:49.953753 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:05:49.968628 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:05:49.969630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:49.969630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:49.986624 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:05:49.987923 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:05:49.987923 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:05:49.987923 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:05:49.987923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:05:50.001995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:05:50.003966 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:05:50.003966 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:05:50.003966 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:05:50.003966 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:05:50.003966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:50.003966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:50.027717 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.027717 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.028716 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:05:50.028716 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:05:50.028716 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:05:50.029717 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:05:50.032717 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:05:50.032717 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:05:50.033717 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:05:50.034717 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:05:50.035718 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:05:50.035718 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:05:50.042717 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.042717 [debug] [MainThread]: On master: BEGIN
[0m12:05:50.043716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:50.067881 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.067881 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.067881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:05:50.067881 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:05:50.083387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241C4E310>]}
[0m12:05:50.083387 [debug] [MainThread]: On master: ROLLBACK
[0m12:05:50.083387 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.083387 [debug] [MainThread]: On master: BEGIN
[0m12:05:50.083387 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.083387 [debug] [MainThread]: On master: COMMIT
[0m12:05:50.083387 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.083387 [debug] [MainThread]: On master: COMMIT
[0m12:05:50.083387 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.089662 [debug] [MainThread]: On master: Close
[0m12:05:50.090391 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:50.090391 [info ] [MainThread]: 
[0m12:05:50.095396 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:05:50.096416 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:05:50.097397 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m12:05:50.099159 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:05:50.097397 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m12:05:50.099159 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:05:50.100164 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:05:50.103125 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:05:50.103125 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:05:50.103125 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:05:50.103125 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:05:50.100164 => 12:05:50.103125
[0m12:05:50.103125 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:05:50.118754 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:05:50.103125 => 12:05:50.118754
[0m12:05:50.137847 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m12:05:50.137847 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:05:50.137847 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:05:50.137847 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:05:50.137847 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m12:05:50.137847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:05:50.137847 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:05:50.137847 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m12:05:50.137847 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:05:50.153685 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.153685 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:05:50.153685 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m12:05:50.153685 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.153685 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:05:50.153685 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m12:05:50.172655 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:05:50.177656 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:05:50.178655 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m12:05:50.180946 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.183655 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:05:50.183655 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m12:05:50.185654 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.198655 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:05:50.199656 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:05:50.199656 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:05:50.210303 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.211826 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m12:05:50.219679 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:05:50.220686 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m12:05:50.232680 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.233684 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:05:50.137847 => 12:05:50.233684
[0m12:05:50.234684 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m12:05:50.235620 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A242298C90>]}
[0m12:05:50.235756 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.13s]
[0m12:05:50.236759 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:05:50.238756 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m12:05:50.238756 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m12:05:50.239756 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m12:05:50.238756 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m12:05:50.239756 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:05:50.239756 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m12:05:50.241757 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m12:05:50.240757 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m12:05:50.244773 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:05:50.244773 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m12:05:50.245760 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m12:05:50.245760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m12:05:50.246759 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m12:05:50.246759 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m12:05:50.248756 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:05:50.249772 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:05:50.252798 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:05:50.253112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.253112 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 12:05:50.246759 => 12:05:50.253112
[0m12:05:50.253112 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:05:50.253112 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:05:50.253112 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 12:05:50.249772 => 12:05:50.253112
[0m12:05:50.253112 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m12:05:50.253112 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:05:50.253112 => 12:05:50.253112
[0m12:05:50.253112 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m12:05:50.253112 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m12:05:50.253112 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m12:05:50.253112 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m12:05:50.269624 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m12:05:50.269624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.269624 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m12:05:50.269624 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:05:50.269624 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:05:50.269624 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:05:50.269624 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:05:50.269624 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m12:05:50.269624 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m12:05:50.269624 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:05:50.269624 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m12:05:50.269624 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:05:50.269624 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:05:50.269624 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:05:50.269624 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:05:50.269624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.287630 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m12:05:50.287630 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:05:50.287630 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m12:05:50.287630 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.287630 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:05:50.103125 => 12:05:50.287630
[0m12:05:50.287630 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m12:05:50.287630 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241EB88D0>]}
[0m12:05:50.287630 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.287630 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.287630 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:05:50.287630 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.19s]
[0m12:05:50.287630 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.287630 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:05:50.287630 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m12:05:50.287630 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:05:50.287630 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:05:50.301923 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m12:05:50.302930 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:05:50.303925 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m12:05:50.304623 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m12:05:50.304623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:05:50.304623 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:05:50.304623 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:05:50.304623 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:05:50.304623 => 12:05:50.304623
[0m12:05:50.304623 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:05:50.304623 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:05:50.304623 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:05:50.304623 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:05:50.354900 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:05:50.354900 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m12:05:50.354900 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:05:50.368699 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:05:50.369722 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m12:05:50.371111 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:05:50.371111 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m12:05:50.371111 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m12:05:50.371111 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m12:05:50.371111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:50.371111 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.371111 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.371111 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.371111 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:05:50.385409 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:05:50.388404 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:05:50.388404 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m12:05:50.389408 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:05:50.389408 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m12:05:50.391406 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.392406 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.393406 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.395407 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:05:50.398407 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:05:50.401405 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:05:50.401405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.402507 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:05:50.403507 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:05:50.403507 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:05:50.404508 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:05:50.405509 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:05:50.405509 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:05:50.406509 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:05:50.406509 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m12:05:50.410509 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.413505 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m12:05:50.414507 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.414507 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.415510 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:05:50.419335 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m12:05:50.419335 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:05:50.419335 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m12:05:50.419335 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m12:05:50.419335 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:05:50.424844 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:05:50.424844 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:05:50.424844 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m12:05:50.424844 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m12:05:50.424844 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m12:05:50.424844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.424844 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:05:50.424844 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.424844 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.424844 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.424844 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m12:05:50.435505 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 12:05:50.253112 => 12:05:50.435505
[0m12:05:50.436510 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:05:50.269624 => 12:05:50.436510
[0m12:05:50.437021 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 12:05:50.253112 => 12:05:50.437021
[0m12:05:50.438073 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m12:05:50.438073 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m12:05:50.439093 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m12:05:50.439093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.440096 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A24220A810>]}
[0m12:05:50.440096 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2422BC1D0>]}
[0m12:05:50.442094 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2422D9650>]}
[0m12:05:50.444113 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:05:50.444113 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.20s]
[0m12:05:50.445096 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.19s]
[0m12:05:50.445755 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:05:50.445755 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.20s]
[0m12:05:50.446817 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m12:05:50.446817 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m12:05:50.447830 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:05:50.447830 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m12:05:50.448795 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:05:50.449793 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:05:50.449793 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:05:50.450764 [info ] [Thread-4 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m12:05:50.452004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.451750 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m12:05:50.452004 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.dim_diagnosis)
[0m12:05:50.452004 [info ] [Thread-3 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m12:05:50.452004 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m12:05:50.452004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m12:05:50.452004 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:05:50.452004 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_paid_amount)
[0m12:05:50.452004 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:05:50.452004 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:05:50.452004 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:05:50.452004 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:05:50.452004 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m12:05:50.452004 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:05:50.452004 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:05:50.452004 => 12:05:50.452004
[0m12:05:50.452004 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:05:50.468818 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:05:50.452004 => 12:05:50.467754
[0m12:05:50.468818 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:05:50.469722 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:05:50.452004 => 12:05:50.469722
[0m12:05:50.469722 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:05:50.469722 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m12:05:50.469722 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.469722 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:05:50.469722 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m12:05:50.469722 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:05:50.469722 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:05:50.304623 => 12:05:50.469722
[0m12:05:50.469722 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m12:05:50.469722 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m12:05:50.469722 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:05:50.469722 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m12:05:50.469722 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:05:50.469722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:05:50.469722 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m12:05:50.486330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241F87510>]}
[0m12:05:50.487331 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m12:05:50.488140 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:05:50.488140 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:05:50.488140 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.18s]
[0m12:05:50.488140 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:05:50.488140 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:05:50.488140 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m12:05:50.488140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m12:05:50.488140 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:05:50.488140 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:05:50.488140 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:05:50.488140 => 12:05:50.488140
[0m12:05:50.488140 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:05:50.505602 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:05:50.505602 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:05:50.505602 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m12:05:50.505602 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.505602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:50.505602 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:05:50.505602 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:05:50.505602 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.505602 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:05:50.505602 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.505602 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:05:50.505602 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:05:50.505602 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m12:05:50.521057 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:05:50.525105 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:05:50.525105 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:05:50.525105 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m12:05:50.525105 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:05:50.525105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.525105 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m12:05:50.525105 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:05:50.525105 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.525105 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m12:05:50.525105 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:05:50.525105 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.535306 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m12:05:50.537796 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:05:50.541805 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m12:05:50.541805 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.541805 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:05:50.541805 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.541805 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m12:05:50.541805 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:05:50.541805 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:05:50.541805 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:05:50.541805 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:05:50.541805 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:05:50.541805 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m12:05:50.552062 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:05:50.554427 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.554427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.563162 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m12:05:50.563162 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.565211 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:05:50.565211 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:05:50.568787 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m12:05:50.570507 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m12:05:50.570507 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m12:05:50.571579 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:05:50.572618 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m12:05:50.580520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.584521 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:05:50.585521 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:05:50.586112 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.587114 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:05:50.589112 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:05:50.469722 => 12:05:50.589112
[0m12:05:50.590111 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.591112 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m12:05:50.593111 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:05:50.469722 => 12:05:50.593111
[0m12:05:50.593111 [debug] [Thread-4 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:05:50.594114 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A24220A810>]}
[0m12:05:50.595113 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount: Close
[0m12:05:50.598146 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:05:50.599160 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.600175 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A242047910>]}
[0m12:05:50.599160 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.14s]
[0m12:05:50.601218 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m12:05:50.604408 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m12:05:50.605456 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:05:50.604932 [info ] [Thread-3 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.15s]
[0m12:05:50.608505 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:05:50.609596 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.610645 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:05:50.611164 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m12:05:50.613306 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:05:50.613906 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m12:05:50.614950 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.614950 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:05:50.614950 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.614950 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:05:50.619193 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:05:50.488140 => 12:05:50.614950
[0m12:05:50.620194 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:05:50.620479 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m12:05:50.620479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2421D2D50>]}
[0m12:05:50.620479 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.13s]
[0m12:05:50.620479 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:05:50.624986 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.624986 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m12:05:50.624986 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:05:50.624986 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m12:05:50.624986 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.624986 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:05:50.469722 => 12:05:50.624986
[0m12:05:50.624986 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: Close
[0m12:05:50.624986 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2421D0A50>]}
[0m12:05:50.624986 [info ] [Thread-4 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.17s]
[0m12:05:50.624986 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:05:50.637638 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m12:05:50.637638 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_analysis .................. [RUN]
[0m12:05:50.637638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_analysis)
[0m12:05:50.637638 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m12:05:50.637638 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m12:05:50.637638 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 12:05:50.637638 => 12:05:50.637638
[0m12:05:50.637638 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m12:05:50.637638 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_analysis"
[0m12:05:50.637638 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:05:50.637638 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: BEGIN
[0m12:05:50.637638 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:05:50.654086 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.654086 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:05:50.654086 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

select 
    diagnosis_key,
    category_title,
    count(*) as count
from 
    analysis
where
    category_title is NOT NULL
group by
    diagnosis_key,
    category_title
order by
    count desc
  );
  
[0m12:05:50.704260 [debug] [Thread-2 (]: SQL status: SELECT 2060 in 0.0 seconds
[0m12:05:50.704260 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:05:50.704260 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis" rename to "diagnosis_analysis__dbt_backup"
[0m12:05:50.704260 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.720201 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:05:50.721170 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
alter table "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_tmp" rename to "diagnosis_analysis"
[0m12:05:50.722168 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:05:50.723167 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m12:05:50.724183 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:05:50.724183 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: COMMIT
[0m12:05:50.727168 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.729187 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup"
[0m12:05:50.730167 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_analysis"
[0m12:05:50.730167 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_analysis"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_analysis__dbt_backup" cascade
[0m12:05:50.733167 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:05:50.735168 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 12:05:50.637638 => 12:05:50.734168
[0m12:05:50.735674 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_analysis: Close
[0m12:05:50.735674 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32203f12-263a-49b9-9c5f-6213ab4fa567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A241F08550>]}
[0m12:05:50.736676 [info ] [Thread-2 (]: 11 of 11 OK created sql table model public_gold.diagnosis_analysis ............. [[32mSELECT 2060[0m in 0.10s]
[0m12:05:50.737681 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m12:05:50.738678 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.739680 [debug] [MainThread]: On master: BEGIN
[0m12:05:50.739680 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:50.753815 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:05:50.753815 [debug] [MainThread]: On master: COMMIT
[0m12:05:50.753815 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.753815 [debug] [MainThread]: On master: COMMIT
[0m12:05:50.753815 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:05:50.753815 [debug] [MainThread]: On master: Close
[0m12:05:50.753815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:50.753815 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:05:50.753815 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:05:50.753815 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:05:50.753815 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:05:50.753815 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m12:05:50.753815 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_analysis' was properly closed.
[0m12:05:50.753815 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m12:05:50.753815 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m12:05:50.753815 [info ] [MainThread]: 
[0m12:05:50.753815 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m12:05:50.753815 [debug] [MainThread]: Command end result
[0m12:05:50.769617 [info ] [MainThread]: 
[0m12:05:50.769617 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:50.769617 [info ] [MainThread]: 
[0m12:05:50.769617 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m12:05:50.769617 [debug] [MainThread]: Command `dbt run` succeeded at 12:05:50.769617 after 1.21 seconds
[0m12:05:50.769617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A24094CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A23B21C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A23B21C550>]}
[0m12:05:50.769617 [debug] [MainThread]: Flushing usage events
[0m12:07:37.847419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958A77650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219586CAB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958A98E10>]}


============================== 12:07:37.847419 | 5255503a-cbae-44ad-81f5-ae77ee1fc0cd ==============================
[0m12:07:37.847419 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:07:37.847419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:07:37.965431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5255503a-cbae-44ad-81f5-ae77ee1fc0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958C6A650>]}
[0m12:07:38.025548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5255503a-cbae-44ad-81f5-ae77ee1fc0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958C68F10>]}
[0m12:07:38.025548 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:07:38.025548 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:07:38.088369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:07:38.088369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:07:38.089299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:07:38.094365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5255503a-cbae-44ad-81f5-ae77ee1fc0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958ED4B10>]}
[0m12:07:38.096298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5255503a-cbae-44ad-81f5-ae77ee1fc0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958EE8990>]}
[0m12:07:38.097300 [info ] [MainThread]: Found 11 models, 29 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:07:38.097300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5255503a-cbae-44ad-81f5-ae77ee1fc0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958C48810>]}
[0m12:07:38.100361 [info ] [MainThread]: 
[0m12:07:38.100361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:07:38.100361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:07:38.100361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:07:38.100361 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:07:38.100361 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:07:38.100361 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:07:38.100361 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:07:38.100361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:38.100361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:38.152356 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:07:38.152356 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:07:38.152356 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:07:38.152356 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:07:38.152356 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:07:38.152356 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:07:38.152356 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:07:38.152356 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:07:38.152356 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:07:38.166093 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:07:38.168002 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:07:38.168002 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:07:38.168002 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:38.178517 [debug] [MainThread]: On master: BEGIN
[0m12:07:38.178517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:38.206900 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:07:38.206900 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:38.207898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:07:38.211925 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:07:38.211925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5255503a-cbae-44ad-81f5-ae77ee1fc0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958ED4BD0>]}
[0m12:07:38.212903 [debug] [MainThread]: On master: ROLLBACK
[0m12:07:38.213850 [debug] [MainThread]: On master: Close
[0m12:07:38.213850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:38.215460 [info ] [MainThread]: 
[0m12:07:38.217548 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:07:38.217548 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:07:38.217548 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:07:38.217548 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:07:38.217548 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:07:38.217548 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:07:38.217548 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0'
[0m12:07:38.217548 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715'
[0m12:07:38.217548 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:07:38.217548 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:07:38.217548 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:07:38.217548 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:07:38.217548 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:07:38.217548 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:07:38.235418 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:07:38.235418 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:07:38.235418 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:07:38.217548 => 12:07:38.235418
[0m12:07:38.235418 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:07:38.217548 => 12:07:38.235418
[0m12:07:38.235418 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:07:38.235418 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:07:38.235418 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:07:38.235418 => 12:07:38.235418
[0m12:07:38.235418 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:07:38.235418 => 12:07:38.235418
[0m12:07:38.235418 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (compile): 12:07:38.235418 => 12:07:38.235418
[0m12:07:38.235418 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:07:38.217548 => 12:07:38.235418
[0m12:07:38.235418 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:07:38.250402 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:07:38.250967 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:07:38.250967 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:07:38.250967 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:07:38.250967 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:07:38.250967 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (execute): 12:07:38.250967 => 12:07:38.250967
[0m12:07:38.250967 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:07:38.250967 => 12:07:38.250967
[0m12:07:38.250967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:07:38.250967 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca)
[0m12:07:38.250967 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:07:38.250967 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:07:38.250967 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:07:38.250967 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:07:38.250967 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:07:38.250967 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:07:38.250967 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:07:38.266126 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:07:38.267172 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715, now model.postgres_dev.dim_diagnosis)
[0m12:07:38.268031 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:07:38.268031 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:07:38.268031 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:07:38.268031 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:07:38.250967 => 12:07:38.268031
[0m12:07:38.268031 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (compile): 12:07:38.250967 => 12:07:38.268031
[0m12:07:38.268031 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:07:38.268031 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:07:38.268031 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:07:38.268031 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:07:38.268031 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:07:38.268031 => 12:07:38.268031
[0m12:07:38.268031 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:07:38.268031 => 12:07:38.268031
[0m12:07:38.278589 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (execute): 12:07:38.278589 => 12:07:38.278589
[0m12:07:38.278589 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:07:38.278589 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:07:38.278589 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:07:38.268031 => 12:07:38.278589
[0m12:07:38.278589 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:07:38.278589 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:07:38.278589 => 12:07:38.278589
[0m12:07:38.278589 [debug] [Thread-1 (]: Began running node model.postgres_dev.dim_date
[0m12:07:38.278589 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:07:38.282796 [debug] [Thread-2 (]: Began running node model.postgres_dev.dim_member
[0m12:07:38.283848 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:07:38.284347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280, now model.postgres_dev.dim_date)
[0m12:07:38.284347 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:07:38.284347 => 12:07:38.284347
[0m12:07:38.284347 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca, now model.postgres_dev.dim_member)
[0m12:07:38.284347 [debug] [Thread-4 (]: Began running node model.postgres_dev.fact_claims
[0m12:07:38.284347 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.dim_date
[0m12:07:38.284347 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:07:38.284347 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.dim_member
[0m12:07:38.284347 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_diagnosis, now model.postgres_dev.fact_claims)
[0m12:07:38.284347 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:07:38.284347 [debug] [Thread-3 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:07:38.292885 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:07:38.292885 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:07:38.292885 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:07:38.292885 [debug] [Thread-1 (]: Timing info for model.postgres_dev.dim_date (compile): 12:07:38.284347 => 12:07:38.292885
[0m12:07:38.292885 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:07:38.292885 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_member (compile): 12:07:38.284347 => 12:07:38.292885
[0m12:07:38.292885 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:07:38.292885 [debug] [Thread-1 (]: Began executing node model.postgres_dev.dim_date
[0m12:07:38.292885 [debug] [Thread-2 (]: Began executing node model.postgres_dev.dim_member
[0m12:07:38.292885 [debug] [Thread-4 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:07:38.292885 => 12:07:38.292885
[0m12:07:38.300439 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:07:38.301497 [debug] [Thread-1 (]: Timing info for model.postgres_dev.dim_date (execute): 12:07:38.301497 => 12:07:38.301497
[0m12:07:38.301497 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_member (execute): 12:07:38.301497 => 12:07:38.301497
[0m12:07:38.302438 [debug] [Thread-4 (]: Began executing node model.postgres_dev.fact_claims
[0m12:07:38.302438 [debug] [Thread-3 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:07:38.292885 => 12:07:38.302438
[0m12:07:38.303440 [debug] [Thread-1 (]: Finished running node model.postgres_dev.dim_date
[0m12:07:38.304433 [debug] [Thread-2 (]: Finished running node model.postgres_dev.dim_member
[0m12:07:38.304433 [debug] [Thread-4 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:07:38.304433 => 12:07:38.304433
[0m12:07:38.304433 [debug] [Thread-3 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:07:38.305446 [debug] [Thread-1 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:07:38.305446 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:07:38.307493 [debug] [Thread-4 (]: Finished running node model.postgres_dev.fact_claims
[0m12:07:38.308448 [debug] [Thread-3 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:07:38.307493 => 12:07:38.307493
[0m12:07:38.308448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489)
[0m12:07:38.309440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:07:38.309440 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:07:38.310441 [debug] [Thread-3 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:07:38.310441 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:07:38.310441 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:07:38.311442 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:07:38.311442 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:07:38.317432 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:07:38.320430 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:07:38.321383 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:07:38.321383 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:07:38.322453 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:07:38.312439 => 12:07:38.322453
[0m12:07:38.325430 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:07:38.326406 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:07:38.318428 => 12:07:38.325430
[0m12:07:38.326406 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:07:38.326406 [debug] [Thread-1 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:07:38.327375 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:07:38.327375 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:07:38.323368 => 12:07:38.327375
[0m12:07:38.330428 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:07:38.331426 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:07:38.330428 => 12:07:38.330428
[0m12:07:38.331426 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:07:38.331426 => 12:07:38.331426
[0m12:07:38.332404 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:07:38.333388 [debug] [Thread-1 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:07:38.333388 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:07:38.328381 => 12:07:38.333388
[0m12:07:38.333388 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:07:38.333388 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:07:38.333388 => 12:07:38.333388
[0m12:07:38.333388 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:07:38.333388 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:07:38.333388 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:07:38.333388 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:07:38.333388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:07:38.333388 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:07:38.333388 => 12:07:38.333388
[0m12:07:38.333388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:07:38.333388 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:07:38.333388 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:07:38.333388 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:07:38.333388 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:07:38.333388 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:07:38.333388 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:07:38.333388 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:07:38.333388 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:07:38.349054 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:07:38.349054 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:07:38.349054 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:07:38.333388 => 12:07:38.349054
[0m12:07:38.349054 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:07:38.333388 => 12:07:38.349054
[0m12:07:38.349054 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:07:38.349054 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:07:38.349054 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:07:38.349054 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:07:38.349054 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:07:38.349054 => 12:07:38.349054
[0m12:07:38.349054 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:07:38.349054 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:07:38.349054 => 12:07:38.349054
[0m12:07:38.349054 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:07:38.349054 => 12:07:38.349054
[0m12:07:38.349054 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:07:38.349054 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:07:38.349054 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:07:38.349054 => 12:07:38.349054
[0m12:07:38.349054 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:07:38.349054 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:07:38.349054 => 12:07:38.349054
[0m12:07:38.349054 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:07:38.349054 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:07:38.364692 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:07:38.364692 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:07:38.364692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:07:38.364692 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:07:38.364692 => 12:07:38.364692
[0m12:07:38.364692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:07:38.364692 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:07:38.364692 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:07:38.364692 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:07:38.364692 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:07:38.364692 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.not_null_dim_member_member_key.ff327b2471)
[0m12:07:38.364692 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:07:38.364692 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:07:38.364692 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:07:38.364692 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:07:38.378737 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:07:38.378737 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:07:38.364692 => 12:07:38.378737
[0m12:07:38.378737 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:07:38.364692 => 12:07:38.378737
[0m12:07:38.378737 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:07:38.378737 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:07:38.378737 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:07:38.378737 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:07:38.378737 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:07:38.378737 => 12:07:38.378737
[0m12:07:38.378737 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:07:38.378737 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:07:38.378737 => 12:07:38.378737
[0m12:07:38.378737 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:07:38.378737 => 12:07:38.378737
[0m12:07:38.378737 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:07:38.378737 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:07:38.378737 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:07:38.378737 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:07:38.378737 => 12:07:38.378737
[0m12:07:38.378737 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:07:38.378737 => 12:07:38.378737
[0m12:07:38.378737 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:07:38.378737 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:07:38.378737 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:07:38.378737 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:07:38.394476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:07:38.394476 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:07:38.394476 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:07:38.394476 => 12:07:38.394476
[0m12:07:38.394476 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:07:38.394476 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:07:38.394476 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:07:38.394476 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:07:38.394476 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:07:38.394476 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:07:38.394476 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:07:38.394476 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:07:38.394476 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:07:38.394476 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:07:38.394476 => 12:07:38.394476
[0m12:07:38.394476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:07:38.394476 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:07:38.394476 => 12:07:38.394476
[0m12:07:38.410085 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:07:38.410085 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:07:38.410085 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:07:38.410085 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:07:38.410085 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:07:38.410085 => 12:07:38.410085
[0m12:07:38.410085 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:07:38.394476 => 12:07:38.410085
[0m12:07:38.410085 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:07:38.410085 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:07:38.410085 => 12:07:38.410085
[0m12:07:38.410085 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:07:38.410085 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:07:38.410085 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:07:38.410085 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:07:38.410085 => 12:07:38.410085
[0m12:07:38.410085 [debug] [Thread-1 (]: Began running node model.postgres_dev.diagnosis_analysis
[0m12:07:38.410085 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:07:38.410085 => 12:07:38.410085
[0m12:07:38.410085 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:07:38.410085 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:07:38.410085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now model.postgres_dev.diagnosis_analysis)
[0m12:07:38.410085 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:07:38.410085 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now model.postgres_dev.total_allowed_amount)
[0m12:07:38.410085 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:07:38.410085 => 12:07:38.410085
[0m12:07:38.410085 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.diagnosis_analysis
[0m12:07:38.410085 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:07:38.410085 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:07:38.425660 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:07:38.426459 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_analysis"
[0m12:07:38.426459 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now model.postgres_dev.total_paid_amount)
[0m12:07:38.426459 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:07:38.426459 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:07:38.426459 [debug] [Thread-1 (]: Timing info for model.postgres_dev.diagnosis_analysis (compile): 12:07:38.425850 => 12:07:38.426459
[0m12:07:38.426459 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:07:38.426459 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:07:38.426459 => 12:07:38.426459
[0m12:07:38.426459 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_dim_member_member_key.31a1be2e46, now model.postgres_dev.total_paid_amount_by_day)
[0m12:07:38.426459 [debug] [Thread-1 (]: Began executing node model.postgres_dev.diagnosis_analysis
[0m12:07:38.426459 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:07:38.426459 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:07:38.426459 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:07:38.426459 [debug] [Thread-1 (]: Timing info for model.postgres_dev.diagnosis_analysis (execute): 12:07:38.426459 => 12:07:38.426459
[0m12:07:38.426459 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:07:38.426459 => 12:07:38.426459
[0m12:07:38.426459 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:07:38.426459 => 12:07:38.426459
[0m12:07:38.426459 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:07:38.426459 [debug] [Thread-1 (]: Finished running node model.postgres_dev.diagnosis_analysis
[0m12:07:38.426459 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:07:38.426459 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:07:38.442184 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:07:38.426459 => 12:07:38.442184
[0m12:07:38.442184 [debug] [Thread-1 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:07:38.442184 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:07:38.442184 => 12:07:38.442184
[0m12:07:38.442184 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:07:38.442184 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:07:38.442184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.diagnosis_analysis, now test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead)
[0m12:07:38.442184 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:07:38.442184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb)
[0m12:07:38.442184 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:07:38.442184 => 12:07:38.442184
[0m12:07:38.442184 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:07:38.442184 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:07:38.442184 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:07:38.442184 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:07:38.442184 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:07:38.442184 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:07:38.442184 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:07:38.442184 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:07:38.442184 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:07:38.442184 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:07:38.442184 => 12:07:38.442184
[0m12:07:38.442184 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount_by_day, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:07:38.457726 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:07:38.457726 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:07:38.442184 => 12:07:38.457726
[0m12:07:38.457726 [debug] [Thread-1 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:07:38.457726 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:07:38.457726 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:07:38.463326 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:07:38.442184 => 12:07:38.457726
[0m12:07:38.463898 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:07:38.463326 => 12:07:38.463326
[0m12:07:38.463898 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:07:38.463898 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:07:38.463898 => 12:07:38.463898
[0m12:07:38.463898 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:07:38.463898 [debug] [Thread-1 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:07:38.463898 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:07:38.463898 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:07:38.463898 => 12:07:38.463898
[0m12:07:38.463898 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:07:38.463898 => 12:07:38.463898
[0m12:07:38.463898 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:07:38.463898 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:07:38.463898 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:07:38.463898 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:07:38.463898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:07:38.463898 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:07:38.463898 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:07:38.463898 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:07:38.463898 => 12:07:38.463898
[0m12:07:38.463898 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:07:38.463898 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:07:38.463898 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:07:38.463898 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:07:38.478993 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:07:38.478993 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:07:38.478993 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:07:38.478993 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:07:38.478993 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:07:38.463898 => 12:07:38.478993
[0m12:07:38.478993 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:07:38.478993 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:07:38.478993 => 12:07:38.478993
[0m12:07:38.478993 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7)
[0m12:07:38.478993 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:07:38.478993 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:07:38.478993 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:07:38.478993 => 12:07:38.478993
[0m12:07:38.478993 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:07:38.478993 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:07:38.478993 => 12:07:38.478993
[0m12:07:38.478993 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:07:38.478993 => 12:07:38.478993
[0m12:07:38.478993 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:07:38.494639 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:07:38.494639 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:07:38.494639 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:07:38.494639 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:07:38.494639 => 12:07:38.494639
[0m12:07:38.494639 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (compile): 12:07:38.478993 => 12:07:38.494639
[0m12:07:38.494639 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:07:38.494639 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:07:38.494639 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (execute): 12:07:38.494639 => 12:07:38.494639
[0m12:07:38.494639 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:07:38.494639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:38.494639 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:07:38.494639 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:07:38.494639 [debug] [MainThread]: Connection 'test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718' was properly closed.
[0m12:07:38.494639 [debug] [MainThread]: Connection 'test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8' was properly closed.
[0m12:07:38.494639 [debug] [MainThread]: Connection 'test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7' was properly closed.
[0m12:07:38.494639 [debug] [MainThread]: Connection 'test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462' was properly closed.
[0m12:07:38.494639 [debug] [MainThread]: Command end result
[0m12:07:38.757187 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:07:38.757187 [info ] [MainThread]: Building catalog
[0m12:07:38.757187 [debug] [ThreadPool]: Acquiring new postgres connection 'bootcamp_project.information_schema'
[0m12:07:38.757187 [debug] [ThreadPool]: Using postgres connection "bootcamp_project.information_schema"
[0m12:07:38.757187 [debug] [ThreadPool]: On bootcamp_project.information_schema: BEGIN
[0m12:07:38.757187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:38.784351 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:07:38.784351 [debug] [ThreadPool]: Using postgres connection "bootcamp_project.information_schema"
[0m12:07:38.784351 [debug] [ThreadPool]: On bootcamp_project.information_schema: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "bootcamp_project.information_schema"} */

    
    

    select
        'bootcamp_project' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('us_healthcare_claims_data')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('dim_member')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('total_paid_amount_by_day')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('diagnosis_analysis')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('final_us_healthcare_claims_data')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('dim_diagnosis')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('icd_codes_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('icd_codes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('us_healthcare_claims')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('total_paid_amount')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('total_allowed_amount')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('fact_claims')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:07:38.784351 [debug] [ThreadPool]: SQL status: SELECT 95 in 0.0 seconds
[0m12:07:38.784351 [debug] [ThreadPool]: On bootcamp_project.information_schema: ROLLBACK
[0m12:07:38.800862 [debug] [ThreadPool]: On bootcamp_project.information_schema: Close
[0m12:07:38.811876 [info ] [MainThread]: Catalog written to D:\bootcamp_project\postgres_dev\target\catalog.json
[0m12:07:38.812860 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:07:38.812860 after 1.00 seconds
[0m12:07:38.813860 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:07:38.813860 [debug] [MainThread]: Connection 'bootcamp_project.information_schema' was properly closed.
[0m12:07:38.813860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958346F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021958F82350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021956531BD0>]}
[0m12:07:38.814861 [debug] [MainThread]: Flushing usage events
[0m12:07:49.000185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C642E0BC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C642E0B890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63FA10410>]}


============================== 12:07:49.000185 | c57998aa-e243-4416-86bb-15c4cc08c771 ==============================
[0m12:07:49.000185 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:07:49.000185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:49.130099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c57998aa-e243-4416-86bb-15c4cc08c771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C642E05810>]}
[0m12:07:49.168503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c57998aa-e243-4416-86bb-15c4cc08c771', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C642DBC150>]}
[0m12:38:05.326500 [error] [MainThread]: Encountered an error:

[0m12:38:05.411225 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m12:38:05.411225 [debug] [MainThread]: Command `dbt docs serve` failed at 12:38:05.411225 after 1816.46 seconds
[0m12:38:05.426857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C63C3CF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C640766590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6407664D0>]}
[0m12:38:05.426857 [debug] [MainThread]: Flushing usage events
[0m12:38:13.890674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ADADF6D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ADADF63D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ADADF7B10>]}


============================== 12:38:13.890674 | dc2e7887-ecf7-400a-a7c1-c79e25d0b23c ==============================
[0m12:38:13.890674 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:38:13.890674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:13.973703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc2e7887-ecf7-400a-a7c1-c79e25d0b23c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ADAEC4C50>]}
[0m12:38:14.022699 [debug] [MainThread]: Command `dbt clean` succeeded at 12:38:14.022699 after 0.18 seconds
[0m12:38:14.023421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ADAE5F910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ADAE5FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012ADA869850>]}
[0m12:38:14.023421 [debug] [MainThread]: Flushing usage events
[0m12:38:20.566462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBF87450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBF9D110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBF9DBD0>]}


============================== 12:38:20.568733 | b08a94b4-4372-4a24-96df-484080d58507 ==============================
[0m12:38:20.568733 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:38:20.569715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:38:20.724743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b08a94b4-4372-4a24-96df-484080d58507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E9934110>]}
[0m12:38:20.771617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b08a94b4-4372-4a24-96df-484080d58507', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EC0D6190>]}
[0m12:38:20.771617 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:38:20.771617 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m12:38:20.787243 [debug] [MainThread]: Command `dbt run` failed at 12:38:20.787243 after 0.26 seconds
[0m12:38:20.787243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E554C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211E554C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211EBBF3150>]}
[0m12:38:20.787243 [debug] [MainThread]: Flushing usage events
[0m12:38:31.104754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5FFD0F310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5FFD0DBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5FFD0D590>]}


============================== 12:38:31.104754 | 0f91250d-7ddf-48a9-b491-04c94d9b7cc0 ==============================
[0m12:38:31.104754 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:38:31.104754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m12:38:31.172958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f91250d-7ddf-48a9-b491-04c94d9b7cc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5FFD7E4D0>]}
[0m12:38:31.189121 [debug] [MainThread]: Set downloads directory='C:\Users\AKSHAY~1.FUN\AppData\Local\Temp\dbt-downloads-4b7zwn1r'
[0m12:38:31.189121 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:38:31.452251 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:38:31.452251 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:38:31.729512 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:38:31.733508 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:38:32.455226 [info ] [MainThread]: Installed from version 1.1.1
[0m12:38:32.455226 [info ] [MainThread]: Up to date!
[0m12:38:32.455226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '0f91250d-7ddf-48a9-b491-04c94d9b7cc0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5FFD6CE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5FFD6CE50>]}
[0m12:38:32.455226 [debug] [MainThread]: Command `dbt deps` succeeded at 12:38:32.455226 after 1.39 seconds
[0m12:38:32.455226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5FFD5E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F932C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5F932F910>]}
[0m12:38:32.455226 [debug] [MainThread]: Flushing usage events
[0m12:38:38.138941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABEB77C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABEBAF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABEB76D10>]}


============================== 12:38:38.138941 | 869c15ee-b031-4781-af3f-297a3e73b56e ==============================
[0m12:38:38.138941 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:38:38.138941 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:38:38.256243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABED4E290>]}
[0m12:38:38.314021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABEC76550>]}
[0m12:38:38.314021 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:38:38.332277 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:38:38.332277 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:38:38.332277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABEDF5310>]}
[0m12:38:39.656072 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'diagnosis_analysis' in the 'models' section of file 'models\testing\test1.yml'
[0m12:38:39.790548 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.postgres_dev.numeric_diagnosis_analysis_diagnosis_frequency.2ededfd413' (models\testing\test1.yml) depends on a node named 'diagnosis_analysis' in package '' which was not found
[0m12:38:39.813810 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:38:39.819383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF2DBF50>]}
[0m12:38:39.840717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF3BFE10>]}
[0m12:38:39.840717 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:38:39.840717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABEE2B950>]}
[0m12:38:39.840717 [info ] [MainThread]: 
[0m12:38:39.840717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:38:39.840717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:38:39.840717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:38:39.857178 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:38:39.857178 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:38:39.857178 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:38:39.857178 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:38:39.857178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:39.857178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:39.873317 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:38:39.873317 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:38:39.873317 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:38:39.873317 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:38:39.883426 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:38:39.888866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:38:39.890055 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:38:39.890055 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:38:39.890055 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:38:39.890055 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:38:39.890055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:39.890055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:39.906269 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:38:39.906269 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:38:39.906269 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:38:39.906269 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:38:39.906269 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:38:39.906269 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:38:39.906269 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:38:39.906269 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:38:39.921130 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:38:39.922167 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:38:39.923129 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:38:39.923129 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:38:39.930164 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:39.930164 [debug] [MainThread]: On master: BEGIN
[0m12:38:39.930164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:39.955087 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:38:39.955087 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:39.955087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:38:39.955087 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:38:39.955087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABEF2AF90>]}
[0m12:38:39.955087 [debug] [MainThread]: On master: ROLLBACK
[0m12:38:39.955087 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:39.955087 [debug] [MainThread]: On master: BEGIN
[0m12:38:39.970746 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:38:39.970746 [debug] [MainThread]: On master: COMMIT
[0m12:38:39.970746 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:39.970746 [debug] [MainThread]: On master: COMMIT
[0m12:38:39.970746 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:38:39.970746 [debug] [MainThread]: On master: Close
[0m12:38:39.970746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:38:39.970746 [info ] [MainThread]: 
[0m12:38:39.970746 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:38:39.970746 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:38:39.970746 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m12:38:39.970746 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:38:39.970746 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m12:38:39.970746 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:38:39.982416 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:38:39.988750 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:38:39.989230 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:38:39.989230 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:38:39.989230 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:38:39.989230 => 12:38:39.989230
[0m12:38:39.989230 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:38:39.989230 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:38:39.982910 => 12:38:39.989230
[0m12:38:40.006385 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:38:40.021417 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:38:40.023291 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m12:38:40.023291 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:38:40.023291 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:38:40.023291 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m12:38:40.023291 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m12:38:40.023291 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:38:40.023291 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:38:40.042767 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.043797 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:38:40.044781 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m12:38:40.051765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.052765 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:38:40.052765 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m12:38:40.056811 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:38:40.062829 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:38:40.063807 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m12:38:40.064915 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.067948 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:38:40.067948 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m12:38:40.069925 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.078882 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:38:40.078882 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:38:40.078882 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:38:40.103259 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.118870 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m12:38:40.118870 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:38:40.118870 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m12:38:40.133996 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.149725 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:38:39.989230 => 12:38:40.149725
[0m12:38:40.149725 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m12:38:40.149725 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABEF2B710>]}
[0m12:38:40.149725 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.17s]
[0m12:38:40.149725 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:38:40.149725 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m12:38:40.149725 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m12:38:40.149725 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m12:38:40.149725 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m12:38:40.149725 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m12:38:40.149725 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m12:38:40.149725 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m12:38:40.157962 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m12:38:40.158448 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m12:38:40.158950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m12:38:40.158950 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m12:38:40.162376 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:38:40.162376 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:38:40.162376 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:38:40.168420 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:38:40.168420 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 12:38:40.158950 => 12:38:40.168420
[0m12:38:40.171091 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m12:38:40.172152 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 12:38:40.162376 => 12:38:40.171091
[0m12:38:40.172953 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m12:38:40.172953 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m12:38:40.172953 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:38:40.162376 => 12:38:40.172953
[0m12:38:40.172953 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m12:38:40.172953 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m12:38:40.172953 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:38:40.172953 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m12:38:40.172953 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:38:40.172953 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m12:38:40.172953 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m12:38:40.172953 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:38:40.172953 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:38:40.187758 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:38:40.187758 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m12:38:40.189755 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:38:40.204403 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.205404 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.205404 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:38:40.207051 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:38:40.207051 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m12:38:40.207051 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m12:38:40.207051 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.207051 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:38:40.207051 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m12:38:40.223885 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:38:40.226409 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:38:40.226409 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m12:38:40.226409 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m12:38:40.230417 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:38:40.230417 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.230417 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m12:38:40.233788 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:38:40.235824 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m12:38:40.235824 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.238101 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.240120 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:38:40.243124 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:38:40.244101 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:38:40.244101 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:38:40.245100 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:38:40.246102 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:38:40.249101 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:38:40.249101 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m12:38:40.280003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.280999 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.281997 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:38:40.281997 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.285018 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:38:40.287849 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m12:38:40.289869 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:38:40.291851 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:38:40.292870 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m12:38:40.294163 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:38:40.294218 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m12:38:40.295221 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:38:40.295221 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m12:38:40.296731 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:38:40.297343 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.298016 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.298016 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:38:40.298016 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.304424 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.298016 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:38:40.304424 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:38:40.307643 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m12:38:40.308698 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 12:38:40.172953 => 12:38:40.308698
[0m12:38:40.308698 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m12:38:40.308698 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:38:40.309677 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:38:40.310677 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m12:38:40.310677 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m12:38:40.311679 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF3F6CD0>]}
[0m12:38:40.312680 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.313677 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.313677 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.16s]
[0m12:38:40.315681 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:38:40.317712 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m12:38:40.318701 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.318701 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m12:38:40.319696 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:38:40.320680 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:38:40.322083 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 12:38:40.172953 => 12:38:40.322083
[0m12:38:40.322083 [debug] [Thread-3 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:38:40.323080 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:38:40.323080 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m12:38:40.324082 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m12:38:40.324901 [info ] [Thread-3 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m12:38:40.324901 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF40FB90>]}
[0m12:38:40.330417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:38:40.330417 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.330417 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.18s]
[0m12:38:40.330417 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:38:40.330417 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.330417 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m12:38:40.330417 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m12:38:40.338790 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:38:40.340783 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:38:40.022458 => 12:38:40.340783
[0m12:38:40.341480 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:38:40.341480 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m12:38:40.341480 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m12:38:40.341480 [debug] [Thread-3 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:38:40.330417 => 12:38:40.341480
[0m12:38:40.341480 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF3A6290>]}
[0m12:38:40.341480 [debug] [Thread-3 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:38:40.341480 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:38:40.341480 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.37s]
[0m12:38:40.341480 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:38:40.341480 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:38:40.341480 [debug] [Thread-3 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m12:38:40.341480 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:38:40.354487 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:38:40.356485 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.354487 [info ] [Thread-4 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m12:38:40.359021 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:38:40.172953 => 12:38:40.359021
[0m12:38:40.359021 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.dim_diagnosis)
[0m12:38:40.359021 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m12:38:40.359021 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:38:40.359021 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF4FF110>]}
[0m12:38:40.359021 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:38:40.359021 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.20s]
[0m12:38:40.372101 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m12:38:40.374102 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:38:40.359021 => 12:38:40.374102
[0m12:38:40.375104 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:38:40.375802 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:38:40.375802 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:38:40.375802 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.375802 [info ] [Thread-1 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m12:38:40.375802 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m12:38:40.375802 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m12:38:40.375802 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:38:40.375802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.total_allowed_amount)
[0m12:38:40.375802 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m12:38:40.375802 [debug] [Thread-3 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m12:38:40.375802 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:38:40.375802 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:38:40.375802 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:38:40.375802 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m12:38:40.389894 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:38:40.392202 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:38:40.392202 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:38:40.392202 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:38:40.375802 => 12:38:40.392202
[0m12:38:40.392202 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:38:40.390806 => 12:38:40.392202
[0m12:38:40.392202 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:38:40.392202 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:38:40.392202 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:38:40.392202 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m12:38:40.407520 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:38:40.409545 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m12:38:40.409545 [debug] [Thread-3 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m12:38:40.409545 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:38:40.409545 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:38:40.409545 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m12:38:40.409545 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.409545 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m12:38:40.409545 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:38:40.423163 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:38:40.423729 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.423772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:40.424294 [debug] [Thread-3 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m12:38:40.424294 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:38:40.424294 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m12:38:40.424294 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.430304 [debug] [Thread-3 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:38:40.430304 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:38:40.430304 [debug] [Thread-3 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:38:40.430304 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.440173 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m12:38:40.440173 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:38:40.440173 [debug] [Thread-3 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m12:38:40.440173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.440173 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:38:40.440173 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:38:40.445868 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:38:40.455472 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.454457 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:38:40.456456 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:38:40.456456 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m12:38:40.456456 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:38:40.469459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.469459 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.472676 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:38:40.474966 [debug] [Thread-3 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:38:40.341480 => 12:38:40.474702
[0m12:38:40.474966 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:38:40.475675 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m12:38:40.475675 [debug] [Thread-3 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m12:38:40.478692 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:38:40.479674 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF12A0D0>]}
[0m12:38:40.479674 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m12:38:40.480677 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.480677 [info ] [Thread-3 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.15s]
[0m12:38:40.483674 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:38:40.483674 [debug] [Thread-3 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:38:40.484674 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:38:40.484674 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:38:40.485682 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:38:40.485682 [info ] [Thread-3 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m12:38:40.486678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m12:38:40.487673 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:38:40.488694 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:38:40.488694 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.488694 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:38:40.487673 => 12:38:40.488694
[0m12:38:40.488694 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:38:40.488694 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:38:40.488694 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m12:38:40.488694 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:38:40.488694 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:38:40.488694 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m12:38:40.488694 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:38:40.505641 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.505641 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:38:40.505641 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m12:38:40.524158 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.524684 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.524684 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:38:40.530197 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m12:38:40.530197 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:38:40.532143 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:38:40.532143 [debug] [Thread-3 (]: SQL status: SELECT 30 in 0.0 seconds
[0m12:38:40.532143 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:38:40.532143 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m12:38:40.532143 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:38:40.532143 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m12:38:40.556159 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.571314 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.573839 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m12:38:40.576869 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:38:40.576869 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.577834 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:38:40.577834 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m12:38:40.579832 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:38:40.392202 => 12:38:40.579538
[0m12:38:40.579832 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m12:38:40.580833 [debug] [Thread-4 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:38:40.580833 [debug] [Thread-1 (]: On model.postgres_dev.total_allowed_amount: Close
[0m12:38:40.583852 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:38:40.583852 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.584835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC0901D10>]}
[0m12:38:40.584835 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m12:38:40.588699 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:38:40.589716 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:38:40.589716 [info ] [Thread-1 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.21s]
[0m12:38:40.590724 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:38:40.590724 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:38:40.591718 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.593738 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:38:40.594736 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m12:38:40.595716 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.597739 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:38:40.597739 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:38:40.598717 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:38:40.614113 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.614670 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.615184 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.616218 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:38:40.407520 => 12:38:40.616218
[0m12:38:40.617856 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m12:38:40.617856 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m12:38:40.617856 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m12:38:40.621020 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:38:40.622020 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:38:40.623080 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC0901CD0>]}
[0m12:38:40.623080 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m12:38:40.623080 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m12:38:40.623080 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.25s]
[0m12:38:40.623080 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:38:40.623080 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.630089 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:38:40.488694 => 12:38:40.630089
[0m12:38:40.630089 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m12:38:40.630089 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.630089 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAC08DC050>]}
[0m12:38:40.630089 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:38:40.375802 => 12:38:40.630089
[0m12:38:40.630089 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: Close
[0m12:38:40.630089 [info ] [Thread-3 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.14s]
[0m12:38:40.630089 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF33BF10>]}
[0m12:38:40.630089 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:38:40.630089 [info ] [Thread-4 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.27s]
[0m12:38:40.637708 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:38:40.638275 [debug] [Thread-1 (]: Began running node model.postgres_dev.diagnosis_frequency
[0m12:38:40.639734 [info ] [Thread-1 (]: 11 of 11 START sql table model public_gold.diagnosis_frequency ................. [RUN]
[0m12:38:40.639734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_frequency)
[0m12:38:40.639734 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.diagnosis_frequency
[0m12:38:40.639734 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_frequency"
[0m12:38:40.639734 [debug] [Thread-1 (]: Timing info for model.postgres_dev.diagnosis_frequency (compile): 12:38:40.639734 => 12:38:40.639734
[0m12:38:40.639734 [debug] [Thread-1 (]: Began executing node model.postgres_dev.diagnosis_frequency
[0m12:38:40.639734 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_frequency"
[0m12:38:40.639734 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:38:40.639734 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: BEGIN
[0m12:38:40.639734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:40.656517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.656517 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:38:40.656517 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

select 
    diagnosis_key,
    category_title,
    count(*) as diagnosis_frequency
from 
    analysis
where
    category_title is NOT NULL
group by
    diagnosis_key,
    category_title
order by
    diagnosis_frequency desc
  );
  
[0m12:38:40.742715 [debug] [Thread-1 (]: SQL status: SELECT 2060 in 0.0 seconds
[0m12:38:40.744732 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:38:40.744732 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
alter table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp" rename to "diagnosis_frequency"
[0m12:38:40.746715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:38:40.747715 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m12:38:40.748715 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:38:40.748715 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m12:38:40.752715 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.754774 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup"
[0m12:38:40.754774 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:38:40.754774 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup" cascade
[0m12:38:40.754774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:38:40.754774 [debug] [Thread-1 (]: Timing info for model.postgres_dev.diagnosis_frequency (execute): 12:38:40.639734 => 12:38:40.754774
[0m12:38:40.754774 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: Close
[0m12:38:40.754774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '869c15ee-b031-4781-af3f-297a3e73b56e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABF33BD90>]}
[0m12:38:40.754774 [info ] [Thread-1 (]: 11 of 11 OK created sql table model public_gold.diagnosis_frequency ............ [[32mSELECT 2060[0m in 0.12s]
[0m12:38:40.754774 [debug] [Thread-1 (]: Finished running node model.postgres_dev.diagnosis_frequency
[0m12:38:40.754774 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:40.754774 [debug] [MainThread]: On master: BEGIN
[0m12:38:40.754774 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:40.772426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:38:40.772426 [debug] [MainThread]: On master: COMMIT
[0m12:38:40.772426 [debug] [MainThread]: Using postgres connection "master"
[0m12:38:40.772426 [debug] [MainThread]: On master: COMMIT
[0m12:38:40.772426 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:38:40.772426 [debug] [MainThread]: On master: Close
[0m12:38:40.772426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:40.772426 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:38:40.772426 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:38:40.772426 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:38:40.772426 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:38:40.772426 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_frequency' was properly closed.
[0m12:38:40.772426 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m12:38:40.787798 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m12:38:40.788793 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m12:38:40.790139 [info ] [MainThread]: 
[0m12:38:40.790139 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m12:38:40.790139 [debug] [MainThread]: Command end result
[0m12:38:40.855169 [info ] [MainThread]: 
[0m12:38:40.855169 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:40.855169 [info ] [MainThread]: 
[0m12:38:40.855169 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m12:38:40.855169 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:40.855169 after 2.77 seconds
[0m12:38:40.855169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABE5B9B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABD82CA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAB81CC4D0>]}
[0m12:38:40.855169 [debug] [MainThread]: Flushing usage events
[0m12:39:32.901168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD4DEE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD49DC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD49CED0>]}


============================== 12:39:32.901708 | 099b689f-037d-4062-b84f-5b13e7f57797 ==============================
[0m12:39:32.901708 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:39:32.901708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:39:33.022844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '099b689f-037d-4062-b84f-5b13e7f57797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD508690>]}
[0m12:39:33.069853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '099b689f-037d-4062-b84f-5b13e7f57797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD5D5E50>]}
[0m12:39:33.069853 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:39:33.087578 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:39:33.141992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:39:33.142992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:39:33.144006 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:39:33.147995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '099b689f-037d-4062-b84f-5b13e7f57797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD619490>]}
[0m12:39:33.154367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '099b689f-037d-4062-b84f-5b13e7f57797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD7CBF50>]}
[0m12:39:33.154367 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:39:33.154367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099b689f-037d-4062-b84f-5b13e7f57797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD99BF10>]}
[0m12:39:33.154367 [info ] [MainThread]: 
[0m12:39:33.154367 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:39:33.154367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:39:33.169850 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:39:33.171634 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:39:33.171634 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:39:33.171634 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:39:33.171634 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:39:33.171634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:33.171634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:39:33.189085 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.189085 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.189085 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:39:33.189085 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:39:33.189085 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:39:33.189085 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:39:33.203165 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:39:33.204170 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:39:33.205238 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:39:33.205238 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:39:33.205238 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:39:33.205238 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:39:33.205238 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:33.205238 [debug] [MainThread]: On master: BEGIN
[0m12:39:33.205238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:39:33.223467 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.223467 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:33.223467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:39:33.236411 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:39:33.237470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099b689f-037d-4062-b84f-5b13e7f57797', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD72DDD0>]}
[0m12:39:33.237470 [debug] [MainThread]: On master: ROLLBACK
[0m12:39:33.238497 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:33.239440 [debug] [MainThread]: On master: BEGIN
[0m12:39:33.240442 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.240442 [debug] [MainThread]: On master: COMMIT
[0m12:39:33.240442 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:33.241500 [debug] [MainThread]: On master: COMMIT
[0m12:39:33.241500 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:39:33.242442 [debug] [MainThread]: On master: Close
[0m12:39:33.242442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:39:33.243462 [info ] [MainThread]: 
[0m12:39:33.246497 [debug] [Thread-1 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:39:33.247442 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:39:33.247442 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:39:33.247442 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:39:33.247442 [info ] [Thread-1 (]: 1 of 31 START test accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [RUN]
[0m12:39:33.248511 [info ] [Thread-2 (]: 2 of 31 START test not_null_dim_member_member_key .............................. [RUN]
[0m12:39:33.248511 [info ] [Thread-3 (]: 3 of 31 START test not_null_fact_claims_claimed_date_key ....................... [RUN]
[0m12:39:33.250464 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489'
[0m12:39:33.249427 [info ] [Thread-4 (]: 4 of 31 START test not_null_fact_claims_enrolled_date_key ...................... [RUN]
[0m12:39:33.250674 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_dim_member_member_key.ff327b2471'
[0m12:39:33.250674 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead'
[0m12:39:33.253231 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:39:33.254232 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb'
[0m12:39:33.254972 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:39:33.254972 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:39:33.254972 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:39:33.254972 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:39:33.272501 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:39:33.272501 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:39:33.280125 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:39:33.280125 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:39:33.254972 => 12:39:33.280125
[0m12:39:33.280125 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:39:33.269962 => 12:39:33.280125
[0m12:39:33.280125 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:39:33.254972 => 12:39:33.280125
[0m12:39:33.280125 [debug] [Thread-1 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:39:33.280125 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:39:33.272501 => 12:39:33.280125
[0m12:39:33.280125 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:39:33.280125 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:39:33.288518 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:39:33.288518 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:39:33.288518 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:39:33.288518 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:39:33.288518 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:39:33.288518 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:39:33.288518 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:39:33.303143 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:39:33.304297 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: BEGIN
[0m12:39:33.304826 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:39:33.304826 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: BEGIN
[0m12:39:33.304826 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: BEGIN
[0m12:39:33.305891 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:39:33.305891 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: BEGIN
[0m12:39:33.305891 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:39:33.306945 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:39:33.306945 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:39:33.318837 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.318837 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:39:33.319837 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Others'
)



      
    ) dbt_internal_test
[0m12:39:33.322234 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.324233 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:39:33.280125 => 12:39:33.323233
[0m12:39:33.324233 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: ROLLBACK
[0m12:39:33.325231 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: Close
[0m12:39:33.326257 [info ] [Thread-1 (]: 1 of 31 PASS accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [[32mPASS[0m in 0.08s]
[0m12:39:33.328237 [debug] [Thread-1 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:39:33.328237 [debug] [Thread-1 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:39:33.329232 [info ] [Thread-1 (]: 5 of 31 START test not_null_us_healthcare_claims_data_claim_id ................. [RUN]
[0m12:39:33.330237 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.331233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:39:33.331233 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.331233 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:39:33.332235 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:39:33.332235 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:39:33.333234 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.333234 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claimed_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where claimed_date_key is null



      
    ) dbt_internal_test
[0m12:39:33.337135 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:39:33.337526 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select enrolled_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where enrolled_date_key is null



      
    ) dbt_internal_test
[0m12:39:33.337526 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:39:33.337526 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:39:33.333234 => 12:39:33.337526
[0m12:39:33.337526 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_key
from "bootcamp_project"."public_silver"."dim_member"
where member_key is null



      
    ) dbt_internal_test
[0m12:39:33.337526 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.337526 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.337526 [debug] [Thread-1 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:39:33.337526 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:39:33.288518 => 12:39:33.337526
[0m12:39:33.337526 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.337526 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:39:33.288518 => 12:39:33.337526
[0m12:39:33.337526 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:39:33.337526 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: ROLLBACK
[0m12:39:33.337526 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:39:33.288518 => 12:39:33.337526
[0m12:39:33.337526 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: ROLLBACK
[0m12:39:33.337526 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: ROLLBACK
[0m12:39:33.337526 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:39:33.337526 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: Close
[0m12:39:33.337526 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: BEGIN
[0m12:39:33.337526 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: Close
[0m12:39:33.337526 [info ] [Thread-4 (]: 4 of 31 PASS not_null_fact_claims_enrolled_date_key ............................ [[32mPASS[0m in 0.08s]
[0m12:39:33.353146 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: Close
[0m12:39:33.353146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:33.355265 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:39:33.355265 [info ] [Thread-3 (]: 3 of 31 PASS not_null_fact_claims_claimed_date_key ............................. [[32mPASS[0m in 0.10s]
[0m12:39:33.355265 [info ] [Thread-2 (]: 2 of 31 PASS not_null_dim_member_member_key .................................... [[32mPASS[0m in 0.10s]
[0m12:39:33.355265 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:39:33.355265 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:39:33.355265 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:39:33.355265 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:39:33.355265 [info ] [Thread-4 (]: 6 of 31 START test not_null_us_healthcare_claims_data_member_id ................ [RUN]
[0m12:39:33.355265 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:39:33.355265 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:39:33.355265 [info ] [Thread-3 (]: 7 of 31 START test relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [RUN]
[0m12:39:33.355265 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:39:33.355265 [info ] [Thread-2 (]: 8 of 31 START test relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [RUN]
[0m12:39:33.355265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:39:33.355265 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:39:33.355265 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:39:33.355265 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:39:33.369776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.369776 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:39:33.370776 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:39:33.355265 => 12:39:33.370776
[0m12:39:33.372129 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:39:33.372129 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:39:33.372129 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:39:33.372129 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:39:33.372129 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is null



      
    ) dbt_internal_test
[0m12:39:33.372129 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:39:33.371775 => 12:39:33.372129
[0m12:39:33.372129 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:39:33.386540 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:39:33.372129 => 12:39:33.372129
[0m12:39:33.386540 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:39:33.388538 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:39:33.389173 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:39:33.389173 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:39:33.389173 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.389173 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:39:33.389173 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: BEGIN
[0m12:39:33.389173 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:39:33.337526 => 12:39:33.389173
[0m12:39:33.389173 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:39:33.389173 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:33.389173 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:39:33.389173 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: ROLLBACK
[0m12:39:33.389173 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: BEGIN
[0m12:39:33.389173 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: BEGIN
[0m12:39:33.389173 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:39:33.389173 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:33.389173 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: Close
[0m12:39:33.404232 [info ] [Thread-1 (]: 5 of 31 PASS not_null_us_healthcare_claims_data_claim_id ....................... [[32mPASS[0m in 0.07s]
[0m12:39:33.406781 [debug] [Thread-1 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:39:33.406781 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:39:33.406781 [info ] [Thread-1 (]: 9 of 31 START test relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [RUN]
[0m12:39:33.406781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:39:33.406781 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:39:33.406781 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:39:33.406781 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:39:33.406781 => 12:39:33.406781
[0m12:39:33.406781 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:39:33.419798 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.422102 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:39:33.424123 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:39:33.424123 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_code is not null
),

parent as (
    select category_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.424123 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.424123 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.424123 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:39:33.424123 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:39:33.424123 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:39:33.424123 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: BEGIN
[0m12:39:33.424123 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is null



      
    ) dbt_internal_test
[0m12:39:33.424123 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_title as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_title is not null
),

parent as (
    select category_title as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.424123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:33.424123 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.424123 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:39:33.372129 => 12:39:33.424123
[0m12:39:33.424123 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: ROLLBACK
[0m12:39:33.424123 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: Close
[0m12:39:33.437485 [info ] [Thread-4 (]: 6 of 31 PASS not_null_us_healthcare_claims_data_member_id ...................... [[32mPASS[0m in 0.08s]
[0m12:39:33.439649 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:39:33.439649 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:39:33.439649 [info ] [Thread-4 (]: 10 of 31 START test relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [RUN]
[0m12:39:33.439649 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:39:33.439649 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:39:33.450187 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:39:33.451359 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:39:33.439649 => 12:39:33.451359
[0m12:39:33.454192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.455190 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:39:33.455190 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:39:33.458760 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:39:33.458760 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_code is not null
),

parent as (
    select diagnosis_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.462522 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:39:33.462522 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: BEGIN
[0m12:39:33.462522 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:33.462522 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.462522 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:39:33.389173 => 12:39:33.462522
[0m12:39:33.470143 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: ROLLBACK
[0m12:39:33.472927 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: Close
[0m12:39:33.476894 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.476894 [info ] [Thread-3 (]: 7 of 31 PASS relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:39:33.476894 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:39:33.389173 => 12:39:33.476894
[0m12:39:33.476894 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:39:33.476894 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: ROLLBACK
[0m12:39:33.476894 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:39:33.476894 [info ] [Thread-3 (]: 11 of 31 START test relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [RUN]
[0m12:39:33.482403 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:39:33.482403 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: Close
[0m12:39:33.482403 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:39:33.489446 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:39:33.482403 [info ] [Thread-2 (]: 8 of 31 PASS relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [[32mPASS[0m in 0.13s]
[0m12:39:33.491421 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:39:33.491421 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:39:33.482403 => 12:39:33.491421
[0m12:39:33.491421 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:39:33.491421 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:39:33.495212 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:39:33.495212 [info ] [Thread-2 (]: 12 of 31 START test relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [RUN]
[0m12:39:33.495212 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:39:33.495212 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.495212 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:39:33.495212 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:39:33.495212 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:39:33.420799 => 12:39:33.495212
[0m12:39:33.495212 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.503067 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: BEGIN
[0m12:39:33.505502 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:39:33.505502 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: ROLLBACK
[0m12:39:33.505502 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:39:33.505502 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:39:33.505502 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:39:33.503580 => 12:39:33.505502
[0m12:39:33.505502 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_key as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_key is not null
),

parent as (
    select full_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.505502 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: Close
[0m12:39:33.505502 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:39:33.505502 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:39:33.505502 [info ] [Thread-1 (]: 9 of 31 PASS relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [[32mPASS[0m in 0.10s]
[0m12:39:33.519915 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:39:33.520449 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:39:33.521445 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:39:33.522904 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: BEGIN
[0m12:39:33.524504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:33.522904 [info ] [Thread-1 (]: 13 of 31 START test relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [RUN]
[0m12:39:33.524504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:39:33.524504 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:39:33.533552 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:39:33.533552 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:39:33.524504 => 12:39:33.533552
[0m12:39:33.533552 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:39:33.537448 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:39:33.537448 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.539285 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:39:33.539285 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select full_description as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where full_description is not null
),

parent as (
    select full_description as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.539285 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:39:33.539285 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: BEGIN
[0m12:39:33.539285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:33.539285 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.539285 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.539285 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:39:33.456232 => 12:39:33.539285
[0m12:39:33.539285 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:39:33.539285 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: ROLLBACK
[0m12:39:33.539285 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select address as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where address is not null
),

parent as (
    select address as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.549814 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: Close
[0m12:39:33.551328 [info ] [Thread-4 (]: 10 of 31 PASS relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [[32mPASS[0m in 0.11s]
[0m12:39:33.553320 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.555323 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:39:33.556297 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:39:33.505502 => 12:39:33.556297
[0m12:39:33.556297 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:39:33.556297 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: ROLLBACK
[0m12:39:33.556297 [info ] [Thread-4 (]: 14 of 31 START test relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [RUN]
[0m12:39:33.556297 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:39:33.556297 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: Close
[0m12:39:33.563822 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:39:33.567839 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:39:33.563822 [info ] [Thread-2 (]: 12 of 31 PASS relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.07s]
[0m12:39:33.571815 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:39:33.572800 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:39:33.572800 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:39:33.563822 => 12:39:33.572800
[0m12:39:33.574994 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.574994 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:39:33.574994 [info ] [Thread-2 (]: 15 of 31 START test relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [RUN]
[0m12:39:33.574994 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:39:33.574994 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:39:33.574994 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:39:33.574994 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select email as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where email is not null
),

parent as (
    select email as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.583553 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.583553 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:39:33.583553 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:39:33.583553 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:39:33.495212 => 12:39:33.583553
[0m12:39:33.588880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.588880 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:39:33.588880 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: BEGIN
[0m12:39:33.588880 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: ROLLBACK
[0m12:39:33.588880 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:39:33.533552 => 12:39:33.588880
[0m12:39:33.588880 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:33.588880 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:39:33.583553 => 12:39:33.588880
[0m12:39:33.588880 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: ROLLBACK
[0m12:39:33.588880 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:39:33.588880 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: Close
[0m12:39:33.588880 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:39:33.588880 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: Close
[0m12:39:33.588880 [info ] [Thread-3 (]: 11 of 31 PASS relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [[32mPASS[0m in 0.11s]
[0m12:39:33.588880 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:39:33.604206 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:39:33.588880 [info ] [Thread-1 (]: 13 of 31 PASS relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.06s]
[0m12:39:33.605206 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: BEGIN
[0m12:39:33.605629 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:39:33.605629 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:39:33.605629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:33.605629 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:39:33.605629 [info ] [Thread-3 (]: 16 of 31 START test relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:39:33.605629 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:39:33.605629 [info ] [Thread-1 (]: 17 of 31 START test relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [RUN]
[0m12:39:33.605629 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:39:33.605629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:39:33.605629 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:39:33.605629 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:39:33.619767 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.622422 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:39:33.624475 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:39:33.624475 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:39:33.605629 => 12:39:33.624475
[0m12:39:33.624475 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select gender as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where gender is not null
),

parent as (
    select gender as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.624475 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:39:33.605629 => 12:39:33.624475
[0m12:39:33.624475 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:39:33.624475 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:39:33.624475 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:39:33.624475 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.624475 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:39:33.624475 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.624475 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:39:33.574994 => 12:39:33.624475
[0m12:39:33.624475 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:39:33.624475 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:39:33.624475 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: ROLLBACK
[0m12:39:33.624475 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:39:33.636462 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: BEGIN
[0m12:39:33.637482 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select name as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where name is not null
),

parent as (
    select name as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.638326 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: BEGIN
[0m12:39:33.638326 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:39:33.638326 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: Close
[0m12:39:33.638326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:33.638326 [info ] [Thread-4 (]: 14 of 31 PASS relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:39:33.638326 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.638326 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:39:33.638326 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:39:33.588880 => 12:39:33.638326
[0m12:39:33.638326 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:39:33.638326 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: ROLLBACK
[0m12:39:33.638326 [info ] [Thread-4 (]: 18 of 31 START test relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [RUN]
[0m12:39:33.638326 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:39:33.638326 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: Close
[0m12:39:33.638326 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:39:33.655914 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:39:33.638326 [info ] [Thread-2 (]: 15 of 31 PASS relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.06s]
[0m12:39:33.655914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.655914 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:39:33.655914 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.655914 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:39:33.655914 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:39:33.638326 => 12:39:33.655914
[0m12:39:33.655914 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:39:33.655914 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:39:33.655914 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_1_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_1_key is not null
),

parent as (
    select diagnosis_1 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.655914 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:39:33.655914 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select claim_id as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where claim_id is not null
),

parent as (
    select claim_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.655914 [info ] [Thread-2 (]: 19 of 31 START test relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [RUN]
[0m12:39:33.655914 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:39:33.655914 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.655914 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:39:33.671769 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:39:33.624475 => 12:39:33.670768
[0m12:39:33.672582 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.672582 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:39:33.672582 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:39:33.672582 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: ROLLBACK
[0m12:39:33.724778 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:39:33.624475 => 12:39:33.724778
[0m12:39:33.724778 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: BEGIN
[0m12:39:33.724778 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:39:33.724778 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: ROLLBACK
[0m12:39:33.724778 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:33.724778 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: Close
[0m12:39:33.724778 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: Close
[0m12:39:33.724778 [info ] [Thread-1 (]: 17 of 31 PASS relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.12s]
[0m12:39:33.724778 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:39:33.724778 => 12:39:33.724778
[0m12:39:33.724778 [info ] [Thread-3 (]: 16 of 31 PASS relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.12s]
[0m12:39:33.724778 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:39:33.736428 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:39:33.737616 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:39:33.738618 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:39:33.740636 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:39:33.740636 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:39:33.741617 [info ] [Thread-1 (]: 20 of 31 START test relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:39:33.742617 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:39:33.742617 [info ] [Thread-3 (]: 21 of 31 START test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [RUN]
[0m12:39:33.743653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:39:33.744628 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: BEGIN
[0m12:39:33.744628 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7)
[0m12:39:33.745649 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:39:33.745649 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:33.746617 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:39:33.750633 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:39:33.750633 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.755130 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:39:33.755130 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:39:33.755130 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:39:33.746617 => 12:39:33.755130
[0m12:39:33.755130 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_2_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_2_key is not null
),

parent as (
    select diagnosis_2 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.755130 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (compile): 12:39:33.750633 => 12:39:33.755130
[0m12:39:33.755130 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:39:33.755130 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:39:33.755130 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:39:33.755130 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.755130 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:39:33.755130 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.755130 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:39:33.655914 => 12:39:33.755130
[0m12:39:33.755130 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:39:33.755130 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:39:33.755130 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:39:33.769765 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: ROLLBACK
[0m12:39:33.769765 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: BEGIN
[0m12:39:33.771249 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_3_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_3_key is not null
),

parent as (
    select diagnosis_3 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.771249 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: BEGIN
[0m12:39:33.771249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:33.771249 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:39:33.771249 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: Close
[0m12:39:33.771249 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.771249 [info ] [Thread-4 (]: 18 of 31 PASS relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.13s]
[0m12:39:33.771249 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:39:33.738618 => 12:39:33.771249
[0m12:39:33.771249 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:39:33.771249 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: ROLLBACK
[0m12:39:33.771249 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:39:33.771249 [info ] [Thread-4 (]: 22 of 31 START test source_not_null_bootcamp_project_icd_codes_Full_Code ....... [RUN]
[0m12:39:33.771249 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: Close
[0m12:39:33.771249 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718, now test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0)
[0m12:39:33.771249 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:39:33.771249 [info ] [Thread-2 (]: 19 of 31 PASS relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.12s]
[0m12:39:33.786454 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:39:33.788459 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:39:33.788982 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.788982 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:39:33.788982 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:39:33.788982 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select total_paid_amount as from_field
    from "bootcamp_project"."public_gold"."total_paid_amount"
    where total_paid_amount is not null
),

parent as (
    select  as to_field
    from "bootcamp_project"."public_silver"."fact_claims"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.788982 [info ] [Thread-2 (]: 23 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:39:33.788982 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:39:33.771249 => 12:39:33.788982
[0m12:39:33.788982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4)
[0m12:39:33.788982 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:39:33.788982 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 18:     select  as to_field
                     ^

[0m12:39:33.788982 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:39:33.788982 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:39:33.788982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.788982 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: ROLLBACK
[0m12:39:33.788982 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:39:33.788982 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:39:33.788982 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:39:33.803123 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (execute): 12:39:33.755130 => 12:39:33.803123
[0m12:39:33.804124 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select member_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where member_key is not null
),

parent as (
    select member_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:39:33.805122 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (compile): 12:39:33.788982 => 12:39:33.804124
[0m12:39:33.805326 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: BEGIN
[0m12:39:33.805326 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: Close
[0m12:39:33.805326 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:39:33.805326 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:33.805326 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:39:33.805326 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.805326 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:39:33.755130 => 12:39:33.805326
[0m12:39:33.805326 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:39:33.805326 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: ROLLBACK
[0m12:39:33.805326 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: BEGIN
[0m12:39:33.805326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:33.805326 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: Close
[0m12:39:33.820800 [info ] [Thread-1 (]: 20 of 31 PASS relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:39:33.822893 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:39:33.824935 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:39:33.824935 [info ] [Thread-1 (]: 24 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:39:33.824935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60)
[0m12:39:33.824935 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:39:33.824935 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:39:33.824935 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.824935 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:39:33.824935 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (compile): 12:39:33.824935 => 12:39:33.824935
[0m12:39:33.824935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.824935 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Full_Code
from "bootcamp_project"."public"."icd_codes"
where Full_Code is null



      
    ) dbt_internal_test
[0m12:39:33.836463 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:39:33.837473 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:39:33.838617 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:39:33.838617 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select diagnosis_key
from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is null



      
    ) dbt_internal_test
[0m12:39:33.838617 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:39:33.838617 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: BEGIN
[0m12:39:33.838617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:33.838617 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 13: select diagnosis_key
                ^

[0m12:39:33.838617 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: ROLLBACK
[0m12:39:33.838617 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.838617 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (execute): 12:39:33.805326 => 12:39:33.838617
[0m12:39:33.838617 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:39:33.788982 => 12:39:33.838617
[0m12:39:33.838617 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: Close
[0m12:39:33.838617 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: ROLLBACK
[0m12:39:33.853386 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: Close
[0m12:39:33.855798 [info ] [Thread-4 (]: 22 of 31 PASS source_not_null_bootcamp_project_icd_codes_Full_Code ............. [[32mPASS[0m in 0.08s]
[0m12:39:33.858568 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:39:33.858568 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:39:33.860103 [info ] [Thread-4 (]: 25 of 31 START test source_unique_bootcamp_project_icd_codes_Full_Code ......... [RUN]
[0m12:39:33.860103 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:39:33.860103 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:39:33.860103 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:39:33.860103 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:39:33.860103 => 12:39:33.860103
[0m12:39:33.860103 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.869756 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:39:33.870772 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:39:33.872138 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:39:33.872138 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is null



      
    ) dbt_internal_test
[0m12:39:33.872138 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:39:33.872138 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: BEGIN
[0m12:39:33.872138 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:33.872138 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.872138 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (execute): 12:39:33.837473 => 12:39:33.872138
[0m12:39:33.872138 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: ROLLBACK
[0m12:39:33.872138 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: Close
[0m12:39:33.872138 [info ] [Thread-1 (]: 24 of 31 PASS source_not_null_bootcamp_project_us_healthcare_claims_member_id .. [[32mPASS[0m in 0.05s]
[0m12:39:33.872138 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:39:33.872138 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:39:33.872138 [info ] [Thread-1 (]: 26 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:39:33.886400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f)
[0m12:39:33.886400 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:39:33.888843 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:39:33.888843 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (compile): 12:39:33.886400 => 12:39:33.888843
[0m12:39:33.888843 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:39:33.888843 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:39:33.888843 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:39:33.888843 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: BEGIN
[0m12:39:33.888843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:33.888843 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.888843 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:39:33.888843 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Full_Code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."icd_codes"
where Full_Code is not null
group by Full_Code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:39:33.909538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.909538 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:39:33.909538 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    diagnosis_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is not null
group by diagnosis_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:39:33.909538 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 12:     diagnosis_key as unique_field,
             ^

[0m12:39:33.909538 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: ROLLBACK
[0m12:39:33.918570 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (execute): 12:39:33.888843 => 12:39:33.909538
[0m12:39:33.918570 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: Close
[0m12:39:33.926022 [debug] [Thread-2 (]: Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:39:33.926022 [debug] [Thread-3 (]: Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:39:33.926022 [debug] [Thread-1 (]: Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:39:33.926022 [error] [Thread-2 (]: 23 of 31 ERROR source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.14s]
[0m12:39:33.926022 [error] [Thread-3 (]: 21 of 31 ERROR relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [[31mERROR[0m in 0.18s]
[0m12:39:33.926022 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:39:33.926022 [error] [Thread-1 (]: 26 of 31 ERROR source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.05s]
[0m12:39:33.926022 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:39:33.926022 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:39:33.926022 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:39:33.926022 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:39:33.926022 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:39:33.926022 [info ] [Thread-2 (]: 27 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:39:33.926022 [info ] [Thread-3 (]: 28 of 31 START test unique_dim_member_member_key ............................... [RUN]
[0m12:39:33.926022 [info ] [Thread-1 (]: 29 of 31 START test unique_icd_codes_data_full_code ............................ [RUN]
[0m12:39:33.926022 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915)
[0m12:39:33.937555 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:39:33.937555 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.938681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:39:33.938681 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:39:33.938681 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:39:33.938681 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:39:33.870772 => 12:39:33.938681
[0m12:39:33.938681 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:39:33.938681 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:39:33.938681 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:39:33.938681 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: ROLLBACK
[0m12:39:33.938681 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:39:33.938681 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:39:33.938681 => 12:39:33.938681
[0m12:39:33.952324 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (compile): 12:39:33.938681 => 12:39:33.952324
[0m12:39:33.953721 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: Close
[0m12:39:33.954789 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:39:33.955305 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:39:33.938681 => 12:39:33.954789
[0m12:39:33.955854 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:39:33.959143 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:39:33.960766 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:39:33.960230 [info ] [Thread-4 (]: 25 of 31 PASS source_unique_bootcamp_project_icd_codes_Full_Code ............... [[32mPASS[0m in 0.10s]
[0m12:39:33.962884 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:39:33.962884 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:39:33.962884 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:39:33.962884 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:39:33.962884 [debug] [Thread-4 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:39:33.962884 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:39:33.962884 [debug] [Thread-3 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: BEGIN
[0m12:39:33.962884 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:39:33.962884 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: BEGIN
[0m12:39:33.962884 [info ] [Thread-4 (]: 30 of 31 START test unique_us_healthcare_claims_data_claim_id .................. [RUN]
[0m12:39:33.969736 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:39:33.970738 [debug] [Thread-1 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: BEGIN
[0m12:39:33.971700 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:33.971700 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:39:33.971700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:39:33.971700 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:39:33.971700 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:39:33.971700 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:39:33.971700 => 12:39:33.971700
[0m12:39:33.971700 [debug] [Thread-4 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:39:33.971700 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:39:33.971700 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:39:33.971700 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: BEGIN
[0m12:39:33.971700 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:39:33.987506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.989203 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:39:33.989203 [debug] [Thread-1 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    full_code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."icd_codes_data"
where full_code is not null
group by full_code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:39:33.989203 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.989203 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:39:33.989203 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:39:33.989203 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:33.989203 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (execute): 12:39:33.961274 => 12:39:33.989203
[0m12:39:33.989203 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: ROLLBACK
[0m12:39:33.989203 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.989203 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:33.989203 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:39:33.989203 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:39:33.989203 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: Close
[0m12:39:33.989203 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is not null
group by claim_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:39:34.001213 [debug] [Thread-3 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."dim_member"
where member_key is not null
group by member_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:39:34.001213 [info ] [Thread-2 (]: 27 of 31 PASS source_unique_bootcamp_project_us_healthcare_claims_member_id .... [[32mPASS[0m in 0.08s]
[0m12:39:34.003162 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:39:34.004164 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:39:34.005877 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:34.005877 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:34.005877 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:39:33.957478 => 12:39:34.005877
[0m12:39:34.005877 [info ] [Thread-2 (]: 31 of 31 START test unique_us_healthcare_claims_data_member_id ................. [RUN]
[0m12:39:34.005877 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:39:33.971700 => 12:39:34.005877
[0m12:39:34.010888 [debug] [Thread-3 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: ROLLBACK
[0m12:39:34.010904 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:39:34.010904 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: ROLLBACK
[0m12:39:34.010904 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:39:34.010904 [debug] [Thread-3 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: Close
[0m12:39:34.010904 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:39:34.010904 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: Close
[0m12:39:34.010904 [info ] [Thread-3 (]: 28 of 31 PASS unique_dim_member_member_key ..................................... [[32mPASS[0m in 0.07s]
[0m12:39:34.020784 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:39:34.019783 [info ] [Thread-4 (]: 30 of 31 PASS unique_us_healthcare_claims_data_claim_id ........................ [[32mPASS[0m in 0.04s]
[0m12:39:34.021784 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:39:34.010904 => 12:39:34.021784
[0m12:39:34.022544 [debug] [Thread-4 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:39:34.022544 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:39:34.025070 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:39:34.025070 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:39:34.025070 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: BEGIN
[0m12:39:34.025070 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:39:34.031578 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:34.031578 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:39:33.962884 => 12:39:34.031578
[0m12:39:34.031578 [debug] [Thread-1 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: ROLLBACK
[0m12:39:34.031578 [debug] [Thread-1 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: Close
[0m12:39:34.031578 [info ] [Thread-1 (]: 29 of 31 PASS unique_icd_codes_data_full_code .................................. [[32mPASS[0m in 0.09s]
[0m12:39:34.037475 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:39:34.039028 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:39:34.039028 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:39:34.039028 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:39:34.039028 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:39:34.039028 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:39:34.025070 => 12:39:34.039028
[0m12:39:34.039028 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: ROLLBACK
[0m12:39:34.039028 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: Close
[0m12:39:34.039028 [info ] [Thread-2 (]: 31 of 31 PASS unique_us_healthcare_claims_data_member_id ....................... [[32mPASS[0m in 0.03s]
[0m12:39:34.053168 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:39:34.055822 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:34.055822 [debug] [MainThread]: On master: BEGIN
[0m12:39:34.055822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:39:34.055822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:39:34.055822 [debug] [MainThread]: On master: COMMIT
[0m12:39:34.069919 [debug] [MainThread]: Using postgres connection "master"
[0m12:39:34.069919 [debug] [MainThread]: On master: COMMIT
[0m12:39:34.072356 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:39:34.072356 [debug] [MainThread]: On master: Close
[0m12:39:34.072356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:39:34.072356 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:39:34.072356 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:39:34.072356 [debug] [MainThread]: Connection 'test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9' was properly closed.
[0m12:39:34.072356 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea' was properly closed.
[0m12:39:34.072356 [debug] [MainThread]: Connection 'test.postgres_dev.unique_dim_member_member_key.31a1be2e46' was properly closed.
[0m12:39:34.072356 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7' was properly closed.
[0m12:39:34.072356 [info ] [MainThread]: 
[0m12:39:34.072356 [info ] [MainThread]: Finished running 31 tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m12:39:34.072356 [debug] [MainThread]: Command end result
[0m12:39:34.089494 [info ] [MainThread]: 
[0m12:39:34.089494 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:39:34.089494 [info ] [MainThread]: 
[0m12:39:34.089494 [error] [MainThread]:   Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:39:34.089494 [info ] [MainThread]: 
[0m12:39:34.089494 [error] [MainThread]:   Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:39:34.089494 [info ] [MainThread]: 
[0m12:39:34.089494 [error] [MainThread]:   Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:39:34.089494 [info ] [MainThread]: 
[0m12:39:34.089494 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=3 SKIP=0 TOTAL=31
[0m12:39:34.089494 [debug] [MainThread]: Command `dbt test` failed at 12:39:34.089494 after 1.24 seconds
[0m12:39:34.089494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1AD0F3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A6A1C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1A6A1C4D0>]}
[0m12:39:34.089494 [debug] [MainThread]: Flushing usage events
[0m12:40:21.865927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7ED03290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7F0EF6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7F0ED010>]}


============================== 12:40:21.865927 | 3346ccfe-df15-4922-804e-5371c6b6646d ==============================
[0m12:40:21.865927 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:40:21.865927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m12:40:21.983995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3346ccfe-df15-4922-804e-5371c6b6646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7F0EE710>]}
[0m12:40:22.040653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3346ccfe-df15-4922-804e-5371c6b6646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7CA441D0>]}
[0m12:40:22.040653 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:40:22.056491 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:40:22.104624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:40:22.105531 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\testing\test1.yml
[0m12:40:22.197854 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:40:22.197854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3346ccfe-df15-4922-804e-5371c6b6646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7F3B3610>]}
[0m12:40:22.209922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3346ccfe-df15-4922-804e-5371c6b6646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7F4C6690>]}
[0m12:40:22.209922 [info ] [MainThread]: Found 11 models, 32 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:40:22.209922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3346ccfe-df15-4922-804e-5371c6b6646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7F296F10>]}
[0m12:40:22.217414 [info ] [MainThread]: 
[0m12:40:22.220766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:40:22.220766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:40:22.220766 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:40:22.220766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:40:22.220766 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:40:22.220766 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:40:22.220766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:22.220766 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:40:22.220766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:22.271518 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.271518 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.271518 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:40:22.271518 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:40:22.271518 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:40:22.271518 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:40:22.271518 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:40:22.271518 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:40:22.271518 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:40:22.271518 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:40:22.271518 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:40:22.271518 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:40:22.287348 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:22.287348 [debug] [MainThread]: On master: BEGIN
[0m12:40:22.287348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:22.311097 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.312149 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:22.312149 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:40:22.316112 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:40:22.317095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3346ccfe-df15-4922-804e-5371c6b6646d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7F228D10>]}
[0m12:40:22.317095 [debug] [MainThread]: On master: ROLLBACK
[0m12:40:22.318610 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:22.318610 [debug] [MainThread]: On master: BEGIN
[0m12:40:22.320663 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.320663 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.320663 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:22.321663 [debug] [MainThread]: On master: COMMIT
[0m12:40:22.322612 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:40:22.322612 [debug] [MainThread]: On master: Close
[0m12:40:22.322612 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:22.323613 [info ] [MainThread]: 
[0m12:40:22.327646 [debug] [Thread-1 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:40:22.327646 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:40:22.328612 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:40:22.328612 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:40:22.328612 [info ] [Thread-1 (]: 1 of 32 START test accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [RUN]
[0m12:40:22.328612 [info ] [Thread-2 (]: 2 of 32 START test not_null_dim_member_member_key .............................. [RUN]
[0m12:40:22.329611 [info ] [Thread-3 (]: 3 of 32 START test not_null_fact_claims_claimed_date_key ....................... [RUN]
[0m12:40:22.330612 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489'
[0m12:40:22.329611 [info ] [Thread-4 (]: 4 of 32 START test not_null_fact_claims_enrolled_date_key ...................... [RUN]
[0m12:40:22.332095 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_dim_member_member_key.ff327b2471'
[0m12:40:22.332095 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead'
[0m12:40:22.335242 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:40:22.337289 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb'
[0m12:40:22.337289 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:40:22.337289 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:40:22.337289 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:40:22.337289 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:40:22.354258 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:40:22.354258 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:40:22.354258 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:40:22.337289 => 12:40:22.354258
[0m12:40:22.354258 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:40:22.354258 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:40:22.352089 => 12:40:22.354258
[0m12:40:22.354258 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:40:22.354258 => 12:40:22.354258
[0m12:40:22.354258 [debug] [Thread-1 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:40:22.368684 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:40:22.368684 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:40:22.369734 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:40:22.354258 => 12:40:22.369734
[0m12:40:22.370657 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:40:22.370657 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:40:22.370657 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:40:22.370657 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:40:22.385464 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:40:22.385464 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:40:22.388561 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:40:22.388561 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:40:22.388561 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: BEGIN
[0m12:40:22.389514 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: BEGIN
[0m12:40:22.389514 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: BEGIN
[0m12:40:22.390489 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:40:22.390489 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:22.391558 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:40:22.391558 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:40:22.391558 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: BEGIN
[0m12:40:22.393456 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:40:22.408363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.408363 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:40:22.409362 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Others'
)



      
    ) dbt_internal_test
[0m12:40:22.411359 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.412381 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:40:22.369734 => 12:40:22.412381
[0m12:40:22.413377 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: ROLLBACK
[0m12:40:22.414322 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: Close
[0m12:40:22.414322 [info ] [Thread-1 (]: 1 of 32 PASS accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [[32mPASS[0m in 0.08s]
[0m12:40:22.415328 [debug] [Thread-1 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:40:22.416330 [debug] [Thread-1 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:40:22.416330 [info ] [Thread-1 (]: 5 of 32 START test not_null_us_healthcare_claims_data_claim_id ................. [RUN]
[0m12:40:22.418328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:40:22.418328 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:40:22.420363 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:40:22.420363 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:40:22.419328 => 12:40:22.420363
[0m12:40:22.420363 [debug] [Thread-1 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:40:22.420363 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:40:22.420363 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:40:22.420363 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: BEGIN
[0m12:40:22.420363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:22.420363 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.420363 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.420363 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:40:22.420363 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:40:22.420363 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claimed_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where claimed_date_key is null



      
    ) dbt_internal_test
[0m12:40:22.420363 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select enrolled_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where enrolled_date_key is null



      
    ) dbt_internal_test
[0m12:40:22.420363 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.420363 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:40:22.420363 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_key
from "bootcamp_project"."public_silver"."dim_member"
where member_key is null



      
    ) dbt_internal_test
[0m12:40:22.435989 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.435989 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.438194 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:40:22.386515 => 12:40:22.438194
[0m12:40:22.438194 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.438194 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:40:22.370657 => 12:40:22.438194
[0m12:40:22.438194 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: ROLLBACK
[0m12:40:22.438194 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:40:22.370657 => 12:40:22.438194
[0m12:40:22.438194 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: ROLLBACK
[0m12:40:22.438194 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: ROLLBACK
[0m12:40:22.438194 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: Close
[0m12:40:22.438194 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: Close
[0m12:40:22.438194 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: Close
[0m12:40:22.438194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.438194 [info ] [Thread-4 (]: 4 of 32 PASS not_null_fact_claims_enrolled_date_key ............................ [[32mPASS[0m in 0.10s]
[0m12:40:22.438194 [info ] [Thread-3 (]: 3 of 32 PASS not_null_fact_claims_claimed_date_key ............................. [[32mPASS[0m in 0.11s]
[0m12:40:22.438194 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:40:22.438194 [info ] [Thread-2 (]: 2 of 32 PASS not_null_dim_member_member_key .................................... [[32mPASS[0m in 0.11s]
[0m12:40:22.438194 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:40:22.438194 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:40:22.438194 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is null



      
    ) dbt_internal_test
[0m12:40:22.452602 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:40:22.453601 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:40:22.453919 [debug] [Thread-3 (]: Began running node test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5
[0m12:40:22.453919 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:40:22.453919 [info ] [Thread-4 (]: 6 of 32 START test not_null_us_healthcare_claims_data_member_id ................ [RUN]
[0m12:40:22.453919 [info ] [Thread-3 (]: 7 of 32 START test numeric_diagnosis_frequency_diagnosis_frequency ............. [RUN]
[0m12:40:22.453919 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:40:22.453919 [info ] [Thread-2 (]: 8 of 32 START test relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [RUN]
[0m12:40:22.453919 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.453919 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5)
[0m12:40:22.453919 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:40:22.453919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:40:22.453919 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:40:22.420363 => 12:40:22.453919
[0m12:40:22.453919 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5
[0m12:40:22.453919 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:40:22.453919 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:40:22.453919 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: ROLLBACK
[0m12:40:22.470718 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:40:22.470718 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:40:22.453919 => 12:40:22.470718
[0m12:40:22.470718 [debug] [Thread-3 (]: Timing info for test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5 (compile): 12:40:22.453919 => 12:40:22.470718
[0m12:40:22.470718 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:40:22.470718 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: Close
[0m12:40:22.470718 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:40:22.453919 => 12:40:22.470718
[0m12:40:22.470718 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:40:22.470718 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:40:22.470718 [info ] [Thread-1 (]: 5 of 32 PASS not_null_us_healthcare_claims_data_claim_id ....................... [[32mPASS[0m in 0.05s]
[0m12:40:22.470718 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:40:22.487385 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:40:22.488061 [debug] [Thread-1 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:40:22.488061 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: BEGIN
[0m12:40:22.488061 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:40:22.488061 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:40:22.488061 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:22.488061 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: BEGIN
[0m12:40:22.488061 [info ] [Thread-1 (]: 9 of 32 START test relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [RUN]
[0m12:40:22.488061 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:22.488061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:40:22.488061 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:40:22.538107 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:40:22.552138 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:40:22.488061 => 12:40:22.538107
[0m12:40:22.554149 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:40:22.554916 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.554916 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.554916 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:40:22.554916 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:40:22.554916 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:40:22.554916 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:40:22.554916 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_code is not null
),

parent as (
    select category_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.554916 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is null



      
    ) dbt_internal_test
[0m12:40:22.554916 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: BEGIN
[0m12:40:22.554916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:22.571683 [debug] [Thread-3 (]: Compilation Error in test numeric_diagnosis_frequency_diagnosis_frequency (models\testing\test1.yml)
  'test_numeric' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:40:22.572676 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.576683 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:40:22.470718 => 12:40:22.576683
[0m12:40:22.573674 [error] [Thread-3 (]: 7 of 32 ERROR numeric_diagnosis_frequency_diagnosis_frequency .................. [[31mERROR[0m in 0.12s]
[0m12:40:22.578678 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: ROLLBACK
[0m12:40:22.580675 [debug] [Thread-3 (]: Finished running node test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5
[0m12:40:22.581675 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:40:22.582673 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: Close
[0m12:40:22.582673 [info ] [Thread-3 (]: 10 of 32 START test relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [RUN]
[0m12:40:22.585678 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:40:22.584675 [info ] [Thread-4 (]: 6 of 32 PASS not_null_us_healthcare_claims_data_member_id ...................... [[32mPASS[0m in 0.13s]
[0m12:40:22.586978 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:40:22.586978 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:40:22.595043 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:40:22.595043 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.595043 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:40:22.602843 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:40:22.470718 => 12:40:22.602843
[0m12:40:22.602843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.602843 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:40:22.591010 => 12:40:22.602843
[0m12:40:22.602843 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: ROLLBACK
[0m12:40:22.602843 [info ] [Thread-4 (]: 11 of 32 START test relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [RUN]
[0m12:40:22.602843 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:40:22.602843 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:40:22.602843 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:40:22.602843 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_title as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_title is not null
),

parent as (
    select category_title as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.610851 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: Close
[0m12:40:22.610851 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:40:22.610851 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:40:22.610851 [info ] [Thread-2 (]: 8 of 32 PASS relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [[32mPASS[0m in 0.16s]
[0m12:40:22.621960 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:40:22.624725 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:40:22.624725 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:40:22.624725 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: BEGIN
[0m12:40:22.624725 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:40:22.624725 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:40:22.610851 => 12:40:22.624725
[0m12:40:22.624725 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:22.624725 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:40:22.624725 [info ] [Thread-2 (]: 12 of 32 START test relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [RUN]
[0m12:40:22.635383 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:40:22.635899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:40:22.638304 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:40:22.638304 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:40:22.638304 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:40:22.638304 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.638304 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: BEGIN
[0m12:40:22.638304 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:40:22.638304 => 12:40:22.638304
[0m12:40:22.638304 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:40:22.554916 => 12:40:22.638304
[0m12:40:22.638304 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:22.638304 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:40:22.638304 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: ROLLBACK
[0m12:40:22.638304 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:40:22.652012 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:40:22.652012 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: Close
[0m12:40:22.653007 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: BEGIN
[0m12:40:22.654501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:22.654501 [info ] [Thread-1 (]: 9 of 32 PASS relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [[32mPASS[0m in 0.17s]
[0m12:40:22.654501 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:40:22.654501 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:40:22.654501 [info ] [Thread-1 (]: 13 of 32 START test relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:22.654501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:40:22.654501 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:40:22.654501 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:40:22.654501 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:40:22.654501 => 12:40:22.654501
[0m12:40:22.668612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.668612 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.669613 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:40:22.670612 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:40:22.671802 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:40:22.671802 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:40:22.671802 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.671802 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_code is not null
),

parent as (
    select diagnosis_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.671802 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_key as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_key is not null
),

parent as (
    select full_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.671802 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:40:22.671802 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:40:22.671802 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select full_description as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where full_description is not null
),

parent as (
    select full_description as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.671802 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: BEGIN
[0m12:40:22.671802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:22.700282 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.703001 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:40:22.610851 => 12:40:22.703001
[0m12:40:22.703999 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: ROLLBACK
[0m12:40:22.706001 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: Close
[0m12:40:22.707000 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.711182 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:40:22.624725 => 12:40:22.711182
[0m12:40:22.708129 [info ] [Thread-3 (]: 10 of 32 PASS relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:40:22.711182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.711182 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: ROLLBACK
[0m12:40:22.711182 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:40:22.711182 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:40:22.715709 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:40:22.716733 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: Close
[0m12:40:22.717343 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select address as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where address is not null
),

parent as (
    select address as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.717343 [info ] [Thread-3 (]: 14 of 32 START test relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:22.720350 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.719349 [info ] [Thread-4 (]: 11 of 32 PASS relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:40:22.722349 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:40:22.724346 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:40:22.638304 => 12:40:22.723346
[0m12:40:22.724346 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.725343 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:40:22.725343 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:40:22.725343 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: ROLLBACK
[0m12:40:22.727343 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:40:22.671802 => 12:40:22.726343
[0m12:40:22.727343 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:40:22.733802 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:40:22.733966 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: ROLLBACK
[0m12:40:22.735234 [info ] [Thread-4 (]: 15 of 32 START test relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:22.736234 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: Close
[0m12:40:22.737233 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:40:22.727343 => 12:40:22.737233
[0m12:40:22.739248 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:40:22.740244 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: Close
[0m12:40:22.741234 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:40:22.741234 [info ] [Thread-2 (]: 12 of 32 PASS relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [[32mPASS[0m in 0.10s]
[0m12:40:22.742236 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:40:22.745236 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:40:22.743235 [info ] [Thread-1 (]: 13 of 32 PASS relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.09s]
[0m12:40:22.746234 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:40:22.751237 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:40:22.753238 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:40:22.754288 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:40:22.754288 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:40:22.754288 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:40:22.754288 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: BEGIN
[0m12:40:22.754288 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:40:22.746234 => 12:40:22.754288
[0m12:40:22.754288 [info ] [Thread-2 (]: 16 of 32 START test relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:22.754288 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:22.754288 [info ] [Thread-1 (]: 17 of 32 START test relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:22.754288 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:40:22.754288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:40:22.754288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:40:22.754288 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:40:22.754288 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:40:22.754288 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:40:22.769601 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:40:22.774439 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:40:22.774439 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:40:22.774439 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: BEGIN
[0m12:40:22.774439 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:40:22.754288 => 12:40:22.774439
[0m12:40:22.774439 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.774439 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:22.774439 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:40:22.774439 => 12:40:22.774439
[0m12:40:22.774439 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:40:22.786201 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:40:22.787133 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:40:22.787133 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:40:22.787133 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select email as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where email is not null
),

parent as (
    select email as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.787133 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:40:22.787133 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:40:22.787133 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: BEGIN
[0m12:40:22.787133 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:40:22.787133 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:22.787133 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.787133 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: BEGIN
[0m12:40:22.787133 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:40:22.743235 => 12:40:22.787133
[0m12:40:22.787133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:22.787133 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: ROLLBACK
[0m12:40:22.787133 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.801925 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:40:22.801925 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: Close
[0m12:40:22.802926 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select gender as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where gender is not null
),

parent as (
    select gender as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.804925 [info ] [Thread-3 (]: 14 of 32 PASS relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:40:22.806365 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:40:22.806365 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:40:22.806365 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.806365 [info ] [Thread-3 (]: 18 of 32 START test relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:22.811373 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:40:22.754288 => 12:40:22.811373
[0m12:40:22.811373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:40:22.811373 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: ROLLBACK
[0m12:40:22.811373 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:40:22.811373 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:40:22.819253 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: Close
[0m12:40:22.819253 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.820803 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:40:22.811373 => 12:40:22.820803
[0m12:40:22.820803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.820803 [info ] [Thread-4 (]: 15 of 32 PASS relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:40:22.820803 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:40:22.820803 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:40:22.820803 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:40:22.820803 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:40:22.820803 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select name as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where name is not null
),

parent as (
    select name as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.820803 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:40:22.820803 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select claim_id as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where claim_id is not null
),

parent as (
    select claim_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.820803 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:40:22.820803 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:40:22.820803 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: BEGIN
[0m12:40:22.820803 [info ] [Thread-4 (]: 19 of 32 START test relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:22.820803 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.820803 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:22.820803 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.820803 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:40:22.820803 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:40:22.787133 => 12:40:22.820803
[0m12:40:22.836930 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:40:22.787133 => 12:40:22.836930
[0m12:40:22.837685 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:40:22.837685 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: ROLLBACK
[0m12:40:22.837685 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: ROLLBACK
[0m12:40:22.837685 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:40:22.837685 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: Close
[0m12:40:22.837685 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:40:22.837685 => 12:40:22.837685
[0m12:40:22.837685 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: Close
[0m12:40:22.837685 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.837685 [info ] [Thread-2 (]: 16 of 32 PASS relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:40:22.837685 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:40:22.851956 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:40:22.851956 [info ] [Thread-1 (]: 17 of 32 PASS relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.10s]
[0m12:40:22.852971 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:40:22.854557 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:40:22.854557 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_1_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_1_key is not null
),

parent as (
    select diagnosis_1 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.854557 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:40:22.854557 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:40:22.854557 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:40:22.854557 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:40:22.854557 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: BEGIN
[0m12:40:22.854557 [info ] [Thread-2 (]: 20 of 32 START test relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:22.854557 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.854557 [info ] [Thread-1 (]: 21 of 32 START test relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:22.854557 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:22.854557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:40:22.854557 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:40:22.820803 => 12:40:22.854557
[0m12:40:22.854557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:40:22.854557 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:40:22.854557 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: ROLLBACK
[0m12:40:22.854557 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:40:22.871153 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:40:22.871153 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:40:22.871153 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: Close
[0m12:40:22.871153 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:40:22.854557 => 12:40:22.871153
[0m12:40:22.871153 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:40:22.871153 => 12:40:22.871153
[0m12:40:22.871153 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.871153 [info ] [Thread-3 (]: 18 of 32 PASS relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.06s]
[0m12:40:22.871153 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:40:22.871153 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:40:22.871153 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:40:22.871153 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:40:22.871153 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:40:22.887227 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:40:22.887227 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_2_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_2_key is not null
),

parent as (
    select diagnosis_2 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.887227 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:40:22.887227 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:40:22.887227 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:40:22.887227 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: BEGIN
[0m12:40:22.887227 [info ] [Thread-3 (]: 22 of 32 START test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [RUN]
[0m12:40:22.887227 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: BEGIN
[0m12:40:22.887227 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:22.887227 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.887227 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7)
[0m12:40:22.887227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:22.887227 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:40:22.853957 => 12:40:22.887227
[0m12:40:22.887227 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:40:22.887227 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: ROLLBACK
[0m12:40:22.901988 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:40:22.902988 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (compile): 12:40:22.887227 => 12:40:22.902988
[0m12:40:22.903989 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: Close
[0m12:40:22.904719 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:40:22.904719 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:40:22.904719 [info ] [Thread-4 (]: 19 of 32 PASS relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:40:22.911229 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:40:22.911229 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:40:22.911229 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.911229 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:40:22.911229 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: BEGIN
[0m12:40:22.911229 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:40:22.911229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.911229 [info ] [Thread-4 (]: 23 of 32 START test source_not_null_bootcamp_project_icd_codes_Full_Code ....... [RUN]
[0m12:40:22.911229 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:22.911229 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_3_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_3_key is not null
),

parent as (
    select diagnosis_3 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.911229 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:40:22.911229 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718, now test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0)
[0m12:40:22.911229 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select member_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where member_key is not null
),

parent as (
    select member_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.911229 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:40:22.921356 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:40:22.921356 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.921356 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.921356 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:40:22.918713 => 12:40:22.921356
[0m12:40:22.921356 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:40:22.871153 => 12:40:22.921356
[0m12:40:22.921356 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:40:22.871153 => 12:40:22.921356
[0m12:40:22.921356 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:40:22.921356 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: ROLLBACK
[0m12:40:22.921356 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: ROLLBACK
[0m12:40:22.921356 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:40:22.921356 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:40:22.921356 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: Close
[0m12:40:22.921356 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: Close
[0m12:40:22.921356 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.921356 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: BEGIN
[0m12:40:22.935252 [info ] [Thread-1 (]: 21 of 32 PASS relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:40:22.938256 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:40:22.937249 [info ] [Thread-2 (]: 20 of 32 PASS relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:40:22.938719 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:22.938719 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:40:22.938719 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select total_paid_amount as from_field
    from "bootcamp_project"."public_gold"."total_paid_amount"
    where total_paid_amount is not null
),

parent as (
    select  as to_field
    from "bootcamp_project"."public_silver"."fact_claims"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:22.938719 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:40:22.938719 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:40:22.938719 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:40:22.938719 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 18:     select  as to_field
                     ^

[0m12:40:22.938719 [info ] [Thread-1 (]: 24 of 32 START test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:40:22.938719 [info ] [Thread-2 (]: 25 of 32 START test source_not_null_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:40:22.938719 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: ROLLBACK
[0m12:40:22.938719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4)
[0m12:40:22.938719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60)
[0m12:40:22.938719 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:40:22.938719 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (execute): 12:40:22.904719 => 12:40:22.938719
[0m12:40:22.938719 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:40:22.954683 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:40:22.954683 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.954683 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: Close
[0m12:40:22.954683 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:40:22.954683 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:40:22.954683 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (compile): 12:40:22.938719 => 12:40:22.954683
[0m12:40:22.954683 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (compile): 12:40:22.954683 => 12:40:22.954683
[0m12:40:22.954683 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Full_Code
from "bootcamp_project"."public"."icd_codes"
where Full_Code is null



      
    ) dbt_internal_test
[0m12:40:22.954683 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:40:22.954683 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:40:22.968715 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:40:22.971256 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:40:22.971256 [debug] [Thread-3 (]: Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:40:22.971256 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:40:22.971256 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:22.971256 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:40:22.971256 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: BEGIN
[0m12:40:22.971256 [error] [Thread-3 (]: 22 of 32 ERROR relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [[31mERROR[0m in 0.08s]
[0m12:40:22.971256 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:40:22.921356 => 12:40:22.971256
[0m12:40:22.971256 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: BEGIN
[0m12:40:22.971256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:22.971256 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:40:22.971256 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: ROLLBACK
[0m12:40:22.971256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:22.971256 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:40:22.983684 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: Close
[0m12:40:22.971256 [info ] [Thread-3 (]: 26 of 32 START test source_unique_bootcamp_project_icd_codes_Full_Code ......... [RUN]
[0m12:40:22.985285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:40:22.987972 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:40:22.986815 [info ] [Thread-4 (]: 23 of 32 PASS source_not_null_bootcamp_project_icd_codes_Full_Code ............. [[32mPASS[0m in 0.08s]
[0m12:40:22.987972 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:40:22.987972 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:40:22.987972 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.987972 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:40:22.987972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:22.987972 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:40:22.987972 => 12:40:22.987972
[0m12:40:22.987972 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:40:22.987972 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:40:22.987972 [info ] [Thread-4 (]: 27 of 32 START test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:40:22.987972 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:40:22.987972 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is null



      
    ) dbt_internal_test
[0m12:40:22.987972 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select diagnosis_key
from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is null



      
    ) dbt_internal_test
[0m12:40:22.987972 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f)
[0m12:40:23.003787 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:40:23.003787 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:40:23.003787 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:40:23.003787 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:40:23.011293 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 13: select diagnosis_key
                ^

[0m12:40:23.011293 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:23.011293 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: BEGIN
[0m12:40:23.011293 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (compile): 12:40:23.003787 => 12:40:23.011293
[0m12:40:23.011293 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: ROLLBACK
[0m12:40:23.011293 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (execute): 12:40:22.969714 => 12:40:23.011293
[0m12:40:23.011293 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:23.011293 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:40:23.011293 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: ROLLBACK
[0m12:40:23.011293 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (execute): 12:40:22.954683 => 12:40:23.011293
[0m12:40:23.011293 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:40:23.019403 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: Close
[0m12:40:23.020403 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: Close
[0m12:40:23.020962 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:40:23.020962 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: BEGIN
[0m12:40:23.020962 [info ] [Thread-2 (]: 25 of 32 PASS source_not_null_bootcamp_project_us_healthcare_claims_member_id .. [[32mPASS[0m in 0.08s]
[0m12:40:23.020962 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:23.020962 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:40:23.020962 [debug] [Thread-1 (]: Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:40:23.020962 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:40:23.020962 [error] [Thread-1 (]: 24 of 32 ERROR source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.08s]
[0m12:40:23.020962 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:40:23.020962 [info ] [Thread-2 (]: 28 of 32 START test source_unique_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:40:23.020962 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:40:23.020962 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915)
[0m12:40:23.020962 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:40:23.020962 [info ] [Thread-1 (]: 29 of 32 START test unique_dim_member_member_key ............................... [RUN]
[0m12:40:23.035274 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:40:23.036271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:40:23.037673 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:40:23.037673 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (compile): 12:40:23.020962 => 12:40:23.037673
[0m12:40:23.037673 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:40:23.037673 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:40:23.037673 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:40:23.037673 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:40:23.037673 => 12:40:23.037673
[0m12:40:23.037673 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:40:23.037673 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:40:23.037673 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:40:23.037673 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:23.037673 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:23.037673 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: BEGIN
[0m12:40:23.037673 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:40:23.052584 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:40:23.052584 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:40:23.053582 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:23.054120 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Full_Code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."icd_codes"
where Full_Code is not null
group by Full_Code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:23.054120 [debug] [Thread-1 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: BEGIN
[0m12:40:23.054120 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    diagnosis_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is not null
group by diagnosis_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:23.054120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:23.054120 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 12:     diagnosis_key as unique_field,
             ^

[0m12:40:23.054120 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: ROLLBACK
[0m12:40:23.054120 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (execute): 12:40:23.011293 => 12:40:23.054120
[0m12:40:23.054120 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: Close
[0m12:40:23.054120 [debug] [Thread-4 (]: Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:40:23.054120 [error] [Thread-4 (]: 27 of 32 ERROR source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.07s]
[0m12:40:23.054120 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:40:23.054120 [debug] [Thread-4 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:40:23.054120 [info ] [Thread-4 (]: 30 of 32 START test unique_icd_codes_data_full_code ............................ [RUN]
[0m12:40:23.054120 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:40:23.069477 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:40:23.074224 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:40:23.074224 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:23.074224 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:40:23.074224 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:40:23.069477 => 12:40:23.074224
[0m12:40:23.074224 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:23.074224 [debug] [Thread-4 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:40:23.074224 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:40:23.074224 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:23.074224 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:23.074224 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:40:23.074224 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:40:23.086938 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (execute): 12:40:23.037673 => 12:40:23.085942
[0m12:40:23.087456 [debug] [Thread-1 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."dim_member"
where member_key is not null
group by member_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:23.087978 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: BEGIN
[0m12:40:23.087978 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: ROLLBACK
[0m12:40:23.087978 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:23.087978 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: Close
[0m12:40:23.087978 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:23.092484 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:40:23.037673 => 12:40:23.092484
[0m12:40:23.092484 [info ] [Thread-2 (]: 28 of 32 PASS source_unique_bootcamp_project_us_healthcare_claims_member_id .... [[32mPASS[0m in 0.07s]
[0m12:40:23.092484 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:23.092484 [debug] [Thread-1 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: ROLLBACK
[0m12:40:23.092484 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:40:23.092484 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:40:22.987972 => 12:40:23.092484
[0m12:40:23.092484 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:40:23.092484 [debug] [Thread-1 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: Close
[0m12:40:23.092484 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: ROLLBACK
[0m12:40:23.092484 [info ] [Thread-2 (]: 31 of 32 START test unique_us_healthcare_claims_data_claim_id .................. [RUN]
[0m12:40:23.101966 [info ] [Thread-1 (]: 29 of 32 PASS unique_dim_member_member_key ..................................... [[32mPASS[0m in 0.06s]
[0m12:40:23.103961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:40:23.104708 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:23.104708 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: Close
[0m12:40:23.104708 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:40:23.104708 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:40:23.104708 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:40:23.104708 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:40:23.104708 [info ] [Thread-3 (]: 26 of 32 PASS source_unique_bootcamp_project_icd_codes_Full_Code ............... [[32mPASS[0m in 0.12s]
[0m12:40:23.111219 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:40:23.111219 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    full_code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."icd_codes_data"
where full_code is not null
group by full_code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:23.111219 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:40:23.111219 [info ] [Thread-1 (]: 32 of 32 START test unique_us_healthcare_claims_data_member_id ................. [RUN]
[0m12:40:23.111219 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:40:23.104708 => 12:40:23.111219
[0m12:40:23.111219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_dim_member_member_key.31a1be2e46, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:40:23.111219 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:40:23.111219 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:40:23.119638 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:40:23.122796 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:40:23.122796 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:40:23.122796 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: BEGIN
[0m12:40:23.122796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:23.122796 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:40:23.120629 => 12:40:23.122796
[0m12:40:23.122796 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:40:23.122796 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:40:23.122796 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:40:23.122796 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: BEGIN
[0m12:40:23.122796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:23.142693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:23.142693 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:23.142693 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:40:23.142693 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:40:23.142693 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:23.142693 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is not null
group by claim_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:23.142693 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:23.142693 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:40:23.074224 => 12:40:23.142693
[0m12:40:23.152160 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: ROLLBACK
[0m12:40:23.152160 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:23.153163 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:23.153163 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: Close
[0m12:40:23.154288 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:40:23.122796 => 12:40:23.154288
[0m12:40:23.157070 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:40:23.111219 => 12:40:23.157070
[0m12:40:23.157070 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: ROLLBACK
[0m12:40:23.157070 [info ] [Thread-4 (]: 30 of 32 PASS unique_icd_codes_data_full_code .................................. [[32mPASS[0m in 0.10s]
[0m12:40:23.157070 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: ROLLBACK
[0m12:40:23.157070 [debug] [Thread-4 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:40:23.157070 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: Close
[0m12:40:23.161078 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: Close
[0m12:40:23.161078 [info ] [Thread-1 (]: 32 of 32 PASS unique_us_healthcare_claims_data_member_id ....................... [[32mPASS[0m in 0.05s]
[0m12:40:23.161078 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:40:23.161078 [info ] [Thread-2 (]: 31 of 32 PASS unique_us_healthcare_claims_data_claim_id ........................ [[32mPASS[0m in 0.06s]
[0m12:40:23.161078 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:40:23.161078 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:23.161078 [debug] [MainThread]: On master: BEGIN
[0m12:40:23.161078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:23.187531 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:40:23.187531 [debug] [MainThread]: On master: COMMIT
[0m12:40:23.187531 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:23.187531 [debug] [MainThread]: On master: COMMIT
[0m12:40:23.187531 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:40:23.187531 [debug] [MainThread]: On master: Close
[0m12:40:23.187531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:23.187531 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:40:23.187531 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:40:23.187531 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea' was properly closed.
[0m12:40:23.187531 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7' was properly closed.
[0m12:40:23.187531 [debug] [MainThread]: Connection 'test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280' was properly closed.
[0m12:40:23.187531 [debug] [MainThread]: Connection 'test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9' was properly closed.
[0m12:40:23.201861 [info ] [MainThread]: 
[0m12:40:23.202866 [info ] [MainThread]: Finished running 32 tests in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m12:40:23.204143 [debug] [MainThread]: Command end result
[0m12:40:23.211173 [info ] [MainThread]: 
[0m12:40:23.219490 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m12:40:23.220487 [info ] [MainThread]: 
[0m12:40:23.220946 [error] [MainThread]:   Compilation Error in test numeric_diagnosis_frequency_diagnosis_frequency (models\testing\test1.yml)
  'test_numeric' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:40:23.220946 [info ] [MainThread]: 
[0m12:40:23.220946 [error] [MainThread]:   Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:40:23.220946 [info ] [MainThread]: 
[0m12:40:23.220946 [error] [MainThread]:   Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:40:23.220946 [info ] [MainThread]: 
[0m12:40:23.220946 [error] [MainThread]:   Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:40:23.220946 [info ] [MainThread]: 
[0m12:40:23.220946 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=4 SKIP=0 TOTAL=32
[0m12:40:23.220946 [debug] [MainThread]: Command `dbt test` failed at 12:40:23.220946 after 1.39 seconds
[0m12:40:23.220946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7EAA3C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7F0BB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C7EC31ED0>]}
[0m12:40:23.220946 [debug] [MainThread]: Flushing usage events
[0m12:40:49.667815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFD33010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFD32E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFD26450>]}


============================== 12:40:49.683438 | fa2fb259-c2bf-4179-9017-11fd94a30e75 ==============================
[0m12:40:49.683438 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:40:49.683438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:40:49.802125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa2fb259-c2bf-4179-9017-11fd94a30e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFEEE610>]}
[0m12:40:49.852757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa2fb259-c2bf-4179-9017-11fd94a30e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CF993210>]}
[0m12:40:49.852757 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:40:49.852757 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:40:49.923194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:40:49.924196 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:40:49.924196 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:40:49.930195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa2fb259-c2bf-4179-9017-11fd94a30e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D01207D0>]}
[0m12:40:49.942733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa2fb259-c2bf-4179-9017-11fd94a30e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFFFE5D0>]}
[0m12:40:49.943717 [info ] [MainThread]: Found 11 models, 32 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:40:49.944716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa2fb259-c2bf-4179-9017-11fd94a30e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7D0013E50>]}
[0m12:40:49.946630 [info ] [MainThread]: 
[0m12:40:49.947632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:40:49.949632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:40:49.949632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:40:49.953385 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:40:49.953385 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:40:49.953385 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:40:49.953385 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:40:49.953385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:49.953385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:40:49.971002 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:40:49.971002 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:40:49.971002 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:40:49.971002 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:40:49.971002 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:40:49.971002 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:40:49.971002 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:40:49.971002 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:40:49.971002 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:40:49.985221 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:40:49.986885 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:40:49.986885 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:40:49.986885 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:49.986885 [debug] [MainThread]: On master: BEGIN
[0m12:40:49.986885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:40:50.003327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.003327 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:50.003327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:40:50.017898 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:40:50.018899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa2fb259-c2bf-4179-9017-11fd94a30e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CFD33110>]}
[0m12:40:50.019898 [debug] [MainThread]: On master: ROLLBACK
[0m12:40:50.020731 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:50.020731 [debug] [MainThread]: On master: BEGIN
[0m12:40:50.020731 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.020731 [debug] [MainThread]: On master: COMMIT
[0m12:40:50.020731 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:50.020731 [debug] [MainThread]: On master: COMMIT
[0m12:40:50.020731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:40:50.020731 [debug] [MainThread]: On master: Close
[0m12:40:50.020731 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:40:50.020731 [info ] [MainThread]: 
[0m12:40:50.020731 [debug] [Thread-1 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:40:50.020731 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:40:50.020731 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:40:50.020731 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:40:50.020731 [info ] [Thread-1 (]: 1 of 32 START test accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [RUN]
[0m12:40:50.020731 [info ] [Thread-2 (]: 2 of 32 START test not_null_dim_member_member_key .............................. [RUN]
[0m12:40:50.035571 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489'
[0m12:40:50.020731 [info ] [Thread-3 (]: 3 of 32 START test not_null_fact_claims_claimed_date_key ....................... [RUN]
[0m12:40:50.036815 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_dim_member_member_key.ff327b2471'
[0m12:40:50.034574 [info ] [Thread-4 (]: 4 of 32 START test not_null_fact_claims_enrolled_date_key ...................... [RUN]
[0m12:40:50.036815 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:40:50.036815 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead'
[0m12:40:50.036815 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:40:50.036815 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb'
[0m12:40:50.036815 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:40:50.036815 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:40:50.054263 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:40:50.054263 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:40:50.054263 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:40:50.036815 => 12:40:50.054263
[0m12:40:50.054263 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:40:50.054263 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:40:50.036815 => 12:40:50.054263
[0m12:40:50.054263 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:40:50.054263 [debug] [Thread-1 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:40:50.067961 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:40:50.054263 => 12:40:50.067935
[0m12:40:50.067961 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:40:50.070439 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:40:50.070439 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:40:50.054263 => 12:40:50.070439
[0m12:40:50.070439 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:40:50.070439 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:40:50.070439 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:40:50.070439 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:40:50.070439 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:40:50.085316 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:40:50.086490 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: BEGIN
[0m12:40:50.086490 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:40:50.086490 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: BEGIN
[0m12:40:50.086490 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:40:50.086490 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:40:50.086490 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:40:50.086490 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:40:50.086490 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: BEGIN
[0m12:40:50.086490 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: BEGIN
[0m12:40:50.086490 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:40:50.086490 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:40:50.104914 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.104914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.105920 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:40:50.106916 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:40:50.106916 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_key
from "bootcamp_project"."public_silver"."dim_member"
where member_key is null



      
    ) dbt_internal_test
[0m12:40:50.106916 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Others'
)



      
    ) dbt_internal_test
[0m12:40:50.107916 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.107916 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.108915 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:40:50.108915 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:40:50.109919 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select enrolled_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where enrolled_date_key is null



      
    ) dbt_internal_test
[0m12:40:50.109919 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.110915 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.110915 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claimed_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where claimed_date_key is null



      
    ) dbt_internal_test
[0m12:40:50.112916 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:40:50.070439 => 12:40:50.111916
[0m12:40:50.112916 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.113915 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:40:50.068965 => 12:40:50.113915
[0m12:40:50.113915 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: ROLLBACK
[0m12:40:50.115916 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:40:50.086490 => 12:40:50.115916
[0m12:40:50.115916 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.115916 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: ROLLBACK
[0m12:40:50.116919 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: ROLLBACK
[0m12:40:50.117916 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:40:50.070439 => 12:40:50.117916
[0m12:40:50.118918 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: Close
[0m12:40:50.119915 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: ROLLBACK
[0m12:40:50.120916 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: Close
[0m12:40:50.120916 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: Close
[0m12:40:50.119915 [info ] [Thread-2 (]: 2 of 32 PASS not_null_dim_member_member_key .................................... [[32mPASS[0m in 0.08s]
[0m12:40:50.122916 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: Close
[0m12:40:50.121917 [info ] [Thread-1 (]: 1 of 32 PASS accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [[32mPASS[0m in 0.09s]
[0m12:40:50.123916 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:40:50.123916 [info ] [Thread-4 (]: 4 of 32 PASS not_null_fact_claims_enrolled_date_key ............................ [[32mPASS[0m in 0.09s]
[0m12:40:50.125917 [debug] [Thread-1 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:40:50.125917 [info ] [Thread-3 (]: 3 of 32 PASS not_null_fact_claims_claimed_date_key ............................. [[32mPASS[0m in 0.09s]
[0m12:40:50.126917 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:40:50.127917 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:40:50.127917 [debug] [Thread-1 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:40:50.128916 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:40:50.129918 [debug] [Thread-4 (]: Began running node test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5
[0m12:40:50.128916 [info ] [Thread-2 (]: 5 of 32 START test not_null_us_healthcare_claims_data_claim_id ................. [RUN]
[0m12:40:50.130915 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:40:50.129918 [info ] [Thread-1 (]: 6 of 32 START test not_null_us_healthcare_claims_data_member_id ................ [RUN]
[0m12:40:50.131919 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:40:50.130915 [info ] [Thread-4 (]: 7 of 32 START test numeric_diagnosis_frequency_diagnosis_frequency ............. [RUN]
[0m12:40:50.132916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:40:50.131919 [info ] [Thread-3 (]: 8 of 32 START test relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [RUN]
[0m12:40:50.132916 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:40:50.133918 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5)
[0m12:40:50.133918 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:40:50.135057 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:40:50.136174 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:40:50.136174 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5
[0m12:40:50.136174 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:40:50.136174 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:40:50.136174 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:40:50.135369 => 12:40:50.136174
[0m12:40:50.136174 [debug] [Thread-4 (]: Timing info for test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5 (compile): 12:40:50.136174 => 12:40:50.136174
[0m12:40:50.136174 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:40:50.136174 => 12:40:50.136174
[0m12:40:50.153631 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:40:50.153631 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:40:50.153631 [debug] [Thread-1 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:40:50.153631 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:40:50.153631 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:40:50.153631 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:40:50.136174 => 12:40:50.153631
[0m12:40:50.153631 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:40:50.153631 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:40:50.153631 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:40:50.153631 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: BEGIN
[0m12:40:50.153631 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: BEGIN
[0m12:40:50.153631 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:40:50.153631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:50.153631 [debug] [Thread-4 (]: Compilation Error in test numeric_diagnosis_frequency_diagnosis_frequency (models\testing\test1.yml)
  'test_numeric' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:40:50.167952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:50.168955 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:40:50.169958 [error] [Thread-4 (]: 7 of 32 ERROR numeric_diagnosis_frequency_diagnosis_frequency .................. [[31mERROR[0m in 0.04s]
[0m12:40:50.170504 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: BEGIN
[0m12:40:50.170504 [debug] [Thread-4 (]: Finished running node test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5
[0m12:40:50.170504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:50.170504 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:40:50.170504 [info ] [Thread-4 (]: 9 of 32 START test relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [RUN]
[0m12:40:50.170504 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.numeric_diagnosis_frequency_diagnosis_frequency.ec99a07ad5, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:40:50.170504 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:40:50.170504 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:40:50.170504 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:40:50.170504 => 12:40:50.170504
[0m12:40:50.170504 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:40:50.184627 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:40:50.186625 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:40:50.186625 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: BEGIN
[0m12:40:50.187626 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:50.188398 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.188398 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:40:50.188398 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_code is not null
),

parent as (
    select category_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.188398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.188398 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.188398 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:40:50.198371 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:40:50.198371 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is null



      
    ) dbt_internal_test
[0m12:40:50.198371 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is null



      
    ) dbt_internal_test
[0m12:40:50.203335 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.204312 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.204312 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.207304 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:40:50.153631 => 12:40:50.206423
[0m12:40:50.209304 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:40:50.153631 => 12:40:50.208304
[0m12:40:50.209304 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:40:50.210372 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: ROLLBACK
[0m12:40:50.210372 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: ROLLBACK
[0m12:40:50.210372 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_title as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_title is not null
),

parent as (
    select category_title as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.210372 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: Close
[0m12:40:50.210372 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: Close
[0m12:40:50.215881 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.215881 [info ] [Thread-1 (]: 6 of 32 PASS not_null_us_healthcare_claims_data_member_id ...................... [[32mPASS[0m in 0.08s]
[0m12:40:50.222396 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:40:50.153631 => 12:40:50.221883
[0m12:40:50.219357 [info ] [Thread-2 (]: 5 of 32 PASS not_null_us_healthcare_claims_data_claim_id ....................... [[32mPASS[0m in 0.09s]
[0m12:40:50.222396 [debug] [Thread-1 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:40:50.225229 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: ROLLBACK
[0m12:40:50.225229 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:40:50.225229 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:40:50.225229 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:40:50.225229 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: Close
[0m12:40:50.225229 [info ] [Thread-1 (]: 10 of 32 START test relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [RUN]
[0m12:40:50.225229 [info ] [Thread-2 (]: 11 of 32 START test relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [RUN]
[0m12:40:50.225229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:40:50.225229 [info ] [Thread-3 (]: 8 of 32 PASS relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [[32mPASS[0m in 0.09s]
[0m12:40:50.233295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:40:50.233295 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:40:50.234638 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:40:50.235641 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:40:50.237666 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:40:50.237666 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:40:50.243193 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:40:50.243193 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.243193 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:40:50.236637 => 12:40:50.243193
[0m12:40:50.243193 [info ] [Thread-3 (]: 12 of 32 START test relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [RUN]
[0m12:40:50.249739 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:40:50.243193 => 12:40:50.249739
[0m12:40:50.249739 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:40:50.170504 => 12:40:50.249739
[0m12:40:50.252161 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:40:50.252161 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:40:50.253532 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:40:50.253532 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: ROLLBACK
[0m12:40:50.253532 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:40:50.253532 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:40:50.253532 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:40:50.253532 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:40:50.253532 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:40:50.253532 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: Close
[0m12:40:50.253532 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:40:50.253532 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:40:50.253532 => 12:40:50.253532
[0m12:40:50.253532 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: BEGIN
[0m12:40:50.253532 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: BEGIN
[0m12:40:50.253532 [info ] [Thread-4 (]: 9 of 32 PASS relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [[32mPASS[0m in 0.08s]
[0m12:40:50.268236 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:40:50.268747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:50.269759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:50.270759 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:40:50.273063 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:40:50.273063 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:40:50.273063 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:40:50.273063 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: BEGIN
[0m12:40:50.273063 [info ] [Thread-4 (]: 13 of 32 START test relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:50.273063 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:50.273063 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:40:50.273063 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:40:50.287590 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:40:50.288127 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:40:50.273063 => 12:40:50.288127
[0m12:40:50.288127 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:40:50.288127 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:40:50.288127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.288127 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:40:50.288127 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_code is not null
),

parent as (
    select diagnosis_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.288127 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:40:50.288127 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: BEGIN
[0m12:40:50.288127 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:50.308683 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.308683 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.308683 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:40:50.308683 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.308683 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:40:50.308683 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.308683 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_key as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_key is not null
),

parent as (
    select full_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.318856 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:40:50.253532 => 12:40:50.317840
[0m12:40:50.318856 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select full_description as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where full_description is not null
),

parent as (
    select full_description as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.319972 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:40:50.319972 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: ROLLBACK
[0m12:40:50.319972 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select address as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where address is not null
),

parent as (
    select address as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.319972 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: Close
[0m12:40:50.319972 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.319972 [info ] [Thread-1 (]: 10 of 32 PASS relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [[32mPASS[0m in 0.09s]
[0m12:40:50.319972 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:40:50.288127 => 12:40:50.319972
[0m12:40:50.319972 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:40:50.319972 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: ROLLBACK
[0m12:40:50.319972 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:40:50.319972 [info ] [Thread-1 (]: 14 of 32 START test relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:50.334803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:40:50.335804 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: Close
[0m12:40:50.336797 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:40:50.345799 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:40:50.346319 [info ] [Thread-4 (]: 13 of 32 PASS relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.07s]
[0m12:40:50.347978 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:40:50.347978 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:40:50.337802 => 12:40:50.347978
[0m12:40:50.351500 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:40:50.352510 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:40:50.356680 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:40:50.352510 [info ] [Thread-4 (]: 15 of 32 START test relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:50.358209 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.358209 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.358209 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:40:50.358209 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:40:50.361729 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:40:50.253532 => 12:40:50.361729
[0m12:40:50.361729 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:40:50.271762 => 12:40:50.361729
[0m12:40:50.361729 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:40:50.361729 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: BEGIN
[0m12:40:50.364756 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: ROLLBACK
[0m12:40:50.364756 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: ROLLBACK
[0m12:40:50.369924 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:40:50.370508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:50.370508 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:40:50.364756 => 12:40:50.370508
[0m12:40:50.370508 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:40:50.370508 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: Close
[0m12:40:50.370508 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: Close
[0m12:40:50.370508 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:40:50.370508 [info ] [Thread-2 (]: 11 of 32 PASS relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [[32mPASS[0m in 0.15s]
[0m12:40:50.370508 [info ] [Thread-3 (]: 12 of 32 PASS relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:40:50.370508 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:40:50.370508 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:40:50.370508 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:40:50.370508 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:40:50.370508 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:40:50.370508 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: BEGIN
[0m12:40:50.370508 [info ] [Thread-2 (]: 16 of 32 START test relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:50.385585 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:50.384585 [info ] [Thread-3 (]: 17 of 32 START test relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:50.385585 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.386583 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:40:50.387719 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:40:50.387719 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:40:50.387719 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:40:50.387719 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:40:50.387719 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select email as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where email is not null
),

parent as (
    select email as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.387719 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:40:50.387719 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:40:50.387719 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:40:50.387719 => 12:40:50.387719
[0m12:40:50.387719 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:40:50.387719 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:40:50.387719 => 12:40:50.387719
[0m12:40:50.403025 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:40:50.404031 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.404381 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:40:50.404381 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:40:50.353504 => 12:40:50.404381
[0m12:40:50.404381 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:40:50.404381 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:40:50.404381 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: ROLLBACK
[0m12:40:50.404381 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: BEGIN
[0m12:40:50.404381 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:40:50.404381 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:50.404381 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: BEGIN
[0m12:40:50.404381 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: Close
[0m12:40:50.404381 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:50.404381 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.404381 [info ] [Thread-1 (]: 14 of 32 PASS relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:40:50.404381 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:40:50.404381 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:40:50.417978 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select gender as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where gender is not null
),

parent as (
    select gender as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.418976 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:40:50.419976 [info ] [Thread-1 (]: 18 of 32 START test relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:50.421229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:40:50.421229 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.421229 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:40:50.421229 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:40:50.370508 => 12:40:50.421229
[0m12:40:50.421229 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:40:50.421229 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: ROLLBACK
[0m12:40:50.421229 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:40:50.421229 => 12:40:50.421229
[0m12:40:50.434575 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:40:50.434575 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.435577 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: Close
[0m12:40:50.435577 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.471368 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:40:50.471368 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:40:50.471368 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:40:50.471368 [info ] [Thread-4 (]: 15 of 32 PASS relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.11s]
[0m12:40:50.471368 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select claim_id as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where claim_id is not null
),

parent as (
    select claim_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.484713 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:40:50.485718 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select name as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where name is not null
),

parent as (
    select name as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.486999 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:40:50.486999 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: BEGIN
[0m12:40:50.486999 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:40:50.486999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:50.486999 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.486999 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.486999 [info ] [Thread-4 (]: 19 of 32 START test relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:50.486999 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:40:50.404381 => 12:40:50.486999
[0m12:40:50.486999 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:40:50.387719 => 12:40:50.486999
[0m12:40:50.486999 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:40:50.486999 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: ROLLBACK
[0m12:40:50.486999 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: ROLLBACK
[0m12:40:50.502062 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:40:50.504578 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:40:50.504578 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: Close
[0m12:40:50.504578 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: Close
[0m12:40:50.504578 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:40:50.503062 => 12:40:50.504578
[0m12:40:50.504578 [info ] [Thread-3 (]: 17 of 32 PASS relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.12s]
[0m12:40:50.504578 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:40:50.504578 [info ] [Thread-2 (]: 16 of 32 PASS relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.12s]
[0m12:40:50.519137 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:40:50.520139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.521791 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:40:50.521791 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:40:50.521791 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:40:50.521791 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:40:50.521791 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:40:50.521791 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:40:50.521791 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_1_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_1_key is not null
),

parent as (
    select diagnosis_1 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.521791 [info ] [Thread-3 (]: 20 of 32 START test relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:50.521791 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: BEGIN
[0m12:40:50.521791 [info ] [Thread-2 (]: 21 of 32 START test relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:40:50.521791 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:40:50.521791 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:50.521791 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:40:50.521791 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:40:50.521791 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.534633 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:40:50.538539 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:40:50.538539 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:40:50.435577 => 12:40:50.538539
[0m12:40:50.538539 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:40:50.538539 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:40:50.534633 => 12:40:50.538539
[0m12:40:50.538539 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: ROLLBACK
[0m12:40:50.538539 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:40:50.538539 => 12:40:50.538539
[0m12:40:50.538539 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:40:50.538539 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:40:50.552271 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:40:50.552271 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: Close
[0m12:40:50.554268 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:40:50.554268 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:40:50.554268 [info ] [Thread-1 (]: 18 of 32 PASS relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.13s]
[0m12:40:50.554268 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:40:50.554268 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: BEGIN
[0m12:40:50.554268 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:40:50.554268 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: BEGIN
[0m12:40:50.554268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:50.554268 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:40:50.554268 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:50.554268 [info ] [Thread-1 (]: 22 of 32 START test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [RUN]
[0m12:40:50.554268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7)
[0m12:40:50.554268 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.554268 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:40:50.568945 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:40:50.571670 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:40:50.571670 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_2_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_2_key is not null
),

parent as (
    select diagnosis_2 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.571670 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (compile): 12:40:50.569648 => 12:40:50.571670
[0m12:40:50.571670 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:40:50.571670 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:40:50.571670 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.571670 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.571670 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:40:50.521135 => 12:40:50.571670
[0m12:40:50.571670 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.571670 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:40:50.571670 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:40:50.571670 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: ROLLBACK
[0m12:40:50.571670 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:40:50.585237 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: BEGIN
[0m12:40:50.585237 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_3_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_3_key is not null
),

parent as (
    select diagnosis_3 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.586874 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select member_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where member_key is not null
),

parent as (
    select member_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.586874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:50.586874 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: Close
[0m12:40:50.586874 [info ] [Thread-4 (]: 19 of 32 PASS relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.10s]
[0m12:40:50.586874 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:40:50.586874 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.586874 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.586874 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:40:50.586874 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:40:50.553268 => 12:40:50.586874
[0m12:40:50.586874 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:40:50.538539 => 12:40:50.586874
[0m12:40:50.586874 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: ROLLBACK
[0m12:40:50.586874 [info ] [Thread-4 (]: 23 of 32 START test source_not_null_bootcamp_project_icd_codes_Full_Code ....... [RUN]
[0m12:40:50.586874 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: ROLLBACK
[0m12:40:50.586874 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718, now test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0)
[0m12:40:50.586874 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: Close
[0m12:40:50.586874 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:40:50.586874 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: Close
[0m12:40:50.586874 [info ] [Thread-2 (]: 21 of 32 PASS relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.07s]
[0m12:40:50.607836 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:40:50.607836 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.609402 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:40:50.608884 [info ] [Thread-3 (]: 20 of 32 PASS relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.09s]
[0m12:40:50.610468 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:40:50.610996 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:40:50.601364 => 12:40:50.610996
[0m12:40:50.611520 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:40:50.612047 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:40:50.612598 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select total_paid_amount as from_field
    from "bootcamp_project"."public_gold"."total_paid_amount"
    where total_paid_amount is not null
),

parent as (
    select  as to_field
    from "bootcamp_project"."public_silver"."fact_claims"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:40:50.612598 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:40:50.613646 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:40:50.613126 [info ] [Thread-2 (]: 24 of 32 START test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:40:50.615193 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:40:50.615193 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 18:     select  as to_field
                     ^

[0m12:40:50.617865 [info ] [Thread-3 (]: 25 of 32 START test source_not_null_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:40:50.618866 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4)
[0m12:40:50.619867 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: ROLLBACK
[0m12:40:50.621089 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:40:50.621089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60)
[0m12:40:50.621089 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:40:50.621089 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: BEGIN
[0m12:40:50.621089 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:40:50.621089 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (execute): 12:40:50.571670 => 12:40:50.621089
[0m12:40:50.621089 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:40:50.621089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:50.621089 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:40:50.621089 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: Close
[0m12:40:50.621089 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (compile): 12:40:50.621089 => 12:40:50.621089
[0m12:40:50.621089 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (compile): 12:40:50.621089 => 12:40:50.621089
[0m12:40:50.634608 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:40:50.635620 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:40:50.638020 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:40:50.638020 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:40:50.638020 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:40:50.638020 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: BEGIN
[0m12:40:50.638020 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:40:50.638020 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:50.638020 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: BEGIN
[0m12:40:50.638020 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:50.638020 [debug] [Thread-1 (]: Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:40:50.638020 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.638020 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:40:50.638020 [error] [Thread-1 (]: 22 of 32 ERROR relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [[31mERROR[0m in 0.08s]
[0m12:40:50.638020 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Full_Code
from "bootcamp_project"."public"."icd_codes"
where Full_Code is null



      
    ) dbt_internal_test
[0m12:40:50.652211 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:40:50.653211 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:40:50.654232 [info ] [Thread-1 (]: 26 of 32 START test source_unique_bootcamp_project_icd_codes_Full_Code ......... [RUN]
[0m12:40:50.654232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:40:50.654232 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:40:50.661117 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:40:50.661117 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.661117 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:40:50.614162 => 12:40:50.661117
[0m12:40:50.661117 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.661117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.667914 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: ROLLBACK
[0m12:40:50.668925 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:40:50.654232 => 12:40:50.667914
[0m12:40:50.668925 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:40:50.669929 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:40:50.670590 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:40:50.670590 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is null



      
    ) dbt_internal_test
[0m12:40:50.670590 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select diagnosis_key
from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is null



      
    ) dbt_internal_test
[0m12:40:50.670590 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: Close
[0m12:40:50.670590 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:40:50.670590 [info ] [Thread-4 (]: 23 of 32 PASS source_not_null_bootcamp_project_icd_codes_Full_Code ............. [[32mPASS[0m in 0.08s]
[0m12:40:50.670590 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 13: select diagnosis_key
                ^

[0m12:40:50.670590 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.670590 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:40:50.670590 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:40:50.670590 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: ROLLBACK
[0m12:40:50.670590 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (execute): 12:40:50.638020 => 12:40:50.670590
[0m12:40:50.670590 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:40:50.670590 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: BEGIN
[0m12:40:50.670590 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: ROLLBACK
[0m12:40:50.670590 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (execute): 12:40:50.636609 => 12:40:50.670590
[0m12:40:50.670590 [info ] [Thread-4 (]: 27 of 32 START test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:40:50.670590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:50.670590 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: Close
[0m12:40:50.670590 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f)
[0m12:40:50.670590 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: Close
[0m12:40:50.686502 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:40:50.687860 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:40:50.687860 [info ] [Thread-3 (]: 25 of 32 PASS source_not_null_bootcamp_project_us_healthcare_claims_member_id .. [[32mPASS[0m in 0.07s]
[0m12:40:50.687860 [debug] [Thread-2 (]: Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:40:50.687860 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (compile): 12:40:50.687860 => 12:40:50.687860
[0m12:40:50.687860 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:40:50.687860 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:40:50.687860 [error] [Thread-2 (]: 24 of 32 ERROR source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.07s]
[0m12:40:50.687860 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:40:50.687860 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:40:50.687860 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.701971 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:40:50.702973 [info ] [Thread-3 (]: 28 of 32 START test source_unique_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:40:50.703974 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:40:50.704190 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:40:50.704190 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:40:50.704190 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915)
[0m12:40:50.704190 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Full_Code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."icd_codes"
where Full_Code is not null
group by Full_Code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:50.704190 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: BEGIN
[0m12:40:50.704190 [info ] [Thread-2 (]: 29 of 32 START test unique_dim_member_member_key ............................... [RUN]
[0m12:40:50.704190 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:40:50.704190 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:50.704190 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:40:50.704190 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:40:50.704190 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:40:50.704190 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:40:50.718544 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (compile): 12:40:50.704190 => 12:40:50.704190
[0m12:40:50.719540 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:40:50.721915 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:40:50.721915 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:40:50.704190 => 12:40:50.721915
[0m12:40:50.721915 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:40:50.721915 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:40:50.728424 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:40:50.728424 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: BEGIN
[0m12:40:50.728424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:50.728424 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:40:50.728424 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: BEGIN
[0m12:40:50.728424 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:40:50.734694 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.736695 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:40:50.736695 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    diagnosis_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is not null
group by diagnosis_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:50.740111 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 12:     diagnosis_key as unique_field,
             ^

[0m12:40:50.740111 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: ROLLBACK
[0m12:40:50.740111 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (execute): 12:40:50.687860 => 12:40:50.740111
[0m12:40:50.740111 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: Close
[0m12:40:50.747417 [debug] [Thread-4 (]: Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:40:50.747955 [error] [Thread-4 (]: 27 of 32 ERROR source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.08s]
[0m12:40:50.748995 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:40:50.750031 [debug] [Thread-4 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:40:50.750558 [info ] [Thread-4 (]: 30 of 32 START test unique_icd_codes_data_full_code ............................ [RUN]
[0m12:40:50.752087 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:40:50.753134 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:40:50.757935 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:40:50.757935 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.757935 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.757935 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.757935 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:40:50.670590 => 12:40:50.757935
[0m12:40:50.757935 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:40:50.753649 => 12:40:50.757935
[0m12:40:50.757935 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:40:50.757935 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:40:50.757935 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: ROLLBACK
[0m12:40:50.757935 [debug] [Thread-4 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:40:50.757935 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."dim_member"
where member_key is not null
group by member_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:50.757935 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:50.757935 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:40:50.757935 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: Close
[0m12:40:50.757935 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:40:50.769459 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: BEGIN
[0m12:40:50.757935 [info ] [Thread-1 (]: 26 of 32 PASS source_unique_bootcamp_project_icd_codes_Full_Code ............... [[32mPASS[0m in 0.10s]
[0m12:40:50.770460 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.771457 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.771457 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:40:50.772589 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:40:50.772589 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:40:50.728424 => 12:40:50.772589
[0m12:40:50.772589 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (execute): 12:40:50.720543 => 12:40:50.772589
[0m12:40:50.772589 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:40:50.772589 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: ROLLBACK
[0m12:40:50.772589 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: ROLLBACK
[0m12:40:50.772589 [info ] [Thread-1 (]: 31 of 32 START test unique_us_healthcare_claims_data_claim_id .................. [RUN]
[0m12:40:50.772589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:40:50.772589 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: Close
[0m12:40:50.772589 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: Close
[0m12:40:50.772589 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:40:50.772589 [info ] [Thread-3 (]: 28 of 32 PASS source_unique_bootcamp_project_us_healthcare_claims_member_id .... [[32mPASS[0m in 0.07s]
[0m12:40:50.772589 [info ] [Thread-2 (]: 29 of 32 PASS unique_dim_member_member_key ..................................... [[32mPASS[0m in 0.07s]
[0m12:40:50.786605 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:40:50.787672 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:40:50.787672 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:40:50.787672 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:40:50.787672 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:40:50.772589 => 12:40:50.787672
[0m12:40:50.787672 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:40:50.787672 [info ] [Thread-3 (]: 32 of 32 START test unique_us_healthcare_claims_data_member_id ................. [RUN]
[0m12:40:50.787672 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:40:50.787672 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:40:50.787672 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:40:50.787672 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:40:50.787672 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.787672 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:40:50.787672 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: BEGIN
[0m12:40:50.787672 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:40:50.801956 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:40:50.787672 => 12:40:50.801956
[0m12:40:50.802958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:40:50.803764 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    full_code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."icd_codes_data"
where full_code is not null
group by full_code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:50.803764 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:40:50.803764 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:40:50.803764 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:40:50.803764 [debug] [Thread-3 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: BEGIN
[0m12:40:50.803764 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:40:50.826863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.826863 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:40:50.826863 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.826863 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is not null
group by claim_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:50.826863 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:40:50.835361 [debug] [Thread-3 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:40:50.838055 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.838055 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.838055 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:40:50.787672 => 12:40:50.838055
[0m12:40:50.838055 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:40:50.803764 => 12:40:50.838055
[0m12:40:50.838055 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: ROLLBACK
[0m12:40:50.838055 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:40:50.838055 [debug] [Thread-3 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: ROLLBACK
[0m12:40:50.838055 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:40:50.757935 => 12:40:50.838055
[0m12:40:50.838055 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: Close
[0m12:40:50.845071 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: ROLLBACK
[0m12:40:50.845071 [debug] [Thread-3 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: Close
[0m12:40:50.845071 [info ] [Thread-1 (]: 31 of 32 PASS unique_us_healthcare_claims_data_claim_id ........................ [[32mPASS[0m in 0.07s]
[0m12:40:50.845071 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:40:50.845071 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: Close
[0m12:40:50.845071 [info ] [Thread-3 (]: 32 of 32 PASS unique_us_healthcare_claims_data_member_id ....................... [[32mPASS[0m in 0.06s]
[0m12:40:50.845071 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:40:50.845071 [info ] [Thread-4 (]: 30 of 32 PASS unique_icd_codes_data_full_code .................................. [[32mPASS[0m in 0.09s]
[0m12:40:50.845071 [debug] [Thread-4 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:40:50.853016 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:50.853524 [debug] [MainThread]: On master: BEGIN
[0m12:40:50.853524 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:40:50.872447 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:40:50.872447 [debug] [MainThread]: On master: COMMIT
[0m12:40:50.872447 [debug] [MainThread]: Using postgres connection "master"
[0m12:40:50.872447 [debug] [MainThread]: On master: COMMIT
[0m12:40:50.872447 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:40:50.872447 [debug] [MainThread]: On master: Close
[0m12:40:50.872447 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:40:50.872447 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:40:50.872447 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:40:50.872447 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7' was properly closed.
[0m12:40:50.872447 [debug] [MainThread]: Connection 'test.postgres_dev.unique_dim_member_member_key.31a1be2e46' was properly closed.
[0m12:40:50.872447 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea' was properly closed.
[0m12:40:50.872447 [debug] [MainThread]: Connection 'test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9' was properly closed.
[0m12:40:50.872447 [info ] [MainThread]: 
[0m12:40:50.884510 [info ] [MainThread]: Finished running 32 tests in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m12:40:50.886465 [debug] [MainThread]: Command end result
[0m12:40:50.886465 [info ] [MainThread]: 
[0m12:40:50.886465 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m12:40:50.886465 [info ] [MainThread]: 
[0m12:40:50.886465 [error] [MainThread]:   Compilation Error in test numeric_diagnosis_frequency_diagnosis_frequency (models\testing\test1.yml)
  'test_numeric' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m12:40:50.886465 [info ] [MainThread]: 
[0m12:40:50.901808 [error] [MainThread]:   Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:40:50.902807 [info ] [MainThread]: 
[0m12:40:50.903637 [error] [MainThread]:   Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:40:50.903637 [info ] [MainThread]: 
[0m12:40:50.903637 [error] [MainThread]:   Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:40:50.903637 [info ] [MainThread]: 
[0m12:40:50.903637 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=4 SKIP=0 TOTAL=32
[0m12:40:50.903637 [debug] [MainThread]: Command `dbt test` failed at 12:40:50.903637 after 1.27 seconds
[0m12:40:50.903637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7CF993150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C939C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7C939F8D0>]}
[0m12:40:50.903637 [debug] [MainThread]: Flushing usage events
[0m12:41:56.692528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B0A506D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B0505890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B0A1D410>]}


============================== 12:41:56.692528 | 2a85c449-f080-4bb5-aea5-d1e59a0584a2 ==============================
[0m12:41:56.692528 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:41:56.692528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:41:56.815808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a85c449-f080-4bb5-aea5-d1e59a0584a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B0A5E710>]}
[0m12:41:56.877816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a85c449-f080-4bb5-aea5-d1e59a0584a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B04659D0>]}
[0m12:41:56.877816 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:41:56.877816 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:41:56.938584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:41:56.939587 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\testing\test1.yml
[0m12:41:57.056345 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:41:57.056345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a85c449-f080-4bb5-aea5-d1e59a0584a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B0D0B610>]}
[0m12:41:57.071970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a85c449-f080-4bb5-aea5-d1e59a0584a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B0A5E090>]}
[0m12:41:57.073894 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:41:57.073894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a85c449-f080-4bb5-aea5-d1e59a0584a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B0FE1D90>]}
[0m12:41:57.077206 [info ] [MainThread]: 
[0m12:41:57.078207 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:41:57.079208 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:41:57.084790 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:41:57.084790 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:41:57.084790 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:41:57.084790 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:41:57.084790 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:41:57.084790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:57.084790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:41:57.109447 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.110476 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.110476 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:41:57.110476 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:41:57.111448 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:41:57.111448 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:41:57.114448 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:41:57.114448 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:41:57.115446 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:41:57.116380 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:41:57.118383 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:41:57.118383 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:41:57.120375 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.120375 [debug] [MainThread]: On master: BEGIN
[0m12:41:57.120375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:41:57.134932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.134932 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.134932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:41:57.134932 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:41:57.134932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a85c449-f080-4bb5-aea5-d1e59a0584a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2B02785D0>]}
[0m12:41:57.134932 [debug] [MainThread]: On master: ROLLBACK
[0m12:41:57.149605 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.149605 [debug] [MainThread]: On master: BEGIN
[0m12:41:57.151600 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.151600 [debug] [MainThread]: On master: COMMIT
[0m12:41:57.152600 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:57.152600 [debug] [MainThread]: On master: COMMIT
[0m12:41:57.153601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:41:57.153601 [debug] [MainThread]: On master: Close
[0m12:41:57.154601 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:41:57.154601 [info ] [MainThread]: 
[0m12:41:57.158618 [debug] [Thread-1 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:41:57.158618 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:41:57.159603 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:41:57.159603 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:41:57.159603 [info ] [Thread-1 (]: 1 of 31 START test accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [RUN]
[0m12:41:57.160616 [info ] [Thread-2 (]: 2 of 31 START test not_null_dim_member_member_key .............................. [RUN]
[0m12:41:57.160616 [info ] [Thread-3 (]: 3 of 31 START test not_null_fact_claims_claimed_date_key ....................... [RUN]
[0m12:41:57.162600 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489'
[0m12:41:57.161601 [info ] [Thread-4 (]: 4 of 31 START test not_null_fact_claims_enrolled_date_key ...................... [RUN]
[0m12:41:57.162600 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_dim_member_member_key.ff327b2471'
[0m12:41:57.163620 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead'
[0m12:41:57.163620 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:41:57.164600 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb'
[0m12:41:57.164600 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:41:57.165601 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:41:57.177433 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:41:57.178546 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:41:57.185136 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:41:57.186917 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:41:57.206173 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:41:57.207171 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:41:57.165601 => 12:41:57.206173
[0m12:41:57.209302 [debug] [Thread-1 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:41:57.218555 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:41:57.218555 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:41:57.178546 => 12:41:57.218555
[0m12:41:57.233100 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:41:57.186917 => 12:41:57.233100
[0m12:41:57.234203 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:41:57.186138 => 12:41:57.233100
[0m12:41:57.235721 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:41:57.236721 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:41:57.236721 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:41:57.237721 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:41:57.241765 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:41:57.242796 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: BEGIN
[0m12:41:57.244825 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:41:57.246819 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:41:57.247758 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:41:57.247758 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:41:57.248756 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:41:57.250228 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: BEGIN
[0m12:41:57.250228 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:41:57.251227 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: BEGIN
[0m12:41:57.251227 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:41:57.252229 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: BEGIN
[0m12:41:57.252229 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:41:57.253228 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:41:57.274951 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.275490 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:41:57.276013 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_key
from "bootcamp_project"."public_silver"."dim_member"
where member_key is null



      
    ) dbt_internal_test
[0m12:41:57.276013 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.278524 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.278524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.278524 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.278524 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:41:57.278524 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:41:57.278524 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:41:57.278524 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:41:57.238723 => 12:41:57.278524
[0m12:41:57.278524 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select enrolled_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where enrolled_date_key is null



      
    ) dbt_internal_test
[0m12:41:57.278524 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claimed_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where claimed_date_key is null



      
    ) dbt_internal_test
[0m12:41:57.278524 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Others'
)



      
    ) dbt_internal_test
[0m12:41:57.278524 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: ROLLBACK
[0m12:41:57.278524 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: Close
[0m12:41:57.278524 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.278524 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.278524 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.278524 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:41:57.245784 => 12:41:57.278524
[0m12:41:57.278524 [info ] [Thread-2 (]: 2 of 31 PASS not_null_dim_member_member_key .................................... [[32mPASS[0m in 0.12s]
[0m12:41:57.278524 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:41:57.243860 => 12:41:57.278524
[0m12:41:57.278524 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:41:57.209302 => 12:41:57.278524
[0m12:41:57.278524 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: ROLLBACK
[0m12:41:57.294161 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:41:57.294161 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: ROLLBACK
[0m12:41:57.295176 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: ROLLBACK
[0m12:41:57.296349 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:41:57.296731 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: Close
[0m12:41:57.297734 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: Close
[0m12:41:57.298575 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: Close
[0m12:41:57.298575 [info ] [Thread-2 (]: 5 of 31 START test not_null_us_healthcare_claims_data_claim_id ................. [RUN]
[0m12:41:57.303422 [info ] [Thread-3 (]: 3 of 31 PASS not_null_fact_claims_claimed_date_key ............................. [[32mPASS[0m in 0.14s]
[0m12:41:57.306380 [info ] [Thread-4 (]: 4 of 31 PASS not_null_fact_claims_enrolled_date_key ............................ [[32mPASS[0m in 0.14s]
[0m12:41:57.307991 [info ] [Thread-1 (]: 1 of 31 PASS accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [[32mPASS[0m in 0.15s]
[0m12:41:57.308518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:41:57.309045 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:41:57.309579 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:41:57.310165 [debug] [Thread-1 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:41:57.310745 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:41:57.311298 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:41:57.311833 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:41:57.312360 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:41:57.315917 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:41:57.316338 [info ] [Thread-3 (]: 6 of 31 START test not_null_us_healthcare_claims_data_member_id ................ [RUN]
[0m12:41:57.316920 [info ] [Thread-4 (]: 7 of 31 START test relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [RUN]
[0m12:41:57.317980 [info ] [Thread-1 (]: 8 of 31 START test relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [RUN]
[0m12:41:57.317980 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:41:57.312360 => 12:41:57.317980
[0m12:41:57.319002 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:41:57.319987 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:41:57.319987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:41:57.320987 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:41:57.320987 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:41:57.321986 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:41:57.321986 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:41:57.324004 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:41:57.328005 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:41:57.385566 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:41:57.385566 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:41:57.385566 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:41:57.385566 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:41:57.324004 => 12:41:57.385566
[0m12:41:57.385566 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: BEGIN
[0m12:41:57.385566 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:41:57.328005 => 12:41:57.385566
[0m12:41:57.385566 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:41:57.385566 => 12:41:57.385566
[0m12:41:57.385566 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:41:57.385566 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:57.385566 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:41:57.399941 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:41:57.401942 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:41:57.403943 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:41:57.406965 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:41:57.407946 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:41:57.408941 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:41:57.408941 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:41:57.409942 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: BEGIN
[0m12:41:57.409942 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: BEGIN
[0m12:41:57.410940 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: BEGIN
[0m12:41:57.410940 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:57.411940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:57.411940 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:57.416810 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.416810 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:41:57.417810 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is null



      
    ) dbt_internal_test
[0m12:41:57.418830 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.419810 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:41:57.321986 => 12:41:57.419810
[0m12:41:57.420829 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: ROLLBACK
[0m12:41:57.421811 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: Close
[0m12:41:57.421811 [info ] [Thread-2 (]: 5 of 31 PASS not_null_us_healthcare_claims_data_claim_id ....................... [[32mPASS[0m in 0.11s]
[0m12:41:57.422811 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:41:57.423810 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:41:57.423810 [info ] [Thread-2 (]: 9 of 31 START test relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [RUN]
[0m12:41:57.424809 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:41:57.424809 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:41:57.428827 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:41:57.429809 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:41:57.424809 => 12:41:57.429809
[0m12:41:57.429809 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:41:57.431830 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:41:57.432812 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:41:57.433276 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: BEGIN
[0m12:41:57.433276 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:57.437058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.437058 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.437058 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:41:57.437058 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.437058 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.437058 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:41:57.449614 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_title as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_title is not null
),

parent as (
    select category_title as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.450619 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:41:57.450619 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:41:57.451299 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is null



      
    ) dbt_internal_test
[0m12:41:57.451299 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_code is not null
),

parent as (
    select diagnosis_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.451299 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_code is not null
),

parent as (
    select category_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.451299 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.451299 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:41:57.399941 => 12:41:57.451299
[0m12:41:57.451299 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: ROLLBACK
[0m12:41:57.451299 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: Close
[0m12:41:57.451299 [info ] [Thread-3 (]: 6 of 31 PASS not_null_us_healthcare_claims_data_member_id ...................... [[32mPASS[0m in 0.13s]
[0m12:41:57.451299 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:41:57.466493 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:41:57.467025 [info ] [Thread-3 (]: 10 of 31 START test relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [RUN]
[0m12:41:57.469021 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:41:57.470030 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:41:57.481054 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:41:57.483217 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:41:57.470030 => 12:41:57.483217
[0m12:41:57.484214 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.485211 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.485211 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:41:57.488211 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:41:57.402940 => 12:41:57.487211
[0m12:41:57.491559 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:41:57.429809 => 12:41:57.488506
[0m12:41:57.491559 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:41:57.491559 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.491559 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: ROLLBACK
[0m12:41:57.491559 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: ROLLBACK
[0m12:41:57.491559 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:41:57.491559 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:41:57.404943 => 12:41:57.491559
[0m12:41:57.491559 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: BEGIN
[0m12:41:57.499698 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: ROLLBACK
[0m12:41:57.499698 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: Close
[0m12:41:57.499698 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: Close
[0m12:41:57.500710 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:57.502701 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: Close
[0m12:41:57.502701 [info ] [Thread-4 (]: 7 of 31 PASS relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [[32mPASS[0m in 0.18s]
[0m12:41:57.505234 [info ] [Thread-2 (]: 9 of 31 PASS relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [[32mPASS[0m in 0.08s]
[0m12:41:57.505569 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:41:57.505569 [info ] [Thread-1 (]: 8 of 31 PASS relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [[32mPASS[0m in 0.19s]
[0m12:41:57.505569 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:41:57.505569 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:41:57.517306 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:41:57.518305 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:41:57.519305 [info ] [Thread-4 (]: 11 of 31 START test relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [RUN]
[0m12:41:57.520304 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:41:57.520304 [info ] [Thread-2 (]: 12 of 31 START test relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [RUN]
[0m12:41:57.521629 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:41:57.521629 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:41:57.521629 [info ] [Thread-1 (]: 13 of 31 START test relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [RUN]
[0m12:41:57.521629 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:41:57.521629 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:41:57.521629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:41:57.521629 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.534001 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:41:57.537968 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:41:57.537968 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:41:57.537968 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:41:57.537968 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:41:57.521629 => 12:41:57.537968
[0m12:41:57.537968 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:41:57.549606 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:41:57.534997 => 12:41:57.537968
[0m12:41:57.549606 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_key as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_key is not null
),

parent as (
    select full_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.550652 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:41:57.551651 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:41:57.551651 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:41:57.537968 => 12:41:57.551651
[0m12:41:57.554851 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:41:57.554851 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:41:57.554851 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:41:57.554851 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:41:57.554851 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:41:57.566349 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:41:57.567399 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: BEGIN
[0m12:41:57.568410 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: BEGIN
[0m12:41:57.569846 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:57.569846 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:41:57.571381 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:57.574922 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: BEGIN
[0m12:41:57.574922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:57.584094 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.586135 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:41:57.491559 => 12:41:57.586135
[0m12:41:57.590678 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: ROLLBACK
[0m12:41:57.592133 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: Close
[0m12:41:57.592133 [info ] [Thread-3 (]: 10 of 31 PASS relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:41:57.594175 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:41:57.594175 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:41:57.594175 [info ] [Thread-3 (]: 14 of 31 START test relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [RUN]
[0m12:41:57.594175 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:41:57.594175 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:41:57.603702 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:41:57.604700 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:41:57.594175 => 12:41:57.604700
[0m12:41:57.605700 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:41:57.607111 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:41:57.607111 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.607111 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.607111 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:41:57.607111 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:41:57.607111 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:41:57.607111 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select full_description as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where full_description is not null
),

parent as (
    select full_description as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.607111 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: BEGIN
[0m12:41:57.607111 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select address as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where address is not null
),

parent as (
    select address as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.616323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.617350 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:57.618857 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:41:57.619425 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select email as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where email is not null
),

parent as (
    select email as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.619425 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.619425 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:41:57.554851 => 12:41:57.619425
[0m12:41:57.619425 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: ROLLBACK
[0m12:41:57.619425 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.619425 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:41:57.554851 => 12:41:57.619425
[0m12:41:57.619425 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: Close
[0m12:41:57.619425 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: ROLLBACK
[0m12:41:57.619425 [info ] [Thread-2 (]: 12 of 31 PASS relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.10s]
[0m12:41:57.634019 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:41:57.635018 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: Close
[0m12:41:57.635018 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:41:57.637020 [info ] [Thread-1 (]: 13 of 31 PASS relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.12s]
[0m12:41:57.637020 [info ] [Thread-2 (]: 15 of 31 START test relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [RUN]
[0m12:41:57.639292 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:41:57.639292 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:41:57.639292 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:41:57.639292 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:41:57.639292 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.639292 [info ] [Thread-1 (]: 16 of 31 START test relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:41:57.655043 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:41:57.657596 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:41:57.657596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:41:57.657596 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select gender as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where gender is not null
),

parent as (
    select gender as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.657596 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:41:57.639292 => 12:41:57.657596
[0m12:41:57.657596 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:41:57.657596 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.657596 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:41:57.669414 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:41:57.670413 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.671572 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:41:57.552604 => 12:41:57.671572
[0m12:41:57.671572 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:41:57.671572 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:41:57.657596 => 12:41:57.671572
[0m12:41:57.678689 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:41:57.605700 => 12:41:57.678689
[0m12:41:57.678689 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: ROLLBACK
[0m12:41:57.678689 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:41:57.678689 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:41:57.678689 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: ROLLBACK
[0m12:41:57.678689 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: BEGIN
[0m12:41:57.685705 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: Close
[0m12:41:57.684923 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:41:57.685705 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:57.685705 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: Close
[0m12:41:57.685705 [info ] [Thread-4 (]: 11 of 31 PASS relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [[32mPASS[0m in 0.16s]
[0m12:41:57.685705 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:41:57.685705 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:41:57.685705 [info ] [Thread-3 (]: 14 of 31 PASS relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.09s]
[0m12:41:57.685705 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: BEGIN
[0m12:41:57.685705 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:41:57.685705 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:41:57.685705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:57.685705 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:41:57.685705 [info ] [Thread-4 (]: 17 of 31 START test relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [RUN]
[0m12:41:57.685705 [info ] [Thread-3 (]: 18 of 31 START test relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [RUN]
[0m12:41:57.685705 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:41:57.685705 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:41:57.699618 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:41:57.700624 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:41:57.705156 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:41:57.705156 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:41:57.716365 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:41:57.701615 => 12:41:57.705156
[0m12:41:57.717366 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:41:57.705156 => 12:41:57.716365
[0m12:41:57.718363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.718363 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.719402 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:41:57.720360 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:41:57.720360 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:41:57.721379 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:41:57.722170 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:41:57.722170 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:41:57.722170 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select claim_id as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where claim_id is not null
),

parent as (
    select claim_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.722170 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select name as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where name is not null
),

parent as (
    select name as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.722170 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:41:57.722170 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:41:57.722170 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: BEGIN
[0m12:41:57.722170 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: BEGIN
[0m12:41:57.732983 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:57.733989 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:57.734982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.734982 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.737984 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:41:57.678689 => 12:41:57.737984
[0m12:41:57.739055 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:41:57.671572 => 12:41:57.739055
[0m12:41:57.739055 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: ROLLBACK
[0m12:41:57.739055 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: ROLLBACK
[0m12:41:57.739055 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: Close
[0m12:41:57.739055 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: Close
[0m12:41:57.739055 [info ] [Thread-2 (]: 15 of 31 PASS relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.10s]
[0m12:41:57.749614 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:41:57.739055 [info ] [Thread-1 (]: 16 of 31 PASS relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:41:57.750622 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:41:57.751610 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:41:57.752737 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:41:57.751610 [info ] [Thread-2 (]: 19 of 31 START test relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [RUN]
[0m12:41:57.752737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:41:57.752737 [info ] [Thread-1 (]: 20 of 31 START test relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:41:57.752737 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:41:57.752737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:41:57.752737 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:41:57.752737 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:41:57.752737 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:41:57.766440 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:41:57.752737 => 12:41:57.766440
[0m12:41:57.767441 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:41:57.752737 => 12:41:57.752737
[0m12:41:57.768484 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:41:57.769437 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:41:57.772302 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:41:57.778812 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:41:57.778812 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:41:57.778812 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: BEGIN
[0m12:41:57.778812 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:41:57.778812 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.782911 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:57.783925 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.784911 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: BEGIN
[0m12:41:57.784911 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:41:57.785913 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:41:57.786910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:57.788440 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_1_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_1_key is not null
),

parent as (
    select diagnosis_1 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.788440 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_2_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_2_key is not null
),

parent as (
    select diagnosis_2 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.788440 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.788440 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.801634 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:41:57.722170 => 12:41:57.800648
[0m12:41:57.802357 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:41:57.721379 => 12:41:57.802357
[0m12:41:57.802357 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: ROLLBACK
[0m12:41:57.802357 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: ROLLBACK
[0m12:41:57.802357 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: Close
[0m12:41:57.802357 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.802357 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: Close
[0m12:41:57.802357 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:41:57.802357 [info ] [Thread-4 (]: 17 of 31 PASS relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.12s]
[0m12:41:57.802357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.802357 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_3_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_3_key is not null
),

parent as (
    select diagnosis_3 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.802357 [info ] [Thread-3 (]: 18 of 31 PASS relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.12s]
[0m12:41:57.802357 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:41:57.802357 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:41:57.802357 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:41:57.816261 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:41:57.818259 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select member_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where member_key is not null
),

parent as (
    select member_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.819259 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:41:57.819259 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.820148 [info ] [Thread-4 (]: 21 of 31 START test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [RUN]
[0m12:41:57.820148 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:41:57.769437 => 12:41:57.820148
[0m12:41:57.820148 [info ] [Thread-3 (]: 22 of 31 START test source_not_null_bootcamp_project_icd_codes_Full_Code ....... [RUN]
[0m12:41:57.820148 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7)
[0m12:41:57.820148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.820148 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: ROLLBACK
[0m12:41:57.820148 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718, now test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0)
[0m12:41:57.820148 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:41:57.820148 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:41:57.772302 => 12:41:57.820148
[0m12:41:57.820148 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:41:57.833067 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: Close
[0m12:41:57.834590 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:41:57.834590 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: ROLLBACK
[0m12:41:57.838106 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:41:57.838106 [info ] [Thread-2 (]: 19 of 31 PASS relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.09s]
[0m12:41:57.838106 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (compile): 12:41:57.820148 => 12:41:57.838106
[0m12:41:57.838106 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: Close
[0m12:41:57.838106 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:41:57.838106 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:41:57.835591 => 12:41:57.838106
[0m12:41:57.838106 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:41:57.849610 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:41:57.838106 [info ] [Thread-1 (]: 20 of 31 PASS relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.09s]
[0m12:41:57.850616 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:41:57.853627 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:41:57.854609 [info ] [Thread-2 (]: 23 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:41:57.854932 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:41:57.854932 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:41:57.854932 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4)
[0m12:41:57.854932 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:41:57.854932 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:41:57.854932 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:41:57.854932 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:41:57.854932 [debug] [Thread-4 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: BEGIN
[0m12:41:57.867348 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:41:57.854932 [info ] [Thread-1 (]: 24 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:41:57.868331 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: BEGIN
[0m12:41:57.869329 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:57.870311 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (compile): 12:41:57.854932 => 12:41:57.869329
[0m12:41:57.871111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60)
[0m12:41:57.871111 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:57.871111 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:41:57.871111 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:41:57.879122 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:41:57.879122 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:41:57.883985 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:41:57.884980 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: BEGIN
[0m12:41:57.885981 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (compile): 12:41:57.879122 => 12:41:57.885981
[0m12:41:57.886982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:57.886982 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:41:57.888373 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:41:57.888373 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:41:57.888373 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: BEGIN
[0m12:41:57.888373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:57.888373 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.888373 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.888373 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:41:57.899638 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:41:57.899638 [debug] [Thread-4 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select total_paid_amount as from_field
    from "bootcamp_project"."public_gold"."total_paid_amount"
    where total_paid_amount is not null
),

parent as (
    select  as to_field
    from "bootcamp_project"."public_silver"."fact_claims"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:41:57.900642 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Full_Code
from "bootcamp_project"."public"."icd_codes"
where Full_Code is null



      
    ) dbt_internal_test
[0m12:41:57.902636 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 18:     select  as to_field
                     ^

[0m12:41:57.903640 [debug] [Thread-4 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: ROLLBACK
[0m12:41:57.905637 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (execute): 12:41:57.851613 => 12:41:57.904637
[0m12:41:57.905637 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.906717 [debug] [Thread-4 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: Close
[0m12:41:57.906717 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:41:57.906717 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select diagnosis_key
from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is null



      
    ) dbt_internal_test
[0m12:41:57.906717 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.916271 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:41:57.854932 => 12:41:57.916271
[0m12:41:57.917279 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 13: select diagnosis_key
                ^

[0m12:41:57.917279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:57.918267 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: ROLLBACK
[0m12:41:57.918874 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: ROLLBACK
[0m12:41:57.918874 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:41:57.918874 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is null



      
    ) dbt_internal_test
[0m12:41:57.918874 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: Close
[0m12:41:57.918874 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (execute): 12:41:57.871111 => 12:41:57.918874
[0m12:41:57.918874 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:57.918874 [info ] [Thread-3 (]: 22 of 31 PASS source_not_null_bootcamp_project_icd_codes_Full_Code ............. [[32mPASS[0m in 0.10s]
[0m12:41:57.918874 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: Close
[0m12:41:57.918874 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (execute): 12:41:57.888373 => 12:41:57.918874
[0m12:41:57.918874 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:41:57.918874 [debug] [Thread-4 (]: Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:41:57.918874 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: ROLLBACK
[0m12:41:57.918874 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:41:57.918874 [debug] [Thread-2 (]: Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:41:57.932983 [error] [Thread-4 (]: 21 of 31 ERROR relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [[31mERROR[0m in 0.10s]
[0m12:41:57.933989 [info ] [Thread-3 (]: 25 of 31 START test source_unique_bootcamp_project_icd_codes_Full_Code ......... [RUN]
[0m12:41:57.934983 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: Close
[0m12:41:57.935694 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:41:57.935694 [error] [Thread-2 (]: 23 of 31 ERROR source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.08s]
[0m12:41:57.935694 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:41:57.935694 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:41:57.935694 [info ] [Thread-1 (]: 24 of 31 PASS source_not_null_bootcamp_project_us_healthcare_claims_member_id .. [[32mPASS[0m in 0.07s]
[0m12:41:57.935694 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:41:57.935694 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:41:57.935694 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:41:57.935694 [info ] [Thread-4 (]: 26 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:41:57.935694 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:41:57.949625 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:41:57.950628 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:41:57.951622 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f)
[0m12:41:57.952623 [info ] [Thread-2 (]: 27 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:41:57.953625 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:41:57.935694 => 12:41:57.953625
[0m12:41:57.952623 [info ] [Thread-1 (]: 28 of 31 START test unique_dim_member_member_key ............................... [RUN]
[0m12:41:57.954341 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:41:57.954341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915)
[0m12:41:57.954341 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:41:57.954341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:41:57.954341 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:41:57.954341 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:41:57.954341 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:41:57.954341 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:41:57.969193 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:41:57.969193 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (compile): 12:41:57.954341 => 12:41:57.969193
[0m12:41:57.969193 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:41:57.969193 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:41:57.969193 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (compile): 12:41:57.966319 => 12:41:57.969193
[0m12:41:57.969193 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:41:57.979251 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: BEGIN
[0m12:41:57.979251 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:41:57.969193 => 12:41:57.979251
[0m12:41:57.979251 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:41:57.979251 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:41:57.982992 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:41:57.982992 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:41:57.986022 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:41:57.986990 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:41:57.988115 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:41:57.988115 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: BEGIN
[0m12:41:57.988115 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:41:57.988115 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:57.988115 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:41:57.988115 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: BEGIN
[0m12:41:57.988115 [debug] [Thread-1 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: BEGIN
[0m12:41:57.988115 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:57.988115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:58.005617 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:58.005617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:58.005617 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:58.005617 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:58.005617 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:41:58.016280 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:41:58.017292 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:41:58.017292 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:41:58.018604 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:58.018604 [debug] [Thread-1 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."dim_member"
where member_key is not null
group by member_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:58.018604 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    diagnosis_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is not null
group by diagnosis_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:58.018604 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Full_Code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."icd_codes"
where Full_Code is not null
group by Full_Code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:58.018604 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 12:     diagnosis_key as unique_field,
             ^

[0m12:41:58.018604 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:58.018604 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:58.018604 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: ROLLBACK
[0m12:41:58.018604 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:41:57.986990 => 12:41:58.018604
[0m12:41:58.018604 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (execute): 12:41:57.984032 => 12:41:58.018604
[0m12:41:58.018604 [debug] [Thread-1 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: ROLLBACK
[0m12:41:58.018604 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: ROLLBACK
[0m12:41:58.018604 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (execute): 12:41:57.979251 => 12:41:58.018604
[0m12:41:58.018604 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: Close
[0m12:41:58.018604 [debug] [Thread-1 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: Close
[0m12:41:58.018604 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: Close
[0m12:41:58.034057 [info ] [Thread-1 (]: 28 of 31 PASS unique_dim_member_member_key ..................................... [[32mPASS[0m in 0.08s]
[0m12:41:58.035590 [info ] [Thread-2 (]: 27 of 31 PASS source_unique_bootcamp_project_us_healthcare_claims_member_id .... [[32mPASS[0m in 0.08s]
[0m12:41:58.036343 [debug] [Thread-4 (]: Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:41:58.036343 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:41:58.036343 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:41:58.036343 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:41:58.036343 [error] [Thread-4 (]: 26 of 31 ERROR source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.08s]
[0m12:41:58.036343 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:41:58.036343 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:41:58.036343 [info ] [Thread-1 (]: 29 of 31 START test unique_icd_codes_data_full_code ............................ [RUN]
[0m12:41:58.036343 [info ] [Thread-2 (]: 30 of 31 START test unique_us_healthcare_claims_data_claim_id .................. [RUN]
[0m12:41:58.036343 [debug] [Thread-4 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:41:58.036343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_dim_member_member_key.31a1be2e46, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:41:58.036343 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:41:58.036343 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:41:58.036343 [info ] [Thread-4 (]: 31 of 31 START test unique_us_healthcare_claims_data_member_id ................. [RUN]
[0m12:41:58.036343 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:41:58.053805 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:41:58.054622 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:41:58.056132 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:41:58.056132 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:41:58.036343 => 12:41:58.056132
[0m12:41:58.056132 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:41:58.056132 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:41:58.056132 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:41:58.056132 => 12:41:58.056132
[0m12:41:58.068390 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:41:58.069390 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:58.071386 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:41:58.071386 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:41:58.075556 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:41:57.954341 => 12:41:58.075556
[0m12:41:58.075556 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:41:58.056132 => 12:41:58.075556
[0m12:41:58.075556 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:41:58.079599 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:41:58.079599 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: ROLLBACK
[0m12:41:58.079599 [debug] [Thread-4 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:41:58.079599 [debug] [Thread-1 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: BEGIN
[0m12:41:58.079599 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:41:58.085616 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:41:58.085616 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: Close
[0m12:41:58.085616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:41:58.085616 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: BEGIN
[0m12:41:58.085616 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:41:58.085616 [info ] [Thread-3 (]: 25 of 31 PASS source_unique_bootcamp_project_icd_codes_Full_Code ............... [[32mPASS[0m in 0.15s]
[0m12:41:58.085616 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:41:58.085616 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: BEGIN
[0m12:41:58.085616 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:41:58.085616 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:41:58.102483 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:58.102483 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:41:58.102483 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is not null
group by claim_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:58.102483 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:58.102483 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:41:58.075556 => 12:41:58.102483
[0m12:41:58.102483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:58.102483 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:41:58.102483 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: ROLLBACK
[0m12:41:58.102483 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:41:58.102483 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:41:58.102483 [debug] [Thread-1 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    full_code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."icd_codes_data"
where full_code is not null
group by full_code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:58.102483 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:41:58.102483 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: Close
[0m12:41:58.117228 [info ] [Thread-2 (]: 30 of 31 PASS unique_us_healthcare_claims_data_claim_id ........................ [[32mPASS[0m in 0.08s]
[0m12:41:58.120227 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:41:58.120227 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:58.122266 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:41:58.082996 => 12:41:58.122266
[0m12:41:58.122266 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: ROLLBACK
[0m12:41:58.123030 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: Close
[0m12:41:58.127241 [info ] [Thread-4 (]: 31 of 31 PASS unique_us_healthcare_claims_data_member_id ....................... [[32mPASS[0m in 0.07s]
[0m12:41:58.127241 [debug] [Thread-4 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:41:58.156245 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:41:58.156245 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:41:58.069390 => 12:41:58.156245
[0m12:41:58.156245 [debug] [Thread-1 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: ROLLBACK
[0m12:41:58.156245 [debug] [Thread-1 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: Close
[0m12:41:58.166310 [info ] [Thread-1 (]: 29 of 31 PASS unique_icd_codes_data_full_code .................................. [[32mPASS[0m in 0.12s]
[0m12:41:58.168307 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:41:58.170334 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:58.170334 [debug] [MainThread]: On master: BEGIN
[0m12:41:58.171225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:41:58.185931 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:41:58.185931 [debug] [MainThread]: On master: COMMIT
[0m12:41:58.185931 [debug] [MainThread]: Using postgres connection "master"
[0m12:41:58.185931 [debug] [MainThread]: On master: COMMIT
[0m12:41:58.185931 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:41:58.185931 [debug] [MainThread]: On master: Close
[0m12:41:58.185931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:41:58.185931 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:41:58.185931 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:41:58.185931 [debug] [MainThread]: Connection 'test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9' was properly closed.
[0m12:41:58.185931 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7' was properly closed.
[0m12:41:58.185931 [debug] [MainThread]: Connection 'test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280' was properly closed.
[0m12:41:58.185931 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea' was properly closed.
[0m12:41:58.185931 [info ] [MainThread]: 
[0m12:41:58.199573 [info ] [MainThread]: Finished running 31 tests in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m12:41:58.204971 [debug] [MainThread]: Command end result
[0m12:41:58.219509 [info ] [MainThread]: 
[0m12:41:58.221415 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:41:58.222012 [info ] [MainThread]: 
[0m12:41:58.222012 [error] [MainThread]:   Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:41:58.222012 [info ] [MainThread]: 
[0m12:41:58.222012 [error] [MainThread]:   Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:41:58.222012 [info ] [MainThread]: 
[0m12:41:58.222012 [error] [MainThread]:   Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:41:58.222012 [info ] [MainThread]: 
[0m12:41:58.222012 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=3 SKIP=0 TOTAL=31
[0m12:41:58.232889 [debug] [MainThread]: Command `dbt test` failed at 12:41:58.232889 after 1.57 seconds
[0m12:41:58.232889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2A9D7E390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2AA00C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2AA00C610>]}
[0m12:41:58.233902 [debug] [MainThread]: Flushing usage events
[0m12:43:14.502478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B6F6B850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B6F5E990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B6F5F890>]}


============================== 12:43:14.502478 | d27b5d37-267a-4047-b01f-23ba34210cc9 ==============================
[0m12:43:14.502478 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:43:14.502478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m12:43:14.614219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd27b5d37-267a-4047-b01f-23ba34210cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B7152ED0>]}
[0m12:43:14.679649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd27b5d37-267a-4047-b01f-23ba34210cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B707C2D0>]}
[0m12:43:14.679649 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:43:14.689244 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:43:14.743963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:43:14.744962 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\testing\test1.yml
[0m12:43:14.755466 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:43:14.760561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd27b5d37-267a-4047-b01f-23ba34210cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B70C6850>]}
[0m12:43:14.768156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd27b5d37-267a-4047-b01f-23ba34210cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B73B6ED0>]}
[0m12:43:14.768156 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:43:14.768156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd27b5d37-267a-4047-b01f-23ba34210cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B730F650>]}
[0m12:43:14.768156 [info ] [MainThread]: 
[0m12:43:14.768156 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:43:14.768156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:43:14.768156 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:43:14.783701 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:43:14.783701 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:43:14.783701 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:43:14.783701 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:43:14.783701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:14.783701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:14.802482 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:43:14.802482 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:43:14.802482 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:43:14.802482 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:43:14.802482 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:43:14.802482 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:43:14.802482 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:43:14.802482 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:43:14.816232 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:43:14.817230 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:43:14.819410 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:43:14.819410 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:43:14.819410 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:14.819410 [debug] [MainThread]: On master: BEGIN
[0m12:43:14.819410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:43:14.833439 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:43:14.833439 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:14.833439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:43:14.833439 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:43:14.833439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd27b5d37-267a-4047-b01f-23ba34210cc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B71D2090>]}
[0m12:43:14.833439 [debug] [MainThread]: On master: ROLLBACK
[0m12:43:14.847806 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:14.848808 [debug] [MainThread]: On master: BEGIN
[0m12:43:14.850000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:43:14.850000 [debug] [MainThread]: On master: COMMIT
[0m12:43:14.850000 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:14.850000 [debug] [MainThread]: On master: COMMIT
[0m12:43:14.850000 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:43:14.850000 [debug] [MainThread]: On master: Close
[0m12:43:14.850000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:43:14.850000 [info ] [MainThread]: 
[0m12:43:14.850000 [debug] [Thread-1 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:43:14.850000 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:43:14.850000 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:43:14.850000 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:43:14.850000 [info ] [Thread-1 (]: 1 of 31 START test accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [RUN]
[0m12:43:14.850000 [info ] [Thread-2 (]: 2 of 31 START test not_null_dim_member_member_key .............................. [RUN]
[0m12:43:14.850000 [info ] [Thread-3 (]: 3 of 31 START test not_null_fact_claims_claimed_date_key ....................... [RUN]
[0m12:43:14.850000 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489'
[0m12:43:14.850000 [info ] [Thread-4 (]: 4 of 31 START test not_null_fact_claims_enrolled_date_key ...................... [RUN]
[0m12:43:14.850000 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_dim_member_member_key.ff327b2471'
[0m12:43:14.865399 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead'
[0m12:43:14.866399 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:43:14.866399 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb'
[0m12:43:14.867399 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:43:14.868402 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:43:14.868931 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:43:14.868931 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:43:14.884117 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:43:14.884117 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:43:14.884117 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:43:14.884117 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:43:14.868931 => 12:43:14.884117
[0m12:43:14.884117 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:43:14.881154 => 12:43:14.884117
[0m12:43:14.884117 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:43:14.884117 => 12:43:14.884117
[0m12:43:14.884117 [debug] [Thread-1 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:43:14.884117 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:43:14.884117 => 12:43:14.884117
[0m12:43:14.884117 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:43:14.897818 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:43:14.902255 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:43:14.902255 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:43:14.902255 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:43:14.902255 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:43:14.902255 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:43:14.915593 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:43:14.917047 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:43:14.917047 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:43:14.917047 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: BEGIN
[0m12:43:14.917047 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:43:14.917047 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: BEGIN
[0m12:43:14.917047 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: BEGIN
[0m12:43:14.917047 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:43:14.917047 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: BEGIN
[0m12:43:14.917047 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:43:14.917047 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:43:14.917047 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:43:14.933174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:14.933174 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:43:14.933174 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Others'
)



      
    ) dbt_internal_test
[0m12:43:14.933174 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:14.933174 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:43:14.898325 => 12:43:14.933174
[0m12:43:14.933174 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: ROLLBACK
[0m12:43:14.933174 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:14.933174 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:14.933174 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: Close
[0m12:43:14.933174 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:43:14.933174 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:14.933174 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:43:14.933174 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claimed_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where claimed_date_key is null



      
    ) dbt_internal_test
[0m12:43:14.933174 [info ] [Thread-1 (]: 1 of 31 PASS accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [[32mPASS[0m in 0.08s]
[0m12:43:14.947731 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:43:14.947731 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select enrolled_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where enrolled_date_key is null



      
    ) dbt_internal_test
[0m12:43:14.949179 [debug] [Thread-1 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:43:14.949179 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_key
from "bootcamp_project"."public_silver"."dim_member"
where member_key is null



      
    ) dbt_internal_test
[0m12:43:14.950182 [debug] [Thread-1 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:43:14.950182 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:14.951180 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:14.951180 [info ] [Thread-1 (]: 5 of 31 START test not_null_us_healthcare_claims_data_claim_id ................. [RUN]
[0m12:43:14.953179 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:43:14.902255 => 12:43:14.953179
[0m12:43:14.953179 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:14.955176 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:43:14.914589 => 12:43:14.954179
[0m12:43:14.955176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:43:14.956179 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: ROLLBACK
[0m12:43:14.957180 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:43:14.902255 => 12:43:14.957180
[0m12:43:14.958054 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: ROLLBACK
[0m12:43:14.958054 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:43:14.958054 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: ROLLBACK
[0m12:43:14.958054 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:43:14.958054 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: Close
[0m12:43:14.964376 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: Close
[0m12:43:14.965381 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:43:14.958054 => 12:43:14.965381
[0m12:43:14.967619 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: Close
[0m12:43:14.966374 [info ] [Thread-4 (]: 4 of 31 PASS not_null_fact_claims_enrolled_date_key ............................ [[32mPASS[0m in 0.10s]
[0m12:43:14.967619 [debug] [Thread-1 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:43:14.967619 [info ] [Thread-3 (]: 3 of 31 PASS not_null_fact_claims_claimed_date_key ............................. [[32mPASS[0m in 0.10s]
[0m12:43:14.967619 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:43:14.967619 [info ] [Thread-2 (]: 2 of 31 PASS not_null_dim_member_member_key .................................... [[32mPASS[0m in 0.12s]
[0m12:43:14.967619 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:43:14.967619 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:43:14.967619 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:43:14.967619 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:43:14.967619 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:43:14.967619 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:43:14.967619 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:43:14.967619 [info ] [Thread-4 (]: 6 of 31 START test not_null_us_healthcare_claims_data_member_id ................ [RUN]
[0m12:43:14.967619 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: BEGIN
[0m12:43:14.967619 [info ] [Thread-3 (]: 7 of 31 START test relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [RUN]
[0m12:43:14.982066 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:43:14.981045 [info ] [Thread-2 (]: 8 of 31 START test relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [RUN]
[0m12:43:14.983046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:14.984043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:43:14.984043 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:43:14.985581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:43:14.985581 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:43:14.985581 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:43:14.985581 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:43:14.997804 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:43:15.002625 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:43:15.002625 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:43:14.985581 => 12:43:15.002625
[0m12:43:15.002625 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:43:14.985581 => 12:43:15.002625
[0m12:43:15.002625 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:43:15.002625 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:43:14.998315 => 12:43:15.002625
[0m12:43:15.002625 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:43:15.002625 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:43:15.002625 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:43:15.002625 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:43:15.014451 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:43:15.017132 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:43:15.017132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.017132 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:43:15.017132 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: BEGIN
[0m12:43:15.017132 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:43:15.017132 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:43:15.017132 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: BEGIN
[0m12:43:15.017132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:15.017132 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: BEGIN
[0m12:43:15.017132 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is null



      
    ) dbt_internal_test
[0m12:43:15.017132 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:15.017132 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:15.017132 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.017132 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:43:14.967619 => 12:43:15.017132
[0m12:43:15.017132 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: ROLLBACK
[0m12:43:15.017132 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: Close
[0m12:43:15.031072 [info ] [Thread-1 (]: 5 of 31 PASS not_null_us_healthcare_claims_data_claim_id ....................... [[32mPASS[0m in 0.08s]
[0m12:43:15.033077 [debug] [Thread-1 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:43:15.033269 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:43:15.033269 [info ] [Thread-1 (]: 9 of 31 START test relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [RUN]
[0m12:43:15.033269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:43:15.033269 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:43:15.033269 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:43:15.033269 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.033269 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:43:15.033269 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:43:15.033269 => 12:43:15.033269
[0m12:43:15.033269 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is null



      
    ) dbt_internal_test
[0m12:43:15.033269 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.033269 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.033269 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:43:15.033269 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:43:15.033269 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:43:15.047783 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:43:15.047783 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.048825 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_title as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_title is not null
),

parent as (
    select category_title as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.048825 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_code is not null
),

parent as (
    select category_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.050784 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:43:15.002625 => 12:43:15.050784
[0m12:43:15.051782 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:43:15.051917 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: ROLLBACK
[0m12:43:15.051917 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: BEGIN
[0m12:43:15.051917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:15.055786 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: Close
[0m12:43:15.058314 [info ] [Thread-4 (]: 6 of 31 PASS not_null_us_healthcare_claims_data_member_id ...................... [[32mPASS[0m in 0.07s]
[0m12:43:15.058314 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:43:15.058314 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:43:15.058314 [info ] [Thread-4 (]: 10 of 31 START test relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [RUN]
[0m12:43:15.058314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:43:15.064419 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:43:15.071142 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:43:15.071142 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:43:15.065417 => 12:43:15.071142
[0m12:43:15.071142 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:43:15.078708 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:43:15.078708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.081153 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:43:15.082154 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:43:15.082803 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_code is not null
),

parent as (
    select diagnosis_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.083156 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: BEGIN
[0m12:43:15.084161 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:15.087158 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.092100 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:43:15.002625 => 12:43:15.088927
[0m12:43:15.092100 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: ROLLBACK
[0m12:43:15.094638 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: Close
[0m12:43:15.096159 [info ] [Thread-3 (]: 7 of 31 PASS relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [[32mPASS[0m in 0.11s]
[0m12:43:15.098338 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:43:15.098338 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:43:15.100350 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.100350 [info ] [Thread-3 (]: 11 of 31 START test relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [RUN]
[0m12:43:15.102351 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:43:15.015452 => 12:43:15.101351
[0m12:43:15.103351 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:43:15.103351 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: ROLLBACK
[0m12:43:15.104351 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:43:15.110258 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:43:15.110258 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: Close
[0m12:43:15.110258 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:43:15.105306 => 12:43:15.110258
[0m12:43:15.110258 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.115557 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.114556 [info ] [Thread-2 (]: 8 of 31 PASS relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [[32mPASS[0m in 0.13s]
[0m12:43:15.115557 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:43:15.117558 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:43:15.033269 => 12:43:15.117558
[0m12:43:15.117558 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:43:15.118557 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:43:15.119855 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:43:15.119855 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: ROLLBACK
[0m12:43:15.119855 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_key as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_key is not null
),

parent as (
    select full_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.119855 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:43:15.119855 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:43:15.119855 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: BEGIN
[0m12:43:15.119855 [info ] [Thread-2 (]: 12 of 31 START test relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [RUN]
[0m12:43:15.119855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:15.119855 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: Close
[0m12:43:15.119855 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:43:15.119855 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:43:15.119855 [info ] [Thread-1 (]: 9 of 31 PASS relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [[32mPASS[0m in 0.09s]
[0m12:43:15.137389 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:43:15.137389 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:43:15.137389 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:43:15.137389 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:43:15.119855 => 12:43:15.137389
[0m12:43:15.137389 [info ] [Thread-1 (]: 13 of 31 START test relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [RUN]
[0m12:43:15.137389 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:43:15.145437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:43:15.145437 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:43:15.145437 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.150476 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:43:15.150476 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.151490 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:43:15.152486 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:43:15.153163 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:43:15.153163 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:43:15.076168 => 12:43:15.153163
[0m12:43:15.153163 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select full_description as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where full_description is not null
),

parent as (
    select full_description as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.153163 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: BEGIN
[0m12:43:15.153163 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: ROLLBACK
[0m12:43:15.153163 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:43:15.152486 => 12:43:15.153163
[0m12:43:15.153163 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:15.153163 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:43:15.167705 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:43:15.167705 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: Close
[0m12:43:15.167705 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:43:15.167705 [info ] [Thread-4 (]: 10 of 31 PASS relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [[32mPASS[0m in 0.11s]
[0m12:43:15.167705 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: BEGIN
[0m12:43:15.167705 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:43:15.167705 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:15.167705 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:43:15.167705 [info ] [Thread-4 (]: 14 of 31 START test relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [RUN]
[0m12:43:15.167705 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:43:15.167705 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:43:15.233425 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.233425 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:43:15.233425 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.233425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.233425 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:43:15.119553 => 12:43:15.233425
[0m12:43:15.233425 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:43:15.167705 => 12:43:15.233425
[0m12:43:15.233425 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:43:15.233425 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:43:15.233425 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: ROLLBACK
[0m12:43:15.233425 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:43:15.247795 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select address as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where address is not null
),

parent as (
    select address as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.247795 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select email as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where email is not null
),

parent as (
    select email as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.249795 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:43:15.250794 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: Close
[0m12:43:15.251795 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:43:15.253801 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: BEGIN
[0m12:43:15.252793 [info ] [Thread-3 (]: 11 of 31 PASS relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [[32mPASS[0m in 0.15s]
[0m12:43:15.255795 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.255795 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:15.257793 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:43:15.259797 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:43:15.145437 => 12:43:15.258798
[0m12:43:15.260795 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.261794 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:43:15.262796 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: ROLLBACK
[0m12:43:15.264901 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:43:15.153163 => 12:43:15.264826
[0m12:43:15.266881 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: ROLLBACK
[0m12:43:15.265874 [info ] [Thread-3 (]: 15 of 31 START test relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [RUN]
[0m12:43:15.267878 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: Close
[0m12:43:15.268880 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:43:15.268880 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: Close
[0m12:43:15.270878 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:43:15.269877 [info ] [Thread-2 (]: 12 of 31 PASS relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.15s]
[0m12:43:15.278890 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:43:15.272876 [info ] [Thread-1 (]: 13 of 31 PASS relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.13s]
[0m12:43:15.279876 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:43:15.281393 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:43:15.281393 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:43:15.272876 => 12:43:15.281393
[0m12:43:15.282736 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:43:15.283738 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:43:15.283738 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:43:15.285059 [info ] [Thread-2 (]: 16 of 31 START test relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:43:15.285747 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:43:15.285747 [info ] [Thread-1 (]: 17 of 31 START test relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [RUN]
[0m12:43:15.285747 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:43:15.285747 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:43:15.285747 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:43:15.285747 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:43:15.285747 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:43:15.285747 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: BEGIN
[0m12:43:15.285747 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.300783 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:43:15.302831 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:43:15.302831 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:15.302831 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:43:15.302831 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:43:15.285747 => 12:43:15.302831
[0m12:43:15.302831 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:43:15.301783 => 12:43:15.302831
[0m12:43:15.302831 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select gender as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where gender is not null
),

parent as (
    select gender as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.302831 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:43:15.302831 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:43:15.316455 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:43:15.316455 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.319490 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:43:15.319490 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:43:15.248796 => 12:43:15.319490
[0m12:43:15.319490 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:43:15.319490 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:43:15.319490 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: ROLLBACK
[0m12:43:15.319490 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: BEGIN
[0m12:43:15.319490 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: BEGIN
[0m12:43:15.319490 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:15.319490 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: Close
[0m12:43:15.319490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:15.319490 [info ] [Thread-4 (]: 14 of 31 PASS relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.15s]
[0m12:43:15.331205 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:43:15.332214 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.332214 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:43:15.333208 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:43:15.335202 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select name as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where name is not null
),

parent as (
    select name as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.334207 [info ] [Thread-4 (]: 18 of 31 START test relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [RUN]
[0m12:43:15.336787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:43:15.336787 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:43:15.336787 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:43:15.336787 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.336787 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:43:15.285747 => 12:43:15.336787
[0m12:43:15.336787 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.336787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.336787 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: ROLLBACK
[0m12:43:15.347728 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:43:15.336787 => 12:43:15.336787
[0m12:43:15.347728 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:43:15.348736 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:43:15.349974 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:43:15.349974 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select claim_id as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where claim_id is not null
),

parent as (
    select claim_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.349974 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: Close
[0m12:43:15.349974 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_1_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_1_key is not null
),

parent as (
    select diagnosis_1 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.349974 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:43:15.349974 [info ] [Thread-3 (]: 15 of 31 PASS relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:43:15.349974 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:43:15.349974 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.349974 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:43:15.349974 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:43:15.349974 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:43:15.302831 => 12:43:15.349974
[0m12:43:15.349974 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.349974 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: BEGIN
[0m12:43:15.349974 [info ] [Thread-3 (]: 19 of 31 START test relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [RUN]
[0m12:43:15.349974 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: ROLLBACK
[0m12:43:15.349974 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:43:15.317453 => 12:43:15.349974
[0m12:43:15.349974 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:15.349974 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:43:15.349974 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: ROLLBACK
[0m12:43:15.365039 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:43:15.365039 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: Close
[0m12:43:15.369332 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:43:15.369332 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: Close
[0m12:43:15.369332 [info ] [Thread-2 (]: 16 of 31 PASS relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:43:15.369332 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:43:15.369332 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:43:15.366049 => 12:43:15.369332
[0m12:43:15.369332 [info ] [Thread-1 (]: 17 of 31 PASS relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:43:15.369332 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:43:15.369332 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:43:15.369332 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:43:15.369332 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.369332 [info ] [Thread-2 (]: 20 of 31 START test relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:43:15.382098 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:43:15.383080 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:43:15.384076 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:43:15.384076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:43:15.385746 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:43:15.385746 [info ] [Thread-1 (]: 21 of 31 START test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [RUN]
[0m12:43:15.385746 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_2_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_2_key is not null
),

parent as (
    select diagnosis_2 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.385746 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:43:15.385746 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: BEGIN
[0m12:43:15.385746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7)
[0m12:43:15.385746 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:43:15.385746 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.385746 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:15.385746 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:43:15.385746 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:43:15.349974 => 12:43:15.385746
[0m12:43:15.385746 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:43:15.385746 => 12:43:15.385746
[0m12:43:15.402772 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:43:15.403417 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: ROLLBACK
[0m12:43:15.403417 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:43:15.403417 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:43:15.403417 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (compile): 12:43:15.385746 => 12:43:15.403417
[0m12:43:15.403417 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: Close
[0m12:43:15.403417 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:43:15.403417 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:43:15.403417 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:43:15.403417 [info ] [Thread-4 (]: 18 of 31 PASS relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.07s]
[0m12:43:15.403417 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.414352 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: BEGIN
[0m12:43:15.415354 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:43:15.415354 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:43:15.416352 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:43:15.416352 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:15.417350 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:43:15.417350 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: BEGIN
[0m12:43:15.418566 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_3_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_3_key is not null
),

parent as (
    select diagnosis_3 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.418566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:15.418566 [info ] [Thread-4 (]: 22 of 31 START test source_not_null_bootcamp_project_icd_codes_Full_Code ....... [RUN]
[0m12:43:15.418566 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718, now test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0)
[0m12:43:15.418566 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:43:15.418566 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:43:15.418566 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.418566 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:43:15.369332 => 12:43:15.418566
[0m12:43:15.418566 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: ROLLBACK
[0m12:43:15.418566 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:43:15.418566 => 12:43:15.418566
[0m12:43:15.418566 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:43:15.432236 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: Close
[0m12:43:15.434324 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:43:15.434324 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.434324 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.434324 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:43:15.434324 [info ] [Thread-3 (]: 19 of 31 PASS relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:43:15.434324 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:43:15.434324 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:43:15.434324 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select total_paid_amount as from_field
    from "bootcamp_project"."public_gold"."total_paid_amount"
    where total_paid_amount is not null
),

parent as (
    select  as to_field
    from "bootcamp_project"."public_silver"."fact_claims"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.434324 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:43:15.434324 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select member_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where member_key is not null
),

parent as (
    select member_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:43:15.434324 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: BEGIN
[0m12:43:15.434324 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:43:15.434324 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 18:     select  as to_field
                     ^

[0m12:43:15.434324 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:15.434324 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: ROLLBACK
[0m12:43:15.434324 [info ] [Thread-3 (]: 23 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:43:15.434324 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.434324 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4)
[0m12:43:15.434324 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (execute): 12:43:15.403417 => 12:43:15.434324
[0m12:43:15.448744 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:43:15.403417 => 12:43:15.448744
[0m12:43:15.449748 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:43:15.449748 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: Close
[0m12:43:15.450740 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: ROLLBACK
[0m12:43:15.451937 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:43:15.451937 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (compile): 12:43:15.451937 => 12:43:15.451937
[0m12:43:15.451937 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: Close
[0m12:43:15.451937 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:43:15.451937 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.451937 [info ] [Thread-2 (]: 20 of 31 PASS relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.07s]
[0m12:43:15.464442 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:43:15.465449 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:43:15.465449 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:43:15.467443 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Full_Code
from "bootcamp_project"."public"."icd_codes"
where Full_Code is null



      
    ) dbt_internal_test
[0m12:43:15.467443 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:43:15.468959 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:43:15.468959 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: BEGIN
[0m12:43:15.468959 [debug] [Thread-1 (]: Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:43:15.468959 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:15.468959 [info ] [Thread-2 (]: 24 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:43:15.468959 [error] [Thread-1 (]: 21 of 31 ERROR relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [[31mERROR[0m in 0.08s]
[0m12:43:15.468959 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60)
[0m12:43:15.468959 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:43:15.468959 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.468959 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:43:15.468959 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:43:15.483208 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:43:15.433239 => 12:43:15.482208
[0m12:43:15.486546 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:43:15.486546 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: ROLLBACK
[0m12:43:15.486546 [info ] [Thread-1 (]: 25 of 31 START test source_unique_bootcamp_project_icd_codes_Full_Code ......... [RUN]
[0m12:43:15.486546 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.486546 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (compile): 12:43:15.483208 => 12:43:15.486546
[0m12:43:15.486546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:43:15.486546 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: Close
[0m12:43:15.486546 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"
[0m12:43:15.486546 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:43:15.486546 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:43:15.499756 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select diagnosis_key
from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is null



      
    ) dbt_internal_test
[0m12:43:15.498753 [info ] [Thread-4 (]: 22 of 31 PASS source_not_null_bootcamp_project_icd_codes_Full_Code ............. [[32mPASS[0m in 0.08s]
[0m12:43:15.502697 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:43:15.502697 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:43:15.502697 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:43:15.502697 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:43:15.502697 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:43:15.502697 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 13: select diagnosis_key
                ^

[0m12:43:15.502697 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: BEGIN
[0m12:43:15.502697 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:43:15.502697 => 12:43:15.502697
[0m12:43:15.502697 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: ROLLBACK
[0m12:43:15.502697 [info ] [Thread-4 (]: 26 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [RUN]
[0m12:43:15.502697 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:15.502697 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:43:15.515328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f)
[0m12:43:15.515328 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4 (execute): 12:43:15.451937 => 12:43:15.515328
[0m12:43:15.518326 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:43:15.519159 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:43:15.519159 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4: Close
[0m12:43:15.519159 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:43:15.519159 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:43:15.519159 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (compile): 12:43:15.519159 => 12:43:15.519159
[0m12:43:15.519159 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: BEGIN
[0m12:43:15.519159 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:43:15.519159 [debug] [Thread-3 (]: Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:43:15.519159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:15.531208 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:43:15.532221 [error] [Thread-3 (]: 23 of 31 ERROR source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.10s]
[0m12:43:15.533982 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4
[0m12:43:15.533982 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:43:15.533982 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:43:15.533982 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: BEGIN
[0m12:43:15.533982 [info ] [Thread-3 (]: 27 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:43:15.533982 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:15.533982 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key.c9fcf0e2d4, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915)
[0m12:43:15.533982 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:43:15.533982 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:43:15.533982 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (compile): 12:43:15.533982 => 12:43:15.533982
[0m12:43:15.533982 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:43:15.547790 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:43:15.548789 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.548789 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.549786 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:43:15.550788 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:43:15.550788 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:43:15.552449 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is null



      
    ) dbt_internal_test
[0m12:43:15.552449 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: BEGIN
[0m12:43:15.552449 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Full_Code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."icd_codes"
where Full_Code is not null
group by Full_Code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:15.552449 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:15.552449 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.552449 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.552449 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"
[0m12:43:15.552449 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (execute): 12:43:15.500755 => 12:43:15.552449
[0m12:43:15.552449 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    diagnosis_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where diagnosis_key is not null
group by diagnosis_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:15.552449 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: ROLLBACK
[0m12:43:15.552449 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: Close
[0m12:43:15.552449 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "diagnosis_key" does not exist
LINE 12:     diagnosis_key as unique_field,
             ^

[0m12:43:15.552449 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: ROLLBACK
[0m12:43:15.552449 [info ] [Thread-2 (]: 24 of 31 PASS source_not_null_bootcamp_project_us_healthcare_claims_member_id .. [[32mPASS[0m in 0.08s]
[0m12:43:15.552449 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:43:15.552449 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f (execute): 12:43:15.519159 => 12:43:15.552449
[0m12:43:15.552449 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:43:15.552449 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f: Close
[0m12:43:15.552449 [info ] [Thread-2 (]: 28 of 31 START test unique_dim_member_member_key ............................... [RUN]
[0m12:43:15.569721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:43:15.569721 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:43:15.569721 [debug] [Thread-4 (]: Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:43:15.577233 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:43:15.577233 [error] [Thread-4 (]: 26 of 31 ERROR source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key  [[31mERROR[0m in 0.06s]
[0m12:43:15.577233 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f
[0m12:43:15.577233 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.577233 [debug] [Thread-4 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:43:15.577233 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:43:15.569721 => 12:43:15.577233
[0m12:43:15.577233 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:43:15.577233 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:43:15.577233 [info ] [Thread-4 (]: 29 of 31 START test unique_icd_codes_data_full_code ............................ [RUN]
[0m12:43:15.577233 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:15.577233 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:43:15.588276 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key.35e98e245f, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:43:15.589335 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:43:15.589335 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:43:15.589335 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:43:15.589335 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.589335 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: BEGIN
[0m12:43:15.589335 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.597724 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (execute): 12:43:15.533982 => 12:43:15.597724
[0m12:43:15.598724 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:43:15.589335 => 12:43:15.597724
[0m12:43:15.598724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:43:15.599720 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:43:15.516328 => 12:43:15.599720
[0m12:43:15.600721 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: ROLLBACK
[0m12:43:15.600721 [debug] [Thread-4 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:43:15.601924 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: ROLLBACK
[0m12:43:15.609182 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:43:15.609718 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: Close
[0m12:43:15.611831 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:43:15.612352 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: Close
[0m12:43:15.611303 [info ] [Thread-3 (]: 27 of 31 PASS source_unique_bootcamp_project_us_healthcare_claims_member_id .... [[32mPASS[0m in 0.08s]
[0m12:43:15.612878 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: BEGIN
[0m12:43:15.614945 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:43:15.613960 [info ] [Thread-1 (]: 25 of 31 PASS source_unique_bootcamp_project_icd_codes_Full_Code ............... [[32mPASS[0m in 0.13s]
[0m12:43:15.616004 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:43:15.616509 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.617518 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:43:15.617518 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:43:15.618518 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:43:15.619493 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:43:15.619493 [info ] [Thread-3 (]: 30 of 31 START test unique_us_healthcare_claims_data_claim_id .................. [RUN]
[0m12:43:15.619493 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."dim_member"
where member_key is not null
group by member_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:15.619493 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:43:15.619493 [info ] [Thread-1 (]: 31 of 31 START test unique_us_healthcare_claims_data_member_id ................. [RUN]
[0m12:43:15.619493 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:43:15.619493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:43:15.619493 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:43:15.619493 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.619493 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:43:15.631127 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:43:15.577233 => 12:43:15.631127
[0m12:43:15.636057 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:43:15.636057 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:43:15.619493 => 12:43:15.636057
[0m12:43:15.636057 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.636057 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: ROLLBACK
[0m12:43:15.636057 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:43:15.636057 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:43:15.631127 => 12:43:15.636057
[0m12:43:15.636057 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:43:15.636057 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:43:15.636057 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: Close
[0m12:43:15.636057 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:43:15.636057 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    full_code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."icd_codes_data"
where full_code is not null
group by full_code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:15.636057 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:43:15.636057 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:43:15.636057 [info ] [Thread-2 (]: 28 of 31 PASS unique_dim_member_member_key ..................................... [[32mPASS[0m in 0.07s]
[0m12:43:15.636057 [debug] [Thread-3 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: BEGIN
[0m12:43:15.636057 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:43:15.649096 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:43:15.650089 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:43:15.650089 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: BEGIN
[0m12:43:15.652096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:43:15.667076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.668590 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:43:15.668590 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.668590 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:15.668590 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:43:15.668590 [debug] [Thread-3 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is not null
group by claim_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:43:15.668590 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.668590 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.668590 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:43:15.636057 => 12:43:15.668590
[0m12:43:15.668590 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:43:15.636057 => 12:43:15.668590
[0m12:43:15.668590 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: ROLLBACK
[0m12:43:15.668590 [debug] [Thread-3 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: ROLLBACK
[0m12:43:15.668590 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: Close
[0m12:43:15.668590 [debug] [Thread-3 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: Close
[0m12:43:15.668590 [info ] [Thread-1 (]: 31 of 31 PASS unique_us_healthcare_claims_data_member_id ....................... [[32mPASS[0m in 0.05s]
[0m12:43:15.683116 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:43:15.668590 [info ] [Thread-3 (]: 30 of 31 PASS unique_us_healthcare_claims_data_claim_id ........................ [[32mPASS[0m in 0.05s]
[0m12:43:15.684115 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:43:15.693177 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:43:15.693177 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:43:15.603178 => 12:43:15.693177
[0m12:43:15.693177 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: ROLLBACK
[0m12:43:15.693177 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: Close
[0m12:43:15.697834 [info ] [Thread-4 (]: 29 of 31 PASS unique_icd_codes_data_full_code .................................. [[32mPASS[0m in 0.11s]
[0m12:43:15.699836 [debug] [Thread-4 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:43:15.701098 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:15.701098 [debug] [MainThread]: On master: BEGIN
[0m12:43:15.701098 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:43:15.718575 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:43:15.718575 [debug] [MainThread]: On master: COMMIT
[0m12:43:15.718575 [debug] [MainThread]: Using postgres connection "master"
[0m12:43:15.718575 [debug] [MainThread]: On master: COMMIT
[0m12:43:15.718575 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:43:15.718575 [debug] [MainThread]: On master: Close
[0m12:43:15.718575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:15.718575 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:43:15.718575 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:43:15.718575 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea' was properly closed.
[0m12:43:15.718575 [debug] [MainThread]: Connection 'test.postgres_dev.unique_dim_member_member_key.31a1be2e46' was properly closed.
[0m12:43:15.731186 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7' was properly closed.
[0m12:43:15.731186 [debug] [MainThread]: Connection 'test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9' was properly closed.
[0m12:43:15.732190 [info ] [MainThread]: 
[0m12:43:15.733188 [info ] [MainThread]: Finished running 31 tests in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m12:43:15.736369 [debug] [MainThread]: Command end result
[0m12:43:15.748961 [info ] [MainThread]: 
[0m12:43:15.749949 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:43:15.750949 [info ] [MainThread]: 
[0m12:43:15.751951 [error] [MainThread]:   Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:43:15.753137 [info ] [MainThread]: 
[0m12:43:15.753137 [error] [MainThread]:   Database Error in test source_not_null_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 13: select diagnosis_key
                  ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_not_null_bootcamp_proje_8b2734380311b61f8c549acf62c8bc5a.sql
[0m12:43:15.753137 [info ] [MainThread]: 
[0m12:43:15.753137 [error] [MainThread]:   Database Error in test source_unique_bootcamp_project_us_healthcare_claims_diagnosis_key (models\source\sources.yml)
  column "diagnosis_key" does not exist
  LINE 12:     diagnosis_key as unique_field,
               ^
  compiled Code at target\run\postgres_dev\models\source\sources.yml\source_unique_bootcamp_project_8493abbb0de422a5c0407d61ac20edb8.sql
[0m12:43:15.753137 [info ] [MainThread]: 
[0m12:43:15.753137 [info ] [MainThread]: Done. PASS=28 WARN=0 ERROR=3 SKIP=0 TOTAL=31
[0m12:43:15.753137 [debug] [MainThread]: Command `dbt test` failed at 12:43:15.753137 after 1.30 seconds
[0m12:43:15.753137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B6BB3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B054C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283B054C4D0>]}
[0m12:43:15.753137 [debug] [MainThread]: Flushing usage events
[0m12:45:18.949309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934CEA7F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934CEC0390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934CEA7550>]}


============================== 12:45:18.949309 | 9b40df01-2064-41b9-a563-a90cc1cfd8fb ==============================
[0m12:45:18.949309 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:45:18.949309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:45:19.026461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b40df01-2064-41b9-a563-a90cc1cfd8fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934CEC0B10>]}
[0m12:45:19.048653 [debug] [MainThread]: Command `dbt clean` succeeded at 12:45:19.048653 after 0.14 seconds
[0m12:45:19.048653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934CAFA590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293461CE390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002934C915D10>]}
[0m12:45:19.048653 [debug] [MainThread]: Flushing usage events
[0m12:45:24.846342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1827F3D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C18270190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C18273A90>]}


============================== 12:45:24.846342 | ded48f5c-a3c9-48f7-ad84-e4f9ac5feca7 ==============================
[0m12:45:24.846342 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:45:24.846342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:45:24.921335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ded48f5c-a3c9-48f7-ad84-e4f9ac5feca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C18361E90>]}
[0m12:45:24.923351 [debug] [MainThread]: Set downloads directory='C:\Users\AKSHAY~1.FUN\AppData\Local\Temp\dbt-downloads-cwlv_xrg'
[0m12:45:24.924336 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:45:25.177501 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:45:25.177501 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:45:25.433110 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:45:25.433110 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:45:26.138846 [info ] [MainThread]: Installed from version 1.1.1
[0m12:45:26.138846 [info ] [MainThread]: Up to date!
[0m12:45:26.138846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ded48f5c-a3c9-48f7-ad84-e4f9ac5feca7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C182D8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C18375E90>]}
[0m12:45:26.138846 [debug] [MainThread]: Command `dbt deps` succeeded at 12:45:26.138846 after 1.34 seconds
[0m12:45:26.138846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C182CD8D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1827CC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C1180C550>]}
[0m12:45:26.138846 [debug] [MainThread]: Flushing usage events
[0m12:45:34.795503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD0A7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD0FFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD0BCE90>]}


============================== 12:45:34.795503 | a18b2d95-3fbb-4322-80a1-f6276291f98a ==============================
[0m12:45:34.795503 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:45:34.795503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:45:34.926042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD29F7D0>]}
[0m12:45:34.972915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD1F5D10>]}
[0m12:45:34.972915 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:45:34.988508 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:45:34.988508 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:45:34.988508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD3442D0>]}
[0m12:45:35.930760 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:45:35.930760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD282C50>]}
[0m12:45:35.952353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD903D90>]}
[0m12:45:35.952353 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:45:35.952353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD7159D0>]}
[0m12:45:35.952353 [info ] [MainThread]: 
[0m12:45:35.952353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:35.962271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:45:35.963777 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:45:35.963777 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:45:35.963777 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:45:35.963777 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:45:35.963777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:35.963777 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:45:35.963777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:35.996424 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:45:35.998391 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:45:35.999899 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:45:35.999899 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:45:36.012012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:45:36.013553 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:45:36.013553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:45:36.013553 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:45:36.013553 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:45:36.013553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:36.013553 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:45:36.013553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:36.029688 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.029688 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.029688 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:45:36.029688 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:45:36.029688 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:45:36.029688 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:45:36.048348 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:45:36.049347 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:45:36.050365 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:45:36.051344 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:45:36.052343 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:45:36.052343 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:45:36.059362 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:36.060361 [debug] [MainThread]: On master: BEGIN
[0m12:45:36.060361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:36.078377 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.078377 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:36.078377 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:36.078377 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:45:36.078377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD7D8D10>]}
[0m12:45:36.078377 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:36.078377 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:36.078377 [debug] [MainThread]: On master: BEGIN
[0m12:45:36.094678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.095071 [debug] [MainThread]: On master: COMMIT
[0m12:45:36.095355 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:36.095355 [debug] [MainThread]: On master: COMMIT
[0m12:45:36.095355 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.095355 [debug] [MainThread]: On master: Close
[0m12:45:36.095355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:36.095355 [info ] [MainThread]: 
[0m12:45:36.095355 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:45:36.095355 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:45:36.095355 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m12:45:36.095355 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:45:36.095355 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m12:45:36.095355 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:45:36.095355 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:45:36.113794 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:45:36.114276 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:45:36.114276 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:45:36.114276 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:45:36.095355 => 12:45:36.114276
[0m12:45:36.114276 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:45:36.114276 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:45:36.114276 => 12:45:36.114276
[0m12:45:36.149510 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m12:45:36.149510 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:45:36.152589 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:45:36.152589 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:45:36.152589 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:45:36.152589 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m12:45:36.160972 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m12:45:36.160972 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:36.162009 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:45:36.180549 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.180549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.180549 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:45:36.180549 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:45:36.180549 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m12:45:36.180549 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m12:45:36.202678 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:45:36.208351 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:45:36.208696 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m12:45:36.210680 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.214579 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:45:36.215563 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m12:45:36.217561 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.227864 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:45:36.231259 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:45:36.231259 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:45:36.252685 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.252685 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m12:45:36.252685 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:45:36.252685 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m12:45:36.278720 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.278720 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:45:36.152589 => 12:45:36.278720
[0m12:45:36.278720 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m12:45:36.278720 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD901E10>]}
[0m12:45:36.278720 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.18s]
[0m12:45:36.294397 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:45:36.294397 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m12:45:36.294397 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m12:45:36.294397 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m12:45:36.294397 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m12:45:36.294397 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m12:45:36.294397 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m12:45:36.294397 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m12:45:36.294397 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m12:45:36.294397 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m12:45:36.294397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m12:45:36.294397 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m12:45:36.294397 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:45:36.294397 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:45:36.294397 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:45:36.310084 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:45:36.310657 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 12:45:36.294397 => 12:45:36.310657
[0m12:45:36.311766 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 12:45:36.294397 => 12:45:36.310657
[0m12:45:36.312410 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m12:45:36.313472 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:45:36.294397 => 12:45:36.312410
[0m12:45:36.313472 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m12:45:36.314962 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m12:45:36.314962 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m12:45:36.314962 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m12:45:36.327746 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m12:45:36.328804 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:45:36.328804 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:45:36.330773 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:45:36.330773 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:45:36.330773 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:45:36.330773 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m12:45:36.330773 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m12:45:36.330773 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m12:45:36.330773 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m12:45:36.330773 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:45:36.330773 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:45:36.330773 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:36.330773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.348167 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:45:36.349167 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m12:45:36.351167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.353411 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:45:36.353411 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:45:36.353411 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:45:36.365492 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.365492 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.365492 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.365492 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:45:36.365492 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:45:36.365492 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:45:36.365492 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m12:45:36.365492 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m12:45:36.365492 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m12:45:36.419669 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.422935 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m12:45:36.424238 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:45:36.425306 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m12:45:36.427432 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:45:36.431744 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:45:36.432267 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:45:36.432797 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m12:45:36.437570 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:45:36.438109 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.438641 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m12:45:36.439729 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m12:45:36.441412 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:45:36.114276 => 12:45:36.441412
[0m12:45:36.441928 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.445616 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:45:36.446709 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m12:45:36.452076 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:45:36.452596 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.453138 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m12:45:36.454741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD901690>]}
[0m12:45:36.455276 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m12:45:36.460124 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:45:36.462808 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.461738 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.36s]
[0m12:45:36.463883 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m12:45:36.468169 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:45:36.468702 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.469242 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:45:36.470287 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:45:36.471362 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.473478 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:45:36.474544 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:45:36.477832 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:45:36.478880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.479456 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:45:36.481049 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:45:36.480513 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m12:45:36.482767 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:45:36.483313 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:45:36.483313 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:45:36.484369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:45:36.484369 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:45:36.485422 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:45:36.485958 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:45:36.488545 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:45:36.488545 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.488545 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.491541 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m12:45:36.492539 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.492539 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:45:36.485958 => 12:45:36.492539
[0m12:45:36.494660 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m12:45:36.494660 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:45:36.494660 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m12:45:36.494660 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:45:36.494660 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:45:36.494660 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m12:45:36.494660 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:45:36.494660 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:45:36.494660 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m12:45:36.494660 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m12:45:36.494660 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:45:36.494660 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m12:45:36.494660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:36.511962 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.511962 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 12:45:36.314571 => 12:45:36.511962
[0m12:45:36.511962 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.511962 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.511962 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m12:45:36.511962 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 12:45:36.314962 => 12:45:36.511962
[0m12:45:36.511962 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:45:36.314962 => 12:45:36.511962
[0m12:45:36.511962 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD94FA10>]}
[0m12:45:36.511962 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m12:45:36.511962 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m12:45:36.511962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD920C50>]}
[0m12:45:36.511962 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.22s]
[0m12:45:36.511962 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD831550>]}
[0m12:45:36.511962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.528535 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m12:45:36.527692 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.22s]
[0m12:45:36.528535 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:45:36.528535 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.22s]
[0m12:45:36.528535 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:45:36.528535 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m12:45:36.528535 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m12:45:36.528535 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m12:45:36.528535 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m12:45:36.528535 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:45:36.528535 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:45:36.528535 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m12:45:36.528535 [info ] [Thread-4 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m12:45:36.528535 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:45:36.528535 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m12:45:36.528535 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_allowed_amount)
[0m12:45:36.545548 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:45:36.545548 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:45:36.545548 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m12:45:36.553069 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:45:36.553069 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:45:36.553069 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:45:36.528535 => 12:45:36.553069
[0m12:45:36.553069 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:45:36.562357 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:45:36.562357 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m12:45:36.562357 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:45:36.562357 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:45:36.562357 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m12:45:36.562357 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:45:36.553069 => 12:45:36.562357
[0m12:45:36.562357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.562357 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:45:36.562357 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:45:36.562357 => 12:45:36.562357
[0m12:45:36.577755 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:45:36.578820 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:45:36.578820 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m12:45:36.578820 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:45:36.578820 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m12:45:36.578820 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m12:45:36.578820 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:45:36.594421 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m12:45:36.595579 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:45:36.603407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.604699 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m12:45:36.605810 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:45:36.608065 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:45:36.609156 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:45:36.609699 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m12:45:36.610239 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:45:36.611637 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:36.612970 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:45:36.614608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.614608 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m12:45:36.614608 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:45:36.614608 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m12:45:36.629044 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.629044 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.629044 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:45:36.629044 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:45:36.494660 => 12:45:36.629044
[0m12:45:36.629044 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.629044 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:45:36.629044 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m12:45:36.629044 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:45:36.629044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD9EF290>]}
[0m12:45:36.629044 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
)
 
SELECT *
FROM source_data
  );
  
[0m12:45:36.629044 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.629044 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.15s]
[0m12:45:36.645005 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:45:36.645005 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:45:36.645005 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m12:45:36.645005 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:45:36.645005 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:36.653015 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:45:36.645005 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m12:45:36.653015 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:36.653015 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m12:45:36.653015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m12:45:36.653015 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:45:36.653015 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:45:36.653015 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m12:45:36.653015 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.665007 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:45:36.673004 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:45:36.674211 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.675280 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m12:45:36.677618 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:45:36.679633 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:45:36.653015 => 12:45:36.678622
[0m12:45:36.680618 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m12:45:36.680618 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:45:36.689661 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:45:36.689661 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.689661 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.689661 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:45:36.689661 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:45:36.689661 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:45:36.694480 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:45:36.695481 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:45:36.696480 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m12:45:36.696480 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:45:36.696480 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:45:36.697478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:36.713593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.713593 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:45:36.713593 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m12:45:36.741588 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.742590 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.744893 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m12:45:36.747928 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m12:45:36.748915 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m12:45:36.748915 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:45:36.749910 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:45:36.752910 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:45:36.752910 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m12:45:36.753892 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m12:45:36.753892 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m12:45:36.756923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.759893 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:45:36.759893 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m12:45:36.777591 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.777591 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:45:36.578820 => 12:45:36.777591
[0m12:45:36.777591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.777591 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.777591 [debug] [Thread-4 (]: On model.postgres_dev.total_allowed_amount: Close
[0m12:45:36.777591 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:45:36.777591 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:45:36.578820 => 12:45:36.777591
[0m12:45:36.777591 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD9EA490>]}
[0m12:45:36.793210 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:45:36.793210 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m12:45:36.794577 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:45:36.794577 [info ] [Thread-4 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.25s]
[0m12:45:36.794577 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5ADA0C0D0>]}
[0m12:45:36.794577 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:45:36.794577 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.25s]
[0m12:45:36.794577 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:45:36.832441 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.832441 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m12:45:36.832441 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:45:36.832441 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:45:36.844413 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:45:36.845466 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m12:45:36.846449 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m12:45:36.847552 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.853065 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:45:36.853065 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m12:45:36.853065 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:36.853065 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:45:36.853065 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.853065 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:45:36.853065 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:45:36.681619 => 12:45:36.853065
[0m12:45:36.853065 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:45:36.860999 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m12:45:36.862007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AD8F4CD0>]}
[0m12:45:36.863003 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.21s]
[0m12:45:36.864057 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:45:36.864057 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:36.931341 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m12:45:36.932400 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:45:36.933406 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m12:45:36.938403 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:36.939397 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:45:36.562357 => 12:45:36.939397
[0m12:45:36.940401 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m12:45:36.940401 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AEE52C90>]}
[0m12:45:36.941300 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.41s]
[0m12:45:36.942350 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:45:36.943393 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_frequency
[0m12:45:36.944299 [info ] [Thread-4 (]: 11 of 11 START sql table model public_gold.diagnosis_frequency ................. [RUN]
[0m12:45:36.944869 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_frequency)
[0m12:45:36.944869 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.diagnosis_frequency
[0m12:45:36.947892 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_frequency"
[0m12:45:36.947892 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_frequency (compile): 12:45:36.944869 => 12:45:36.947892
[0m12:45:36.948869 [debug] [Thread-4 (]: Began executing node model.postgres_dev.diagnosis_frequency
[0m12:45:36.951887 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_frequency"
[0m12:45:36.951887 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:45:36.952869 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_frequency: BEGIN
[0m12:45:36.952869 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:45:36.963848 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:36.963848 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:45:36.963848 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

select 
    diagnosis_key,
    category_title,
    count(*) as diagnosis_frequency
from 
    analysis
where
    category_title is NOT NULL
group by
    diagnosis_key,
    category_title
order by
    diagnosis_frequency desc
  );
  
[0m12:45:37.014172 [debug] [Thread-4 (]: SQL status: SELECT 2060 in 0.0 seconds
[0m12:45:37.024240 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:45:37.024240 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
alter table "bootcamp_project"."public_gold"."diagnosis_frequency" rename to "diagnosis_frequency__dbt_backup"
[0m12:45:37.027728 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:37.030314 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:45:37.030314 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
alter table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp" rename to "diagnosis_frequency"
[0m12:45:37.030314 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:45:37.030314 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m12:45:37.030314 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:45:37.030314 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m12:45:37.030314 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:45:37.046337 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup"
[0m12:45:37.047355 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:45:37.047355 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup" cascade
[0m12:45:37.051312 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:45:37.053312 [debug] [Thread-4 (]: Timing info for model.postgres_dev.diagnosis_frequency (execute): 12:45:36.948869 => 12:45:37.053312
[0m12:45:37.053312 [debug] [Thread-4 (]: On model.postgres_dev.diagnosis_frequency: Close
[0m12:45:37.055312 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a18b2d95-3fbb-4322-80a1-f6276291f98a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5AEE4BD90>]}
[0m12:45:37.056309 [info ] [Thread-4 (]: 11 of 11 OK created sql table model public_gold.diagnosis_frequency ............ [[32mSELECT 2060[0m in 0.11s]
[0m12:45:37.063398 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_frequency
[0m12:45:37.066307 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:37.067309 [debug] [MainThread]: On master: BEGIN
[0m12:45:37.068307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:37.094981 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:37.096139 [debug] [MainThread]: On master: COMMIT
[0m12:45:37.097125 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:37.097125 [debug] [MainThread]: On master: COMMIT
[0m12:45:37.099125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:45:37.099125 [debug] [MainThread]: On master: Close
[0m12:45:37.100125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:37.101125 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:45:37.101125 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:45:37.101125 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:45:37.102430 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:45:37.102430 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m12:45:37.102430 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m12:45:37.103435 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_frequency' was properly closed.
[0m12:45:37.103435 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m12:45:37.104438 [info ] [MainThread]: 
[0m12:45:37.105432 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m12:45:37.109109 [debug] [MainThread]: Command end result
[0m12:45:37.137430 [info ] [MainThread]: 
[0m12:45:37.137430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:45:37.137430 [info ] [MainThread]: 
[0m12:45:37.137430 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m12:45:37.137430 [debug] [MainThread]: Command `dbt run` succeeded at 12:45:37.137430 after 2.39 seconds
[0m12:45:37.137430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A665C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A665C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B5A665C610>]}
[0m12:45:37.137430 [debug] [MainThread]: Flushing usage events
[0m12:45:44.110952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CB6332D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CB5B6D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CB4D5990>]}


============================== 12:45:44.126591 | 2561f3aa-0552-4194-bbaf-e7b238d126ee ==============================
[0m12:45:44.126591 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:45:44.126591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:45:44.255019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2561f3aa-0552-4194-bbaf-e7b238d126ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CBA1EF10>]}
[0m12:45:44.301906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2561f3aa-0552-4194-bbaf-e7b238d126ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CBB16050>]}
[0m12:45:44.301906 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:45:44.317626 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:45:44.363860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:45:44.363860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:45:44.363860 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:45:44.382354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2561f3aa-0552-4194-bbaf-e7b238d126ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CBDE20D0>]}
[0m12:45:44.392261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2561f3aa-0552-4194-bbaf-e7b238d126ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CBD0B8D0>]}
[0m12:45:44.393241 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:45:44.394242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2561f3aa-0552-4194-bbaf-e7b238d126ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CBC1DED0>]}
[0m12:45:44.396374 [info ] [MainThread]: 
[0m12:45:44.397374 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:45:44.399374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:45:44.400374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:45:44.407372 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:45:44.409484 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:45:44.409720 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:45:44.409720 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:45:44.410718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:44.410973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:45:44.430119 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.430119 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.430119 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:45:44.430119 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:45:44.430119 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:45:44.430119 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:45:44.430119 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:45:44.438625 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:45:44.438625 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:45:44.438625 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:45:44.438625 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:45:44.438625 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:45:44.449119 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:44.449119 [debug] [MainThread]: On master: BEGIN
[0m12:45:44.449119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:45:44.462918 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.462918 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:44.462918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:45:44.479709 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:45:44.479709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2561f3aa-0552-4194-bbaf-e7b238d126ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CBCC9C50>]}
[0m12:45:44.479709 [debug] [MainThread]: On master: ROLLBACK
[0m12:45:44.479709 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:44.479709 [debug] [MainThread]: On master: BEGIN
[0m12:45:44.479709 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.486443 [debug] [MainThread]: On master: COMMIT
[0m12:45:44.486443 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:44.486950 [debug] [MainThread]: On master: COMMIT
[0m12:45:44.486950 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:45:44.486950 [debug] [MainThread]: On master: Close
[0m12:45:44.486950 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:45:44.486950 [info ] [MainThread]: 
[0m12:45:44.495120 [debug] [Thread-1 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:45:44.495120 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:45:44.496116 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:45:44.496116 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:45:44.497117 [info ] [Thread-1 (]: 1 of 31 START test accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [RUN]
[0m12:45:44.497117 [info ] [Thread-2 (]: 2 of 31 START test not_null_dim_member_member_key .............................. [RUN]
[0m12:45:44.498115 [info ] [Thread-3 (]: 3 of 31 START test not_null_fact_claims_claimed_date_key ....................... [RUN]
[0m12:45:44.499117 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489'
[0m12:45:44.498115 [info ] [Thread-4 (]: 4 of 31 START test not_null_fact_claims_enrolled_date_key ...................... [RUN]
[0m12:45:44.500121 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_dim_member_member_key.ff327b2471'
[0m12:45:44.501116 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead'
[0m12:45:44.502116 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:45:44.503040 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb'
[0m12:45:44.503040 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:45:44.503040 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:45:44.515783 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:45:44.515783 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:45:44.528565 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:45:44.530029 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:45:44.530029 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:45:44.530029 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:45:44.503040 => 12:45:44.530029
[0m12:45:44.530029 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:45:44.515783 => 12:45:44.530029
[0m12:45:44.530029 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:45:44.529559 => 12:45:44.530029
[0m12:45:44.530029 [debug] [Thread-1 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:45:44.530029 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:45:44.530029 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:45:44.546388 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:45:44.546388 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:45:44.530029 => 12:45:44.546388
[0m12:45:44.555422 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:45:44.555422 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:45:44.555422 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:45:44.555422 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:45:44.555422 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:45:44.561863 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:45:44.561863 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:45:44.561863 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: BEGIN
[0m12:45:44.562863 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: BEGIN
[0m12:45:44.562863 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: BEGIN
[0m12:45:44.563863 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:45:44.563863 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:45:44.564863 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:45:44.564863 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:45:44.564863 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: BEGIN
[0m12:45:44.565863 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:45:44.591006 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.591006 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.592004 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:45:44.593005 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:45:44.593005 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_key
from "bootcamp_project"."public_silver"."dim_member"
where member_key is null



      
    ) dbt_internal_test
[0m12:45:44.594006 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.594006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.595026 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select enrolled_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where enrolled_date_key is null



      
    ) dbt_internal_test
[0m12:45:44.595026 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:45:44.595026 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:45:44.595026 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claimed_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where claimed_date_key is null



      
    ) dbt_internal_test
[0m12:45:44.595026 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.595026 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Others'
)



      
    ) dbt_internal_test
[0m12:45:44.595026 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.595026 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:45:44.546388 => 12:45:44.595026
[0m12:45:44.595026 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.595026 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:45:44.555422 => 12:45:44.595026
[0m12:45:44.595026 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: ROLLBACK
[0m12:45:44.595026 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.595026 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:45:44.555422 => 12:45:44.595026
[0m12:45:44.595026 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: ROLLBACK
[0m12:45:44.595026 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:45:44.530029 => 12:45:44.595026
[0m12:45:44.595026 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: Close
[0m12:45:44.595026 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: ROLLBACK
[0m12:45:44.595026 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: ROLLBACK
[0m12:45:44.595026 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: Close
[0m12:45:44.595026 [info ] [Thread-2 (]: 2 of 31 PASS not_null_dim_member_member_key .................................... [[32mPASS[0m in 0.09s]
[0m12:45:44.610717 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: Close
[0m12:45:44.611225 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: Close
[0m12:45:44.610717 [info ] [Thread-4 (]: 4 of 31 PASS not_null_fact_claims_enrolled_date_key ............................ [[32mPASS[0m in 0.09s]
[0m12:45:44.611225 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:45:44.611225 [info ] [Thread-3 (]: 3 of 31 PASS not_null_fact_claims_claimed_date_key ............................. [[32mPASS[0m in 0.11s]
[0m12:45:44.615879 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:45:44.611225 [info ] [Thread-1 (]: 1 of 31 PASS accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [[32mPASS[0m in 0.11s]
[0m12:45:44.616884 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:45:44.617881 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:45:44.618726 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:45:44.618775 [debug] [Thread-1 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:45:44.618775 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:45:44.618775 [info ] [Thread-2 (]: 5 of 31 START test not_null_us_healthcare_claims_data_claim_id ................. [RUN]
[0m12:45:44.618775 [info ] [Thread-4 (]: 6 of 31 START test not_null_us_healthcare_claims_data_member_id ................ [RUN]
[0m12:45:44.618775 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:45:44.618775 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:45:44.618775 [info ] [Thread-3 (]: 7 of 31 START test relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [RUN]
[0m12:45:44.618775 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:45:44.618775 [info ] [Thread-1 (]: 8 of 31 START test relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [RUN]
[0m12:45:44.627437 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:45:44.628455 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:45:44.629439 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:45:44.630438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:45:44.632341 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:45:44.632341 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:45:44.632341 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:45:44.632341 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:45:44.647095 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:45:44.647095 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:45:44.630438 => 12:45:44.647095
[0m12:45:44.647095 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:45:44.647095 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:45:44.632341 => 12:45:44.647095
[0m12:45:44.655603 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:45:44.632341 => 12:45:44.655603
[0m12:45:44.655603 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:45:44.655603 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:45:44.647095 => 12:45:44.655603
[0m12:45:44.655603 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:45:44.655603 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:45:44.655603 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:45:44.655603 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:45:44.661773 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:45:44.664766 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:45:44.665455 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:45:44.665455 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:45:44.665455 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:45:44.665455 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:45:44.665455 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: BEGIN
[0m12:45:44.665455 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:45:44.665455 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: BEGIN
[0m12:45:44.665455 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: BEGIN
[0m12:45:44.665455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:44.665455 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: BEGIN
[0m12:45:44.665455 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:45:44.665455 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:45:44.665455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:44.683435 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.683435 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:45:44.694130 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is null



      
    ) dbt_internal_test
[0m12:45:44.696752 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.696752 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:45:44.655603 => 12:45:44.696752
[0m12:45:44.696752 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: ROLLBACK
[0m12:45:44.696752 [debug] [Thread-2 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: Close
[0m12:45:44.696752 [info ] [Thread-2 (]: 5 of 31 PASS not_null_us_healthcare_claims_data_claim_id ....................... [[32mPASS[0m in 0.08s]
[0m12:45:44.696752 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:45:44.696752 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:45:44.696752 [info ] [Thread-2 (]: 9 of 31 START test relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [RUN]
[0m12:45:44.696752 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:45:44.696752 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:45:44.712701 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.712701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.712701 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.712701 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:45:44.712701 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:45:44.712701 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:45:44.712701 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:45:44.712701 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is null



      
    ) dbt_internal_test
[0m12:45:44.712701 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:45:44.696752 => 12:45:44.712701
[0m12:45:44.712701 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_title as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_title is not null
),

parent as (
    select category_title as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:44.712701 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_code is not null
),

parent as (
    select category_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:44.712701 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:45:44.712701 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:45:44.712701 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.729923 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:45:44.655603 => 12:45:44.728922
[0m12:45:44.730930 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:45:44.730930 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: ROLLBACK
[0m12:45:44.731923 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: BEGIN
[0m12:45:44.732921 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:44.734996 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: Close
[0m12:45:44.734996 [info ] [Thread-4 (]: 6 of 31 PASS not_null_us_healthcare_claims_data_member_id ...................... [[32mPASS[0m in 0.12s]
[0m12:45:44.742111 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:45:44.744251 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:45:44.745255 [info ] [Thread-4 (]: 10 of 31 START test relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [RUN]
[0m12:45:44.748253 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:45:44.749251 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:45:44.757778 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:45:44.760959 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.763960 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:45:44.661773 => 12:45:44.762961
[0m12:45:44.764958 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:45:44.749251 => 12:45:44.763960
[0m12:45:44.764958 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.765958 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: ROLLBACK
[0m12:45:44.766964 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:45:44.767847 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:45:44.767847 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.767847 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:45:44.767847 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: Close
[0m12:45:44.767847 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_code is not null
),

parent as (
    select diagnosis_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:44.767847 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:45:44.665455 => 12:45:44.767847
[0m12:45:44.767847 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:45:44.767847 [info ] [Thread-3 (]: 7 of 31 PASS relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [[32mPASS[0m in 0.14s]
[0m12:45:44.779510 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: ROLLBACK
[0m12:45:44.780517 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: BEGIN
[0m12:45:44.781507 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:45:44.782508 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:45:44.783512 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:45:44.784510 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: Close
[0m12:45:44.785506 [info ] [Thread-3 (]: 11 of 31 START test relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [RUN]
[0m12:45:44.787510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:45:44.786507 [info ] [Thread-1 (]: 8 of 31 PASS relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [[32mPASS[0m in 0.16s]
[0m12:45:44.788646 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:45:44.788646 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:45:44.801590 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:45:44.801590 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:45:44.801590 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:45:44.788646 => 12:45:44.801590
[0m12:45:44.801590 [info ] [Thread-1 (]: 12 of 31 START test relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [RUN]
[0m12:45:44.801590 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.801590 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.801590 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:45:44.810798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:45:44.811811 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:45:44.712701 => 12:45:44.811811
[0m12:45:44.812804 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:45:44.814802 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:45:44.816004 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:45:44.816004 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: ROLLBACK
[0m12:45:44.817548 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_key as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_key is not null
),

parent as (
    select full_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:44.817548 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:45:44.817548 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:45:44.817548 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: BEGIN
[0m12:45:44.817548 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: Close
[0m12:45:44.817548 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:45:44.817548 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:45:44.817548 => 12:45:44.817548
[0m12:45:44.828491 [info ] [Thread-2 (]: 9 of 31 PASS relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [[32mPASS[0m in 0.13s]
[0m12:45:44.829490 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:45:44.831486 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:45:44.835150 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:45:44.835150 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:45:44.842192 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:45:44.842192 [info ] [Thread-2 (]: 13 of 31 START test relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [RUN]
[0m12:45:44.842192 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: BEGIN
[0m12:45:44.844264 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:45:44.845289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:44.846261 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:45:44.855887 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:45:44.855887 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:45:44.847263 => 12:45:44.855887
[0m12:45:44.859418 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:45:44.859418 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.859418 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.863659 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:45:44.868173 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:45:44.767847 => 12:45:44.863659
[0m12:45:44.868173 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:45:44.868173 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: ROLLBACK
[0m12:45:44.868173 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select full_description as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where full_description is not null
),

parent as (
    select full_description as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:44.868173 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:45:44.868173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.868173 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: BEGIN
[0m12:45:44.868173 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: Close
[0m12:45:44.868173 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:45:44.868173 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:44.868173 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select address as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where address is not null
),

parent as (
    select address as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:44.868173 [info ] [Thread-4 (]: 10 of 31 PASS relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:45:44.868173 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:45:44.868173 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:45:44.868173 [info ] [Thread-4 (]: 14 of 31 START test relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [RUN]
[0m12:45:44.868173 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:45:44.868173 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.868173 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:45:44.884143 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:45:44.831486 => 12:45:44.883143
[0m12:45:44.885779 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:45:44.894738 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: ROLLBACK
[0m12:45:44.896758 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:45:44.884143 => 12:45:44.896758
[0m12:45:44.897756 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.897756 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: Close
[0m12:45:44.898752 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:45:44.899750 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:45:44.904849 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:45:44.901752 [info ] [Thread-1 (]: 12 of 31 PASS relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.10s]
[0m12:45:44.904849 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select email as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where email is not null
),

parent as (
    select email as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:44.910969 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:45:44.912970 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:45:44.912970 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.913973 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:45:44.914970 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.914970 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: BEGIN
[0m12:45:44.917126 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:45:44.812804 => 12:45:44.917126
[0m12:45:44.917126 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:45:44.859418 => 12:45:44.917126
[0m12:45:44.917126 [info ] [Thread-1 (]: 15 of 31 START test relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [RUN]
[0m12:45:44.917126 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:45:44.917126 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: ROLLBACK
[0m12:45:44.917126 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: ROLLBACK
[0m12:45:44.917126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:45:44.917126 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:45:44.931466 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:45:44.932468 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: Close
[0m12:45:44.932468 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: Close
[0m12:45:44.935466 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:45:44.917126 => 12:45:44.934468
[0m12:45:44.934468 [info ] [Thread-3 (]: 11 of 31 PASS relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [[32mPASS[0m in 0.15s]
[0m12:45:44.935970 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:45:44.935970 [info ] [Thread-2 (]: 13 of 31 PASS relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.09s]
[0m12:45:44.944598 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:45:44.945174 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.947173 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:45:44.948170 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:45:44.949172 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:45:44.949739 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:45:44.949739 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:45:44.952951 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:45:44.952951 [info ] [Thread-3 (]: 16 of 31 START test relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:45:44.952951 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select gender as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where gender is not null
),

parent as (
    select gender as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:44.955964 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: BEGIN
[0m12:45:44.955964 [info ] [Thread-2 (]: 17 of 31 START test relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [RUN]
[0m12:45:44.955964 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:45:44.955964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:44.955964 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:45:44.955964 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:45:44.955964 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:45:44.955964 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.964770 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:45:44.967126 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:45:44.967126 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:45:44.901752 => 12:45:44.967126
[0m12:45:44.967126 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:45:44.955964 => 12:45:44.967126
[0m12:45:44.967126 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: ROLLBACK
[0m12:45:44.977549 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:45:44.965766 => 12:45:44.977549
[0m12:45:44.978582 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:45:44.979551 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:45:44.980548 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: Close
[0m12:45:44.982550 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:45:44.983483 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:44.983483 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:45:44.983483 [info ] [Thread-4 (]: 14 of 31 PASS relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.12s]
[0m12:45:44.983483 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:45:44.983483 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:45:44.983483 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:45:44.983483 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select name as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where name is not null
),

parent as (
    select name as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:44.983483 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:45:44.983483 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: BEGIN
[0m12:45:44.983483 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:45:44.994085 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: BEGIN
[0m12:45:44.995101 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:45:44.996099 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:44.996099 [info ] [Thread-4 (]: 18 of 31 START test relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [RUN]
[0m12:45:44.997089 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:44.999087 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:45:45.001108 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:45:44.945174 => 12:45:45.000089
[0m12:45:45.001108 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:45:45.001108 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: ROLLBACK
[0m12:45:45.010844 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:45:45.012850 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:45:45.001108 => 12:45:45.011845
[0m12:45:45.012850 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: Close
[0m12:45:45.013850 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:45:45.017341 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:45:45.014848 [info ] [Thread-1 (]: 15 of 31 PASS relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.10s]
[0m12:45:45.017341 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.017341 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:45:45.017341 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:45:45.017341 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:45:45.017341 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:45:45.027416 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_1_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_1_key is not null
),

parent as (
    select diagnosis_1 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:45.028432 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: BEGIN
[0m12:45:45.029419 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:45:45.028432 [info ] [Thread-1 (]: 19 of 31 START test relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [RUN]
[0m12:45:45.031156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:45:45.031156 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.031156 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.031156 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:45:45.031156 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:45:45.031156 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:45:44.983483 => 12:45:45.031156
[0m12:45:45.096975 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:45:45.096975 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.096975 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select claim_id as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where claim_id is not null
),

parent as (
    select claim_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:45.096975 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: ROLLBACK
[0m12:45:45.096975 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:45:45.096975 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:45:45.031156 => 12:45:45.096975
[0m12:45:45.096975 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_2_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_2_key is not null
),

parent as (
    select diagnosis_2 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:45.096975 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:45:45.096975 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:45:45.096975 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: Close
[0m12:45:45.096975 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.096975 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.096975 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:45:45.096975 [info ] [Thread-2 (]: 17 of 31 PASS relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.14s]
[0m12:45:45.110864 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:45:44.980548 => 12:45:45.096975
[0m12:45:45.113862 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:45:45.015844 => 12:45:45.112876
[0m12:45:45.114860 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: BEGIN
[0m12:45:45.115864 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:45:45.116860 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: ROLLBACK
[0m12:45:45.117858 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: ROLLBACK
[0m12:45:45.118857 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:45.119855 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:45:45.120893 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: Close
[0m12:45:45.120893 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: Close
[0m12:45:45.120893 [info ] [Thread-2 (]: 20 of 31 START test relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:45:45.120893 [info ] [Thread-3 (]: 16 of 31 PASS relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.16s]
[0m12:45:45.131568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:45:45.129587 [info ] [Thread-4 (]: 18 of 31 PASS relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.13s]
[0m12:45:45.133420 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:45:45.133420 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:45:45.133420 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:45:45.133420 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:45:45.144201 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:45:45.145205 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:45:45.146200 [info ] [Thread-3 (]: 21 of 31 START test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [RUN]
[0m12:45:45.148199 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:45:45.133420 => 12:45:45.148199
[0m12:45:45.147198 [info ] [Thread-4 (]: 22 of 31 START test source_not_null_bootcamp_project_icd_codes_Full_Code ....... [RUN]
[0m12:45:45.149199 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7)
[0m12:45:45.150201 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:45:45.151195 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718, now test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0)
[0m12:45:45.151195 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:45:45.156213 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:45:45.156213 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:45:45.165241 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:45:45.165241 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.165241 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:45:45.165241 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:45:45.165241 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:45:45.165241 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (compile): 12:45:45.156213 => 12:45:45.165241
[0m12:45:45.165241 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: BEGIN
[0m12:45:45.165241 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_3_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_3_key is not null
),

parent as (
    select diagnosis_3 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:45.178500 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:45:45.165241 => 12:45:45.177481
[0m12:45:45.178500 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:45:45.179486 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:45.180488 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:45:45.183131 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:45:45.183131 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.183131 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:45:45.183131 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:45:45.096975 => 12:45:45.183131
[0m12:45:45.183131 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:45:45.194127 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: ROLLBACK
[0m12:45:45.195131 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: BEGIN
[0m12:45:45.196129 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:45:45.197126 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:45:45.198132 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: Close
[0m12:45:45.199129 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: BEGIN
[0m12:45:45.201535 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:45:45.201535 [info ] [Thread-1 (]: 19 of 31 PASS relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.17s]
[0m12:45:45.201535 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:45:45.201535 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:45:45.201535 [info ] [Thread-1 (]: 23 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_claim  [RUN]
[0m12:45:45.211936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715)
[0m12:45:45.211936 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.212934 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:45:45.213932 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:45:45.214351 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:45:45.214351 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select member_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where member_key is not null
),

parent as (
    select member_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:45.214351 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (compile): 12:45:45.214351 => 12:45:45.214351
[0m12:45:45.214351 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.214351 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:45:45.214351 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.214351 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"
[0m12:45:45.214351 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:45:45.214351 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.228517 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:45:45.151195 => 12:45:45.228517
[0m12:45:45.229564 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select total_paid_amount as from_field
    from "bootcamp_project"."public_gold"."total_paid_amount"
    where total_paid_amount is not null
),

parent as (
    select  as to_field
    from "bootcamp_project"."public_silver"."fact_claims"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:45:45.230076 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:45:45.231087 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:45:45.231087 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: ROLLBACK
[0m12:45:45.232084 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Full_Code
from "bootcamp_project"."public"."icd_codes"
where Full_Code is null



      
    ) dbt_internal_test
[0m12:45:45.233187 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: BEGIN
[0m12:45:45.233187 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 18:     select  as to_field
                     ^

[0m12:45:45.233187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:45.233187 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: ROLLBACK
[0m12:45:45.233187 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: Close
[0m12:45:45.233187 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7 (execute): 12:45:45.181482 => 12:45:45.233187
[0m12:45:45.233187 [info ] [Thread-2 (]: 20 of 31 PASS relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.10s]
[0m12:45:45.233187 [debug] [Thread-3 (]: On test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7: Close
[0m12:45:45.233187 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:45:45.244118 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:45:45.246120 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.247139 [info ] [Thread-2 (]: 24 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:45:45.250118 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:45:45.183131 => 12:45:45.249121
[0m12:45:45.251120 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60)
[0m12:45:45.251120 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: ROLLBACK
[0m12:45:45.252119 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:45:45.262898 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:45:45.262898 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: Close
[0m12:45:45.264897 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (compile): 12:45:45.253371 => 12:45:45.263898
[0m12:45:45.265899 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.265899 [info ] [Thread-4 (]: 22 of 31 PASS source_not_null_bootcamp_project_icd_codes_Full_Code ............. [[32mPASS[0m in 0.11s]
[0m12:45:45.266935 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:45:45.266935 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:45:45.266935 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:45:45.266935 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:45:45.266935 [debug] [Thread-3 (]: Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:45:45.266935 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim
from "bootcamp_project"."public"."us_healthcare_claims"
where claim is null



      
    ) dbt_internal_test
[0m12:45:45.266935 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:45:45.277564 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:45:45.277564 [error] [Thread-3 (]: 21 of 31 ERROR relationships_total_paid_amount_total_paid_amount__ref_fact_claims_  [[31mERROR[0m in 0.13s]
[0m12:45:45.279565 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: BEGIN
[0m12:45:45.279565 [info ] [Thread-4 (]: 25 of 31 START test source_unique_bootcamp_project_icd_codes_Full_Code ......... [RUN]
[0m12:45:45.280566 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7
[0m12:45:45.281561 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.281561 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:45.283170 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:45:45.283170 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:45:45.283170 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (execute): 12:45:45.214351 => 12:45:45.283170
[0m12:45:45.283170 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:45:45.283170 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: ROLLBACK
[0m12:45:45.283170 [info ] [Thread-3 (]: 26 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_claim .. [RUN]
[0m12:45:45.296137 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:45:45.297144 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_total_paid_amount_total_paid_amount__ref_fact_claims_.c10bd2b3b7, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca)
[0m12:45:45.298139 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: Close
[0m12:45:45.299138 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:45:45.300851 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:45:45.300851 [info ] [Thread-1 (]: 23 of 31 PASS source_not_null_bootcamp_project_us_healthcare_claims_claim ...... [[32mPASS[0m in 0.09s]
[0m12:45:45.300851 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.300851 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:45:45.283170 => 12:45:45.300851
[0m12:45:45.310824 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:45:45.310824 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:45:45.311838 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (compile): 12:45:45.300851 => 12:45:45.311838
[0m12:45:45.311838 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:45:45.312824 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:45:45.313825 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is null



      
    ) dbt_internal_test
[0m12:45:45.313825 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:45:45.316650 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:45:45.316650 [info ] [Thread-1 (]: 27 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:45:45.316650 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:45:45.316650 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.316650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915)
[0m12:45:45.316650 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:45:45.316650 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (execute): 12:45:45.266935 => 12:45:45.316650
[0m12:45:45.316650 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:45:45.316650 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:45:45.316650 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: BEGIN
[0m12:45:45.316650 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: ROLLBACK
[0m12:45:45.327490 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: BEGIN
[0m12:45:45.330413 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:45:45.330413 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:45:45.330413 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:45:45.330413 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (compile): 12:45:45.327490 => 12:45:45.330413
[0m12:45:45.330413 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: Close
[0m12:45:45.330413 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:45:45.344143 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:45:45.330413 [info ] [Thread-2 (]: 24 of 31 PASS source_not_null_bootcamp_project_us_healthcare_claims_member_id .. [[32mPASS[0m in 0.08s]
[0m12:45:45.345165 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:45:45.347145 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:45:45.347145 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:45:45.349154 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: BEGIN
[0m12:45:45.348144 [info ] [Thread-2 (]: 28 of 31 START test unique_dim_member_member_key ............................... [RUN]
[0m12:45:45.350576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:45.350576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:45:45.350576 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:45:45.361791 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:45:45.362791 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.362791 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:45:45.364377 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where claim is not null
group by claim
having count(*) > 1



      
    ) dbt_internal_test
[0m12:45:45.364377 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:45:45.356616 => 12:45:45.364377
[0m12:45:45.364377 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.364377 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:45:45.364377 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:45:45.364377 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:45:45.364377 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.364377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.364377 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Full_Code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."icd_codes"
where Full_Code is not null
group by Full_Code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:45:45.364377 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (execute): 12:45:45.316650 => 12:45:45.364377
[0m12:45:45.364377 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:45:45.364377 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:45:45.364377 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: ROLLBACK
[0m12:45:45.364377 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: BEGIN
[0m12:45:45.364377 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:45:45.377456 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:45.379466 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: Close
[0m12:45:45.381459 [info ] [Thread-3 (]: 26 of 31 PASS source_unique_bootcamp_project_us_healthcare_claims_claim ........ [[32mPASS[0m in 0.09s]
[0m12:45:45.383458 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:45:45.384453 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.384453 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:45:45.386730 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (execute): 12:45:45.330413 => 12:45:45.386730
[0m12:45:45.386730 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: ROLLBACK
[0m12:45:45.386730 [info ] [Thread-3 (]: 29 of 31 START test unique_icd_codes_data_full_code ............................ [RUN]
[0m12:45:45.386730 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:45:45.386730 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: Close
[0m12:45:45.394102 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:45:45.407099 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:45:45.396101 [info ] [Thread-1 (]: 27 of 31 PASS source_unique_bootcamp_project_us_healthcare_claims_member_id .... [[32mPASS[0m in 0.08s]
[0m12:45:45.407099 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:45:45.407099 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:45:45.411007 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:45:45.396101 => 12:45:45.411007
[0m12:45:45.412009 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.413005 [info ] [Thread-1 (]: 30 of 31 START test unique_us_healthcare_claims_data_claim_id .................. [RUN]
[0m12:45:45.414008 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:45:45.415012 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:45:45.416011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:45:45.418168 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:45:45.418168 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."dim_member"
where member_key is not null
group by member_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:45:45.418168 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:45:45.418168 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:45:45.430494 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:45:45.430494 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.431497 [debug] [Thread-3 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: BEGIN
[0m12:45:45.433414 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:45:45.364377 => 12:45:45.433414
[0m12:45:45.433930 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:45:45.418168 => 12:45:45.433930
[0m12:45:45.433930 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:45:45.435440 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: ROLLBACK
[0m12:45:45.435440 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:45:45.435440 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:45:45.435440 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: Close
[0m12:45:45.435440 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.446299 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:45:45.313825 => 12:45:45.445303
[0m12:45:45.435440 [info ] [Thread-2 (]: 28 of 31 PASS unique_dim_member_member_key ..................................... [[32mPASS[0m in 0.08s]
[0m12:45:45.446299 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:45:45.447607 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: ROLLBACK
[0m12:45:45.447607 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:45:45.447607 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: BEGIN
[0m12:45:45.447607 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:45:45.447607 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: Close
[0m12:45:45.447607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:45:45.447607 [info ] [Thread-2 (]: 31 of 31 START test unique_us_healthcare_claims_data_member_id ................. [RUN]
[0m12:45:45.447607 [info ] [Thread-4 (]: 25 of 31 PASS source_unique_bootcamp_project_icd_codes_Full_Code ............... [[32mPASS[0m in 0.17s]
[0m12:45:45.447607 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_dim_member_member_key.31a1be2e46, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:45:45.456615 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:45:45.456615 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:45:45.460830 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:45:45.461832 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:45:45.456615 => 12:45:45.461832
[0m12:45:45.462833 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:45:45.464832 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:45:45.465832 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.466829 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:45:45.467341 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:45:45.467341 [debug] [Thread-3 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    full_code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."icd_codes_data"
where full_code is not null
group by full_code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:45:45.467341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.467341 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: BEGIN
[0m12:45:45.467341 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:45:45.467341 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:45:45.467341 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is not null
group by claim_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:45:45.467341 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.467341 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:45:45.435440 => 12:45:45.467341
[0m12:45:45.467341 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: ROLLBACK
[0m12:45:45.467341 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: Close
[0m12:45:45.467341 [info ] [Thread-1 (]: 30 of 31 PASS unique_us_healthcare_claims_data_claim_id ........................ [[32mPASS[0m in 0.05s]
[0m12:45:45.484119 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:45:45.495123 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.496120 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:45:45.497129 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:45:45.499866 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.502480 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:45:45.462833 => 12:45:45.502480
[0m12:45:45.502480 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: ROLLBACK
[0m12:45:45.502480 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: Close
[0m12:45:45.502480 [info ] [Thread-2 (]: 31 of 31 PASS unique_us_healthcare_claims_data_member_id ....................... [[32mPASS[0m in 0.05s]
[0m12:45:45.502480 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:45:45.515910 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:45:45.515910 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:45:45.417009 => 12:45:45.515910
[0m12:45:45.515910 [debug] [Thread-3 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: ROLLBACK
[0m12:45:45.515910 [debug] [Thread-3 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: Close
[0m12:45:45.515910 [info ] [Thread-3 (]: 29 of 31 PASS unique_icd_codes_data_full_code .................................. [[32mPASS[0m in 0.13s]
[0m12:45:45.515910 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:45:45.527581 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:45.528583 [debug] [MainThread]: On master: BEGIN
[0m12:45:45.528583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:45:45.533246 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:45:45.533246 [debug] [MainThread]: On master: COMMIT
[0m12:45:45.533246 [debug] [MainThread]: Using postgres connection "master"
[0m12:45:45.533246 [debug] [MainThread]: On master: COMMIT
[0m12:45:45.544268 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:45:45.544268 [debug] [MainThread]: On master: Close
[0m12:45:45.545276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:45:45.545276 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:45:45.546267 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:45:45.546267 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7' was properly closed.
[0m12:45:45.546267 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea' was properly closed.
[0m12:45:45.546267 [debug] [MainThread]: Connection 'test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9' was properly closed.
[0m12:45:45.547267 [debug] [MainThread]: Connection 'test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280' was properly closed.
[0m12:45:45.547928 [info ] [MainThread]: 
[0m12:45:45.547928 [info ] [MainThread]: Finished running 31 tests in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m12:45:45.547928 [debug] [MainThread]: Command end result
[0m12:45:45.561906 [info ] [MainThread]: 
[0m12:45:45.562899 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:45:45.563897 [info ] [MainThread]: 
[0m12:45:45.563897 [error] [MainThread]:   Database Error in test relationships_total_paid_amount_total_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amoun_d44ef8aa8975192f839dc33a4383945c.sql
[0m12:45:45.564898 [info ] [MainThread]: 
[0m12:45:45.566373 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=1 SKIP=0 TOTAL=31
[0m12:45:45.566373 [debug] [MainThread]: Command `dbt test` failed at 12:45:45.566373 after 1.48 seconds
[0m12:45:45.566373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226CB633150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226C9376890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226C9374290>]}
[0m12:45:45.566373 [debug] [MainThread]: Flushing usage events
[0m12:49:06.643765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7910CE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB790F7D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB79102F10>]}


============================== 12:49:06.647619 | 553417b1-c2ab-4ac7-be5e-a586d7f620fd ==============================
[0m12:49:06.647619 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:49:06.648155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:49:06.756863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '553417b1-c2ab-4ac7-be5e-a586d7f620fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB78B69AD0>]}
[0m12:49:06.803868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '553417b1-c2ab-4ac7-be5e-a586d7f620fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB78B69AD0>]}
[0m12:49:06.803868 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:49:06.820107 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:49:06.874817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:49:06.875806 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\testing\test1.yml
[0m12:49:07.072571 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:49:07.072571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '553417b1-c2ab-4ac7-be5e-a586d7f620fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7933E350>]}
[0m12:49:07.094303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '553417b1-c2ab-4ac7-be5e-a586d7f620fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB79508310>]}
[0m12:49:07.094303 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:49:07.094303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553417b1-c2ab-4ac7-be5e-a586d7f620fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB79562910>]}
[0m12:49:07.094303 [info ] [MainThread]: 
[0m12:49:07.094303 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:49:07.094303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:49:07.105913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:49:07.108491 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:49:07.108491 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:49:07.108491 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:49:07.108491 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:49:07.108491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:07.108491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:49:07.125701 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.125701 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.125701 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:49:07.125701 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:49:07.125701 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:49:07.125701 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:49:07.125701 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:49:07.125701 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:49:07.140279 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:49:07.142275 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:49:07.144876 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:49:07.144876 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:49:07.155904 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:07.156905 [debug] [MainThread]: On master: BEGIN
[0m12:49:07.156905 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:49:07.174633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.174633 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:07.174633 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:49:07.174633 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:49:07.174633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '553417b1-c2ab-4ac7-be5e-a586d7f620fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7985D910>]}
[0m12:49:07.189385 [debug] [MainThread]: On master: ROLLBACK
[0m12:49:07.190433 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:07.190433 [debug] [MainThread]: On master: BEGIN
[0m12:49:07.192424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.192424 [debug] [MainThread]: On master: COMMIT
[0m12:49:07.193414 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:07.193414 [debug] [MainThread]: On master: COMMIT
[0m12:49:07.194416 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:49:07.194416 [debug] [MainThread]: On master: Close
[0m12:49:07.195382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:49:07.196384 [info ] [MainThread]: 
[0m12:49:07.199846 [debug] [Thread-1 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:49:07.200845 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:49:07.200845 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:49:07.200845 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:49:07.200845 [info ] [Thread-1 (]: 1 of 31 START test accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [RUN]
[0m12:49:07.201870 [info ] [Thread-2 (]: 2 of 31 START test not_null_dim_member_member_key .............................. [RUN]
[0m12:49:07.201870 [info ] [Thread-3 (]: 3 of 31 START test not_null_fact_claims_claimed_date_key ....................... [RUN]
[0m12:49:07.203848 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489'
[0m12:49:07.202847 [info ] [Thread-4 (]: 4 of 31 START test not_null_fact_claims_enrolled_date_key ...................... [RUN]
[0m12:49:07.205932 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_dim_member_member_key.ff327b2471'
[0m12:49:07.206968 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead'
[0m12:49:07.207933 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:49:07.208411 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb'
[0m12:49:07.208411 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:49:07.208411 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:49:07.223449 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:49:07.223449 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:49:07.223449 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:49:07.223449 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:49:07.239935 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:49:07.208411 => 12:49:07.239224
[0m12:49:07.239935 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:49:07.239935 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:49:07.223449 => 12:49:07.239935
[0m12:49:07.239935 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:49:07.223449 => 12:49:07.239935
[0m12:49:07.239935 [debug] [Thread-1 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:49:07.239935 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:49:07.239935 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:49:07.239935 => 12:49:07.239935
[0m12:49:07.239935 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:49:07.308420 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:49:07.312435 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:49:07.313434 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:49:07.317435 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:49:07.318419 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:49:07.318419 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:49:07.320434 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:49:07.321435 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: BEGIN
[0m12:49:07.321435 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:49:07.322574 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: BEGIN
[0m12:49:07.322833 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:49:07.322833 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:49:07.323835 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: BEGIN
[0m12:49:07.323835 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:49:07.324834 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: BEGIN
[0m12:49:07.324834 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:49:07.325832 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:49:07.341606 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.342142 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:49:07.342142 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select enrolled_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where enrolled_date_key is null



      
    ) dbt_internal_test
[0m12:49:07.344301 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.345897 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:49:07.319417 => 12:49:07.345365
[0m12:49:07.345951 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: ROLLBACK
[0m12:49:07.347020 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: Close
[0m12:49:07.347557 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.349698 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.349166 [info ] [Thread-4 (]: 4 of 31 PASS not_null_fact_claims_enrolled_date_key ............................ [[32mPASS[0m in 0.14s]
[0m12:49:07.350235 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:49:07.350235 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:49:07.350768 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.351296 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:49:07.351823 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claimed_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where claimed_date_key is null



      
    ) dbt_internal_test
[0m12:49:07.352397 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_key
from "bootcamp_project"."public_silver"."dim_member"
where member_key is null



      
    ) dbt_internal_test
[0m12:49:07.352397 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:49:07.352921 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:49:07.354046 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Others'
)



      
    ) dbt_internal_test
[0m12:49:07.355111 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.355639 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.354579 [info ] [Thread-4 (]: 5 of 31 START test not_null_us_healthcare_claims_data_claim_id ................. [RUN]
[0m12:49:07.357238 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:49:07.314436 => 12:49:07.356701
[0m12:49:07.359046 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:49:07.309435 => 12:49:07.358731
[0m12:49:07.359046 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.360107 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:49:07.360645 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: ROLLBACK
[0m12:49:07.361233 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: ROLLBACK
[0m12:49:07.362408 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:49:07.239935 => 12:49:07.362408
[0m12:49:07.362408 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:49:07.362408 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: ROLLBACK
[0m12:49:07.362408 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:49:07.362408 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: Close
[0m12:49:07.362408 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: Close
[0m12:49:07.362408 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:49:07.362408 => 12:49:07.362408
[0m12:49:07.362408 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: Close
[0m12:49:07.362408 [info ] [Thread-3 (]: 3 of 31 PASS not_null_fact_claims_claimed_date_key ............................. [[32mPASS[0m in 0.16s]
[0m12:49:07.372620 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:49:07.362408 [info ] [Thread-2 (]: 2 of 31 PASS not_null_dim_member_member_key .................................... [[32mPASS[0m in 0.16s]
[0m12:49:07.374618 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:49:07.374618 [info ] [Thread-1 (]: 1 of 31 PASS accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [[32mPASS[0m in 0.17s]
[0m12:49:07.375612 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:49:07.375612 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:49:07.375612 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:49:07.375612 [debug] [Thread-1 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:49:07.375612 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:49:07.375612 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:49:07.375612 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:49:07.375612 [info ] [Thread-3 (]: 6 of 31 START test not_null_us_healthcare_claims_data_member_id ................ [RUN]
[0m12:49:07.375612 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: BEGIN
[0m12:49:07.375612 [info ] [Thread-2 (]: 7 of 31 START test relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [RUN]
[0m12:49:07.375612 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:49:07.375612 [info ] [Thread-1 (]: 8 of 31 START test relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [RUN]
[0m12:49:07.375612 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:07.375612 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:49:07.375612 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:49:07.375612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:49:07.375612 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:49:07.392121 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:49:07.392121 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:49:07.394414 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:49:07.394414 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:49:07.394414 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:49:07.375612 => 12:49:07.394414
[0m12:49:07.394414 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.394414 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:49:07.405850 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:49:07.393118 => 12:49:07.394414
[0m12:49:07.405850 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:49:07.406855 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:49:07.394414 => 12:49:07.406855
[0m12:49:07.408848 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:49:07.409848 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:49:07.410370 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is null



      
    ) dbt_internal_test
[0m12:49:07.410370 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:49:07.410370 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:49:07.410370 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:49:07.410370 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:49:07.410370 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.410370 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: BEGIN
[0m12:49:07.410370 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:49:07.410370 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:49:07.410370 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:49:07.375612 => 12:49:07.410370
[0m12:49:07.410370 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:07.422570 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: BEGIN
[0m12:49:07.423576 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: BEGIN
[0m12:49:07.423576 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: ROLLBACK
[0m12:49:07.424570 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:49:07.425569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:07.427571 [debug] [Thread-4 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: Close
[0m12:49:07.428342 [info ] [Thread-4 (]: 5 of 31 PASS not_null_us_healthcare_claims_data_claim_id ....................... [[32mPASS[0m in 0.07s]
[0m12:49:07.428342 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:49:07.428342 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:49:07.428342 [info ] [Thread-4 (]: 9 of 31 START test relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [RUN]
[0m12:49:07.428342 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:49:07.428342 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:49:07.441661 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:49:07.441661 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:49:07.428342 => 12:49:07.441661
[0m12:49:07.441661 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.441661 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:49:07.441661 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:49:07.441661 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:49:07.441661 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_code is not null
),

parent as (
    select category_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.441661 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:49:07.441661 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: BEGIN
[0m12:49:07.441661 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.441661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.441661 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:07.441661 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:49:07.455928 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:49:07.456929 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is null



      
    ) dbt_internal_test
[0m12:49:07.457928 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_title as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_title is not null
),

parent as (
    select category_title as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.461934 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.462445 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:49:07.406855 => 12:49:07.462445
[0m12:49:07.467991 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: ROLLBACK
[0m12:49:07.467991 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: Close
[0m12:49:07.470051 [info ] [Thread-3 (]: 6 of 31 PASS not_null_us_healthcare_claims_data_member_id ...................... [[32mPASS[0m in 0.09s]
[0m12:49:07.472799 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:49:07.473801 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:49:07.474800 [info ] [Thread-3 (]: 10 of 31 START test relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [RUN]
[0m12:49:07.476071 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:49:07.476071 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:49:07.476071 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.485696 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:49:07.485696 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:49:07.410370 => 12:49:07.485696
[0m12:49:07.490432 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: ROLLBACK
[0m12:49:07.490432 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.491435 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:49:07.480151 => 12:49:07.491435
[0m12:49:07.492430 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.492430 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:49:07.493430 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: Close
[0m12:49:07.493430 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:49:07.494926 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:49:07.410370 => 12:49:07.494926
[0m12:49:07.494926 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_code is not null
),

parent as (
    select diagnosis_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.494926 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:49:07.494926 [info ] [Thread-2 (]: 7 of 31 PASS relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:49:07.494926 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: ROLLBACK
[0m12:49:07.494926 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:49:07.494926 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:49:07.494926 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: Close
[0m12:49:07.494926 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:49:07.494926 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: BEGIN
[0m12:49:07.505988 [info ] [Thread-2 (]: 11 of 31 START test relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [RUN]
[0m12:49:07.508984 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:07.507994 [info ] [Thread-1 (]: 8 of 31 PASS relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [[32mPASS[0m in 0.13s]
[0m12:49:07.509985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:49:07.510983 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:49:07.511983 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:49:07.512861 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:49:07.517398 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:49:07.517398 [info ] [Thread-1 (]: 12 of 31 START test relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [RUN]
[0m12:49:07.523091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:49:07.524110 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:49:07.512861 => 12:49:07.524110
[0m12:49:07.525107 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.526478 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:49:07.526478 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:49:07.526478 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:49:07.441661 => 12:49:07.526478
[0m12:49:07.526478 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:49:07.526478 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.541280 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:49:07.542264 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: ROLLBACK
[0m12:49:07.543267 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:49:07.544374 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:49:07.526478 => 12:49:07.544374
[0m12:49:07.544374 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:49:07.544374 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_key as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_key is not null
),

parent as (
    select full_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.544374 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:49:07.544374 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: Close
[0m12:49:07.544374 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: BEGIN
[0m12:49:07.544374 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:49:07.544374 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:49:07.544374 [info ] [Thread-4 (]: 9 of 31 PASS relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:49:07.558033 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:49:07.559036 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:49:07.560036 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:49:07.561037 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: BEGIN
[0m12:49:07.563046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:07.562037 [info ] [Thread-4 (]: 13 of 31 START test relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [RUN]
[0m12:49:07.564378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:49:07.564378 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:49:07.576809 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:49:07.578812 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:49:07.564378 => 12:49:07.577809
[0m12:49:07.579810 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:49:07.583311 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:49:07.583311 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.583311 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.583311 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:49:07.583311 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:49:07.494926 => 12:49:07.583311
[0m12:49:07.589978 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:49:07.591019 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.591976 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select full_description as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where full_description is not null
),

parent as (
    select full_description as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.592980 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: ROLLBACK
[0m12:49:07.592980 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: BEGIN
[0m12:49:07.594853 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:49:07.595362 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:07.595362 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: Close
[0m12:49:07.595362 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select address as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where address is not null
),

parent as (
    select address as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.595362 [info ] [Thread-3 (]: 10 of 31 PASS relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:49:07.595362 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:49:07.606055 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:49:07.607051 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.610196 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:49:07.544374 => 12:49:07.610196
[0m12:49:07.609101 [info ] [Thread-3 (]: 14 of 31 START test relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [RUN]
[0m12:49:07.610196 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: ROLLBACK
[0m12:49:07.614229 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:49:07.614229 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:49:07.625746 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: Close
[0m12:49:07.624650 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:49:07.628299 [info ] [Thread-1 (]: 12 of 31 PASS relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.11s]
[0m12:49:07.630506 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.630506 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:49:07.630506 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:49:07.614229 => 12:49:07.630506
[0m12:49:07.630506 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:49:07.636066 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:49:07.636066 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:49:07.636066 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select email as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where email is not null
),

parent as (
    select email as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.636066 [info ] [Thread-1 (]: 15 of 31 START test relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [RUN]
[0m12:49:07.644335 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:49:07.647363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:49:07.649666 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:49:07.650269 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:49:07.650816 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.655899 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:49:07.657507 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: BEGIN
[0m12:49:07.660188 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:49:07.580369 => 12:49:07.659656
[0m12:49:07.660718 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.662045 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:49:07.651354 => 12:49:07.661522
[0m12:49:07.662045 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:07.663571 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: ROLLBACK
[0m12:49:07.663571 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:49:07.526478 => 12:49:07.663571
[0m12:49:07.663571 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:49:07.663571 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: ROLLBACK
[0m12:49:07.663571 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:49:07.663571 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: Close
[0m12:49:07.674599 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: Close
[0m12:49:07.674599 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:49:07.673602 [info ] [Thread-4 (]: 13 of 31 PASS relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.11s]
[0m12:49:07.677602 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: BEGIN
[0m12:49:07.676608 [info ] [Thread-2 (]: 11 of 31 PASS relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [[32mPASS[0m in 0.17s]
[0m12:49:07.678210 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:49:07.678210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:07.678210 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:49:07.678210 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:49:07.678210 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:49:07.678210 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.678210 [info ] [Thread-4 (]: 16 of 31 START test relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:49:07.678210 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:49:07.678210 [info ] [Thread-2 (]: 17 of 31 START test relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [RUN]
[0m12:49:07.678210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:49:07.678210 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select gender as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where gender is not null
),

parent as (
    select gender as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.678210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:49:07.678210 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:49:07.678210 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:49:07.693911 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:49:07.693911 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.693911 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:49:07.693911 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:49:07.636066 => 12:49:07.693911
[0m12:49:07.693911 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:49:07.689218 => 12:49:07.693911
[0m12:49:07.693911 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: ROLLBACK
[0m12:49:07.693911 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:49:07.693911 => 12:49:07.693911
[0m12:49:07.693911 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:49:07.705900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.705900 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: Close
[0m12:49:07.706941 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:49:07.708979 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:49:07.709488 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:49:07.710519 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:49:07.710519 [info ] [Thread-3 (]: 14 of 31 PASS relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.10s]
[0m12:49:07.710519 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select name as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where name is not null
),

parent as (
    select name as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.710519 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:49:07.710519 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:49:07.710519 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:49:07.710519 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: BEGIN
[0m12:49:07.710519 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:49:07.710519 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: BEGIN
[0m12:49:07.710519 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:07.710519 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.710519 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:49:07.710519 [info ] [Thread-3 (]: 18 of 31 START test relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [RUN]
[0m12:49:07.723555 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:49:07.663571 => 12:49:07.722557
[0m12:49:07.725555 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:49:07.725555 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: ROLLBACK
[0m12:49:07.726556 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:49:07.728309 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:49:07.728309 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: Close
[0m12:49:07.728309 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:49:07.727557 => 12:49:07.728309
[0m12:49:07.739323 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.728309 [info ] [Thread-1 (]: 15 of 31 PASS relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:49:07.740323 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:49:07.741318 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:49:07.742368 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.742368 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:49:07.742368 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:49:07.742368 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select claim_id as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where claim_id is not null
),

parent as (
    select claim_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.742368 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:49:07.742368 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:49:07.742368 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_1_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_1_key is not null
),

parent as (
    select diagnosis_1 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.742368 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:49:07.742368 [info ] [Thread-1 (]: 19 of 31 START test relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [RUN]
[0m12:49:07.742368 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: BEGIN
[0m12:49:07.742368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:49:07.742368 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.742368 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.742368 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:07.742368 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:49:07.742368 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:49:07.706941 => 12:49:07.742368
[0m12:49:07.742368 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:49:07.710519 => 12:49:07.742368
[0m12:49:07.760929 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:49:07.762152 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: ROLLBACK
[0m12:49:07.762152 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: ROLLBACK
[0m12:49:07.762152 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:49:07.742368 => 12:49:07.762152
[0m12:49:07.762152 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:49:07.762152 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: Close
[0m12:49:07.762152 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: Close
[0m12:49:07.762152 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:49:07.762152 [info ] [Thread-4 (]: 16 of 31 PASS relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:49:07.762152 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.762152 [info ] [Thread-2 (]: 17 of 31 PASS relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:49:07.773573 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:49:07.773573 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:49:07.774571 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:49:07.775570 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:49:07.775570 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:49:07.776573 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: BEGIN
[0m12:49:07.777188 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_2_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_2_key is not null
),

parent as (
    select diagnosis_2 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.777188 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:49:07.777188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:07.777188 [info ] [Thread-4 (]: 20 of 31 START test relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:49:07.777188 [info ] [Thread-2 (]: 21 of 31 START test relationships_total_paid_amount_paid_amount__ref_fact_claims_  [RUN]
[0m12:49:07.777188 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:49:07.777188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8)
[0m12:49:07.777188 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:49:07.777188 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.777188 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:49:07.777188 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:49:07.789201 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:49:07.742368 => 12:49:07.789201
[0m12:49:07.794411 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"
[0m12:49:07.794411 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: ROLLBACK
[0m12:49:07.794411 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:49:07.777188 => 12:49:07.794411
[0m12:49:07.794411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.794411 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:49:07.794411 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8 (compile): 12:49:07.790202 => 12:49:07.794411
[0m12:49:07.794411 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: Close
[0m12:49:07.794411 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:49:07.794411 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:49:07.794411 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:49:07.794411 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_3_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_3_key is not null
),

parent as (
    select diagnosis_3 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.794411 [info ] [Thread-3 (]: 18 of 31 PASS relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.07s]
[0m12:49:07.806904 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"
[0m12:49:07.807892 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:49:07.808890 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:49:07.809890 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: BEGIN
[0m12:49:07.810701 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"
[0m12:49:07.810701 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:49:07.810701 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.810701 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:07.810701 [debug] [Thread-2 (]: On test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8: BEGIN
[0m12:49:07.810701 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:49:07.762152 => 12:49:07.810701
[0m12:49:07.810701 [info ] [Thread-3 (]: 22 of 31 START test source_not_null_bootcamp_project_icd_codes_Full_Code ....... [RUN]
[0m12:49:07.810701 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:49:07.810701 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: ROLLBACK
[0m12:49:07.810701 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718, now test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0)
[0m12:49:07.810701 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:49:07.810701 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: Close
[0m12:49:07.822622 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:49:07.824601 [info ] [Thread-1 (]: 19 of 31 PASS relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:49:07.825598 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:49:07.827600 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:49:07.810701 => 12:49:07.826601
[0m12:49:07.827600 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:49:07.828649 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:49:07.828649 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.828649 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:49:07.828649 [info ] [Thread-1 (]: 23 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_claim  [RUN]
[0m12:49:07.828649 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:49:07.828649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715)
[0m12:49:07.828649 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select member_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where member_key is not null
),

parent as (
    select member_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.828649 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:49:07.828649 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.828649 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:49:07.828649 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: BEGIN
[0m12:49:07.828649 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"
[0m12:49:07.841240 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.843258 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:49:07.844100 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:07.844100 [debug] [Thread-2 (]: On test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select paid_amount as from_field
    from "bootcamp_project"."public_gold"."total_paid_amount"
    where paid_amount is not null
),

parent as (
    select  as to_field
    from "bootcamp_project"."public_silver"."fact_claims"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:49:07.844100 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:49:07.794411 => 12:49:07.844100
[0m12:49:07.844100 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (compile): 12:49:07.828649 => 12:49:07.844100
[0m12:49:07.844100 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: ROLLBACK
[0m12:49:07.844100 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 18:     select  as to_field
                     ^

[0m12:49:07.844100 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:49:07.844100 [debug] [Thread-2 (]: On test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8: ROLLBACK
[0m12:49:07.844100 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:49:07.844100 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: Close
[0m12:49:07.844100 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:49:07.855955 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8 (execute): 12:49:07.794411 => 12:49:07.855955
[0m12:49:07.844100 [info ] [Thread-4 (]: 20 of 31 PASS relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.07s]
[0m12:49:07.857618 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: BEGIN
[0m12:49:07.858141 [debug] [Thread-2 (]: On test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8: Close
[0m12:49:07.859079 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:49:07.859079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:07.859079 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:49:07.859079 [info ] [Thread-4 (]: 24 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:49:07.859079 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60)
[0m12:49:07.859079 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:49:07.859079 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:49:07.859079 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.859079 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:49:07.859079 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Full_Code
from "bootcamp_project"."public"."icd_codes"
where Full_Code is null



      
    ) dbt_internal_test
[0m12:49:07.872545 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (compile): 12:49:07.859079 => 12:49:07.859079
[0m12:49:07.873544 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:49:07.877675 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:49:07.877675 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:49:07.877675 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: BEGIN
[0m12:49:07.877675 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:07.877675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.877675 [debug] [Thread-2 (]: Database Error in test relationships_total_paid_amount_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amount_paid_amount__ref_fact_claims_.sql
[0m12:49:07.877675 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.877675 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:49:07.877675 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:49:07.828649 => 12:49:07.877675
[0m12:49:07.877675 [error] [Thread-2 (]: 21 of 31 ERROR relationships_total_paid_amount_paid_amount__ref_fact_claims_ ... [[31mERROR[0m in 0.10s]
[0m12:49:07.877675 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim
from "bootcamp_project"."public"."us_healthcare_claims"
where claim is null



      
    ) dbt_internal_test
[0m12:49:07.877675 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: ROLLBACK
[0m12:49:07.877675 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:49:07.889289 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:49:07.890292 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: Close
[0m12:49:07.891290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.890292 [info ] [Thread-2 (]: 25 of 31 START test source_unique_bootcamp_project_icd_codes_Full_Code ......... [RUN]
[0m12:49:07.894289 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (execute): 12:49:07.844100 => 12:49:07.894289
[0m12:49:07.892292 [info ] [Thread-3 (]: 22 of 31 PASS source_not_null_bootcamp_project_icd_codes_Full_Code ............. [[32mPASS[0m in 0.08s]
[0m12:49:07.895924 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:49:07.895924 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: ROLLBACK
[0m12:49:07.895924 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:49:07.895924 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:49:07.895924 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:49:07.895924 [debug] [Thread-1 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: Close
[0m12:49:07.895924 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:49:07.895924 [info ] [Thread-3 (]: 26 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_claim .. [RUN]
[0m12:49:07.906928 [info ] [Thread-1 (]: 23 of 31 PASS source_not_null_bootcamp_project_us_healthcare_claims_claim ...... [[32mPASS[0m in 0.08s]
[0m12:49:07.907928 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.908925 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca)
[0m12:49:07.909922 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:49:07.895924 => 12:49:07.909922
[0m12:49:07.909922 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:49:07.910923 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:49:07.912074 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:49:07.912074 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:49:07.912074 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:49:07.912074 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is null



      
    ) dbt_internal_test
[0m12:49:07.912074 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:49:07.912074 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:49:07.912074 [info ] [Thread-1 (]: 27 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:49:07.912074 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (compile): 12:49:07.912074 => 12:49:07.912074
[0m12:49:07.912074 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:49:07.922683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915)
[0m12:49:07.923794 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.923794 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:49:07.924813 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: BEGIN
[0m12:49:07.924813 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:49:07.926749 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (execute): 12:49:07.874548 => 12:49:07.925729
[0m12:49:07.927083 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:49:07.927083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:49:07.927083 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:49:07.927083 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: ROLLBACK
[0m12:49:07.927083 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:49:07.927083 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (compile): 12:49:07.927083 => 12:49:07.927083
[0m12:49:07.927083 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: BEGIN
[0m12:49:07.927083 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: Close
[0m12:49:07.927083 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:49:07.927083 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:07.942320 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:49:07.927083 [info ] [Thread-4 (]: 24 of 31 PASS source_not_null_bootcamp_project_us_healthcare_claims_member_id .. [[32mPASS[0m in 0.07s]
[0m12:49:07.942320 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:49:07.942320 [debug] [Thread-4 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:49:07.942320 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:49:07.942320 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: BEGIN
[0m12:49:07.942320 [info ] [Thread-4 (]: 28 of 31 START test unique_dim_member_member_key ............................... [RUN]
[0m12:49:07.942320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:07.942320 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:49:07.942320 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:49:07.942320 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:49:07.942320 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.942320 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:49:07.942320 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:49:07.942320 => 12:49:07.942320
[0m12:49:07.942320 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Full_Code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."icd_codes"
where Full_Code is not null
group by Full_Code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:49:07.955877 [debug] [Thread-4 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:49:07.960966 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:49:07.960966 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.960966 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:49:07.960966 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:49:07.960966 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where claim is not null
group by claim
having count(*) > 1



      
    ) dbt_internal_test
[0m12:49:07.960966 [debug] [Thread-4 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: BEGIN
[0m12:49:07.960966 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:07.960966 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.960966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.972586 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (execute): 12:49:07.927083 => 12:49:07.960966
[0m12:49:07.972586 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:49:07.974586 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: ROLLBACK
[0m12:49:07.974586 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:49:07.977675 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: Close
[0m12:49:07.977675 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.977675 [info ] [Thread-3 (]: 26 of 31 PASS source_unique_bootcamp_project_us_healthcare_claims_claim ........ [[32mPASS[0m in 0.07s]
[0m12:49:07.977675 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (execute): 12:49:07.927083 => 12:49:07.977675
[0m12:49:07.977675 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:49:07.977675 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: ROLLBACK
[0m12:49:07.977675 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:07.977675 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:49:07.977675 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:49:07.977675 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: Close
[0m12:49:07.977675 [debug] [Thread-4 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."dim_member"
where member_key is not null
group by member_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:49:07.977675 [info ] [Thread-3 (]: 29 of 31 START test unique_icd_codes_data_full_code ............................ [RUN]
[0m12:49:07.977675 [info ] [Thread-1 (]: 27 of 31 PASS source_unique_bootcamp_project_us_healthcare_claims_member_id .... [[32mPASS[0m in 0.05s]
[0m12:49:07.977675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:49:07.990240 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:49:07.990240 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:07.991228 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:49:07.992226 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:49:07.994228 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:49:07.956881 => 12:49:07.993226
[0m12:49:07.998876 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:49:07.998876 [info ] [Thread-1 (]: 30 of 31 START test unique_us_healthcare_claims_data_claim_id .................. [RUN]
[0m12:49:07.998876 [debug] [Thread-4 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: ROLLBACK
[0m12:49:07.998876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:49:07.998876 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:49:07.994228 => 12:49:07.998876
[0m12:49:07.998876 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:49:07.998876 [debug] [Thread-4 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: Close
[0m12:49:07.998876 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:49:08.007909 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:49:08.007909 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:08.011376 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:49:08.008874 [info ] [Thread-4 (]: 28 of 31 PASS unique_dim_member_member_key ..................................... [[32mPASS[0m in 0.07s]
[0m12:49:08.011376 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:49:07.912074 => 12:49:08.011376
[0m12:49:08.011376 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:49:07.998876 => 12:49:08.011376
[0m12:49:08.011376 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:49:08.011376 [debug] [Thread-4 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:49:08.011376 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: ROLLBACK
[0m12:49:08.011376 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:49:08.011376 [debug] [Thread-3 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: BEGIN
[0m12:49:08.011376 [debug] [Thread-4 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:49:08.011376 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:49:08.011376 [debug] [Thread-2 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: Close
[0m12:49:08.011376 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:49:08.011376 [info ] [Thread-4 (]: 31 of 31 START test unique_us_healthcare_claims_data_member_id ................. [RUN]
[0m12:49:08.023778 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:49:08.022776 [info ] [Thread-2 (]: 25 of 31 PASS source_unique_bootcamp_project_icd_codes_Full_Code ............... [[32mPASS[0m in 0.13s]
[0m12:49:08.026042 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_dim_member_member_key.31a1be2e46, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:49:08.026042 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: BEGIN
[0m12:49:08.026042 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:49:08.026042 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:49:08.026042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:49:08.026042 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:49:08.026042 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:49:08.026042 => 12:49:08.026042
[0m12:49:08.026042 [debug] [Thread-4 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:49:08.026042 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:49:08.039286 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:49:08.039286 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: BEGIN
[0m12:49:08.039286 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:49:08.040286 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:08.041285 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:49:08.041285 [debug] [Thread-3 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    full_code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."icd_codes_data"
where full_code is not null
group by full_code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:49:08.044987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:08.044987 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:49:08.044987 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is not null
group by claim_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:49:08.056024 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:08.061023 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:49:08.011376 => 12:49:08.061023
[0m12:49:08.062008 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: ROLLBACK
[0m12:49:08.063524 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: Close
[0m12:49:08.063524 [info ] [Thread-1 (]: 30 of 31 PASS unique_us_healthcare_claims_data_claim_id ........................ [[32mPASS[0m in 0.06s]
[0m12:49:08.063524 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:49:08.063524 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:49:08.063524 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:49:08.063524 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:49:08.073619 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:08.075132 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:49:08.026042 => 12:49:08.075132
[0m12:49:08.075132 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: ROLLBACK
[0m12:49:08.075132 [debug] [Thread-4 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: Close
[0m12:49:08.075132 [info ] [Thread-4 (]: 31 of 31 PASS unique_us_healthcare_claims_data_member_id ....................... [[32mPASS[0m in 0.05s]
[0m12:49:08.075132 [debug] [Thread-4 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:49:08.075132 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:49:08.075132 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:49:08.009872 => 12:49:08.075132
[0m12:49:08.075132 [debug] [Thread-3 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: ROLLBACK
[0m12:49:08.075132 [debug] [Thread-3 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: Close
[0m12:49:08.084180 [info ] [Thread-3 (]: 29 of 31 PASS unique_icd_codes_data_full_code .................................. [[32mPASS[0m in 0.11s]
[0m12:49:08.084180 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:49:08.084180 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:08.084180 [debug] [MainThread]: On master: BEGIN
[0m12:49:08.084180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:49:08.110450 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:49:08.110450 [debug] [MainThread]: On master: COMMIT
[0m12:49:08.110450 [debug] [MainThread]: Using postgres connection "master"
[0m12:49:08.110450 [debug] [MainThread]: On master: COMMIT
[0m12:49:08.110450 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:49:08.110450 [debug] [MainThread]: On master: Close
[0m12:49:08.122553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:49:08.122553 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:49:08.123595 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:49:08.124599 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7' was properly closed.
[0m12:49:08.124599 [debug] [MainThread]: Connection 'test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280' was properly closed.
[0m12:49:08.124599 [debug] [MainThread]: Connection 'test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9' was properly closed.
[0m12:49:08.125568 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea' was properly closed.
[0m12:49:08.125568 [info ] [MainThread]: 
[0m12:49:08.125568 [info ] [MainThread]: Finished running 31 tests in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m12:49:08.125568 [debug] [MainThread]: Command end result
[0m12:49:08.142072 [info ] [MainThread]: 
[0m12:49:08.142072 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:49:08.142072 [info ] [MainThread]: 
[0m12:49:08.142072 [error] [MainThread]:   Database Error in test relationships_total_paid_amount_paid_amount__ref_fact_claims_ (models\testing\test1.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test1.yml\relationships_total_paid_amount_paid_amount__ref_fact_claims_.sql
[0m12:49:08.142072 [info ] [MainThread]: 
[0m12:49:08.142072 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=1 SKIP=0 TOTAL=31
[0m12:49:08.142072 [debug] [MainThread]: Command `dbt test` failed at 12:49:08.142072 after 1.56 seconds
[0m12:49:08.142072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB76AA6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB77DDCA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EB7240F050>]}
[0m12:49:08.142072 [debug] [MainThread]: Flushing usage events
[0m12:53:50.762059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2CDCB6D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2CDCD16D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2CDCD2810>]}


============================== 12:53:50.762059 | bdc77cb5-9d20-4527-baea-3ca8e89b7509 ==============================
[0m12:53:50.762059 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:53:50.762059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m12:53:50.834861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bdc77cb5-9d20-4527-baea-3ca8e89b7509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2CDD27050>]}
[0m12:53:50.868412 [debug] [MainThread]: Command `dbt clean` succeeded at 12:53:50.868412 after 0.14 seconds
[0m12:53:50.868412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2C6FBE390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2CC9FCA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2C724F910>]}
[0m12:53:50.868412 [debug] [MainThread]: Flushing usage events
[0m12:53:57.830262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001327116F950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001327116E790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001327116DA90>]}


============================== 12:53:57.830262 | 93d9b734-30e3-4c31-aa37-044bee8996fc ==============================
[0m12:53:57.830262 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:53:57.830262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m12:53:57.907856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93d9b734-30e3-4c31-aa37-044bee8996fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013271236A90>]}
[0m12:53:57.910753 [debug] [MainThread]: Set downloads directory='C:\Users\AKSHAY~1.FUN\AppData\Local\Temp\dbt-downloads-8mi7_14q'
[0m12:53:57.910753 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:53:58.224253 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:53:58.224253 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:53:58.479832 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:53:58.483486 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:53:59.182494 [info ] [MainThread]: Installed from version 1.1.1
[0m12:53:59.184291 [info ] [MainThread]: Up to date!
[0m12:53:59.184838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '93d9b734-30e3-4c31-aa37-044bee8996fc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013271157A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013271269E90>]}
[0m12:53:59.186413 [debug] [MainThread]: Command `dbt deps` succeeded at 12:53:59.186413 after 1.40 seconds
[0m12:53:59.186940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000132711BFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001326EAACA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001326A75C4D0>]}
[0m12:53:59.186940 [debug] [MainThread]: Flushing usage events
[0m12:54:04.320442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A668095110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A667CE33D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A667CE32D0>]}


============================== 12:54:04.320442 | a2595532-9e2a-4e46-a910-f5a8fd4774ee ==============================
[0m12:54:04.320442 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:54:04.320442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:04.448325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A668209690>]}
[0m12:54:04.501762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6680C2210>]}
[0m12:54:04.501762 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:54:04.509828 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:54:04.509828 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:54:04.519834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6680CD410>]}
[0m12:54:05.464823 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:54:05.480457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6687E2850>]}
[0m12:54:05.480457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6688D7E90>]}
[0m12:54:05.480457 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:54:05.496082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A668217F10>]}
[0m12:54:05.497705 [info ] [MainThread]: 
[0m12:54:05.498885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:05.500930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:54:05.500930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:54:05.500930 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:54:05.500930 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:54:05.500930 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:54:05.500930 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:54:05.500930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:05.500930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:05.533333 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:54:05.533333 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:54:05.533333 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:54:05.533333 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:54:05.539845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:54:05.539845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:54:05.539845 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:54:05.539845 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:54:05.539845 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:54:05.548714 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:54:05.549716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:05.549919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:05.583225 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:54:05.583225 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:54:05.583225 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:54:05.583225 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:54:05.583225 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:54:05.583225 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:54:05.583225 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:54:05.583225 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:54:05.583225 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:54:05.583225 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:54:05.583225 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:54:05.583225 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:54:05.607367 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:05.607923 [debug] [MainThread]: On master: BEGIN
[0m12:54:05.608453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:05.643491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:05.644509 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:05.644509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:05.648491 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:54:05.649625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6684BDED0>]}
[0m12:54:05.649625 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:05.649625 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:05.649625 [debug] [MainThread]: On master: BEGIN
[0m12:54:05.649625 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:05.649625 [debug] [MainThread]: On master: COMMIT
[0m12:54:05.649625 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:05.649625 [debug] [MainThread]: On master: COMMIT
[0m12:54:05.649625 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:05.649625 [debug] [MainThread]: On master: Close
[0m12:54:05.649625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:05.649625 [info ] [MainThread]: 
[0m12:54:05.649625 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:54:05.649625 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:54:05.649625 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m12:54:05.649625 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:54:05.649625 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:54:05.649625 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m12:54:05.665680 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:54:05.665680 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:54:05.665680 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:54:05.665680 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:05.665680 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:54:05.649625 => 12:54:05.665680
[0m12:54:05.665680 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:54:05.665680 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:54:05.665680 => 12:54:05.665680
[0m12:54:05.700982 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m12:54:05.700982 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:54:05.700982 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:05.700982 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:05.700982 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:05.700982 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m12:54:05.700982 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m12:54:05.700982 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:05.700982 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:05.716948 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:05.716948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:05.716948 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:05.716948 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:05.716948 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m12:54:05.716948 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m12:54:05.732994 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:54:05.749793 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:05.749793 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m12:54:05.749793 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.749793 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:05.749793 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m12:54:05.757310 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.772356 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:54:05.772356 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:05.772356 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:54:05.801004 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:05.806430 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m12:54:05.806430 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:05.806430 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m12:54:05.832109 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:05.832109 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:54:05.700982 => 12:54:05.832109
[0m12:54:05.832109 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m12:54:05.832109 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6687BC490>]}
[0m12:54:05.832109 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.17s]
[0m12:54:05.832109 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:54:05.832109 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m12:54:05.832109 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m12:54:05.832109 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m12:54:05.832109 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m12:54:05.832109 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m12:54:05.847735 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m12:54:05.847735 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m12:54:05.832109 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m12:54:05.847735 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:54:05.850154 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m12:54:05.850779 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m12:54:05.851786 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m12:54:05.856213 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:05.856213 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:54:05.856213 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:54:05.856213 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:54:05.856213 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m12:54:05.866106 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 12:54:05.856213 => 12:54:05.865598
[0m12:54:05.866106 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 12:54:05.856213 => 12:54:05.866106
[0m12:54:05.867115 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:54:05.868097 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m12:54:05.868097 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m12:54:05.868097 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m12:54:05.868097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.868097 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:54:05.856213 => 12:54:05.868097
[0m12:54:05.868097 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m12:54:05.868097 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:05.868097 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m12:54:05.868097 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:05.868097 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:05.882787 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m12:54:05.887233 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m12:54:05.887233 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m12:54:05.887233 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m12:54:05.887233 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:54:05.887233 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:05.887233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.887233 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:54:05.887233 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m12:54:05.887233 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:54:05.887233 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:05.898784 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:05.901785 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:54:05.916230 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:05.902580 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:05.916230 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:05.917759 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:05.917759 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:05.917759 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:05.917759 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m12:54:05.917759 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m12:54:05.917759 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m12:54:05.917759 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:54:05.917759 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:05.917759 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:54:05.933424 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m12:54:05.935532 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:05.936535 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m12:54:05.940535 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.940535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:05.941534 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m12:54:05.941534 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.944536 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:05.946538 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m12:54:05.949752 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:05.951730 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:05.951730 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m12:54:05.952732 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:05.952732 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m12:54:05.953729 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m12:54:05.953729 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m12:54:05.955730 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.955730 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.955730 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.957732 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:54:05.959729 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:54:05.959729 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:05.961742 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:05.962729 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:05.962729 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:05.963732 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:54:05.665680 => 12:54:05.963732
[0m12:54:05.964733 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:54:05.964733 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:54:05.965392 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:54:05.965392 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m12:54:05.965392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A66897FBD0>]}
[0m12:54:05.965392 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:05.965392 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:54:05.965392 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.32s]
[0m12:54:05.965392 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:05.965392 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:05.965392 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:05.965392 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:54:05.965392 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m12:54:05.965392 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m12:54:05.965392 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:54:05.965392 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:54:05.965392 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:05.965392 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:05.965392 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m12:54:05.965392 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m12:54:05.965392 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m12:54:05.965392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:54:05.981023 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:05.982147 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:54:05.984927 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m12:54:05.985590 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:05.985590 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:05.985590 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:05.985590 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:05.985590 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:54:05.883792 => 12:54:05.985590
[0m12:54:05.985590 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 12:54:05.868097 => 12:54:05.985590
[0m12:54:05.985590 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m12:54:05.985590 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:54:05.985590 => 12:54:05.985590
[0m12:54:05.985590 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m12:54:05.985590 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m12:54:05.985590 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:54:05.985590 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A668927BD0>]}
[0m12:54:05.985590 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6684AF150>]}
[0m12:54:06.001108 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:06.003284 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:06.003284 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.13s]
[0m12:54:06.003284 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 12:54:05.868097 => 12:54:06.003284
[0m12:54:06.003284 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.14s]
[0m12:54:06.003284 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m12:54:06.003284 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m12:54:06.003284 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:06.003284 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m12:54:06.003284 [debug] [Thread-2 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:54:06.003284 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A668973E90>]}
[0m12:54:06.003284 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m12:54:06.003284 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:54:06.003284 [info ] [Thread-2 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m12:54:06.003284 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.16s]
[0m12:54:06.003284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:06.015299 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.dim_diagnosis)
[0m12:54:06.003284 [info ] [Thread-3 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m12:54:06.015299 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m12:54:06.016304 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:54:06.017297 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_allowed_amount)
[0m12:54:06.018297 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:54:06.020424 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:54:06.020424 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:54:06.020424 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m12:54:06.020424 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:54:06.020424 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:54:06.019301 => 12:54:06.020424
[0m12:54:06.020424 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m12:54:06.020424 [debug] [Thread-2 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:54:06.020424 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:54:06.034812 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m12:54:06.035812 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:54:06.020424 => 12:54:06.034812
[0m12:54:06.037345 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:54:06.037345 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:54:06.037345 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:06.037345 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m12:54:06.037345 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:54:06.035812 => 12:54:06.037345
[0m12:54:06.037345 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m12:54:06.037345 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:54:06.037345 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:54:06.037345 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:06.037345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:06.050867 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m12:54:06.050867 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m12:54:06.050867 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:06.050867 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:06.050867 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:06.050867 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m12:54:06.050867 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m12:54:06.050867 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:06.065339 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:54:06.069062 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:06.070351 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m12:54:06.070351 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:06.070351 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:06.070351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.070351 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT 
        *
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
), 
source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        fact_claims
)
 
SELECT *
FROM source_data
  );
  
[0m12:54:06.070351 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:06.082135 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m12:54:06.085134 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:06.086134 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:06.086134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.087134 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:06.088138 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:54:06.089389 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:54:06.089389 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m12:54:06.089389 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
),
source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        fact_claims
)
 
SELECT *
FROM source_data
  );
  
[0m12:54:06.089389 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:06.089389 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:06.099685 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:54:06.102216 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:06.102216 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "allowed_amount" does not exist
LINE 22:         sum(allowed_amount) AS total_allowed_amount
                     ^

[0m12:54:06.102216 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m12:54:06.102216 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: ROLLBACK
[0m12:54:06.102216 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:54:06.037345 => 12:54:06.102216
[0m12:54:06.113742 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.113742 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: Close
[0m12:54:06.120737 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:06.120737 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:06.123734 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m12:54:06.128660 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m12:54:06.132114 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:06.134109 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.134109 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m12:54:06.137110 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:54:06.138110 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:06.139115 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:54:06.151840 [debug] [Thread-3 (]: Database Error in model total_allowed_amount (models\gold\analytics\total_allowed_amount.sql)
  column "allowed_amount" does not exist
  LINE 22:         sum(allowed_amount) AS total_allowed_amount
                       ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\total_allowed_amount.sql
[0m12:54:06.151840 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A668949BD0>]}
[0m12:54:06.152839 [error] [Thread-3 (]: 8 of 11 ERROR creating sql table model public_gold.total_allowed_amount ........ [[31mERROR[0m in 0.13s]
[0m12:54:06.154696 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:54:06.154696 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:54:06.154696 [info ] [Thread-3 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m12:54:06.154696 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.total_paid_amount_by_day)
[0m12:54:06.154696 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:54:06.154696 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:06.154696 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:54:06.154696 => 12:54:06.154696
[0m12:54:06.154696 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:54:06.166372 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:06.167385 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:06.169728 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m12:54:06.169728 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:06.169728 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:06.174703 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:06.174703 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m12:54:06.174703 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m12:54:06.174703 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:54:05.985590 => 12:54:06.174703
[0m12:54:06.174703 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:06.174703 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m12:54:06.174703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6685626D0>]}
[0m12:54:06.174703 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.21s]
[0m12:54:06.183097 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:54:06.187317 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:06.187317 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:06.187317 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m12:54:06.203850 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:06.203850 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:54:06.037345 => 12:54:06.203850
[0m12:54:06.203850 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m12:54:06.216430 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6684AF150>]}
[0m12:54:06.220421 [debug] [Thread-3 (]: SQL status: SELECT 30 in 0.0 seconds
[0m12:54:06.219425 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.20s]
[0m12:54:06.223638 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:06.223638 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:54:06.228201 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m12:54:06.228201 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.234064 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:06.235060 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m12:54:06.236749 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.236749 [debug] [Thread-2 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:54:06.236749 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:54:06.236749 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:06.236749 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:06.236749 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m12:54:06.236749 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:54:06.236749 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.249891 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:06.250880 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m12:54:06.268651 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:06.282010 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.284676 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m12:54:06.284676 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:54:06.284676 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:06.284676 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:06.284676 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m12:54:06.284676 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:54:06.284676 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:06.284676 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m12:54:06.284676 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:06.284676 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:06.284676 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:54:06.154696 => 12:54:06.284676
[0m12:54:06.284676 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m12:54:06.284676 [debug] [Thread-3 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m12:54:06.298642 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A669E3F810>]}
[0m12:54:06.300642 [info ] [Thread-3 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.14s]
[0m12:54:06.301648 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:54:06.304658 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:06.306660 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:54:06.020424 => 12:54:06.306660
[0m12:54:06.306660 [debug] [Thread-2 (]: On model.postgres_dev.dim_diagnosis: Close
[0m12:54:06.307641 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A668842450>]}
[0m12:54:06.308642 [info ] [Thread-2 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.30s]
[0m12:54:06.309650 [debug] [Thread-2 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:54:06.310641 [debug] [Thread-1 (]: Began running node model.postgres_dev.diagnosis_frequency
[0m12:54:06.310641 [info ] [Thread-1 (]: 11 of 11 START sql table model public_gold.diagnosis_frequency ................. [RUN]
[0m12:54:06.312646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.diagnosis_frequency)
[0m12:54:06.312646 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.diagnosis_frequency
[0m12:54:06.317511 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_frequency"
[0m12:54:06.319513 [debug] [Thread-1 (]: Timing info for model.postgres_dev.diagnosis_frequency (compile): 12:54:06.312646 => 12:54:06.318518
[0m12:54:06.319513 [debug] [Thread-1 (]: Began executing node model.postgres_dev.diagnosis_frequency
[0m12:54:06.321245 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_frequency"
[0m12:54:06.321245 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:06.321245 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: BEGIN
[0m12:54:06.321245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:06.334389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:06.334389 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:06.334389 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

select 
    diagnosis_key,
    category_title,
    count(*) as diagnosis_frequency
from 
    analysis
where
    category_title is NOT NULL
group by
    diagnosis_key,
    category_title
order by
    diagnosis_frequency desc
  );
  
[0m12:54:06.391997 [debug] [Thread-1 (]: SQL status: SELECT 2060 in 0.0 seconds
[0m12:54:06.400491 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:06.400491 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
alter table "bootcamp_project"."public_gold"."diagnosis_frequency" rename to "diagnosis_frequency__dbt_backup"
[0m12:54:06.402442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.404446 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:06.405445 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
alter table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp" rename to "diagnosis_frequency"
[0m12:54:06.406442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:06.407464 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m12:54:06.408442 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:06.408442 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m12:54:06.412469 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:06.415441 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup"
[0m12:54:06.415781 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:06.415781 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup" cascade
[0m12:54:06.418784 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:06.419781 [debug] [Thread-1 (]: Timing info for model.postgres_dev.diagnosis_frequency (execute): 12:54:06.319513 => 12:54:06.419781
[0m12:54:06.420803 [debug] [Thread-1 (]: On model.postgres_dev.diagnosis_frequency: Close
[0m12:54:06.420803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2595532-9e2a-4e46-a910-f5a8fd4774ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A669E73350>]}
[0m12:54:06.421782 [info ] [Thread-1 (]: 11 of 11 OK created sql table model public_gold.diagnosis_frequency ............ [[32mSELECT 2060[0m in 0.11s]
[0m12:54:06.422785 [debug] [Thread-1 (]: Finished running node model.postgres_dev.diagnosis_frequency
[0m12:54:06.423780 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:06.424806 [debug] [MainThread]: On master: BEGIN
[0m12:54:06.424806 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:06.452065 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:06.452065 [debug] [MainThread]: On master: COMMIT
[0m12:54:06.452065 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:06.452065 [debug] [MainThread]: On master: COMMIT
[0m12:54:06.452065 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:06.452065 [debug] [MainThread]: On master: Close
[0m12:54:06.452065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:06.452065 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:54:06.452065 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:54:06.452065 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:54:06.452065 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:54:06.452065 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_frequency' was properly closed.
[0m12:54:06.466426 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m12:54:06.466426 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m12:54:06.467427 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m12:54:06.468498 [info ] [MainThread]: 
[0m12:54:06.468498 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m12:54:06.468498 [debug] [MainThread]: Command end result
[0m12:54:06.468498 [info ] [MainThread]: 
[0m12:54:06.468498 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:54:06.483042 [info ] [MainThread]: 
[0m12:54:06.483551 [error] [MainThread]:   Database Error in model total_allowed_amount (models\gold\analytics\total_allowed_amount.sql)
  column "allowed_amount" does not exist
  LINE 22:         sum(allowed_amount) AS total_allowed_amount
                       ^
  compiled Code at target\run\postgres_dev\models\gold\analytics\total_allowed_amount.sql
[0m12:54:06.484559 [info ] [MainThread]: 
[0m12:54:06.485558 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m12:54:06.486622 [debug] [MainThread]: Command `dbt run` failed at 12:54:06.486622 after 2.20 seconds
[0m12:54:06.486622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A66144EF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A66144EF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A6616DF910>]}
[0m12:54:06.486622 [debug] [MainThread]: Flushing usage events
[0m12:54:48.396994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D6E93290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D724CC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D724F850>]}


============================== 12:54:48.396994 | f51395c5-d314-4484-9d5f-3104dbf6e788 ==============================
[0m12:54:48.396994 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:54:48.396994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:54:48.530305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D7387190>]}
[0m12:54:48.583124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D6E93150>]}
[0m12:54:48.584987 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:54:48.592231 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:54:48.645743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:54:48.647835 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\gold\analytics\total_allowed_amount.sql
[0m12:54:48.758023 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:54:48.760164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D74DD210>]}
[0m12:54:48.768503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D77F2A10>]}
[0m12:54:48.768503 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:54:48.768503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D76A3A90>]}
[0m12:54:48.776972 [info ] [MainThread]: 
[0m12:54:48.778004 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:48.779596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:54:48.786259 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m12:54:48.786259 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:54:48.786259 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m12:54:48.786259 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:54:48.786259 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m12:54:48.786259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:48.786259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:48.816621 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:54:48.817567 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:54:48.818655 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:54:48.819968 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m12:54:48.819968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:54:48.819968 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:54:48.819968 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:54:48.831015 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:54:48.832039 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:54:48.833105 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:54:48.833619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:48.833619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:48.850042 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:54:48.850042 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:54:48.850042 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:54:48.850042 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:54:48.850042 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:54:48.850042 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:54:48.850042 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:54:48.850042 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:54:48.850042 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:54:48.866146 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:54:48.868237 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:54:48.869141 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:54:48.874243 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:48.874243 [debug] [MainThread]: On master: BEGIN
[0m12:54:48.874243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:48.898782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:48.898782 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:48.898782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:48.898782 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:54:48.898782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D7636F50>]}
[0m12:54:48.898782 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:48.898782 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:48.898782 [debug] [MainThread]: On master: BEGIN
[0m12:54:48.898782 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:48.898782 [debug] [MainThread]: On master: COMMIT
[0m12:54:48.898782 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:48.914408 [debug] [MainThread]: On master: COMMIT
[0m12:54:48.914408 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:48.914408 [debug] [MainThread]: On master: Close
[0m12:54:48.917966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:48.920162 [info ] [MainThread]: 
[0m12:54:48.924421 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:54:48.924421 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:54:48.924946 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m12:54:48.926535 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:54:48.925497 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m12:54:48.927136 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:54:48.927665 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:54:48.933841 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:54:48.933841 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:54:48.933841 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:48.933841 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:54:48.928230 => 12:54:48.933841
[0m12:54:48.933841 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:54:48.967455 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m12:54:48.967455 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:54:48.933841 => 12:54:48.967455
[0m12:54:48.967455 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:54:48.967455 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:48.967455 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:48.967455 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:48.967455 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m12:54:48.967455 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m12:54:48.967455 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:48.967455 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:48.983391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:48.983391 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:48.983391 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:48.983391 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:48.983391 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m12:54:48.983391 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from "bootcamp_project"."public"."us_healthcare_claims"
 
)
 
select *
from source_data
  );
  
[0m12:54:49.005269 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:54:49.010267 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:49.010267 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m12:54:49.012268 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.014848 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:49.014848 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m12:54:49.016849 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.029850 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:54:49.029850 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:49.030850 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m12:54:49.047532 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.047532 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m12:54:49.047532 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m12:54:49.047532 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m12:54:49.084864 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.085865 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:54:48.967455 => 12:54:49.085865
[0m12:54:49.085865 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m12:54:49.086864 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D792BD90>]}
[0m12:54:49.087863 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.16s]
[0m12:54:49.089865 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:54:49.090863 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m12:54:49.090863 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m12:54:49.091876 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m12:54:49.091876 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m12:54:49.092872 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m12:54:49.093865 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m12:54:49.092872 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m12:54:49.093865 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m12:54:49.094864 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:54:49.094864 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m12:54:49.095864 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m12:54:49.095864 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m12:54:49.098188 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:49.100191 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:54:49.101189 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:54:49.104190 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:54:49.104190 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m12:54:49.148723 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:54:49.148723 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 12:54:49.099214 => 12:54:49.148723
[0m12:54:49.148723 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 12:54:49.101189 => 12:54:49.148723
[0m12:54:49.148723 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:54:49.104190 => 12:54:49.148723
[0m12:54:49.148723 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m12:54:49.148723 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m12:54:49.148723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.148723 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m12:54:49.148723 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m12:54:49.165421 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m12:54:49.165421 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:49.165421 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m12:54:49.165421 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:49.165421 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:49.165421 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m12:54:49.165421 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:49.165421 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m12:54:49.165421 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m12:54:49.165421 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m12:54:49.165421 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:54:49.165421 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:54:49.165421 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.165421 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:49.180919 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:54:49.182121 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:49.184790 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m12:54:49.193807 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.193807 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.197685 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:49.198436 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:49.198436 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with member_details AS (
SELECT
  DISTINCT member_id AS member_key,
  name,
  address,
  email,
  gender
FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT *
FROM member_details
  );
  
[0m12:54:49.198436 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m12:54:49.198436 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.198436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.198436 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:49.214537 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m12:54:49.214537 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:54:49.214537 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m12:54:49.215542 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with facts AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

SELECT * 
FROM facts
  );
  
[0m12:54:49.216539 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m12:54:49.218539 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:49.220559 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:49.221553 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m12:54:49.221553 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m12:54:49.222539 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m12:54:49.224538 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.224538 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.226537 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:49.230536 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:49.231268 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.231268 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:54:49.231268 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m12:54:49.232269 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m12:54:49.233292 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:54:48.933841 => 12:54:49.233292
[0m12:54:49.235272 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:49.236269 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m12:54:49.236269 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m12:54:49.237271 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.237271 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.238272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D781D950>]}
[0m12:54:49.240269 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:54:49.240269 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.242268 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:54:49.243269 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:49.242268 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.31s]
[0m12:54:49.245271 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:49.245271 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:49.246269 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m12:54:49.246269 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:54:49.247272 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m12:54:49.247272 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m12:54:49.248307 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:54:49.248307 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m12:54:49.248307 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.250758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:54:49.252391 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:54:49.252391 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.253772 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.253772 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:54:49.253772 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:49.253772 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m12:54:49.253772 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m12:54:49.253772 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:49.253772 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m12:54:49.253772 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m12:54:49.253772 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m12:54:49.266018 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:54:49.253772 => 12:54:49.265017
[0m12:54:49.266018 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m12:54:49.266911 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m12:54:49.266911 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:54:49.266911 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.266911 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:49.266911 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m12:54:49.266911 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.266911 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:49.266911 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.266911 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m12:54:49.266911 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 12:54:49.148723 => 12:54:49.266911
[0m12:54:49.266911 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m12:54:49.279921 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 12:54:49.148723 => 12:54:49.279921
[0m12:54:49.279921 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m12:54:49.281607 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m12:54:49.281607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:49.282606 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m12:54:49.283608 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D7464890>]}
[0m12:54:49.286733 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D793ED90>]}
[0m12:54:49.286733 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.286733 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.19s]
[0m12:54:49.286733 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.19s]
[0m12:54:49.286733 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:54:49.165421 => 12:54:49.286733
[0m12:54:49.286733 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m12:54:49.286733 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m12:54:49.286733 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m12:54:49.286733 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:54:49.286733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D789EB90>]}
[0m12:54:49.286733 [info ] [Thread-4 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m12:54:49.297718 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.19s]
[0m12:54:49.299712 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.dim_diagnosis)
[0m12:54:49.300481 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m12:54:49.300481 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:54:49.300481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.300481 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:54:49.300481 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:54:49.300481 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:54:49.300481 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:49.300481 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:54:49.300481 => 12:54:49.300481
[0m12:54:49.300481 [info ] [Thread-3 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m12:54:49.300481 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m12:54:49.300481 [info ] [Thread-2 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m12:54:49.300481 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:54:49.300481 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.total_allowed_amount)
[0m12:54:49.300481 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_paid_amount)
[0m12:54:49.300481 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m12:54:49.315142 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:54:49.316133 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:54:49.317132 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:49.319401 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:54:49.319401 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m12:54:49.319401 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:54:49.319401 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m12:54:49.319401 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:54:49.317132 => 12:54:49.319401
[0m12:54:49.319401 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:49.319401 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:49.332646 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:54:49.332646 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:54:49.319401 => 12:54:49.332646
[0m12:54:49.333658 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m12:54:49.336790 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m12:54:49.336790 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:54:49.336790 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m12:54:49.336790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.336790 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:54:49.350489 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:49.351488 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:49.351488 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m12:54:49.352872 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m12:54:49.352872 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m12:54:49.352872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:49.352872 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:49.352872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.352872 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:54:49.352872 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:49.352872 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m12:54:49.352872 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.352872 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:49.352872 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m12:54:49.352872 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.366771 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m12:54:49.366771 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:54:49.366771 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m12:54:49.366771 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.366771 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:49.366771 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT 
        *
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
), 
source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        fact_claims
)
 
SELECT *
FROM source_data
  );
  
[0m12:54:49.366771 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.366771 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.380974 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:54:49.266911 => 12:54:49.380974
[0m12:54:49.381982 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:49.382590 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:54:49.383588 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m12:54:49.385595 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:49.385595 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT 
        *
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
),
source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        fact_claims
)
 
SELECT *
FROM source_data
  );
  
[0m12:54:49.385595 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D7851750>]}
[0m12:54:49.385595 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m12:54:49.385595 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.14s]
[0m12:54:49.385595 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:54:49.385595 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:54:49.385595 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.385595 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:49.385595 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m12:54:49.385595 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m12:54:49.385595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m12:54:49.398118 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:54:49.402121 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:49.403282 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.403282 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:49.403282 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:54:49.398118 => 12:54:49.403282
[0m12:54:49.406814 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:54:49.406814 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:54:49.406814 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:54:49.406814 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:49.406814 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m12:54:49.417209 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:49.417209 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m12:54:49.419726 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:49.419726 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m12:54:49.419726 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:49.445366 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.445883 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:49.446387 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m12:54:49.448970 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.449502 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.452710 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m12:54:49.460211 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:54:49.460211 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m12:54:49.460211 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m12:54:49.460211 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m12:54:49.466848 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:49.467963 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m12:54:49.468843 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m12:54:49.471652 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.472189 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.474323 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:54:49.477024 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:49.477642 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:54:49.478169 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m12:54:49.478680 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m12:54:49.504927 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.504927 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.505935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.506929 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:54:49.336790 => 12:54:49.506929
[0m12:54:49.508926 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m12:54:49.509926 [debug] [Thread-4 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m12:54:49.510955 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:54:49.511927 [debug] [Thread-2 (]: On model.postgres_dev.total_paid_amount: Close
[0m12:54:49.512954 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m12:54:49.514852 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:49.515855 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:49.516856 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D7A27710>]}
[0m12:54:49.516856 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m12:54:49.517854 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m12:54:49.517854 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m12:54:49.518860 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.22s]
[0m12:54:49.520863 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:54:49.520863 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.523853 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:49.524854 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m12:54:49.525855 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.527853 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:54:49.527853 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:49.528858 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m12:54:49.532015 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.534589 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:54:49.334655 => 12:54:49.534589
[0m12:54:49.534589 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.534589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.534589 [debug] [Thread-3 (]: On model.postgres_dev.total_allowed_amount: Close
[0m12:54:49.534589 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m12:54:49.534589 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m12:54:49.534589 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D7420150>]}
[0m12:54:49.534589 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m12:54:49.534589 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m12:54:49.534589 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m12:54:49.534589 [info ] [Thread-3 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.23s]
[0m12:54:49.534589 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m12:54:49.534589 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:54:49.550341 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.550341 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.550341 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:54:49.300481 => 12:54:49.550341
[0m12:54:49.550341 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:54:49.406814 => 12:54:49.550341
[0m12:54:49.550341 [debug] [Thread-4 (]: On model.postgres_dev.dim_diagnosis: Close
[0m12:54:49.550341 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m12:54:49.550341 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D7A4B750>]}
[0m12:54:49.550341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D73A23D0>]}
[0m12:54:49.550341 [info ] [Thread-4 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.25s]
[0m12:54:49.550341 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:54:49.550341 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.16s]
[0m12:54:49.550341 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_frequency
[0m12:54:49.550341 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:54:49.550341 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_frequency ................. [RUN]
[0m12:54:49.550341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now model.postgres_dev.diagnosis_frequency)
[0m12:54:49.550341 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_frequency
[0m12:54:49.568164 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_frequency"
[0m12:54:49.569016 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_frequency (compile): 12:54:49.550341 => 12:54:49.569016
[0m12:54:49.569016 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_frequency
[0m12:54:49.569016 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_frequency"
[0m12:54:49.569016 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:49.569016 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: BEGIN
[0m12:54:49.569016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:49.587332 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.587332 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:49.587332 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

select 
    diagnosis_key,
    category_title,
    count(*) as diagnosis_frequency
from 
    analysis
where
    category_title is NOT NULL
group by
    diagnosis_key,
    category_title
order by
    diagnosis_frequency desc
  );
  
[0m12:54:49.649288 [debug] [Thread-2 (]: SQL status: SELECT 2060 in 0.0 seconds
[0m12:54:49.652288 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:49.652288 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
alter table "bootcamp_project"."public_gold"."diagnosis_frequency" rename to "diagnosis_frequency__dbt_backup"
[0m12:54:49.654287 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.656289 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:49.656289 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
alter table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp" rename to "diagnosis_frequency"
[0m12:54:49.658288 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:49.660292 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m12:54:49.660292 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:49.660292 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m12:54:49.664636 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.666641 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup"
[0m12:54:49.667642 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m12:54:49.667642 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup" cascade
[0m12:54:49.670638 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m12:54:49.672638 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_frequency (execute): 12:54:49.569016 => 12:54:49.672638
[0m12:54:49.672638 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: Close
[0m12:54:49.673637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f51395c5-d314-4484-9d5f-3104dbf6e788', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D792CA10>]}
[0m12:54:49.673637 [info ] [Thread-2 (]: 11 of 11 OK created sql table model public_gold.diagnosis_frequency ............ [[32mSELECT 2060[0m in 0.12s]
[0m12:54:49.674641 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_frequency
[0m12:54:49.676638 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:49.676638 [debug] [MainThread]: On master: BEGIN
[0m12:54:49.676638 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:49.701574 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:49.701574 [debug] [MainThread]: On master: COMMIT
[0m12:54:49.701574 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:49.701574 [debug] [MainThread]: On master: COMMIT
[0m12:54:49.701574 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:49.701574 [debug] [MainThread]: On master: Close
[0m12:54:49.701574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:49.701574 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:54:49.701574 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m12:54:49.701574 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:54:49.701574 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:54:49.701574 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m12:54:49.701574 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_frequency' was properly closed.
[0m12:54:49.701574 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m12:54:49.701574 [debug] [MainThread]: Connection 'model.postgres_dev.total_allowed_amount' was properly closed.
[0m12:54:49.714349 [info ] [MainThread]: 
[0m12:54:49.715355 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m12:54:49.717585 [debug] [MainThread]: Command end result
[0m12:54:49.717585 [info ] [MainThread]: 
[0m12:54:49.717585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:49.717585 [info ] [MainThread]: 
[0m12:54:49.717585 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m12:54:49.731003 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:49.731003 after 1.37 seconds
[0m12:54:49.732006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D07DC610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D07DC550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163D6C99A90>]}
[0m12:54:49.732006 [debug] [MainThread]: Flushing usage events
[0m12:54:56.612925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267DCDCD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267DCD2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267DCD21D0>]}


============================== 12:54:56.628559 | 257d2cfa-6370-4a07-86b9-893101b7c907 ==============================
[0m12:54:56.628559 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:54:56.628559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:54:56.747555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '257d2cfa-6370-4a07-86b9-893101b7c907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267B676A90>]}
[0m12:54:56.806832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '257d2cfa-6370-4a07-86b9-893101b7c907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267D91A250>]}
[0m12:54:56.808973 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:54:56.819153 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:54:56.889697 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:54:56.890213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:54:56.891277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:54:56.898775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '257d2cfa-6370-4a07-86b9-893101b7c907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267E04D010>]}
[0m12:54:56.913341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '257d2cfa-6370-4a07-86b9-893101b7c907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267E00BD50>]}
[0m12:54:56.914175 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:54:56.914845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '257d2cfa-6370-4a07-86b9-893101b7c907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267DF9FC90>]}
[0m12:54:56.919607 [info ] [MainThread]: 
[0m12:54:56.922463 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:56.925080 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:54:56.926126 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:54:56.936383 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:54:56.938469 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:54:56.938989 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:54:56.939520 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:54:56.940046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:56.940579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:56.956317 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:54:56.956317 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:54:56.956317 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:54:56.956317 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:54:56.956317 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:54:56.956317 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:54:56.966574 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:54:56.966574 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:54:56.966574 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:54:56.966574 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:54:56.966574 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:54:56.966574 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:54:56.966574 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:56.966574 [debug] [MainThread]: On master: BEGIN
[0m12:54:56.966574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:56.985286 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:56.985286 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:56.985286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:56.985286 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:54:56.997531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '257d2cfa-6370-4a07-86b9-893101b7c907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267DF3DE50>]}
[0m12:54:56.998530 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:56.999029 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.000030 [debug] [MainThread]: On master: BEGIN
[0m12:54:57.001029 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.001029 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.002033 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.002033 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.003029 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:57.003029 [debug] [MainThread]: On master: Close
[0m12:54:57.004030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:54:57.004030 [info ] [MainThread]: 
[0m12:54:57.008029 [debug] [Thread-1 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:54:57.008029 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:54:57.008029 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:54:57.009031 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:54:57.009031 [info ] [Thread-1 (]: 1 of 31 START test accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [RUN]
[0m12:54:57.009031 [info ] [Thread-2 (]: 2 of 31 START test not_null_dim_member_member_key .............................. [RUN]
[0m12:54:57.010030 [info ] [Thread-3 (]: 3 of 31 START test not_null_fact_claims_claimed_date_key ....................... [RUN]
[0m12:54:57.011031 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489'
[0m12:54:57.010030 [info ] [Thread-4 (]: 4 of 31 START test not_null_fact_claims_enrolled_date_key ...................... [RUN]
[0m12:54:57.012030 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_dim_member_member_key.ff327b2471'
[0m12:54:57.012030 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead'
[0m12:54:57.013031 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:54:57.013031 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb'
[0m12:54:57.014010 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:54:57.014612 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:54:57.025122 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:54:57.025122 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:54:57.032818 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:54:57.035705 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:54:57.035705 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:54:57.035705 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:54:57.014612 => 12:54:57.035705
[0m12:54:57.035705 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:54:57.025122 => 12:54:57.035705
[0m12:54:57.035705 [debug] [Thread-1 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:54:57.035705 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:54:57.035705 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:54:57.033818 => 12:54:57.035705
[0m12:54:57.035705 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:54:57.035705 => 12:54:57.035705
[0m12:54:57.049774 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:54:57.049774 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:54:57.049774 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:54:57.049774 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:54:57.049774 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:54:57.049774 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:54:57.049774 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:54:57.064206 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:54:57.065211 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: BEGIN
[0m12:54:57.066408 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:54:57.066408 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: BEGIN
[0m12:54:57.066408 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:54:57.066408 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:54:57.066408 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: BEGIN
[0m12:54:57.066408 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:54:57.066408 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: BEGIN
[0m12:54:57.066408 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:54:57.066408 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:54:57.095529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.096532 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.096532 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:54:57.097873 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:54:57.098381 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        gender as value_field,
        count(*) as n_records

    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
    group by gender

)

select *
from all_values
where value_field not in (
    'Male','Female','Others'
)



      
    ) dbt_internal_test
[0m12:54:57.098381 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.099392 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.099392 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claimed_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where claimed_date_key is null



      
    ) dbt_internal_test
[0m12:54:57.100389 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:54:57.100389 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:54:57.101392 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select enrolled_date_key
from "bootcamp_project"."public_silver"."fact_claims"
where enrolled_date_key is null



      
    ) dbt_internal_test
[0m12:54:57.102391 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_key
from "bootcamp_project"."public_silver"."dim_member"
where member_key is null



      
    ) dbt_internal_test
[0m12:54:57.102391 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.102391 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.105390 [debug] [Thread-1 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:54:57.035705 => 12:54:57.104393
[0m12:54:57.105390 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.105390 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.107405 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:54:57.049774 => 12:54:57.106391
[0m12:54:57.107405 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: ROLLBACK
[0m12:54:57.108392 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:54:57.049774 => 12:54:57.108392
[0m12:54:57.110394 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:54:57.049774 => 12:54:57.109407
[0m12:54:57.110394 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: ROLLBACK
[0m12:54:57.111390 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: ROLLBACK
[0m12:54:57.111390 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: ROLLBACK
[0m12:54:57.112391 [debug] [Thread-1 (]: On test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489: Close
[0m12:54:57.113986 [debug] [Thread-3 (]: On test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead: Close
[0m12:54:57.113986 [debug] [Thread-2 (]: On test.postgres_dev.not_null_dim_member_member_key.ff327b2471: Close
[0m12:54:57.113986 [info ] [Thread-1 (]: 1 of 31 PASS accepted_values_us_healthcare_claims_data_gender__Male__Female__Others  [[32mPASS[0m in 0.10s]
[0m12:54:57.115022 [debug] [Thread-4 (]: On test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb: Close
[0m12:54:57.115022 [info ] [Thread-3 (]: 3 of 31 PASS not_null_fact_claims_claimed_date_key ............................. [[32mPASS[0m in 0.10s]
[0m12:54:57.115022 [debug] [Thread-1 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:54:57.115022 [info ] [Thread-2 (]: 2 of 31 PASS not_null_dim_member_member_key .................................... [[32mPASS[0m in 0.10s]
[0m12:54:57.115022 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:54:57.115022 [info ] [Thread-4 (]: 4 of 31 PASS not_null_fact_claims_enrolled_date_key ............................ [[32mPASS[0m in 0.10s]
[0m12:54:57.115022 [debug] [Thread-1 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:54:57.121152 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:54:57.121781 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:54:57.121781 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:54:57.122786 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:54:57.122786 [info ] [Thread-1 (]: 5 of 31 START test not_null_us_healthcare_claims_data_claim_id ................. [RUN]
[0m12:54:57.124201 [info ] [Thread-3 (]: 6 of 31 START test not_null_us_healthcare_claims_data_member_id ................ [RUN]
[0m12:54:57.125065 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:54:57.125065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:54:57.125065 [info ] [Thread-2 (]: 7 of 31 START test relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [RUN]
[0m12:54:57.125065 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:54:57.125065 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:54:57.125065 [info ] [Thread-4 (]: 8 of 31 START test relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [RUN]
[0m12:54:57.125065 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:54:57.125065 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:54:57.134747 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:54:57.135381 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:54:57.135381 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:54:57.135381 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:54:57.135381 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:54:57.135381 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:54:57.130751 => 12:54:57.135381
[0m12:54:57.147816 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:54:57.149876 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:54:57.149876 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:54:57.135381 => 12:54:57.149876
[0m12:54:57.149876 [debug] [Thread-1 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:54:57.149876 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:54:57.135381 => 12:54:57.149876
[0m12:54:57.149876 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:54:57.149876 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:54:57.148322 => 12:54:57.149876
[0m12:54:57.149876 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:54:57.149876 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:54:57.149876 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:54:57.149876 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:54:57.149876 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:54:57.164858 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:54:57.166869 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:54:57.168830 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:54:57.168830 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: BEGIN
[0m12:54:57.168830 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: BEGIN
[0m12:54:57.168830 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:54:57.168830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.168830 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:57.168830 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:54:57.168830 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: BEGIN
[0m12:54:57.168830 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: BEGIN
[0m12:54:57.168830 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:57.168830 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:57.185166 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.185166 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.185166 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:54:57.185166 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:54:57.185166 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_code is not null
),

parent as (
    select category_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.185166 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.185166 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is null



      
    ) dbt_internal_test
[0m12:54:57.185166 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:54:57.185166 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.185166 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is null



      
    ) dbt_internal_test
[0m12:54:57.185166 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:54:57.185166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.185166 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select category_title as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where category_title is not null
),

parent as (
    select category_title as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.198496 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:54:57.149876 => 12:54:57.198496
[0m12:54:57.200061 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.200061 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: ROLLBACK
[0m12:54:57.203066 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:54:57.149876 => 12:54:57.203066
[0m12:54:57.203066 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: ROLLBACK
[0m12:54:57.203066 [debug] [Thread-1 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239: Close
[0m12:54:57.203066 [debug] [Thread-3 (]: On test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4: Close
[0m12:54:57.203066 [info ] [Thread-1 (]: 5 of 31 PASS not_null_us_healthcare_claims_data_claim_id ....................... [[32mPASS[0m in 0.08s]
[0m12:54:57.203066 [info ] [Thread-3 (]: 6 of 31 PASS not_null_us_healthcare_claims_data_member_id ...................... [[32mPASS[0m in 0.08s]
[0m12:54:57.203066 [debug] [Thread-1 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:54:57.211092 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:54:57.211092 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:54:57.211092 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:54:57.211092 [info ] [Thread-1 (]: 9 of 31 START test relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [RUN]
[0m12:54:57.215247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:54:57.214241 [info ] [Thread-3 (]: 10 of 31 START test relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [RUN]
[0m12:54:57.217068 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:54:57.217068 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:54:57.219665 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.219665 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:54:57.224700 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:54:57.225205 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:54:57.149876 => 12:54:57.225205
[0m12:54:57.232857 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:54:57.232857 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.233856 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: ROLLBACK
[0m12:54:57.234853 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:54:57.219665 => 12:54:57.233856
[0m12:54:57.236297 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:54:57.166869 => 12:54:57.236297
[0m12:54:57.236297 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:54:57.225205 => 12:54:57.236297
[0m12:54:57.236297 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:54:57.236297 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: ROLLBACK
[0m12:54:57.236297 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:54:57.236297 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917: Close
[0m12:54:57.236297 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:54:57.236297 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:54:57.236297 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f: Close
[0m12:54:57.236297 [info ] [Thread-2 (]: 7 of 31 PASS relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_  [[32mPASS[0m in 0.11s]
[0m12:54:57.236297 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:54:57.248558 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:54:57.249557 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:54:57.247556 [info ] [Thread-4 (]: 8 of 31 PASS relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_  [[32mPASS[0m in 0.10s]
[0m12:54:57.250554 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: BEGIN
[0m12:54:57.251555 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: BEGIN
[0m12:54:57.251555 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:54:57.252662 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:54:57.252662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.252662 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:57.252662 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:54:57.252662 [info ] [Thread-2 (]: 11 of 31 START test relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [RUN]
[0m12:54:57.252662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:54:57.252662 [info ] [Thread-4 (]: 12 of 31 START test relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [RUN]
[0m12:54:57.252662 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:54:57.252662 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:54:57.264105 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:54:57.265125 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:54:57.269152 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:54:57.269152 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:54:57.252662 => 12:54:57.269152
[0m12:54:57.269152 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:54:57.269152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.269152 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:54:57.269152 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:54:57.265125 => 12:54:57.269152
[0m12:54:57.269152 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:54:57.269152 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:54:57.269152 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_code as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_code is not null
),

parent as (
    select diagnosis_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.269152 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:54:57.269152 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.281779 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:54:57.282774 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: BEGIN
[0m12:54:57.283768 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:54:57.284766 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:57.285776 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_key as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where diagnosis_key is not null
),

parent as (
    select full_code as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.286769 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:54:57.287765 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: BEGIN
[0m12:54:57.287765 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:57.308270 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.308270 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:54:57.236297 => 12:54:57.308270
[0m12:54:57.308270 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: ROLLBACK
[0m12:54:57.308270 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.308270 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:54:57.308270 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.308270 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f: Close
[0m12:54:57.314133 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select address as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where address is not null
),

parent as (
    select address as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.315136 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:54:57.316899 [info ] [Thread-1 (]: 9 of 31 PASS relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_  [[32mPASS[0m in 0.10s]
[0m12:54:57.316899 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select full_description as from_field
    from "bootcamp_project"."public_silver"."dim_diagnosis"
    where full_description is not null
),

parent as (
    select full_description as to_field
    from "bootcamp_project"."public_silver"."icd_codes_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.316899 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:54:57.316899 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.316899 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.316899 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:54:57.316899 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:54:57.236297 => 12:54:57.316899
[0m12:54:57.325429 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:54:57.269152 => 12:54:57.316899
[0m12:54:57.325429 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: ROLLBACK
[0m12:54:57.325429 [info ] [Thread-1 (]: 13 of 31 START test relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [RUN]
[0m12:54:57.325429 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: ROLLBACK
[0m12:54:57.328020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:54:57.329045 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae: Close
[0m12:54:57.329045 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:54:57.330845 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a: Close
[0m12:54:57.330845 [info ] [Thread-3 (]: 10 of 31 PASS relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_  [[32mPASS[0m in 0.11s]
[0m12:54:57.340180 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:54:57.342200 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:54:57.342200 [info ] [Thread-4 (]: 12 of 31 PASS relationships_dim_member_address__address__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.09s]
[0m12:54:57.342200 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:54:57.347216 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:54:57.347216 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:54:57.331847 => 12:54:57.347216
[0m12:54:57.348529 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:54:57.348529 [info ] [Thread-3 (]: 14 of 31 START test relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [RUN]
[0m12:54:57.348529 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:54:57.351486 [info ] [Thread-4 (]: 15 of 31 START test relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [RUN]
[0m12:54:57.352489 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:54:57.354126 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:54:57.357144 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.357144 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:54:57.357144 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:54:57.357144 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:54:57.269152 => 12:54:57.357144
[0m12:54:57.357144 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:54:57.357144 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:54:57.364909 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:54:57.365473 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: ROLLBACK
[0m12:54:57.368830 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:54:57.368830 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: BEGIN
[0m12:54:57.368830 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:54:57.357144 => 12:54:57.368830
[0m12:54:57.368830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.368830 [debug] [Thread-2 (]: On test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f: Close
[0m12:54:57.368830 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:54:57.365473 => 12:54:57.368830
[0m12:54:57.368830 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:54:57.368830 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:54:57.368830 [info ] [Thread-2 (]: 11 of 31 PASS relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_  [[32mPASS[0m in 0.12s]
[0m12:54:57.368830 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:54:57.381755 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:54:57.382756 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:54:57.384755 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:54:57.385441 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:54:57.385441 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:54:57.385441 [info ] [Thread-2 (]: 16 of 31 START test relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:54:57.385441 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: BEGIN
[0m12:54:57.385441 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: BEGIN
[0m12:54:57.385441 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:54:57.385441 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:57.385441 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:57.385441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.385441 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:54:57.385441 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:54:57.397419 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:54:57.398418 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select email as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where email is not null
),

parent as (
    select email as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.400418 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:54:57.385441 => 12:54:57.399419
[0m12:54:57.401420 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:54:57.403360 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:54:57.403360 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.403360 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:54:57.353491 => 12:54:57.403360
[0m12:54:57.403360 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.403360 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: ROLLBACK
[0m12:54:57.403360 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:54:57.403360 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:54:57.403360 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.403360 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: BEGIN
[0m12:54:57.403360 [debug] [Thread-1 (]: On test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34: Close
[0m12:54:57.414960 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select name as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where name is not null
),

parent as (
    select name as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.415948 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:54:57.416720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:57.416720 [info ] [Thread-1 (]: 13 of 31 PASS relationships_dim_member_email__email__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.09s]
[0m12:54:57.416720 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select gender as from_field
    from "bootcamp_project"."public_silver"."dim_member"
    where gender is not null
),

parent as (
    select gender as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.416720 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:54:57.422353 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.423398 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:54:57.424942 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:54:57.368830 => 12:54:57.424435
[0m12:54:57.425457 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.425973 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: ROLLBACK
[0m12:54:57.425457 [info ] [Thread-1 (]: 17 of 31 START test relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [RUN]
[0m12:54:57.427523 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:54:57.368830 => 12:54:57.427009
[0m12:54:57.428556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:54:57.429070 [debug] [Thread-4 (]: On test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce: Close
[0m12:54:57.429586 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: ROLLBACK
[0m12:54:57.429586 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:54:57.430797 [info ] [Thread-4 (]: 15 of 31 PASS relationships_dim_member_name__name__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.07s]
[0m12:54:57.436369 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:54:57.436369 [debug] [Thread-3 (]: On test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c: Close
[0m12:54:57.436369 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:54:57.436369 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:54:57.432006 => 12:54:57.436369
[0m12:54:57.436369 [info ] [Thread-3 (]: 14 of 31 PASS relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.08s]
[0m12:54:57.436369 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:54:57.436369 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:54:57.436369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.436369 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:54:57.448122 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:54:57.436369 [info ] [Thread-4 (]: 18 of 31 START test relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [RUN]
[0m12:54:57.449121 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:54:57.449121 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:54:57.450120 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:54:57.451119 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:54:57.451755 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select claim_id as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where claim_id is not null
),

parent as (
    select claim_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.451755 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:54:57.451755 [info ] [Thread-3 (]: 19 of 31 START test relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [RUN]
[0m12:54:57.451755 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: BEGIN
[0m12:54:57.451755 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:54:57.451755 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.451755 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:54:57.451755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.451755 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:54:57.401420 => 12:54:57.451755
[0m12:54:57.451755 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:54:57.451755 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:54:57.451755 => 12:54:57.451755
[0m12:54:57.451755 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: ROLLBACK
[0m12:54:57.517085 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:54:57.517085 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:54:57.517085 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.517085 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:54:57.517085 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686: Close
[0m12:54:57.517085 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:54:57.517085 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:54:57.451755 => 12:54:57.517085
[0m12:54:57.517085 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:54:57.525591 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_1_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_1_key is not null
),

parent as (
    select diagnosis_1 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.525591 [info ] [Thread-2 (]: 16 of 31 PASS relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.14s]
[0m12:54:57.525591 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:54:57.525591 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: BEGIN
[0m12:54:57.525591 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:54:57.533819 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:54:57.533930 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.533930 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:57.533930 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:54:57.533930 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:54:57.436369 => 12:54:57.533930
[0m12:54:57.533930 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:54:57.533930 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: ROLLBACK
[0m12:54:57.533930 [info ] [Thread-2 (]: 20 of 31 START test relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [RUN]
[0m12:54:57.533930 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: BEGIN
[0m12:54:57.533930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:54:57.533930 [debug] [Thread-1 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a: Close
[0m12:54:57.533930 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:57.533930 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:54:57.533930 [info ] [Thread-1 (]: 17 of 31 PASS relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.11s]
[0m12:54:57.553105 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:54:57.553105 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:54:57.553105 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:54:57.553105 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:54:57.533930 => 12:54:57.553105
[0m12:54:57.553105 [info ] [Thread-1 (]: 21 of 31 START test relationships_total_paid_amount_paid_amount__ref_fact_claims_  [RUN]
[0m12:54:57.553105 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:54:57.553105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8)
[0m12:54:57.553105 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:54:57.564824 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.553105 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.565823 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:54:57.565823 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:54:57.566824 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:54:57.567823 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:54:57.568958 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"
[0m12:54:57.568958 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_3_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_3_key is not null
),

parent as (
    select diagnosis_3 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.568958 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: BEGIN
[0m12:54:57.568958 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select diagnosis_2_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where diagnosis_2_key is not null
),

parent as (
    select diagnosis_2 as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.568958 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:57.568958 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8 (compile): 12:54:57.568450 => 12:54:57.568958
[0m12:54:57.568958 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:54:57.568958 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"
[0m12:54:57.568958 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.580780 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.583448 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:54:57.525591 => 12:54:57.582778
[0m12:54:57.583448 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"
[0m12:54:57.583448 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:54:57.517085 => 12:54:57.583448
[0m12:54:57.583448 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: ROLLBACK
[0m12:54:57.583448 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8: BEGIN
[0m12:54:57.583448 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: ROLLBACK
[0m12:54:57.583448 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.583448 [debug] [Thread-3 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8: Close
[0m12:54:57.583448 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.583448 [debug] [Thread-4 (]: On test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718: Close
[0m12:54:57.583448 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:54:57.583448 [info ] [Thread-3 (]: 19 of 31 PASS relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.13s]
[0m12:54:57.583448 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select member_key as from_field
    from "bootcamp_project"."public_silver"."fact_claims"
    where member_key is not null
),

parent as (
    select member_id as to_field
    from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.583448 [info ] [Thread-4 (]: 18 of 31 PASS relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.13s]
[0m12:54:57.583448 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:54:57.583448 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:54:57.583448 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:54:57.583448 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:54:57.597435 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.583448 [info ] [Thread-3 (]: 22 of 31 START test source_not_null_bootcamp_project_icd_codes_Full_Code ....... [RUN]
[0m12:54:57.598439 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:54:57.553105 => 12:54:57.598439
[0m12:54:57.583448 [info ] [Thread-4 (]: 23 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_claim  [RUN]
[0m12:54:57.600430 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8, now test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0)
[0m12:54:57.600430 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: ROLLBACK
[0m12:54:57.601758 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715)
[0m12:54:57.601758 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:54:57.601758 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:54:57.601758 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:54:57.601758 [debug] [Thread-2 (]: On test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462: Close
[0m12:54:57.601758 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:54:57.601758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.601758 [info ] [Thread-2 (]: 20 of 31 PASS relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_  [[32mPASS[0m in 0.07s]
[0m12:54:57.601758 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"
[0m12:54:57.614154 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:54:57.616150 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:54:57.601758 => 12:54:57.615151
[0m12:54:57.616150 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select paid_amount as from_field
    from "bootcamp_project"."public_gold"."total_paid_amount"
    where paid_amount is not null
),

parent as (
    select  as to_field
    from "bootcamp_project"."public_silver"."fact_claims"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m12:54:57.617151 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (compile): 12:54:57.601758 => 12:54:57.617151
[0m12:54:57.618150 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:54:57.619149 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:54:57.620044 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:54:57.625554 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:54:57.620044 [info ] [Thread-2 (]: 24 of 31 START test source_not_null_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:54:57.625554 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 18:     select  as to_field
                     ^

[0m12:54:57.625554 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:54:57.625554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60)
[0m12:54:57.630867 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8: ROLLBACK
[0m12:54:57.632865 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:54:57.633858 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:54:57.634856 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:54:57.634856 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: BEGIN
[0m12:54:57.637690 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:54:57.637690 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8 (execute): 12:54:57.568958 => 12:54:57.637690
[0m12:54:57.637690 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: BEGIN
[0m12:54:57.637690 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:57.647664 [debug] [Thread-1 (]: On test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8: Close
[0m12:54:57.648684 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:57.649653 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (compile): 12:54:57.636855 => 12:54:57.648684
[0m12:54:57.653652 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:54:57.656588 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:54:57.656588 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:54:57.665540 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: BEGIN
[0m12:54:57.666540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:57.667425 [debug] [Thread-1 (]: Database Error in test relationships_total_paid_amount_paid_amount__ref_fact_claims_ (models\testing\test.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test.yml\relationships_total_paid_amount_paid_amount__ref_fact_claims_.sql
[0m12:54:57.667425 [error] [Thread-1 (]: 21 of 31 ERROR relationships_total_paid_amount_paid_amount__ref_fact_claims_ ... [[31mERROR[0m in 0.11s]
[0m12:54:57.667425 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:54:57.667425 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.667425 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.667425 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:54:57.667425 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:54:57.667425 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:54:57.680818 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Full_Code
from "bootcamp_project"."public"."icd_codes"
where Full_Code is null



      
    ) dbt_internal_test
[0m12:54:57.667425 [info ] [Thread-1 (]: 25 of 31 START test source_unique_bootcamp_project_icd_codes_Full_Code ......... [RUN]
[0m12:54:57.682817 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select claim
from "bootcamp_project"."public"."us_healthcare_claims"
where claim is null



      
    ) dbt_internal_test
[0m12:54:57.684898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:54:57.684898 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:54:57.692540 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:54:57.692540 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.692540 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.692540 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.698087 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (execute): 12:54:57.625554 => 12:54:57.698087
[0m12:54:57.699099 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:54:57.700098 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:54:57.684898 => 12:54:57.700098
[0m12:54:57.702123 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:54:57.620044 => 12:54:57.702123
[0m12:54:57.703078 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: ROLLBACK
[0m12:54:57.703078 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select member_id
from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is null



      
    ) dbt_internal_test
[0m12:54:57.703078 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:54:57.703078 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: ROLLBACK
[0m12:54:57.703078 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:54:57.703078 [debug] [Thread-4 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715: Close
[0m12:54:57.703078 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.716325 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (execute): 12:54:57.654651 => 12:54:57.715325
[0m12:54:57.718324 [debug] [Thread-3 (]: On test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0: Close
[0m12:54:57.718324 [info ] [Thread-4 (]: 23 of 31 PASS source_not_null_bootcamp_project_us_healthcare_claims_claim ...... [[32mPASS[0m in 0.12s]
[0m12:54:57.719326 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: ROLLBACK
[0m12:54:57.720326 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:54:57.721153 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:54:57.721153 [info ] [Thread-3 (]: 22 of 31 PASS source_not_null_bootcamp_project_icd_codes_Full_Code ............. [[32mPASS[0m in 0.12s]
[0m12:54:57.725687 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: BEGIN
[0m12:54:57.725687 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:54:57.725687 [debug] [Thread-2 (]: On test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60: Close
[0m12:54:57.725687 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:54:57.725687 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.730889 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:54:57.725687 [info ] [Thread-4 (]: 26 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_claim .. [RUN]
[0m12:54:57.732890 [info ] [Thread-2 (]: 24 of 31 PASS source_not_null_bootcamp_project_us_healthcare_claims_member_id .. [[32mPASS[0m in 0.11s]
[0m12:54:57.734888 [info ] [Thread-3 (]: 27 of 31 START test source_unique_bootcamp_project_us_healthcare_claims_member_id  [RUN]
[0m12:54:57.736883 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca)
[0m12:54:57.737884 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:54:57.738962 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915)
[0m12:54:57.738962 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:54:57.738962 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:54:57.738962 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:54:57.750459 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:54:57.754213 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:54:57.751457 [info ] [Thread-2 (]: 28 of 31 START test unique_dim_member_member_key ............................... [RUN]
[0m12:54:57.754213 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (compile): 12:54:57.738962 => 12:54:57.754213
[0m12:54:57.754213 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:54:57.754213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.764160 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (compile): 12:54:57.752459 => 12:54:57.764160
[0m12:54:57.765154 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:54:57.766156 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:54:57.766868 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:54:57.766868 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:54:57.766868 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:54:57.766868 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:54:57.766868 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Full_Code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."icd_codes"
where Full_Code is not null
group by Full_Code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:57.766868 [debug] [Thread-3 (]: Writing runtime sql for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:54:57.766868 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:54:57.766868 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:54:57.766868 => 12:54:57.766868
[0m12:54:57.766868 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: BEGIN
[0m12:54:57.766868 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:54:57.780817 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:54:57.782913 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:57.786445 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:54:57.787329 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: BEGIN
[0m12:54:57.788898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:54:57.788898 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:54:57.788898 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: BEGIN
[0m12:54:57.788898 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:57.808415 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.808415 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:54:57.814229 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where claim is not null
group by claim
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:57.818255 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.818255 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.818255 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:54:57.818255 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (execute): 12:54:57.766868 => 12:54:57.818255
[0m12:54:57.825767 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_key as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."dim_member"
where member_key is not null
group by member_key
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:57.825767 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: ROLLBACK
[0m12:54:57.825767 [debug] [Thread-4 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca: Close
[0m12:54:57.830948 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.831954 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.830948 [info ] [Thread-4 (]: 26 of 31 PASS source_unique_bootcamp_project_us_healthcare_claims_claim ........ [[32mPASS[0m in 0.09s]
[0m12:54:57.832961 [debug] [Thread-3 (]: Using postgres connection "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:54:57.834946 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:54:57.783429 => 12:54:57.834946
[0m12:54:57.835946 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:54:57.835946 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public"."us_healthcare_claims"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:57.836948 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: ROLLBACK
[0m12:54:57.837947 [debug] [Thread-4 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:54:57.838948 [info ] [Thread-4 (]: 29 of 31 START test unique_icd_codes_data_full_code ............................ [RUN]
[0m12:54:57.839953 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.839953 [debug] [Thread-2 (]: On test.postgres_dev.unique_dim_member_member_key.31a1be2e46: Close
[0m12:54:57.840948 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:54:57.841948 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.842945 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:54:57.703078 => 12:54:57.842945
[0m12:54:57.845072 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:54:57.845072 [info ] [Thread-2 (]: 28 of 31 PASS unique_dim_member_member_key ..................................... [[32mPASS[0m in 0.09s]
[0m12:54:57.851723 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (execute): 12:54:57.766868 => 12:54:57.850727
[0m12:54:57.852723 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: ROLLBACK
[0m12:54:57.853262 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:54:57.853262 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:54:57.853262 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: ROLLBACK
[0m12:54:57.853262 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:54:57.864411 [debug] [Thread-1 (]: On test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280: Close
[0m12:54:57.865405 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:54:57.853262 => 12:54:57.864411
[0m12:54:57.866404 [info ] [Thread-2 (]: 30 of 31 START test unique_us_healthcare_claims_data_claim_id .................. [RUN]
[0m12:54:57.868972 [debug] [Thread-3 (]: On test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915: Close
[0m12:54:57.868972 [info ] [Thread-1 (]: 25 of 31 PASS source_unique_bootcamp_project_icd_codes_Full_Code ............... [[32mPASS[0m in 0.18s]
[0m12:54:57.869987 [debug] [Thread-4 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:54:57.871742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_dim_member_member_key.31a1be2e46, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:54:57.871742 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:54:57.871742 [info ] [Thread-3 (]: 27 of 31 PASS source_unique_bootcamp_project_us_healthcare_claims_member_id .... [[32mPASS[0m in 0.13s]
[0m12:54:57.880769 [debug] [Thread-4 (]: Writing runtime sql for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:54:57.881772 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:54:57.883768 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:54:57.884770 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:54:57.887681 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:54:57.887681 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:54:57.887681 [info ] [Thread-1 (]: 31 of 31 START test unique_us_healthcare_claims_data_member_id ................. [RUN]
[0m12:54:57.887681 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: BEGIN
[0m12:54:57.887681 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:54:57.885765 => 12:54:57.887681
[0m12:54:57.898423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:54:57.899421 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:54:57.900423 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:54:57.901419 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:54:57.903435 [debug] [Thread-2 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:54:57.903435 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:54:57.913282 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:54:57.914289 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:54:57.903435 => 12:54:57.913837
[0m12:54:57.915342 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: BEGIN
[0m12:54:57.916392 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:54:57.916978 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:54:57.920666 [debug] [Thread-1 (]: Writing runtime sql for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:54:57.922252 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:54:57.922781 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.923305 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: BEGIN
[0m12:54:57.923832 [debug] [Thread-4 (]: Using postgres connection "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:54:57.924355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:57.924355 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    full_code as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."icd_codes_data"
where full_code is not null
group by full_code
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:57.944059 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.944059 [debug] [Thread-2 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:54:57.944059 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    claim_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where claim_id is not null
group by claim_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:57.950271 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.952624 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:54:57.902421 => 12:54:57.952624
[0m12:54:57.952624 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: ROLLBACK
[0m12:54:57.952624 [debug] [Thread-2 (]: On test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7: Close
[0m12:54:57.952624 [info ] [Thread-2 (]: 30 of 31 PASS unique_us_healthcare_claims_data_claim_id ........................ [[32mPASS[0m in 0.08s]
[0m12:54:57.952624 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:54:57.952624 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.952624 [debug] [Thread-4 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:54:57.871742 => 12:54:57.952624
[0m12:54:57.963168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.963168 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: ROLLBACK
[0m12:54:57.964064 [debug] [Thread-1 (]: Using postgres connection "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:54:57.965065 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    member_id as unique_field,
    count(*) as n_records

from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
where member_id is not null
group by member_id
having count(*) > 1



      
    ) dbt_internal_test
[0m12:54:57.966317 [debug] [Thread-4 (]: On test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9: Close
[0m12:54:57.966317 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m12:54:57.966317 [info ] [Thread-4 (]: 29 of 31 PASS unique_icd_codes_data_full_code .................................. [[32mPASS[0m in 0.13s]
[0m12:54:57.966317 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:54:57.917503 => 12:54:57.966317
[0m12:54:57.966317 [debug] [Thread-4 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:54:57.966317 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: ROLLBACK
[0m12:54:57.966317 [debug] [Thread-1 (]: On test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea: Close
[0m12:54:57.966317 [info ] [Thread-1 (]: 31 of 31 PASS unique_us_healthcare_claims_data_member_id ....................... [[32mPASS[0m in 0.08s]
[0m12:54:57.966317 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:54:57.966317 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.966317 [debug] [MainThread]: On master: BEGIN
[0m12:54:57.966317 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:57.986008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:57.986008 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.986008 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:57.986008 [debug] [MainThread]: On master: COMMIT
[0m12:54:57.986008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:57.986008 [debug] [MainThread]: On master: Close
[0m12:54:57.986008 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:57.986008 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:54:57.986008 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:54:57.986008 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea' was properly closed.
[0m12:54:57.986008 [debug] [MainThread]: Connection 'test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7' was properly closed.
[0m12:54:57.986008 [debug] [MainThread]: Connection 'test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915' was properly closed.
[0m12:54:57.986008 [debug] [MainThread]: Connection 'test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9' was properly closed.
[0m12:54:57.986008 [info ] [MainThread]: 
[0m12:54:57.998256 [info ] [MainThread]: Finished running 31 tests in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m12:54:58.002034 [debug] [MainThread]: Command end result
[0m12:54:58.002034 [info ] [MainThread]: 
[0m12:54:58.002034 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:54:58.002034 [info ] [MainThread]: 
[0m12:54:58.014141 [error] [MainThread]:   Database Error in test relationships_total_paid_amount_paid_amount__ref_fact_claims_ (models\testing\test.yml)
  syntax error at or near "as"
  LINE 18:     select  as to_field
                       ^
  compiled Code at target\run\postgres_dev\models\testing\test.yml\relationships_total_paid_amount_paid_amount__ref_fact_claims_.sql
[0m12:54:58.015149 [info ] [MainThread]: 
[0m12:54:58.016145 [info ] [MainThread]: Done. PASS=30 WARN=0 ERROR=1 SKIP=0 TOTAL=31
[0m12:54:58.017144 [debug] [MainThread]: Command `dbt test` failed at 12:54:58.017144 after 1.43 seconds
[0m12:54:58.017144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267D933150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267CB8B490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002267B676910>]}
[0m12:54:58.018143 [debug] [MainThread]: Flushing usage events
[0m12:55:06.626863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05BE961D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05C39EE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05C39F550>]}


============================== 12:55:06.626863 | a410fcdf-f206-4898-85e6-aa3161387e6d ==============================
[0m12:55:06.626863 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:55:06.642488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:55:06.763645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a410fcdf-f206-4898-85e6-aa3161387e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05C404FD0>]}
[0m12:55:06.818154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a410fcdf-f206-4898-85e6-aa3161387e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05C4E6450>]}
[0m12:55:06.819715 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m12:55:06.831648 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:55:06.893781 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:06.894300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:06.895362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m12:55:06.903037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a410fcdf-f206-4898-85e6-aa3161387e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05C7AEC50>]}
[0m12:55:06.906705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a410fcdf-f206-4898-85e6-aa3161387e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05C71D1D0>]}
[0m12:55:06.907218 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m12:55:06.908282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a410fcdf-f206-4898-85e6-aa3161387e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05C3C7DD0>]}
[0m12:55:06.911235 [info ] [MainThread]: 
[0m12:55:06.912819 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:55:06.915489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m12:55:06.917079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m12:55:06.930129 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:55:06.933800 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:55:06.934829 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m12:55:06.935391 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m12:55:06.936159 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:06.937237 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:06.957646 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:55:06.958151 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:55:06.958224 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m12:55:06.958730 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m12:55:06.958730 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m12:55:06.958730 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m12:55:06.958730 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m12:55:06.958730 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:55:06.958730 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m12:55:06.964547 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m12:55:06.966099 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m12:55:06.966099 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m12:55:06.966099 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:06.966099 [debug] [MainThread]: On master: BEGIN
[0m12:55:06.966099 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:06.982553 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:55:06.982553 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:06.982553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:55:06.982553 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m12:55:06.982553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a410fcdf-f206-4898-85e6-aa3161387e6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05C7F5690>]}
[0m12:55:06.982553 [debug] [MainThread]: On master: ROLLBACK
[0m12:55:06.982553 [debug] [MainThread]: On master: Close
[0m12:55:06.997914 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:55:06.998914 [info ] [MainThread]: 
[0m12:55:07.001912 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m12:55:07.002913 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m12:55:07.002913 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:55:07.002913 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:55:07.003912 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m12:55:07.004913 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m12:55:07.004913 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0'
[0m12:55:07.005914 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715'
[0m12:55:07.005914 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m12:55:07.006912 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m12:55:07.006912 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:55:07.006912 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:55:07.012913 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m12:55:07.014850 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m12:55:07.022853 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0"
[0m12:55:07.025865 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715"
[0m12:55:07.026854 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 12:55:07.007912 => 12:55:07.025865
[0m12:55:07.027851 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (compile): 12:55:07.014850 => 12:55:07.027851
[0m12:55:07.028850 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 12:55:07.012913 => 12:55:07.027851
[0m12:55:07.028850 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m12:55:07.029854 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (compile): 12:55:07.022853 => 12:55:07.028850
[0m12:55:07.029854 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:55:07.030791 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m12:55:07.031518 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 12:55:07.030791 => 12:55:07.030791
[0m12:55:07.031518 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:55:07.032520 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0 (execute): 12:55:07.032520 => 12:55:07.032520
[0m12:55:07.033202 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 12:55:07.032520 => 12:55:07.032520
[0m12:55:07.033692 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m12:55:07.033692 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715 (execute): 12:55:07.033692 => 12:55:07.033692
[0m12:55:07.033692 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0
[0m12:55:07.033692 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m12:55:07.033692 [debug] [Thread-1 (]: Began running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:55:07.033692 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715
[0m12:55:07.033692 [debug] [Thread-3 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:55:07.033692 [debug] [Thread-2 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:55:07.033692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60)
[0m12:55:07.033692 [debug] [Thread-4 (]: Began running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:55:07.033692 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_icd_codes_Full_Code.a461ebadb0, now test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280)
[0m12:55:07.033692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca)
[0m12:55:07.033692 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:55:07.033692 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_claim.dca6db6715, now test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915)
[0m12:55:07.033692 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:55:07.033692 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:55:07.033692 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60"
[0m12:55:07.033692 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:55:07.049955 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280"
[0m12:55:07.049955 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca"
[0m12:55:07.049955 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (compile): 12:55:07.033692 => 12:55:07.049955
[0m12:55:07.049955 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915"
[0m12:55:07.049955 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (compile): 12:55:07.033692 => 12:55:07.049955
[0m12:55:07.049955 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (compile): 12:55:07.049955 => 12:55:07.049955
[0m12:55:07.049955 [debug] [Thread-1 (]: Began executing node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:55:07.049955 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (compile): 12:55:07.049955 => 12:55:07.049955
[0m12:55:07.049955 [debug] [Thread-3 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:55:07.049955 [debug] [Thread-2 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:55:07.049955 [debug] [Thread-1 (]: Timing info for test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60 (execute): 12:55:07.049955 => 12:55:07.049955
[0m12:55:07.049955 [debug] [Thread-4 (]: Began executing node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:55:07.049955 [debug] [Thread-3 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280 (execute): 12:55:07.049955 => 12:55:07.049955
[0m12:55:07.049955 [debug] [Thread-2 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca (execute): 12:55:07.049955 => 12:55:07.049955
[0m12:55:07.065517 [debug] [Thread-1 (]: Finished running node test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60
[0m12:55:07.065922 [debug] [Thread-4 (]: Timing info for test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915 (execute): 12:55:07.065922 => 12:55:07.065922
[0m12:55:07.065922 [debug] [Thread-3 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280
[0m12:55:07.065922 [debug] [Thread-2 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca
[0m12:55:07.065922 [debug] [Thread-1 (]: Began running node model.postgres_dev.dim_diagnosis
[0m12:55:07.065922 [debug] [Thread-4 (]: Finished running node test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915
[0m12:55:07.065922 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:55:07.065922 [debug] [Thread-2 (]: Began running node model.postgres_dev.dim_date
[0m12:55:07.065922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_not_null_bootcamp_project_us_healthcare_claims_member_id.4544716a60, now model.postgres_dev.dim_diagnosis)
[0m12:55:07.065922 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_member
[0m12:55:07.065922 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_icd_codes_Full_Code.a339279280, now test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9)
[0m12:55:07.065922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_claim.754993bfca, now model.postgres_dev.dim_date)
[0m12:55:07.065922 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m12:55:07.065922 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.source_unique_bootcamp_project_us_healthcare_claims_member_id.9652bca915, now model.postgres_dev.dim_member)
[0m12:55:07.065922 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:55:07.065922 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.dim_date
[0m12:55:07.065922 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m12:55:07.065922 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_member
[0m12:55:07.065922 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9"
[0m12:55:07.082066 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m12:55:07.084206 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m12:55:07.085207 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (compile): 12:55:07.065922 => 12:55:07.085207
[0m12:55:07.086103 [debug] [Thread-1 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 12:55:07.065922 => 12:55:07.086103
[0m12:55:07.086103 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_date (compile): 12:55:07.065922 => 12:55:07.086103
[0m12:55:07.087102 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:55:07.087102 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_member (compile): 12:55:07.083100 => 12:55:07.087102
[0m12:55:07.088101 [debug] [Thread-1 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m12:55:07.088101 [debug] [Thread-2 (]: Began executing node model.postgres_dev.dim_date
[0m12:55:07.089100 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9 (execute): 12:55:07.088101 => 12:55:07.088101
[0m12:55:07.089100 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_member
[0m12:55:07.089100 [debug] [Thread-1 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 12:55:07.089100 => 12:55:07.089100
[0m12:55:07.090101 [debug] [Thread-2 (]: Timing info for model.postgres_dev.dim_date (execute): 12:55:07.090101 => 12:55:07.090101
[0m12:55:07.090101 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9
[0m12:55:07.091125 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_member (execute): 12:55:07.091125 => 12:55:07.091125
[0m12:55:07.091125 [debug] [Thread-1 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m12:55:07.092104 [debug] [Thread-2 (]: Finished running node model.postgres_dev.dim_date
[0m12:55:07.092841 [debug] [Thread-3 (]: Began running node model.postgres_dev.fact_claims
[0m12:55:07.092841 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_member
[0m12:55:07.093903 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:55:07.093903 [debug] [Thread-2 (]: Began running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:55:07.094866 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_icd_codes_data_full_code.18bac334b9, now model.postgres_dev.fact_claims)
[0m12:55:07.094866 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:55:07.095863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_diagnosis, now model.postgres_dev.final_us_healthcare_claims_data)
[0m12:55:07.095863 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489)
[0m12:55:07.096871 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.fact_claims
[0m12:55:07.097648 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239)
[0m12:55:07.097648 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m12:55:07.097648 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:55:07.099649 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m12:55:07.100736 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:55:07.102775 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m12:55:07.107755 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489"
[0m12:55:07.108846 [debug] [Thread-3 (]: Timing info for model.postgres_dev.fact_claims (compile): 12:55:07.098650 => 12:55:07.108846
[0m12:55:07.112013 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239"
[0m12:55:07.112519 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 12:55:07.100736 => 12:55:07.112519
[0m12:55:07.112519 [debug] [Thread-3 (]: Began executing node model.postgres_dev.fact_claims
[0m12:55:07.113525 [debug] [Thread-2 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (compile): 12:55:07.102775 => 12:55:07.113525
[0m12:55:07.114525 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m12:55:07.114525 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (compile): 12:55:07.108846 => 12:55:07.114525
[0m12:55:07.115595 [debug] [Thread-3 (]: Timing info for model.postgres_dev.fact_claims (execute): 12:55:07.114525 => 12:55:07.114525
[0m12:55:07.115595 [debug] [Thread-2 (]: Began executing node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:55:07.115595 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 12:55:07.115595 => 12:55:07.115595
[0m12:55:07.115595 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:55:07.115595 [debug] [Thread-3 (]: Finished running node model.postgres_dev.fact_claims
[0m12:55:07.115595 [debug] [Thread-2 (]: Timing info for test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489 (execute): 12:55:07.115595 => 12:55:07.115595
[0m12:55:07.115595 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m12:55:07.115595 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239 (execute): 12:55:07.115595 => 12:55:07.115595
[0m12:55:07.115595 [debug] [Thread-3 (]: Began running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:55:07.115595 [debug] [Thread-2 (]: Finished running node test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489
[0m12:55:07.115595 [debug] [Thread-1 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:55:07.115595 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239
[0m12:55:07.115595 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4)
[0m12:55:07.115595 [debug] [Thread-2 (]: Began running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:55:07.115595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7)
[0m12:55:07.115595 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:55:07.115595 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:55:07.115595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.accepted_values_us_healthcare_claims_data_gender__Male__Female__Others.679d59a489, now test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea)
[0m12:55:07.115595 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:55:07.115595 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_claim_id.0549f5a239, now test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917)
[0m12:55:07.115595 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4"
[0m12:55:07.115595 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:55:07.115595 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7"
[0m12:55:07.131399 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:55:07.131906 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (compile): 12:55:07.115595 => 12:55:07.131906
[0m12:55:07.131906 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea"
[0m12:55:07.131906 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917"
[0m12:55:07.131906 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (compile): 12:55:07.115595 => 12:55:07.131906
[0m12:55:07.131906 [debug] [Thread-3 (]: Began executing node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:55:07.131906 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (compile): 12:55:07.131906 => 12:55:07.131906
[0m12:55:07.131906 [debug] [Thread-1 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:55:07.131906 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (compile): 12:55:07.131906 => 12:55:07.131906
[0m12:55:07.131906 [debug] [Thread-3 (]: Timing info for test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4 (execute): 12:55:07.131906 => 12:55:07.131906
[0m12:55:07.131906 [debug] [Thread-2 (]: Began executing node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:55:07.131906 [debug] [Thread-1 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7 (execute): 12:55:07.131906 => 12:55:07.131906
[0m12:55:07.131906 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:55:07.131906 [debug] [Thread-3 (]: Finished running node test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4
[0m12:55:07.131906 [debug] [Thread-2 (]: Timing info for test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea (execute): 12:55:07.131906 => 12:55:07.131906
[0m12:55:07.131906 [debug] [Thread-1 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7
[0m12:55:07.131906 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917 (execute): 12:55:07.131906 => 12:55:07.131906
[0m12:55:07.147540 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:55:07.148048 [debug] [Thread-2 (]: Finished running node test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea
[0m12:55:07.148048 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:55:07.148048 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917
[0m12:55:07.148048 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_us_healthcare_claims_data_member_id.98bac6d8b4, now test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f)
[0m12:55:07.148048 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:55:07.148048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_us_healthcare_claims_data_claim_id.060e29acd7, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f)
[0m12:55:07.148048 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:55:07.148048 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:55:07.148048 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_us_healthcare_claims_data_member_id.110c7b53ea, now test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae)
[0m12:55:07.148048 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:55:07.148048 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_code__category_code__ref_icd_codes_data_.ee118ec917, now test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f)
[0m12:55:07.148048 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f"
[0m12:55:07.148048 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:55:07.148048 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f"
[0m12:55:07.148048 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:55:07.163707 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae"
[0m12:55:07.163707 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (compile): 12:55:07.148048 => 12:55:07.163707
[0m12:55:07.163707 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f"
[0m12:55:07.163707 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (compile): 12:55:07.148048 => 12:55:07.163707
[0m12:55:07.163707 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (compile): 12:55:07.148048 => 12:55:07.163707
[0m12:55:07.163707 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:55:07.163707 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (compile): 12:55:07.163707 => 12:55:07.163707
[0m12:55:07.163707 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:55:07.163707 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:55:07.163707 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f (execute): 12:55:07.163707 => 12:55:07.163707
[0m12:55:07.163707 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:55:07.163707 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f (execute): 12:55:07.163707 => 12:55:07.163707
[0m12:55:07.163707 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae (execute): 12:55:07.163707 => 12:55:07.163707
[0m12:55:07.163707 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f
[0m12:55:07.163707 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f (execute): 12:55:07.163707 => 12:55:07.163707
[0m12:55:07.163707 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f
[0m12:55:07.163707 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae
[0m12:55:07.163707 [debug] [Thread-1 (]: Began running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:55:07.163707 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f
[0m12:55:07.179307 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:55:07.179307 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:55:07.179307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_code__diagnosis_code__ref_icd_codes_data_.f276a1b21f, now test.postgres_dev.not_null_dim_member_member_key.ff327b2471)
[0m12:55:07.179307 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:55:07.179307 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_category_title__category_title__ref_icd_codes_data_.f639d98d1f, now test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a)
[0m12:55:07.179307 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_diagnosis_key__full_code__ref_icd_codes_data_.6003c97cae, now test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34)
[0m12:55:07.179307 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:55:07.179307 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_diagnosis_full_description__full_description__ref_icd_codes_data_.cc08b49c1f, now test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c)
[0m12:55:07.179307 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:55:07.179307 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:55:07.179307 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.not_null_dim_member_member_key.ff327b2471"
[0m12:55:07.179307 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:55:07.179307 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a"
[0m12:55:07.179307 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34"
[0m12:55:07.179307 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (compile): 12:55:07.179307 => 12:55:07.179307
[0m12:55:07.194980 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c"
[0m12:55:07.194980 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (compile): 12:55:07.179307 => 12:55:07.194980
[0m12:55:07.194980 [debug] [Thread-1 (]: Began executing node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:55:07.194980 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (compile): 12:55:07.179307 => 12:55:07.194980
[0m12:55:07.194980 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (compile): 12:55:07.179307 => 12:55:07.194980
[0m12:55:07.194980 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:55:07.194980 [debug] [Thread-1 (]: Timing info for test.postgres_dev.not_null_dim_member_member_key.ff327b2471 (execute): 12:55:07.194980 => 12:55:07.194980
[0m12:55:07.194980 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:55:07.194980 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:55:07.194980 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a (execute): 12:55:07.194980 => 12:55:07.194980
[0m12:55:07.194980 [debug] [Thread-1 (]: Finished running node test.postgres_dev.not_null_dim_member_member_key.ff327b2471
[0m12:55:07.194980 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34 (execute): 12:55:07.194980 => 12:55:07.194980
[0m12:55:07.194980 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c (execute): 12:55:07.194980 => 12:55:07.194980
[0m12:55:07.194980 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a
[0m12:55:07.194980 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:55:07.194980 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34
[0m12:55:07.194980 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c
[0m12:55:07.194980 [debug] [Thread-3 (]: Began running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:55:07.194980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_dim_member_member_key.ff327b2471, now test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce)
[0m12:55:07.194980 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_frequency
[0m12:55:07.194980 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_allowed_amount
[0m12:55:07.194980 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_address__address__ref_us_healthcare_claims_data_.3337e4ca2a, now test.postgres_dev.unique_dim_member_member_key.31a1be2e46)
[0m12:55:07.194980 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:55:07.194980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_email__email__ref_us_healthcare_claims_data_.41446eeb34, now model.postgres_dev.diagnosis_frequency)
[0m12:55:07.194980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_gender__gender__ref_us_healthcare_claims_data_.bb45ea076c, now model.postgres_dev.total_allowed_amount)
[0m12:55:07.194980 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:55:07.210560 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce"
[0m12:55:07.210560 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_frequency
[0m12:55:07.210560 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m12:55:07.210560 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.unique_dim_member_member_key.31a1be2e46"
[0m12:55:07.210560 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (compile): 12:55:07.194980 => 12:55:07.210560
[0m12:55:07.210560 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_frequency"
[0m12:55:07.210560 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m12:55:07.210560 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (compile): 12:55:07.210560 => 12:55:07.210560
[0m12:55:07.210560 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:55:07.210560 [debug] [Thread-3 (]: Began executing node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:55:07.210560 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_frequency (compile): 12:55:07.210560 => 12:55:07.210560
[0m12:55:07.210560 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 12:55:07.210560 => 12:55:07.210560
[0m12:55:07.210560 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce (execute): 12:55:07.210560 => 12:55:07.210560
[0m12:55:07.226184 [debug] [Thread-3 (]: Timing info for test.postgres_dev.unique_dim_member_member_key.31a1be2e46 (execute): 12:55:07.210560 => 12:55:07.210560
[0m12:55:07.226184 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_frequency
[0m12:55:07.226184 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m12:55:07.226184 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce
[0m12:55:07.226184 [debug] [Thread-3 (]: Finished running node test.postgres_dev.unique_dim_member_member_key.31a1be2e46
[0m12:55:07.226184 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_frequency (execute): 12:55:07.226184 => 12:55:07.226184
[0m12:55:07.226184 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 12:55:07.226184 => 12:55:07.226184
[0m12:55:07.226184 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount
[0m12:55:07.226184 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m12:55:07.226184 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_frequency
[0m12:55:07.226184 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m12:55:07.226184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_dim_member_name__name__ref_us_healthcare_claims_data_.dfa962efce, now model.postgres_dev.total_paid_amount)
[0m12:55:07.226184 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.unique_dim_member_member_key.31a1be2e46, now model.postgres_dev.total_paid_amount_by_day)
[0m12:55:07.226184 [debug] [Thread-2 (]: Began running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:55:07.226184 [debug] [Thread-4 (]: Began running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:55:07.226184 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m12:55:07.226184 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m12:55:07.226184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.diagnosis_frequency, now test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead)
[0m12:55:07.226184 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb)
[0m12:55:07.226184 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m12:55:07.226184 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m12:55:07.226184 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:55:07.226184 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:55:07.226184 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 12:55:07.226184 => 12:55:07.226184
[0m12:55:07.241813 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 12:55:07.226184 => 12:55:07.241813
[0m12:55:07.241813 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead"
[0m12:55:07.241813 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb"
[0m12:55:07.241813 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount
[0m12:55:07.241813 [debug] [Thread-3 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m12:55:07.241813 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (compile): 12:55:07.226184 => 12:55:07.241813
[0m12:55:07.248326 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 12:55:07.248326 => 12:55:07.248326
[0m12:55:07.248326 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (compile): 12:55:07.241813 => 12:55:07.248326
[0m12:55:07.248326 [debug] [Thread-3 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 12:55:07.248326 => 12:55:07.248326
[0m12:55:07.248326 [debug] [Thread-2 (]: Began executing node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:55:07.248326 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount
[0m12:55:07.248326 [debug] [Thread-4 (]: Began executing node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:55:07.248326 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m12:55:07.248326 [debug] [Thread-2 (]: Timing info for test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead (execute): 12:55:07.248326 => 12:55:07.248326
[0m12:55:07.248326 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:55:07.248326 [debug] [Thread-4 (]: Timing info for test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb (execute): 12:55:07.248326 => 12:55:07.248326
[0m12:55:07.248326 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:55:07.248326 [debug] [Thread-2 (]: Finished running node test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead
[0m12:55:07.248326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount, now test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686)
[0m12:55:07.248326 [debug] [Thread-4 (]: Finished running node test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb
[0m12:55:07.248326 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_paid_amount_by_day, now test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a)
[0m12:55:07.248326 [debug] [Thread-2 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:55:07.248326 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:55:07.248326 [debug] [Thread-4 (]: Began running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:55:07.248326 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:55:07.248326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_claimed_date_key.b6174fbead, now test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718)
[0m12:55:07.248326 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686"
[0m12:55:07.248326 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.postgres_dev.not_null_fact_claims_enrolled_date_key.b04de21ddb, now test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8)
[0m12:55:07.263964 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a"
[0m12:55:07.263964 [debug] [Thread-2 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:55:07.263964 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (compile): 12:55:07.248326 => 12:55:07.263964
[0m12:55:07.263964 [debug] [Thread-4 (]: Began compiling node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:55:07.263964 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (compile): 12:55:07.248326 => 12:55:07.263964
[0m12:55:07.263964 [debug] [Thread-2 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718"
[0m12:55:07.263964 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:55:07.263964 [debug] [Thread-4 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8"
[0m12:55:07.263964 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:55:07.263964 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (compile): 12:55:07.263964 => 12:55:07.263964
[0m12:55:07.263964 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686 (execute): 12:55:07.263964 => 12:55:07.263964
[0m12:55:07.263964 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (compile): 12:55:07.263964 => 12:55:07.263964
[0m12:55:07.263964 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a (execute): 12:55:07.263964 => 12:55:07.263964
[0m12:55:07.263964 [debug] [Thread-2 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:55:07.263964 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686
[0m12:55:07.263964 [debug] [Thread-4 (]: Began executing node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:55:07.279590 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a
[0m12:55:07.279590 [debug] [Thread-2 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718 (execute): 12:55:07.279590 => 12:55:07.279590
[0m12:55:07.279590 [debug] [Thread-1 (]: Began running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:55:07.279590 [debug] [Thread-4 (]: Timing info for test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8 (execute): 12:55:07.279590 => 12:55:07.279590
[0m12:55:07.279590 [debug] [Thread-3 (]: Began running node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:55:07.279590 [debug] [Thread-2 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718
[0m12:55:07.279590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_claim_id__claim_id__ref_us_healthcare_claims_data_.4273da8686, now test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462)
[0m12:55:07.279590 [debug] [Thread-4 (]: Finished running node test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8
[0m12:55:07.279590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.postgres_dev.relationships_fact_claims_diagnosis_1_key__diagnosis_1__ref_us_healthcare_claims_data_.455d2be17a, now test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8)
[0m12:55:07.279590 [debug] [Thread-1 (]: Began compiling node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:55:07.279590 [debug] [Thread-3 (]: Began compiling node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:55:07.279590 [debug] [Thread-1 (]: Writing injected SQL for node "test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462"
[0m12:55:07.279590 [debug] [Thread-3 (]: Writing injected SQL for node "test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8"
[0m12:55:07.279590 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (compile): 12:55:07.279590 => 12:55:07.279590
[0m12:55:07.279590 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8 (compile): 12:55:07.279590 => 12:55:07.279590
[0m12:55:07.279590 [debug] [Thread-1 (]: Began executing node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:55:07.279590 [debug] [Thread-3 (]: Began executing node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:55:07.295313 [debug] [Thread-1 (]: Timing info for test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462 (execute): 12:55:07.279590 => 12:55:07.279590
[0m12:55:07.295313 [debug] [Thread-3 (]: Timing info for test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8 (execute): 12:55:07.295313 => 12:55:07.295313
[0m12:55:07.295820 [debug] [Thread-1 (]: Finished running node test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462
[0m12:55:07.295820 [debug] [Thread-3 (]: Finished running node test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8
[0m12:55:07.295820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:07.295820 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m12:55:07.295820 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m12:55:07.295820 [debug] [MainThread]: Connection 'test.postgres_dev.relationships_fact_claims_member_key__member_id__ref_us_healthcare_claims_data_.994f46f462' was properly closed.
[0m12:55:07.295820 [debug] [MainThread]: Connection 'test.postgres_dev.relationships_fact_claims_diagnosis_2_key__diagnosis_2__ref_us_healthcare_claims_data_.06dbab8718' was properly closed.
[0m12:55:07.295820 [debug] [MainThread]: Connection 'test.postgres_dev.relationships_total_paid_amount_paid_amount__ref_fact_claims_.62e27ac9a8' was properly closed.
[0m12:55:07.295820 [debug] [MainThread]: Connection 'test.postgres_dev.relationships_fact_claims_diagnosis_3_key__diagnosis_3__ref_us_healthcare_claims_data_.e651063df8' was properly closed.
[0m12:55:07.295820 [debug] [MainThread]: Command end result
[0m12:55:07.464166 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m12:55:07.464166 [info ] [MainThread]: Building catalog
[0m12:55:07.464166 [debug] [ThreadPool]: Acquiring new postgres connection 'bootcamp_project.information_schema'
[0m12:55:07.464166 [debug] [ThreadPool]: Using postgres connection "bootcamp_project.information_schema"
[0m12:55:07.464166 [debug] [ThreadPool]: On bootcamp_project.information_schema: BEGIN
[0m12:55:07.464166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:07.484891 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:55:07.484891 [debug] [ThreadPool]: Using postgres connection "bootcamp_project.information_schema"
[0m12:55:07.484891 [debug] [ThreadPool]: On bootcamp_project.information_schema: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "bootcamp_project.information_schema"} */

    
    

    select
        'bootcamp_project' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('us_healthcare_claims_data')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('total_allowed_amount')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('fact_claims')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('dim_date')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('total_paid_amount')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('diagnosis_frequency')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('final_us_healthcare_claims_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('icd_codes')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('dim_diagnosis')) or (upper(sch.nspname) = upper('public_gold') and
           upper(tbl.relname) = upper('total_paid_amount_by_day')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('dim_member')) or (upper(sch.nspname) = upper('public_silver') and
           upper(tbl.relname) = upper('icd_codes_data')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('us_healthcare_claims')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m12:55:07.500204 [debug] [ThreadPool]: SQL status: SELECT 95 in 0.0 seconds
[0m12:55:07.500204 [debug] [ThreadPool]: On bootcamp_project.information_schema: ROLLBACK
[0m12:55:07.500204 [debug] [ThreadPool]: On bootcamp_project.information_schema: Close
[0m12:55:07.516244 [info ] [MainThread]: Catalog written to D:\bootcamp_project\postgres_dev\target\catalog.json
[0m12:55:07.516244 [debug] [MainThread]: Command `dbt docs generate` succeeded at 12:55:07.516244 after 0.93 seconds
[0m12:55:07.516244 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m12:55:07.516244 [debug] [MainThread]: Connection 'bootcamp_project.information_schema' was properly closed.
[0m12:55:07.516244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05BB84CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05568E490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F05C3B8D50>]}
[0m12:55:07.516244 [debug] [MainThread]: Flushing usage events
[0m12:55:19.783847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0B555290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC082F1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0B554C10>]}


============================== 12:55:19.783847 | 31a2216c-f92f-4bea-82a4-e6b103bbc060 ==============================
[0m12:55:19.783847 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:55:19.783847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:55:19.927658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31a2216c-f92f-4bea-82a4-e6b103bbc060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0B57AB50>]}
[0m12:55:19.981239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31a2216c-f92f-4bea-82a4-e6b103bbc060', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0B035950>]}
[0m13:09:42.785656 [error] [MainThread]: Encountered an error:

[0m13:09:42.806011 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 169, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 198, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\requires.py", line 245, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\cli\main.py", line 324, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Akshay.Funde\AppData\Local\Programs\Python\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m13:09:42.813042 [debug] [MainThread]: Command `dbt docs serve` failed at 13:09:42.813042 after 863.08 seconds
[0m13:09:42.826537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC04ABF850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0B541490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0B541A10>]}
[0m13:09:42.829090 [debug] [MainThread]: Flushing usage events
[0m13:09:55.295815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB7F40790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB7F51650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB7F506D0>]}


============================== 13:09:55.295815 | fdf04172-6cb5-4bfb-b62f-f73c6eb1e741 ==============================
[0m13:09:55.295815 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:09:55.295815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m13:09:55.365301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdf04172-6cb5-4bfb-b62f-f73c6eb1e741', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB7FBCC50>]}
[0m13:09:55.390161 [debug] [MainThread]: Command `dbt clean` succeeded at 13:09:55.389164 after 0.13 seconds
[0m13:09:55.390161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB7F9FE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB7F9FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026AB125E390>]}
[0m13:09:55.390161 [debug] [MainThread]: Flushing usage events
[0m13:10:01.264501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42437E850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A423E75890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42436F810>]}


============================== 13:10:01.264501 | 62183342-2323-4346-8bb4-42f18644cc53 ==============================
[0m13:10:01.264501 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:10:01.264501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:10:01.338960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62183342-2323-4346-8bb4-42f18644cc53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4240986D0>]}
[0m13:10:01.341980 [debug] [MainThread]: Set downloads directory='C:\Users\AKSHAY~1.FUN\AppData\Local\Temp\dbt-downloads-ipsbkdya'
[0m13:10:01.342680 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:10:01.906300 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:10:01.908296 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:10:02.418966 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:10:02.444544 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:10:03.193507 [info ] [MainThread]: Installed from version 1.1.1
[0m13:10:03.193507 [info ] [MainThread]: Up to date!
[0m13:10:03.193507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '62183342-2323-4346-8bb4-42f18644cc53', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A42437C610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A424476C90>]}
[0m13:10:03.193507 [debug] [MainThread]: Command `dbt deps` succeeded at 13:10:03.193507 after 1.97 seconds
[0m13:10:03.193507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A423FD3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4243D8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A41D94C550>]}
[0m13:10:03.193507 [debug] [MainThread]: Flushing usage events
[0m13:10:29.097927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9B25510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9B5CCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9B1EE50>]}


============================== 13:10:29.113592 | 7c557d0f-b9ba-4b50-9681-6abfa3f1ecee ==============================
[0m13:10:29.113592 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:10:29.113592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:10:29.225040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9B5D290>]}
[0m13:10:29.285773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B84841D0>]}
[0m13:10:29.285773 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:10:29.296244 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:10:29.296244 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:10:29.304314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9D8D310>]}
[0m13:10:30.277877 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m13:10:30.279963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9F63610>]}
[0m13:10:30.298060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA367E90>]}
[0m13:10:30.298060 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m13:10:30.298060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9E54C50>]}
[0m13:10:30.298060 [info ] [MainThread]: 
[0m13:10:30.298060 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:30.309378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m13:10:30.309378 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m13:10:30.309378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m13:10:30.309378 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m13:10:30.309378 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m13:10:30.309378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:30.309378 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m13:10:30.309378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:30.342612 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:10:30.342612 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:10:30.342612 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m13:10:30.342612 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m13:10:30.342612 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m13:10:30.342612 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m13:10:30.342612 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m13:10:30.342612 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m13:10:30.358340 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m13:10:30.358340 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m13:10:30.359426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:30.359426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:30.374953 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.376096 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m13:10:30.376096 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m13:10:30.376096 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m13:10:30.376096 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m13:10:30.376096 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m13:10:30.376096 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.376096 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m13:10:30.376096 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m13:10:30.392468 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:10:30.392468 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m13:10:30.392468 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m13:10:30.398482 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:30.398482 [debug] [MainThread]: On master: BEGIN
[0m13:10:30.398482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:30.435371 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.435371 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:30.436490 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:10:30.440383 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:10:30.441492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA359550>]}
[0m13:10:30.441492 [debug] [MainThread]: On master: ROLLBACK
[0m13:10:30.442461 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:30.442461 [debug] [MainThread]: On master: BEGIN
[0m13:10:30.442461 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.442461 [debug] [MainThread]: On master: COMMIT
[0m13:10:30.442461 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:30.442461 [debug] [MainThread]: On master: COMMIT
[0m13:10:30.442461 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:10:30.442461 [debug] [MainThread]: On master: Close
[0m13:10:30.442461 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:10:30.442461 [info ] [MainThread]: 
[0m13:10:30.442461 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m13:10:30.442461 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m13:10:30.442461 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m13:10:30.442461 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m13:10:30.442461 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m13:10:30.455684 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m13:10:30.455684 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m13:10:30.456689 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m13:10:30.458406 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m13:10:30.458406 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m13:10:30.458406 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 13:10:30.458406 => 13:10:30.458406
[0m13:10:30.458406 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 13:10:30.456689 => 13:10:30.458406
[0m13:10:30.458406 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m13:10:30.458406 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m13:10:30.498749 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m13:10:30.498749 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m13:10:30.498749 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:10:30.498749 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:10:30.498749 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m13:10:30.498749 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m13:10:30.498749 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:10:30.498749 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:10:30.509637 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.509637 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:10:30.509637 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with us_healthcare_claims AS (
	SELECT *
	FROM 
		"bootcamp_project"."public"."us_healthcare_claims"
),
source_data AS (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from 
		us_healthcare_claims
)
 
select *
from source_data
  );
  
[0m13:10:30.525859 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m13:10:30.525859 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:10:30.525859 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m13:10:30.525859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.525859 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.525859 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:10:30.525859 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:10:30.541709 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m13:10:30.541709 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m13:10:30.543712 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.556829 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m13:10:30.556829 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:10:30.557778 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m13:10:30.574996 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:30.574996 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m13:10:30.590630 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:10:30.590630 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m13:10:30.614823 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:30.616918 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 13:10:30.458406 => 13:10:30.616327
[0m13:10:30.617461 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m13:10:30.618527 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA2FCA10>]}
[0m13:10:30.619061 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.16s]
[0m13:10:30.620661 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m13:10:30.621726 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m13:10:30.622255 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m13:10:30.622255 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m13:10:30.622791 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m13:10:30.623316 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m13:10:30.624902 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m13:10:30.623843 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m13:10:30.625680 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m13:10:30.626796 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m13:10:30.627906 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m13:10:30.628622 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m13:10:30.632252 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m13:10:30.632252 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m13:10:30.632252 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m13:10:30.632252 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m13:10:30.641719 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 13:10:30.628622 => 13:10:30.632252
[0m13:10:30.642712 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 13:10:30.632252 => 13:10:30.641719
[0m13:10:30.643712 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m13:10:30.643712 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 13:10:30.632252 => 13:10:30.643712
[0m13:10:30.644712 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m13:10:30.646580 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m13:10:30.646580 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m13:10:30.646580 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m13:10:30.658205 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m13:10:30.659217 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:10:30.660207 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m13:10:30.661205 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:10:30.662205 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m13:10:30.662205 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:10:30.663885 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m13:10:30.663885 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m13:10:30.663885 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m13:10:30.665395 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:10:30.665395 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:10:30.665395 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:10:30.665395 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m13:10:30.665395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.675936 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:10:30.675936 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m13:10:30.677358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.677358 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m13:10:30.677358 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:10:30.677358 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m13:10:30.677358 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.677358 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:10:30.677358 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
  Select * 
  FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
member_details AS (
  SELECT
    DISTINCT member_id AS member_key,
    name,
    address,
    email,
    gender
  FROM
    us_healthcare_claims_data
)

SELECT *
FROM member_details
  );
  
[0m13:10:30.677358 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.677358 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:10:30.677358 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m13:10:30.677358 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.691605 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m13:10:30.691605 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
  SELECT *
  FROM
    "bootcamp_project"."public_silver"."us_healthcare_claims_data"

),
 fact_claims AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  us_healthcare_claims_data
)

SELECT * 
FROM facfact_claimsts
  );
  
[0m13:10:30.693616 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "facfact_claimsts" does not exist
LINE 38: FROM facfact_claimsts
              ^

[0m13:10:30.693616 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: ROLLBACK
[0m13:10:30.693616 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 13:10:30.646580 => 13:10:30.693616
[0m13:10:30.693616 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m13:10:30.699126 [debug] [Thread-2 (]: Database Error in model fact_claims (models\silver\staging\artifacts\fact_claims.sql)
  relation "facfact_claimsts" does not exist
  LINE 38: FROM facfact_claimsts
                ^
  compiled Code at target\run\postgres_dev\models\silver\staging\artifacts\fact_claims.sql
[0m13:10:30.699126 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA369190>]}
[0m13:10:30.699126 [error] [Thread-2 (]: 5 of 11 ERROR creating sql table model public_silver.fact_claims ............... [[31mERROR[0m in 0.07s]
[0m13:10:30.699126 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m13:10:30.699126 [debug] [Thread-2 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m13:10:30.699126 [info ] [Thread-2 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m13:10:30.699126 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.final_us_healthcare_claims_data)
[0m13:10:30.699126 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m13:10:30.708177 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:10:30.709189 [debug] [Thread-2 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 13:10:30.699126 => 13:10:30.708177
[0m13:10:30.709189 [debug] [Thread-2 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m13:10:30.714182 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:10:30.714749 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:10:30.714749 [debug] [Thread-2 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m13:10:30.714749 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:10:30.714749 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:30.714749 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m13:10:30.714749 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:10:30.714749 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m13:10:30.724880 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m13:10:30.727553 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:10:30.727553 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m13:10:30.727553 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m13:10:30.727553 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:10:30.727553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.727553 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.727553 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m13:10:30.737816 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:10:30.737816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:30.737816 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:10:30.737816 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m13:10:30.741545 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 13:10:30.498749 => 13:10:30.741545
[0m13:10:30.743155 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.743155 [debug] [Thread-2 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m13:10:30.743888 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m13:10:30.743888 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:10:30.743888 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.743888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA3AD550>]}
[0m13:10:30.743888 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:10:30.743888 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m13:10:30.743888 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.30s]
[0m13:10:30.743888 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:10:30.743888 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m13:10:30.743888 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.743888 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m13:10:30.743888 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_allowed_amount
[0m13:10:30.743888 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m13:10:30.743888 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m13:10:30.758216 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:10:30.743888 [info ] [Thread-1 (]: 7 of 11 SKIP relation public_gold.total_allowed_amount ......................... [[33mSKIP[0m]
[0m13:10:30.762219 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:10:30.762640 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m13:10:30.762640 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m13:10:30.762640 [debug] [Thread-2 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m13:10:30.762640 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:30.762640 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount
[0m13:10:30.762640 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m13:10:30.762640 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.762640 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:30.762640 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:10:30.762640 [info ] [Thread-1 (]: 8 of 11 SKIP relation public_gold.total_paid_amount ............................ [[33mSKIP[0m]
[0m13:10:30.762640 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:10:30.774876 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m13:10:30.775889 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m13:10:30.775889 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount
[0m13:10:30.776877 [debug] [Thread-2 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m13:10:30.777875 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:10:30.778875 [debug] [Thread-1 (]: Began running node model.postgres_dev.dim_diagnosis
[0m13:10:30.780827 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m13:10:30.780827 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.780827 [info ] [Thread-1 (]: 9 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m13:10:30.780827 [debug] [Thread-2 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m13:10:30.780827 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:30.780827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.dim_diagnosis)
[0m13:10:30.780827 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:30.780827 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:10:30.780827 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 13:10:30.646580 => 13:10:30.780827
[0m13:10:30.780827 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m13:10:30.780827 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 13:10:30.644712 => 13:10:30.780827
[0m13:10:30.791567 [debug] [Thread-2 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m13:10:30.791567 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m13:10:30.794565 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m13:10:30.795565 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m13:10:30.799097 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA2A4750>]}
[0m13:10:30.799097 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA17BC90>]}
[0m13:10:30.799097 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:30.799097 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.17s]
[0m13:10:30.799097 [debug] [Thread-1 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 13:10:30.792566 => 13:10:30.799097
[0m13:10:30.799097 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m13:10:30.799097 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.17s]
[0m13:10:30.799097 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m13:10:30.799097 [debug] [Thread-1 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m13:10:30.808158 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:10:30.809178 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m13:10:30.812938 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m13:10:30.812938 [debug] [Thread-2 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m13:10:30.812938 [debug] [Thread-3 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m13:10:30.812938 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:10:30.812938 [debug] [Thread-1 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m13:10:30.812938 [info ] [Thread-3 (]: 10 of 11 SKIP relation public_gold.total_paid_amount_by_day .................... [[33mSKIP[0m]
[0m13:10:30.812938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:10:30.812938 [debug] [Thread-3 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m13:10:30.812938 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:30.812938 [debug] [Thread-2 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 13:10:30.710174 => 13:10:30.812938
[0m13:10:30.812938 [debug] [Thread-2 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m13:10:30.812938 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA4AEDD0>]}
[0m13:10:30.812938 [info ] [Thread-2 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.11s]
[0m13:10:30.825868 [debug] [Thread-2 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m13:10:30.829966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:10:30.829966 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:10:30.829966 [debug] [Thread-1 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m13:10:30.977951 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m13:10:30.977951 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:10:30.977951 [debug] [Thread-1 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m13:10:30.977951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.977951 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:10:30.977951 [debug] [Thread-1 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m13:10:30.977951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:10:30.977951 [debug] [Thread-1 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m13:10:30.977951 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:10:30.977951 [debug] [Thread-1 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m13:10:30.994479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:10:30.994479 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m13:10:30.994479 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:10:30.994479 [debug] [Thread-1 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m13:10:30.999486 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:10:30.999486 [debug] [Thread-1 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 13:10:30.810157 => 13:10:30.999486
[0m13:10:30.999486 [debug] [Thread-1 (]: On model.postgres_dev.dim_diagnosis: Close
[0m13:10:30.999486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c557d0f-b9ba-4b50-9681-6abfa3f1ecee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA4CBB50>]}
[0m13:10:30.999486 [info ] [Thread-1 (]: 9 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.22s]
[0m13:10:30.999486 [debug] [Thread-1 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m13:10:31.008259 [debug] [Thread-4 (]: Began running node model.postgres_dev.diagnosis_frequency
[0m13:10:31.010254 [info ] [Thread-4 (]: 11 of 11 SKIP relation public_gold.diagnosis_frequency ......................... [[33mSKIP[0m]
[0m13:10:31.010254 [debug] [Thread-4 (]: Finished running node model.postgres_dev.diagnosis_frequency
[0m13:10:31.012311 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:31.012311 [debug] [MainThread]: On master: BEGIN
[0m13:10:31.012311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:10:31.036484 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:10:31.037508 [debug] [MainThread]: On master: COMMIT
[0m13:10:31.037508 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:31.037508 [debug] [MainThread]: On master: COMMIT
[0m13:10:31.038485 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:10:31.038485 [debug] [MainThread]: On master: Close
[0m13:10:31.039484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:10:31.039484 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m13:10:31.040486 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m13:10:31.040486 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m13:10:31.040486 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m13:10:31.040486 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m13:10:31.041485 [debug] [MainThread]: Connection 'model.postgres_dev.final_us_healthcare_claims_data' was properly closed.
[0m13:10:31.041485 [debug] [MainThread]: Connection 'model.postgres_dev.dim_date' was properly closed.
[0m13:10:31.041485 [debug] [MainThread]: Connection 'model.postgres_dev.dim_member' was properly closed.
[0m13:10:31.042485 [info ] [MainThread]: 
[0m13:10:31.043489 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m13:10:31.045486 [debug] [MainThread]: Command end result
[0m13:10:31.060390 [info ] [MainThread]: 
[0m13:10:31.062390 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:10:31.062390 [info ] [MainThread]: 
[0m13:10:31.063885 [error] [MainThread]:   Database Error in model fact_claims (models\silver\staging\artifacts\fact_claims.sql)
  relation "facfact_claimsts" does not exist
  LINE 38: FROM facfact_claimsts
                ^
  compiled Code at target\run\postgres_dev\models\silver\staging\artifacts\fact_claims.sql
[0m13:10:31.063885 [info ] [MainThread]: 
[0m13:10:31.063885 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=4 TOTAL=11
[0m13:10:31.063885 [debug] [MainThread]: Command `dbt run` failed at 13:10:31.063885 after 2.00 seconds
[0m13:10:31.063885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9773150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240BA1FFE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000240B9EEA410>]}
[0m13:10:31.063885 [debug] [MainThread]: Flushing usage events
[0m13:11:22.622606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C96DF0C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C968B5950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C942F18D0>]}


============================== 13:11:22.625728 | 527ba48a-d06b-4d6b-a2f4-423983c5bcec ==============================
[0m13:11:22.625728 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:11:22.626729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\bootcamp_project\\postgres_dev\\logs', 'profiles_dir': 'C:\\Users\\Akshay.Funde\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:11:22.755899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C96F0A410>]}
[0m13:11:22.810656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C96EC72D0>]}
[0m13:11:22.811640 [info ] [MainThread]: Registered adapter: postgres=1.7.10
[0m13:11:22.819657 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:11:22.878602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:11:22.879604 [debug] [MainThread]: Partial parsing: updated file: postgres_dev://models\silver\staging\artifacts\fact_claims.sql
[0m13:11:23.075853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.postgres_dev.example
[0m13:11:23.080852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C974EF990>]}
[0m13:11:23.091233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C97586CD0>]}
[0m13:11:23.092080 [info ] [MainThread]: Found 11 models, 31 tests, 2 sources, 0 exposures, 0 metrics, 515 macros, 0 groups, 0 semantic models
[0m13:11:23.093089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C973553D0>]}
[0m13:11:23.095215 [info ] [MainThread]: 
[0m13:11:23.095215 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:23.095215 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m13:11:23.095215 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project'
[0m13:11:23.107979 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m13:11:23.110046 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project"
[0m13:11:23.111565 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m13:11:23.111565 [debug] [ThreadPool]: On list_bootcamp_project: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project"} */

    select distinct nspname from pg_namespace
  
[0m13:11:23.111565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:23.111565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:23.129212 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:11:23.129212 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m13:11:23.129212 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:11:23.140342 [debug] [ThreadPool]: On list_bootcamp_project: Close
[0m13:11:23.143346 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_gold'
[0m13:11:23.145343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_bootcamp_project_public_silver'
[0m13:11:23.147716 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m13:11:23.147716 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m13:11:23.147716 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: BEGIN
[0m13:11:23.147716 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: BEGIN
[0m13:11:23.147716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:23.147716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:23.190250 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.190250 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.191255 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_silver"
[0m13:11:23.191255 [debug] [ThreadPool]: Using postgres connection "list_bootcamp_project_public_gold"
[0m13:11:23.192250 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_silver"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m13:11:23.193252 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "list_bootcamp_project_public_gold"} */
select
      'bootcamp_project' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_gold'
    union all
    select
      'bootcamp_project' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_gold'
  
[0m13:11:23.197252 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m13:11:23.197252 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:11:23.198252 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: ROLLBACK
[0m13:11:23.199268 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: ROLLBACK
[0m13:11:23.201249 [debug] [ThreadPool]: On list_bootcamp_project_public_silver: Close
[0m13:11:23.201249 [debug] [ThreadPool]: On list_bootcamp_project_public_gold: Close
[0m13:11:23.210263 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:23.211263 [debug] [MainThread]: On master: BEGIN
[0m13:11:23.211263 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:23.230878 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.231881 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:23.231881 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:23.235879 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:11:23.236880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C97329BD0>]}
[0m13:11:23.237881 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:23.238879 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:23.238879 [debug] [MainThread]: On master: BEGIN
[0m13:11:23.240322 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.240322 [debug] [MainThread]: On master: COMMIT
[0m13:11:23.240322 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:23.240322 [debug] [MainThread]: On master: COMMIT
[0m13:11:23.240322 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.240322 [debug] [MainThread]: On master: Close
[0m13:11:23.240322 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:23.240322 [info ] [MainThread]: 
[0m13:11:23.240322 [debug] [Thread-1 (]: Began running node model.postgres_dev.icd_codes_data
[0m13:11:23.240322 [debug] [Thread-2 (]: Began running node model.postgres_dev.us_healthcare_claims_data
[0m13:11:23.240322 [info ] [Thread-1 (]: 1 of 11 START sql table model public_silver.icd_codes_data ..................... [RUN]
[0m13:11:23.240322 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.postgres_dev.icd_codes_data'
[0m13:11:23.240322 [info ] [Thread-2 (]: 2 of 11 START sql table model public_silver.us_healthcare_claims_data .......... [RUN]
[0m13:11:23.240322 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.icd_codes_data
[0m13:11:23.240322 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.postgres_dev.us_healthcare_claims_data'
[0m13:11:23.240322 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.icd_codes_data"
[0m13:11:23.240322 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.us_healthcare_claims_data
[0m13:11:23.256946 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.us_healthcare_claims_data"
[0m13:11:23.257784 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (compile): 13:11:23.240322 => 13:11:23.257784
[0m13:11:23.258794 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (compile): 13:11:23.240322 => 13:11:23.258794
[0m13:11:23.258794 [debug] [Thread-1 (]: Began executing node model.postgres_dev.icd_codes_data
[0m13:11:23.259975 [debug] [Thread-2 (]: Began executing node model.postgres_dev.us_healthcare_claims_data
[0m13:11:23.326314 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.icd_codes_data"
[0m13:11:23.326314 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.us_healthcare_claims_data"
[0m13:11:23.340432 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:11:23.341428 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: BEGIN
[0m13:11:23.341428 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:23.342428 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:11:23.342428 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: BEGIN
[0m13:11:23.343432 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:11:23.355428 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.355428 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:11:23.356431 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with us_healthcare_claims AS (
	SELECT *
	FROM 
		"bootcamp_project"."public"."us_healthcare_claims"
),
source_data AS (
 
    select claim as claim_id, member_id, name, address, email, 
	case when gender NOT IN ('Male', 'Female') then 'Others' else gender end as gender,
	date(date_of_birth) AS date_of_birth,
	COALESCE(diagnosis_1, diagnosis_2, diagnosis_3) AS diagnosis_1,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL THEN COALESCE(diagnosis_2, diagnosis_3)
        	ELSE CASE WHEN diagnosis_2 IS NOT NULL THEN diagnosis_3
            		ELSE NULL 
        		END 
    	END AS diagnosis_2,
    	CASE 
        	WHEN diagnosis_1 IS NOT NULL AND diagnosis_2 IS NOT NULL THEN diagnosis_3
        	ELSE NULL 
    	END AS diagnosis_3,
	allowed_amount::varchar AS allowed_amount,
    paid_amount::varchar AS paid_amount,
	enrolled_date,
	claimed_date,
	paid_date,
	created_date
	
	from 
		us_healthcare_claims
)
 
select *
from source_data
  );
  
[0m13:11:23.367428 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m13:11:23.372444 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:11:23.372444 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data" rename to "us_healthcare_claims_data__dbt_backup"
[0m13:11:23.373872 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.374874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.376889 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:11:23.376889 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:11:23.377874 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_tmp" rename to "us_healthcare_claims_data"
[0m13:11:23.377874 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */

  
    

  create  table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp"
  
  
    as
  
  (
    

with source_data as (
 
    select category_code, diagnosis_code, full_code, full_description, category_title
	from "bootcamp_project"."public"."icd_codes"
 
)
 
select *
from source_data
  );
  
[0m13:11:23.378874 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.392520 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m13:11:23.392520 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:11:23.392520 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: COMMIT
[0m13:11:23.414770 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.414770 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup"
[0m13:11:23.414770 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.us_healthcare_claims_data"
[0m13:11:23.414770 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_silver"."us_healthcare_claims_data__dbt_backup" cascade
[0m13:11:23.435407 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.435407 [debug] [Thread-2 (]: Timing info for model.postgres_dev.us_healthcare_claims_data (execute): 13:11:23.326314 => 13:11:23.435407
[0m13:11:23.435407 [debug] [Thread-2 (]: On model.postgres_dev.us_healthcare_claims_data: Close
[0m13:11:23.435407 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C96EEBF50>]}
[0m13:11:23.451057 [info ] [Thread-2 (]: 2 of 11 OK created sql table model public_silver.us_healthcare_claims_data ..... [[32mSELECT 1000[0m in 0.20s]
[0m13:11:23.451057 [debug] [Thread-2 (]: Finished running node model.postgres_dev.us_healthcare_claims_data
[0m13:11:23.454604 [debug] [Thread-4 (]: Began running node model.postgres_dev.dim_date
[0m13:11:23.454604 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_member
[0m13:11:23.454604 [debug] [Thread-2 (]: Began running node model.postgres_dev.fact_claims
[0m13:11:23.455639 [info ] [Thread-4 (]: 3 of 11 START sql table model public_silver.dim_date ........................... [RUN]
[0m13:11:23.456607 [info ] [Thread-3 (]: 4 of 11 START sql table model public_silver.dim_member ......................... [RUN]
[0m13:11:23.457117 [info ] [Thread-2 (]: 5 of 11 START sql table model public_silver.fact_claims ........................ [RUN]
[0m13:11:23.457961 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.postgres_dev.dim_date'
[0m13:11:23.457961 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.postgres_dev.dim_member'
[0m13:11:23.457961 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.us_healthcare_claims_data, now model.postgres_dev.fact_claims)
[0m13:11:23.457961 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.dim_date
[0m13:11:23.457961 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_member
[0m13:11:23.457961 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.fact_claims
[0m13:11:23.457961 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.dim_date"
[0m13:11:23.457961 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_member"
[0m13:11:23.467966 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.fact_claims"
[0m13:11:23.467966 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (compile): 13:11:23.457961 => 13:11:23.467966
[0m13:11:23.467966 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (compile): 13:11:23.457961 => 13:11:23.467966
[0m13:11:23.467966 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (compile): 13:11:23.457961 => 13:11:23.467966
[0m13:11:23.467966 [debug] [Thread-4 (]: Began executing node model.postgres_dev.dim_date
[0m13:11:23.467966 [debug] [Thread-2 (]: Began executing node model.postgres_dev.fact_claims
[0m13:11:23.467966 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_member
[0m13:11:23.477378 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.dim_date"
[0m13:11:23.480759 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.fact_claims"
[0m13:11:23.480759 [debug] [Thread-1 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m13:11:23.486287 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_member"
[0m13:11:23.486287 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:11:23.486287 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m13:11:23.486287 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:11:23.486287 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:11:23.491075 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: BEGIN
[0m13:11:23.491688 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: BEGIN
[0m13:11:23.492693 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data" rename to "icd_codes_data__dbt_backup"
[0m13:11:23.492693 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: BEGIN
[0m13:11:23.493690 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:11:23.494694 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:11:23.494694 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:11:23.496228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.496228 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:11:23.496228 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
alter table "bootcamp_project"."public_silver"."icd_codes_data__dbt_tmp" rename to "icd_codes_data"
[0m13:11:23.496228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.507953 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m13:11:23.508953 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:11:23.509956 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: COMMIT
[0m13:11:23.512888 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.512888 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.512888 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m13:11:23.512888 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:11:23.512888 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */

  
    

  create  table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
  SELECT *
  FROM
    "bootcamp_project"."public_silver"."us_healthcare_claims_data"

),
 fact_claims AS (
SELECT
  claim_id,
  member_id as member_key,
  diagnosis_1 as diagnosis_1_key,
  diagnosis_2 as diagnosis_2_key,
  diagnosis_3 as diagnosis_3_key,
  CAST(REGEXP_REPLACE(allowed_amount, '[$,]', '', 'g') AS numeric) AS allowed_amount,
  CAST(REGEXP_REPLACE(paid_amount, '[$,]', '', 'g') AS numeric) AS paid_amount,
  date(enrolled_date) as enrolled_date_key, 
  date(claimed_date) as claimed_date_key,
  date(paid_date) as paid_date_key

FROM
  us_healthcare_claims_data
)

SELECT * 
FROM fact_claims
  );
  
[0m13:11:23.512888 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
    SELECT * 
    FROM "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
dates_data AS (
    SELECT
        DISTINCT DATE(dates) as date_key,
        EXTRACT(DAY FROM dates) as day_of_month,
        EXTRACT(MONTH FROM dates) as month,
        EXTRACT(YEAR FROM dates) as year,
        EXTRACT(QUARTER FROM dates) as quarter,
        EXTRACT(DOW FROM dates) as day_of_week,
        EXTRACT(DOY FROM dates) as day_of_year,
        EXTRACT(WEEK FROM dates) as week_of_year,
        CASE WHEN EXTRACT(ISODOW FROM dates) IN (6, 7) THEN 1 ELSE 0 END as is_weekend
    FROM (
        SELECT enrolled_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT claimed_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT paid_date as dates FROM us_healthcare_claims_data 
        UNION
        SELECT created_date as dates FROM us_healthcare_claims_data 
    ) AS all_dates
    ORDER BY date_key
)

SELECT * 
FROM dates_data
  );
  
[0m13:11:23.512888 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.512888 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:11:23.512888 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_member__dbt_tmp"
  
  
    as
  
  (
    

with us_healthcare_claims_data AS (
  Select * 
  FROM
  "bootcamp_project"."public_silver"."us_healthcare_claims_data"
),
member_details AS (
  SELECT
    DISTINCT member_id AS member_key,
    name,
    address,
    email,
    gender
  FROM
    us_healthcare_claims_data
)

SELECT *
FROM member_details
  );
  
[0m13:11:23.525482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.541441 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup"
[0m13:11:23.542441 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.icd_codes_data"
[0m13:11:23.543442 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.icd_codes_data"} */
drop table if exists "bootcamp_project"."public_silver"."icd_codes_data__dbt_backup" cascade
[0m13:11:23.548437 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m13:11:23.552439 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:11:23.553439 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.553439 [debug] [Thread-4 (]: SQL status: SELECT 118 in 0.0 seconds
[0m13:11:23.553439 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m13:11:23.554444 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member" rename to "dim_member__dbt_backup"
[0m13:11:23.555439 [debug] [Thread-1 (]: Timing info for model.postgres_dev.icd_codes_data (execute): 13:11:23.260402 => 13:11:23.555439
[0m13:11:23.557438 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:11:23.560438 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m13:11:23.561438 [debug] [Thread-1 (]: On model.postgres_dev.icd_codes_data: Close
[0m13:11:23.561438 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date" rename to "dim_date__dbt_backup"
[0m13:11:23.562436 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims" rename to "fact_claims__dbt_backup"
[0m13:11:23.562436 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.563436 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C973D3D10>]}
[0m13:11:23.567436 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:11:23.567436 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.567436 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.568436 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
alter table "bootcamp_project"."public_silver"."dim_member__dbt_tmp" rename to "dim_member"
[0m13:11:23.568436 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public_silver.icd_codes_data ................ [[32mSELECT 71704[0m in 0.32s]
[0m13:11:23.573563 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m13:11:23.573563 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:11:23.573563 [debug] [Thread-1 (]: Finished running node model.postgres_dev.icd_codes_data
[0m13:11:23.573563 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
alter table "bootcamp_project"."public_silver"."fact_claims__dbt_tmp" rename to "fact_claims"
[0m13:11:23.573563 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
alter table "bootcamp_project"."public_silver"."dim_date__dbt_tmp" rename to "dim_date"
[0m13:11:23.573563 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.573563 [debug] [Thread-1 (]: Began running node model.postgres_dev.final_us_healthcare_claims_data
[0m13:11:23.573563 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m13:11:23.573563 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.573563 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.573563 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:11:23.573563 [info ] [Thread-1 (]: 6 of 11 START sql table model public_gold.final_us_healthcare_claims_data ...... [RUN]
[0m13:11:23.573563 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m13:11:23.573563 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m13:11:23.573563 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: COMMIT
[0m13:11:23.573563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.icd_codes_data, now model.postgres_dev.final_us_healthcare_claims_data)
[0m13:11:23.573563 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:11:23.573563 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m13:11:23.573563 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.final_us_healthcare_claims_data
[0m13:11:23.589191 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: COMMIT
[0m13:11:23.589191 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: COMMIT
[0m13:11:23.592000 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:11:23.592997 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.593666 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_member__dbt_backup"
[0m13:11:23.593666 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.593666 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.593666 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_member"
[0m13:11:23.593666 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (compile): 13:11:23.590337 => 13:11:23.593666
[0m13:11:23.593666 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_silver"."fact_claims__dbt_backup"
[0m13:11:23.593666 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_date__dbt_backup"
[0m13:11:23.593666 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_member"} */
drop table if exists "bootcamp_project"."public_silver"."dim_member__dbt_backup" cascade
[0m13:11:23.593666 [debug] [Thread-1 (]: Began executing node model.postgres_dev.final_us_healthcare_claims_data
[0m13:11:23.593666 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.fact_claims"
[0m13:11:23.593666 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.dim_date"
[0m13:11:23.610274 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:11:23.610274 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.fact_claims"} */
drop table if exists "bootcamp_project"."public_silver"."fact_claims__dbt_backup" cascade
[0m13:11:23.610274 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.610274 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_date"} */
drop table if exists "bootcamp_project"."public_silver"."dim_date__dbt_backup" cascade
[0m13:11:23.612787 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:11:23.612787 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_member (execute): 13:11:23.480759 => 13:11:23.612787
[0m13:11:23.612787 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: BEGIN
[0m13:11:23.612787 [debug] [Thread-3 (]: On model.postgres_dev.dim_member: Close
[0m13:11:23.612787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:23.612787 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C96FD0150>]}
[0m13:11:23.612787 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.612787 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.612787 [info ] [Thread-3 (]: 4 of 11 OK created sql table model public_silver.dim_member .................... [[32mSELECT 1000[0m in 0.15s]
[0m13:11:23.612787 [debug] [Thread-2 (]: Timing info for model.postgres_dev.fact_claims (execute): 13:11:23.477378 => 13:11:23.612787
[0m13:11:23.612787 [debug] [Thread-4 (]: Timing info for model.postgres_dev.dim_date (execute): 13:11:23.467966 => 13:11:23.612787
[0m13:11:23.612787 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_member
[0m13:11:23.612787 [debug] [Thread-2 (]: On model.postgres_dev.fact_claims: Close
[0m13:11:23.612787 [debug] [Thread-4 (]: On model.postgres_dev.dim_date: Close
[0m13:11:23.623562 [debug] [Thread-3 (]: Began running node model.postgres_dev.dim_diagnosis
[0m13:11:23.625562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C9756E090>]}
[0m13:11:23.626561 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C9756D910>]}
[0m13:11:23.627567 [info ] [Thread-3 (]: 7 of 11 START sql table model public_silver.dim_diagnosis ...................... [RUN]
[0m13:11:23.628563 [info ] [Thread-2 (]: 5 of 11 OK created sql table model public_silver.fact_claims ................... [[32mSELECT 1000[0m in 0.17s]
[0m13:11:23.630562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.630907 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_member, now model.postgres_dev.dim_diagnosis)
[0m13:11:23.629561 [info ] [Thread-4 (]: 3 of 11 OK created sql table model public_silver.dim_date ...................... [[32mSELECT 118[0m in 0.17s]
[0m13:11:23.630907 [debug] [Thread-2 (]: Finished running node model.postgres_dev.fact_claims
[0m13:11:23.630907 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:11:23.630907 [debug] [Thread-3 (]: Began compiling node model.postgres_dev.dim_diagnosis
[0m13:11:23.630907 [debug] [Thread-4 (]: Finished running node model.postgres_dev.dim_date
[0m13:11:23.630907 [debug] [Thread-2 (]: Began running node model.postgres_dev.total_allowed_amount
[0m13:11:23.630907 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */

  
    

  create  table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp"
  
  
    as
  
  (
    
 
with source_data as (
 
    select
	claim_id, member_id, name, address, email, 
	gender,
	date(date_of_birth) AS date_of_birth,
	diagnosis_1,
    diagnosis_2,
    diagnosis_3,
	allowed_amount,
    paid_amount,
	date(enrolled_date) as enrolled_date,
	date(claimed_date) as claimed_date,
	date(paid_date) as paid_date,
	date(created_date) as created_date
	
from "bootcamp_project"."public_silver"."us_healthcare_claims_data"
 
)
 
select *
from source_data
  );
  
[0m13:11:23.630907 [debug] [Thread-3 (]: Writing injected SQL for node "model.postgres_dev.dim_diagnosis"
[0m13:11:23.630907 [debug] [Thread-4 (]: Began running node model.postgres_dev.total_paid_amount
[0m13:11:23.630907 [info ] [Thread-2 (]: 8 of 11 START sql table model public_gold.total_allowed_amount ................. [RUN]
[0m13:11:23.641180 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (compile): 13:11:23.630907 => 13:11:23.630907
[0m13:11:23.630907 [info ] [Thread-4 (]: 9 of 11 START sql table model public_gold.total_paid_amount .................... [RUN]
[0m13:11:23.642183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.fact_claims, now model.postgres_dev.total_allowed_amount)
[0m13:11:23.642183 [debug] [Thread-3 (]: Began executing node model.postgres_dev.dim_diagnosis
[0m13:11:23.643183 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.postgres_dev.dim_date, now model.postgres_dev.total_paid_amount)
[0m13:11:23.644181 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.total_allowed_amount
[0m13:11:23.645724 [debug] [Thread-3 (]: Writing runtime sql for node "model.postgres_dev.dim_diagnosis"
[0m13:11:23.645724 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.0 seconds
[0m13:11:23.645724 [debug] [Thread-4 (]: Began compiling node model.postgres_dev.total_paid_amount
[0m13:11:23.645724 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.total_allowed_amount"
[0m13:11:23.645724 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:11:23.645724 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:11:23.659837 [debug] [Thread-4 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount"
[0m13:11:23.660908 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: BEGIN
[0m13:11:23.662206 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (compile): 13:11:23.645724 => 13:11:23.661615
[0m13:11:23.662357 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data" rename to "final_us_healthcare_claims_data__dbt_backup"
[0m13:11:23.663400 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:11:23.663949 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (compile): 13:11:23.645724 => 13:11:23.663949
[0m13:11:23.665011 [debug] [Thread-2 (]: Began executing node model.postgres_dev.total_allowed_amount
[0m13:11:23.666648 [debug] [Thread-4 (]: Began executing node model.postgres_dev.total_paid_amount
[0m13:11:23.668200 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.total_allowed_amount"
[0m13:11:23.668200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.668200 [debug] [Thread-4 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount"
[0m13:11:23.675425 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:11:23.676426 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m13:11:23.677424 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
alter table "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_tmp" rename to "final_us_healthcare_claims_data"
[0m13:11:23.678423 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m13:11:23.678423 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: BEGIN
[0m13:11:23.679227 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: BEGIN
[0m13:11:23.679227 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:11:23.679227 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:23.679227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.679227 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m13:11:23.679227 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:11:23.679227 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: COMMIT
[0m13:11:23.690291 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.693919 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup"
[0m13:11:23.693919 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.final_us_healthcare_claims_data"
[0m13:11:23.693919 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.final_us_healthcare_claims_data"} */
drop table if exists "bootcamp_project"."public_gold"."final_us_healthcare_claims_data__dbt_backup" cascade
[0m13:11:23.693919 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.693919 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:11:23.693919 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */

  
    

  create  table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp"
  
  
    as
  
  (
    -- models/dim_diagnosis.sql



WITH icd_codes AS (
  select *
  from "bootcamp_project"."public_silver"."icd_codes_data"
)

SELECT
  full_code AS diagnosis_key,
  category_code,
  diagnosis_code,
  full_description,
  category_title
FROM
  icd_codes
  );
  
[0m13:11:23.693919 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.693919 [debug] [Thread-1 (]: Timing info for model.postgres_dev.final_us_healthcare_claims_data (execute): 13:11:23.593666 => 13:11:23.693919
[0m13:11:23.693919 [debug] [Thread-1 (]: On model.postgres_dev.final_us_healthcare_claims_data: Close
[0m13:11:23.693919 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C973A7F90>]}
[0m13:11:23.693919 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.693919 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m13:11:23.693919 [info ] [Thread-1 (]: 6 of 11 OK created sql table model public_gold.final_us_healthcare_claims_data . [[32mSELECT 1000[0m in 0.12s]
[0m13:11:23.693919 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.693919 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT 
        *
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
),
source_data AS (
    SELECT 
        sum(allowed_amount) AS total_allowed_amount
    FROM 
        fact_claims
)
 
SELECT *
FROM source_data
  );
  
[0m13:11:23.693919 [debug] [Thread-1 (]: Finished running node model.postgres_dev.final_us_healthcare_claims_data
[0m13:11:23.693919 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m13:11:23.693919 [debug] [Thread-1 (]: Began running node model.postgres_dev.total_paid_amount_by_day
[0m13:11:23.709622 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp"
  
  
    as
  
  (
    

WITH fact_claims AS (
    SELECT 
        *
    FROM 
        "bootcamp_project"."public_silver"."fact_claims"
), 
source_data AS (
    SELECT 
        sum(paid_amount) AS total_paid_amount
    FROM 
        fact_claims
)
 
SELECT *
FROM source_data
  );
  
[0m13:11:23.710135 [info ] [Thread-1 (]: 10 of 11 START sql table model public_gold.total_paid_amount_by_day ............ [RUN]
[0m13:11:23.710135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.postgres_dev.final_us_healthcare_claims_data, now model.postgres_dev.total_paid_amount_by_day)
[0m13:11:23.710135 [debug] [Thread-1 (]: Began compiling node model.postgres_dev.total_paid_amount_by_day
[0m13:11:23.713950 [debug] [Thread-1 (]: Writing injected SQL for node "model.postgres_dev.total_paid_amount_by_day"
[0m13:11:23.713950 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:11:23.713950 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m13:11:23.713950 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:11:23.713950 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (compile): 13:11:23.710135 => 13:11:23.713950
[0m13:11:23.713950 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount" rename to "total_allowed_amount__dbt_backup"
[0m13:11:23.724607 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m13:11:23.725607 [debug] [Thread-1 (]: Began executing node model.postgres_dev.total_paid_amount_by_day
[0m13:11:23.726608 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount" rename to "total_paid_amount__dbt_backup"
[0m13:11:23.728801 [debug] [Thread-1 (]: Writing runtime sql for node "model.postgres_dev.total_paid_amount_by_day"
[0m13:11:23.728801 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.736580 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m13:11:23.736580 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m13:11:23.736580 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.736580 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
alter table "bootcamp_project"."public_gold"."total_allowed_amount__dbt_tmp" rename to "total_allowed_amount"
[0m13:11:23.736580 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: BEGIN
[0m13:11:23.742333 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m13:11:23.743334 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:23.744333 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount__dbt_tmp" rename to "total_paid_amount"
[0m13:11:23.745715 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.745715 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m13:11:23.745715 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.745715 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m13:11:23.745715 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m13:11:23.745715 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: COMMIT
[0m13:11:23.745715 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m13:11:23.745715 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: COMMIT
[0m13:11:23.759866 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.771492 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m13:11:23.772004 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */

  
    

  create  table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp"
  
  
    as
  
  (
    

WITH source_data AS ( 
    SELECT * 
    FROM 
         "bootcamp_project"."public_silver"."fact_claims"
), 
dim_day AS (
    SELECT
        date_key,
        day_of_month
    FROM
        "bootcamp_project"."public_silver"."dim_date"
),
calculate AS (
    SELECT 
        d.day_of_month AS paid_by_day,
        SUM(sd.paid_amount) AS total_paid_amount
    FROM 
        source_data sd
    LEFT JOIN
        dim_day d ON sd.paid_date_key = d.date_key
    WHERE
        sd.paid_date_key IS NOT NULL AND sd.paid_amount IS NOT NULL
    GROUP BY 
        d.day_of_month 
    ORDER BY
        d.day_of_month 
)
 
SELECT *
FROM calculate
  );
  
[0m13:11:23.775785 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.775785 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup"
[0m13:11:23.775785 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.775785 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.total_allowed_amount"
[0m13:11:23.775785 [debug] [Thread-4 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup"
[0m13:11:23.775785 [debug] [Thread-1 (]: SQL status: SELECT 30 in 0.0 seconds
[0m13:11:23.790484 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_allowed_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_allowed_amount__dbt_backup" cascade
[0m13:11:23.791362 [debug] [Thread-4 (]: Using postgres connection "model.postgres_dev.total_paid_amount"
[0m13:11:23.794361 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m13:11:23.795361 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount__dbt_backup" cascade
[0m13:11:23.795361 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day" rename to "total_paid_amount_by_day__dbt_backup"
[0m13:11:23.798361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.800381 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m13:11:23.801359 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
alter table "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_tmp" rename to "total_paid_amount_by_day"
[0m13:11:23.819262 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.819262 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.821263 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m13:11:23.823264 [debug] [Thread-2 (]: Timing info for model.postgres_dev.total_allowed_amount (execute): 13:11:23.667174 => 13:11:23.822262
[0m13:11:23.823264 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.823264 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m13:11:23.824337 [debug] [Thread-3 (]: SQL status: SELECT 71704 in 0.0 seconds
[0m13:11:23.824337 [debug] [Thread-2 (]: On model.postgres_dev.total_allowed_amount: Close
[0m13:11:23.824337 [debug] [Thread-4 (]: Timing info for model.postgres_dev.total_paid_amount (execute): 13:11:23.668200 => 13:11:23.824337
[0m13:11:23.824337 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: COMMIT
[0m13:11:23.824337 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:11:23.824337 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C971E82D0>]}
[0m13:11:23.824337 [debug] [Thread-4 (]: On model.postgres_dev.total_paid_amount: Close
[0m13:11:23.824337 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis" rename to "dim_diagnosis__dbt_backup"
[0m13:11:23.824337 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C96FC7C10>]}
[0m13:11:23.824337 [info ] [Thread-2 (]: 8 of 11 OK created sql table model public_gold.total_allowed_amount ............ [[32mSELECT 1[0m in 0.18s]
[0m13:11:23.824337 [debug] [Thread-2 (]: Finished running node model.postgres_dev.total_allowed_amount
[0m13:11:23.824337 [info ] [Thread-4 (]: 9 of 11 OK created sql table model public_gold.total_paid_amount ............... [[32mSELECT 1[0m in 0.18s]
[0m13:11:23.824337 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.824337 [debug] [Thread-4 (]: Finished running node model.postgres_dev.total_paid_amount
[0m13:11:23.824337 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:11:23.824337 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
alter table "bootcamp_project"."public_silver"."dim_diagnosis__dbt_tmp" rename to "dim_diagnosis"
[0m13:11:23.839964 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.841891 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m13:11:23.842898 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:11:23.843895 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: COMMIT
[0m13:11:23.845032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.845032 [debug] [Thread-1 (]: Applying DROP to: "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup"
[0m13:11:23.845032 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.858020 [debug] [Thread-1 (]: Using postgres connection "model.postgres_dev.total_paid_amount_by_day"
[0m13:11:23.859974 [debug] [Thread-3 (]: Applying DROP to: "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup"
[0m13:11:23.859974 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.total_paid_amount_by_day"} */
drop table if exists "bootcamp_project"."public_gold"."total_paid_amount_by_day__dbt_backup" cascade
[0m13:11:23.859974 [debug] [Thread-3 (]: Using postgres connection "model.postgres_dev.dim_diagnosis"
[0m13:11:23.859974 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.dim_diagnosis"} */
drop table if exists "bootcamp_project"."public_silver"."dim_diagnosis__dbt_backup" cascade
[0m13:11:23.859974 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.859974 [debug] [Thread-1 (]: Timing info for model.postgres_dev.total_paid_amount_by_day (execute): 13:11:23.726608 => 13:11:23.859974
[0m13:11:23.859974 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.859974 [debug] [Thread-1 (]: On model.postgres_dev.total_paid_amount_by_day: Close
[0m13:11:23.859974 [debug] [Thread-3 (]: Timing info for model.postgres_dev.dim_diagnosis (execute): 13:11:23.644181 => 13:11:23.859974
[0m13:11:23.859974 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C971BBFD0>]}
[0m13:11:23.859974 [debug] [Thread-3 (]: On model.postgres_dev.dim_diagnosis: Close
[0m13:11:23.859974 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C97514150>]}
[0m13:11:23.859974 [info ] [Thread-1 (]: 10 of 11 OK created sql table model public_gold.total_paid_amount_by_day ....... [[32mSELECT 30[0m in 0.15s]
[0m13:11:23.859974 [debug] [Thread-1 (]: Finished running node model.postgres_dev.total_paid_amount_by_day
[0m13:11:23.859974 [info ] [Thread-3 (]: 7 of 11 OK created sql table model public_silver.dim_diagnosis ................. [[32mSELECT 71704[0m in 0.23s]
[0m13:11:23.874540 [debug] [Thread-3 (]: Finished running node model.postgres_dev.dim_diagnosis
[0m13:11:23.875542 [debug] [Thread-2 (]: Began running node model.postgres_dev.diagnosis_frequency
[0m13:11:23.876542 [info ] [Thread-2 (]: 11 of 11 START sql table model public_gold.diagnosis_frequency ................. [RUN]
[0m13:11:23.877541 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.postgres_dev.total_allowed_amount, now model.postgres_dev.diagnosis_frequency)
[0m13:11:23.877541 [debug] [Thread-2 (]: Began compiling node model.postgres_dev.diagnosis_frequency
[0m13:11:23.878720 [debug] [Thread-2 (]: Writing injected SQL for node "model.postgres_dev.diagnosis_frequency"
[0m13:11:23.878720 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_frequency (compile): 13:11:23.878540 => 13:11:23.878720
[0m13:11:23.878720 [debug] [Thread-2 (]: Began executing node model.postgres_dev.diagnosis_frequency
[0m13:11:23.878720 [debug] [Thread-2 (]: Writing runtime sql for node "model.postgres_dev.diagnosis_frequency"
[0m13:11:23.878720 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m13:11:23.878720 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: BEGIN
[0m13:11:23.878720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:11:23.896318 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m13:11:23.896318 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m13:11:23.896318 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */

  
    

  create  table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp"
  
  
    as
  
  (
    -- models/diagnosis_analysis.sql



WITH fact_claims AS (
  SELECT
    diagnosis_1_key,
    diagnosis_2_key,
    diagnosis_3_key
  FROM "bootcamp_project"."public_silver"."fact_claims"
),
dim_diagnosis AS (
  SELECT *
  FROM "bootcamp_project"."public_silver"."dim_diagnosis"
),
analysis AS (
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d1 ON f.diagnosis_1_key = d1.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d2 ON f.diagnosis_2_key = d2.diagnosis_key
    UNION ALL
    SELECT
    diagnosis_key,
    category_title
    FROM fact_claims f
    LEFT JOIN dim_diagnosis d3 ON f.diagnosis_3_key = d3.diagnosis_key
)

select 
    diagnosis_key,
    category_title,
    count(*) as diagnosis_frequency
from 
    analysis
where
    category_title is NOT NULL
group by
    diagnosis_key,
    category_title
order by
    diagnosis_frequency desc
  );
  
[0m13:11:23.959710 [debug] [Thread-2 (]: SQL status: SELECT 2060 in 0.0 seconds
[0m13:11:23.959710 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m13:11:23.959710 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
alter table "bootcamp_project"."public_gold"."diagnosis_frequency" rename to "diagnosis_frequency__dbt_backup"
[0m13:11:23.959710 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.959710 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m13:11:23.959710 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
alter table "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_tmp" rename to "diagnosis_frequency"
[0m13:11:23.959710 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:11:23.959710 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m13:11:23.959710 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m13:11:23.959710 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: COMMIT
[0m13:11:23.976580 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m13:11:23.978583 [debug] [Thread-2 (]: Applying DROP to: "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup"
[0m13:11:23.979583 [debug] [Thread-2 (]: Using postgres connection "model.postgres_dev.diagnosis_frequency"
[0m13:11:23.979583 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "postgres_dev", "target_name": "dev", "node_id": "model.postgres_dev.diagnosis_frequency"} */
drop table if exists "bootcamp_project"."public_gold"."diagnosis_frequency__dbt_backup" cascade
[0m13:11:23.983581 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:11:23.984584 [debug] [Thread-2 (]: Timing info for model.postgres_dev.diagnosis_frequency (execute): 13:11:23.878720 => 13:11:23.984584
[0m13:11:23.985583 [debug] [Thread-2 (]: On model.postgres_dev.diagnosis_frequency: Close
[0m13:11:23.985583 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '527ba48a-d06b-4d6b-a2f4-423983c5bcec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C976CC090>]}
[0m13:11:23.986587 [info ] [Thread-2 (]: 11 of 11 OK created sql table model public_gold.diagnosis_frequency ............ [[32mSELECT 2060[0m in 0.11s]
[0m13:11:23.987583 [debug] [Thread-2 (]: Finished running node model.postgres_dev.diagnosis_frequency
[0m13:11:23.989605 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:23.990301 [debug] [MainThread]: On master: BEGIN
[0m13:11:23.990301 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:24.013595 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:11:24.013595 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.013595 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:24.013595 [debug] [MainThread]: On master: COMMIT
[0m13:11:24.013595 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:11:24.013595 [debug] [MainThread]: On master: Close
[0m13:11:24.013595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:24.013595 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m13:11:24.013595 [debug] [MainThread]: Connection 'list_bootcamp_project' was properly closed.
[0m13:11:24.013595 [debug] [MainThread]: Connection 'list_bootcamp_project_public_gold' was properly closed.
[0m13:11:24.013595 [debug] [MainThread]: Connection 'list_bootcamp_project_public_silver' was properly closed.
[0m13:11:24.013595 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount_by_day' was properly closed.
[0m13:11:24.013595 [debug] [MainThread]: Connection 'model.postgres_dev.diagnosis_frequency' was properly closed.
[0m13:11:24.013595 [debug] [MainThread]: Connection 'model.postgres_dev.total_paid_amount' was properly closed.
[0m13:11:24.013595 [debug] [MainThread]: Connection 'model.postgres_dev.dim_diagnosis' was properly closed.
[0m13:11:24.013595 [info ] [MainThread]: 
[0m13:11:24.013595 [info ] [MainThread]: Finished running 11 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m13:11:24.013595 [debug] [MainThread]: Command end result
[0m13:11:24.027128 [info ] [MainThread]: 
[0m13:11:24.027128 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:24.027128 [info ] [MainThread]: 
[0m13:11:24.027128 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m13:11:24.027128 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:24.027128 after 1.45 seconds
[0m13:11:24.027128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C9036C550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C9036C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011C900DE350>]}
[0m13:11:24.027128 [debug] [MainThread]: Flushing usage events
